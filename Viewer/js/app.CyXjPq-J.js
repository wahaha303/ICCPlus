var e=Object.defineProperty,t=(t,o,i)=>((t,o,i)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[o]=i)(t,"symbol"!=typeof o?o+"":o,i);function o(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}import{p as i,S as n,a as r,o as l,c as a,b as s,d as c,w as d,g as u,N as g,t as p,r as m,e as h,f as v,u as f,h as b,i as w,j as T,k as I,l as S,m as y,n as C,q as x,s as O,v as A,x as k,y as B,z as M,A as D,B as F,C as R,D as j,E as q,F as P,G as $,H as V,I as W,J as N,K as U,L,M as E,O as z,P as G,Q as H,R as _,T as Y,U as J,V as Z,W as X,X as K,Y as Q,Z as ee,_ as te,$ as oe,a0 as ie,a1 as ne,a2 as re,a3 as le,a4 as ae,a5 as se,a6 as ce,a7 as de,a8 as ue,a9 as ge,aa as pe,ab as me,ac as he,ad as ve,ae as fe,af as be,ag as we,ah as Te,ai as Ie,aj as Se,ak as ye,al as Ce,am as xe,an as Oe,ao as Ae,ap as ke,aq as Be,ar as Me,as as De,at as Fe,au as Re,av as je,aw as qe,ax as Pe,ay as $e,az as Ve,aA as We,aB as Ne,aC as Ue,aD as Le,aE as Ee,aF as ze,aG as Ge,aH as He,aI as _e,aJ as Ye,aK as Je,aL as Ze,aM as Xe,aN as Ke,aO as Qe,aP as et,aQ as tt,aR as ot,aS as it,aT as nt,aU as rt,aV as lt}from"./chunk-vendors.D6_oVHyc.js";
/*!
 * canvas-size
 * v2.0.0
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2024 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */
function at(e){const t=e.sizes.shift(),o=Math.max(Math.ceil(t[0]),1),i=Math.max(Math.ceil(t[1]),1),n=[o-1,i-1,1,1],r=performance.now(),l="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;let a,s;l?(a=new OffscreenCanvas(1,1),s=new OffscreenCanvas(o,i)):(a=document.createElement("canvas"),a.width=1,a.height=1,s=document.createElement("canvas"),s.width=o,s.height=i);const c=a.getContext("2d"),d=s.getContext("2d");d&&(d.fillRect.apply(d,n),c.drawImage(s,o-1,i-1,1,1,0,0,1,1));const u=c&&0!==c.getImageData(0,0,1,1).data[3],g=parseInt(performance.now()-r);return[a,s].forEach(e=>{e.height=0,e.width=0}),l?(postMessage({width:o,height:i,testTime:g,isTestPass:u}),!u&&e.sizes.length&&setTimeout(()=>{at(e)},0)):u?e.onSuccess({width:o,height:i,testTime:g}):(e.onError({width:o,height:i,testTime:g}),e.sizes.length&&setTimeout(()=>{at(e)},0)),u}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const st={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},ct={max:null,min:1,sizes:[],step:1024,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},dt={};function ut(e){const t=e.width===e.height,o=1===e.height,i=1===e.width,n=[];if(e.width&&e.height){const r=e.min||ct.min,l=e.step||ct.step;let a=Math.max(e.width,e.height);for(;a>=r;){const e=t||o?a:1,r=t||i?a:1;n.push([e,r]),a-=l}}else e.sizes.forEach(e=>{const r=t||o?e:1,l=t||i?e:1;n.push([r,l])});return n}function gt(e){const t="undefined"!=typeof window,o=t&&"Promise"in window,i=t&&"HTMLCanvasElement"in window,n=t&&"OffscreenCanvas"in window,r=URL.createObjectURL(new Blob([])).slice(-36),l=performance.now(),{onError:a,onSuccess:s,...c}=e,d=()=>parseInt(performance.now()-l);let u=null;if(!i)return!1;if(e.useWorker&&n){const e="\n            var canvasTest = ".concat(at.toString(),";\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),t=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(t);u=new Worker(o),URL.revokeObjectURL(o),u.onmessage=function(e){const{width:t,height:o,testTime:i,isTestPass:n}=e.data,l={width:t,height:o,testTime:i,totalTime:d()};n?(dt[r].onSuccess(l),delete dt[r]):dt[r].onError(l)}}return o?new Promise(t=>{const o={...e,onError(o){let{width:i,height:n,testTime:r}=o;const l={width:i,height:n,testTime:r,totalTime:d()};let s;if(0===e.sizes.length)s=!0;else{const[[t,o]]=e.sizes.slice(-1);s=i===t&&n===o}a(l),s&&t({...l,success:!1})},onSuccess(e){let{width:o,height:i,testTime:n}=e;const r={width:o,height:i,testTime:n,totalTime:d()};s(r),t({...r,success:!0})}};if(u){const{onError:e,onSuccess:t}=o;dt[r]={onError:e,onSuccess:t},u.postMessage(c)}else at(o)}):u?(dt[r]={onError:a,onSuccess:s},void u.postMessage(c)):at(e)}const pt={maxArea(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=ut({width:e.max,height:e.max,min:e.min,step:e.step,sizes:[...st.area]});return gt({...ct,...e,sizes:t})},maxHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=ut({width:1,height:e.max,min:e.min,step:e.step,sizes:[...st.height]});return gt({...ct,...e,sizes:t})},maxWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=ut({width:e.max,height:1,min:e.min,step:e.step,sizes:[...st.width]});return gt({...ct,...e,sizes:t})},test(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={...ct,...e};return t.sizes=[...t.sizes],t.width&&t.height&&(t.sizes=[[t.width,t.height]]),gt(t)}},mt="2.8.7",ht={selFilterBlurIsOn:!1,selFilterBlur:0,selFilterBrightIsOn:!1,selFilterBright:100,selFilterContIsOn:!1,selFilterCont:100,selFilterGrayIsOn:!1,selFilterGray:0,selFilterHueIsOn:!1,selFilterHue:0,selFilterInvertIsOn:!1,selFilterInvert:0,selFilterOpacIsOn:!1,selFilterOpac:100,selFilterSaturIsOn:!1,selFilterSatur:1,selFilterSepiaIsOn:!1,selFilterSepia:0,selBgColorIsOn:!0,selOverlayOnImage:!1,selFilterBgColor:"#70FF7EFF",selBorderColorIsOn:!1,selFilterBorderColor:"#000000FF",selImgBorderColorIsOn:!1,selFilterImgBorderColor:"#000000FF",selCTitleColorIsOn:!1,selFilterCTitleColor:"#000000FF",selCTextColorIsOn:!1,selFilterCTextColor:"#000000FF",selATitleColorIsOn:!1,selFilterATitleColor:"#000000FF",selATextColorIsOn:!1,selFilterATextColor:"#000000FF",selScoreTextColorIsOn:!1,selFilterSTextColor:"#000000FF",selFilterVisibleIsOn:!1,reqFilterBlurIsOn:!1,reqFilterBlur:0,reqFilterBrightIsOn:!1,reqFilterBright:100,reqFilterContIsOn:!1,reqFilterCont:100,reqFilterGrayIsOn:!1,reqFilterGray:0,reqFilterHueIsOn:!1,reqFilterHue:0,reqFilterInvertIsOn:!1,reqFilterInvert:0,reqFilterOpacIsOn:!0,reqFilterOpac:50,reqFilterSaturIsOn:!1,reqFilterSatur:1,reqFilterSepiaIsOn:!1,reqFilterSepia:0,reqBgColorIsOn:!1,reqOverlayOnImage:!1,reqFilterBgColor:"#FFFFFFFF",reqBorderColorIsOn:!1,reqFilterBorderColor:"#000000FF",reqImgBorderColorIsOn:!1,reqImgFilterBorderColor:"#000000FF",reqCTitleColorIsOn:!1,reqFilterCTitleColor:"#000000FF",reqCTextColorIsOn:!1,reqFilterCTextColor:"#000000FF",reqATitleColorIsOn:!1,reqFilterATitleColor:"#000000FF",reqATextColorIsOn:!1,reqFilterATextColor:"#000000FF",reqScoreTextColorIsOn:!1,reqFilterSTextColor:"#000000FF",reqFilterVisibleIsOn:!1,unselFilterBlurIsOn:!1,unselFilterBlur:0,unselFilterBrightIsOn:!1,unselFilterBright:100,unselFilterContIsOn:!1,unselFilterCont:100,unselFilterGrayIsOn:!1,unselFilterGray:0,unselFilterHueIsOn:!1,unselFilterHue:0,unselFilterInvertIsOn:!1,unselFilterInvert:0,unselFilterOpacIsOn:!1,unselFilterOpac:100,unselFilterSaturIsOn:!1,unselFilterSatur:1,unselFilterSepiaIsOn:!1,unselFilterSepia:0,unselFilterVisibleIsOn:!1},vt={customRowTitle:!1,rowTitle:"Times New Roman",customRowText:!1,rowText:"Times New Roman",customObjectTitle:!1,objectTitle:"Times New Roman",customObjectText:!1,objectText:"Times New Roman",customAddonTitle:!1,addonTitle:"Times New Roman",customAddonText:!1,addonText:"Times New Roman",customScoreText:!1,scoreText:"Times New Roman",rowTitleTextSize:200,rowTextTextSize:100,objectTitleTextSize:200,objectTextTextSize:100,addonTitleTextSize:200,addonTextTextSize:100,scoreTextSize:75,rowTitleColor:"#000000",rowTextColor:"#000000",objectTitleColor:"#000000",objectTextColor:"#000000",addonTitleColor:"#000000",addonTextColor:"#000000",scoreTextColor:"#000000",rowTitleAlign:"center",rowTextAlign:"center",objectTitleAlign:"center",objectTextAlign:"center",addonTitleAlign:"center",addonTextAlign:"center",scoreTextAlign:"center"},ft={objectImgBorderStyle:"solid",objectImgBorderWidth:2,objectImageWidth:100,objectImageMarginTop:0,objectImageMarginBottom:0,objectImgBorderRadiusTopLeft:0,objectImgBorderRadiusTopRight:0,objectImgBorderRadiusBottomRight:0,objectImgBorderRadiusBottomLeft:0,objectImgBorderRadiusIsPixels:!0,objectImgBorderIsOn:!1,objectImgOverflowIsOn:!1,objectImgBorderColor:"red",objectImgObjectFillStyle:"",objectImgObjectFillIsOn:!1,objectImgObjectFillHeight:0,objectImageBoxWidth:50},bt={rowImgBorderStyle:"solid",rowImgBorderWidth:2,rowImageWidth:100,rowImageMarginTop:0,rowImageMarginBottom:0,rowImgBorderRadiusTopLeft:0,rowImgBorderRadiusTopRight:0,rowImgBorderRadiusBottomRight:0,rowImgBorderRadiusBottomLeft:0,rowImgBorderRadiusIsPixels:!0,rowImgBorderIsOn:!1,rowImgOverflowIsOn:!1,rowImgBorderColor:"red",rowImageBoxWidth:50,rowImgObjectFillStyle:"",rowImgObjectFillIsOn:!1,rowImgObjectFillHeight:0},wt={useAddonImage:!1,addonImgBorderStyle:"solid",addonImgBorderWidth:2,addonImageWidth:100,addonImageMarginTop:0,addonImageMarginBottom:0,addonImgBorderRadiusTopLeft:0,addonImgBorderRadiusTopRight:0,addonImgBorderRadiusBottomRight:0,addonImgBorderRadiusBottomLeft:0,addonImgBorderRadiusIsPixels:!0,addonImgBorderIsOn:!1,addonImgOverflowIsOn:!1,addonImgBorderColor:"red",addonImgObjectFillStyle:"",addonImgObjectFillIsOn:!1,addonImgObjectFillHeight:0,addonImageBoxWidth:50},Tt={bgColorIsOn:!1,backgroundColor:"#FFFFFFFF",rowBgColorIsOn:!1,rowBgColor:"#FFFFFFFF",objectBgColorIsOn:!1,objectBgColor:"#FFFFFFFF",isBackgroundRepeat:!1,isBackgroundFitIn:!1,backgroundImage:"",isRowBackgroundRepeat:!1,isRowBackgroundFitIn:!1,rowBackgroundImage:"",isObjectBackgroundRepeat:!1,isObjectBackgroundFitIn:!1,objectBackgroundImage:""},It={objectHeight:!0,objectDesignIsAdvanced:!1,objectMargin:10,objectTextPadding:10,objectBorderStyle:"solid",objectBorderWidth:2,objectBorderIsOn:!1,objectDropShadowH:0,objectDropShadowV:0,objectDropShadowBlur:0,objectDropShadowSpread:0,objectDropShadowIsOn:!1,objectUseBoxShadowIsOn:!1,objectBorderRadiusTopLeft:0,objectBorderRadiusTopRight:0,objectBorderRadiusBottomRight:0,objectBorderRadiusBottomLeft:0,objectBorderRadiusIsPixels:!0,objectOverflowIsOn:!0,objectDropShadowColor:"grey",objectGradientIsOn:!1,objectGradient:"",objectGradientOnSelect:"",objectGradientOnReq:"",objectBorderColor:"red",objectBorderImage:"",objectBorderImageRepeat:"stretch",objectBorderImageWidth:5,objectBorderImageSliceTop:5,objectBorderImageSliceBottom:5,objectBorderImageSliceLeft:5,objectBorderImageSliceRight:5,removeSpaceAddonIsOn:!1,titlePaddingIsOn:!1},St={rowDesignIsAdvanced:!1,rowMargin:10,rowBodyMarginSides:1,rowBodyMarginTop:25,rowBodyMarginBottom:25,rowTextPaddingY:5,rowTextPaddingX:10,rowOverflowIsOn:!0,rowDropShadowH:0,rowDropShadowV:0,rowDropShadowBlur:0,rowDropShadowSpread:0,rowDropShadowColor:"grey",rowButtonXPadding:0,rowButtonYPadding:0,rowDropShadowIsOn:!1,rowUseBoxShadowIsOn:!1,rowBorderRadiusTopLeft:0,rowBorderRadiusTopRight:0,rowBorderRadiusBottomRight:0,rowBorderRadiusBottomLeft:0,rowBorderRadiusIsPixels:!0,rowBorderStyle:"solid",rowBorderWidth:2,rowBorderIsOn:!1,rowBorderColor:"red",rowGradientIsOn:!1,rowGradient:"",rowBorderImage:"",rowBorderImageRepeat:"stretch",rowBorderImageWidth:5,rowBorderImageSliceTop:5,rowBorderImageSliceBottom:5,rowBorderImageSliceLeft:5,rowBorderImageSliceRight:5},yt={useAddonDesign:!1,addonDesignIsAdvanced:!1,addonMargin:10,addonTextPadding:10,addonBorderStyle:"solid",addonBorderWidth:2,addonBorderIsOn:!1,addonDropShadowH:0,addonDropShadowV:0,addonDropShadowBlur:0,addonDropShadowSpread:0,addonDropShadowIsOn:!1,addonUseBoxShadowIsOn:!1,addonBorderRadiusTopLeft:0,addonBorderRadiusTopRight:0,addonBorderRadiusBottomRight:0,addonBorderRadiusBottomLeft:0,addonBorderRadiusIsPixels:!0,addonOverflowIsOn:!0,addonDropShadowColor:"grey",addonGradientIsOn:!1,addonGradient:"",addonGradientOnSelect:"",addonGradientOnReq:"",addonBorderColor:"red",addonBorderImage:"",addonBorderImageRepeat:"stretch",addonBorderImageWidth:5,addonBorderImageSliceTop:5,addonBorderImageSliceBottom:5,addonBorderImageSliceLeft:5,addonBorderImageSliceRight:5,useAddonBackgroundImage:!1,addonBackgroundImage:"",isAddonBackgroundFitIn:!1,isAddonBackgroundRepeat:!1,addonBgColorIsOn:!1,addonBgColor:"#FFFFFFFF",addonTitlePaddingIsOn:!1},Ct={customMultiTextFont:!1,multiChoiceCounterPosition:0,multiChoiceCounterSize:170,multiChoiceTextFont:"Times New Roman",multiChoiceTextSize:100},xt={barTextPadding:17,barTextMargin:0,customBarTextFont:!1,barTextFont:"Times New Roman",barPadding:0,barMargin:0,barTextSize:15,barTextColor:"#000000",barPointPos:"#FF0000FF",barPointNeg:"#FF0000FF",barIconColor:"#0000008A",barBackgroundColor:"#FFFFFFFF"},Ot={useBackpackDesign:!1,backpackBgColor:"#FFFFFF",isBackpackBgRepeat:!1,isBackpackBgFitIn:!1,backpackBgImage:"",backPackWidth:1400},app=i(

/*! Delete and replace this part with your project if you're pasting it in, leave it here if you have placed your project.json file under index.html. */
{version:mt,isEditModeOnAll:!0,isPointerCursor:!1,importedChoicesIsOpen:!0,curVolume:100,isMute:!1,showMusicPlayer:!1,fadeTransitionColor:"#000000FF",fadeTransitionTime:.25,fadeTransitionIsOn:!1,hideBackpackBtn:0,btnBackpackIsOn:0,showAllAddons:0,tmpRow:[],tmpChoice:[],tmpRequired:[],tmpScore:[],tmpAddon:[],tmpGroup:[],rowIdLength:4,objectIdLength:4,words:[],groups:[],rowDesignGroups:[],objectDesignGroups:[],objectsPerRow:"col-6",globalRequirements:[],googleFonts:[],customFonts:[],compressImageAuto:!1,useTextEditor:!0,useToolbarBtn:!1,useChoiceEditBtn:!0,hideScoresUpdated:!1,hideChoiceDT:!1,hideImages:!1,preloadImages:!1,preloadExternalImages:!1,useVW:!1,addPrefix:!0,activated:[],rows:[],pointTypes:[],variables:[],mdObjects:[],categories:[],printThis:!1,autoSaveIsOn:!1,autoSaveInterval:10,buildAutoSaveIsOn:!1,buildAutoSaveInterval:10,tooltipDelay:1e3,checkDeleteRow:!0,checkDeleteObject:!1,checkSelectAll:!1,defaultRowTitle:"Row",defaultRowText:"This is a row, and inside of it, you can place choices. On both rows and choices Requirements can be placed, which will block a row from being viewed, or make the player unable to select a choice, depending on either Point-types or the Ids of other choices. Point-types can be made in Features then Manage Points. Hovering over buttons will explain what they do. The Design of the project can be changed in 'Modify Design' at the side navigation bar, and private styling for each row can be turned on in the rows Settings. Default text like this can be turned off in Features -> Manage Defaults.",defaultChoiceTitle:"Choice",defaultChoiceText:"This is a Choice, and inside of it, you can place images and text. Scores can be added to it, and have Point-types attached. Addons can be added underneath the image and text. In the Functions at the bottom of the choice, there is an array of different things that can be done. Default text like this can be turned off in Features then Manage Defaults.",defaultBeforePoint:"Cost:",defaultAfterPoint:"points",defaultBeforeReq:"Required:",defaultAfterReq:"choice",defaultAddonTitle:"Addon",defaultAddonText:"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.",enableShortcut:!0,orderOrReqText:"0",defaultOrReq:"of",orderSelReqText:"0",defaultSelReq:"choice from",defaultRowTemplate:1,defaultRowWidth:"col-md-3",defaultRowJustify:"start",defaultRowAllowedChoices:0,defaultChoiceTemplate:1,defaultChoiceWidth:"",defaultChoiceMaxNum:99,defaultAddonJustify:"start",defaultAddonTemplate:1,defaultAddonWidth:"col-12",defaultUseSeperateAddon:!1,defaultUseShowAddon:!1,defaultUseHideAddon:!1,defaultUseShowScore:!0,defaultUseHideValue:!1,defaultUseShowReq:!1,cropperPosition:4,enableSearch:!0,backpack:[{index:0,id:"default_backpack_row",isBackpack:!0,title:"Result",debugTitle:"",titleText:"",objectWidth:"col-md-3",image:"",template:1,rowJustify:"start",isButtonRow:!1,buttonType:!0,buttonId:"",buttonText:"Click",buttonRandom:!1,buttonRandomNumber:1,isResultRow:!0,resultGroupId:"",isInfoRow:!0,defaultAspectWidth:1,defaultAspectHeight:1,allowedChoices:0,currentChoices:0,requireds:[],isEditModeOn:!1,isRequirementOpen:!1,objects:[],rowDesignGroups:[]}],styling:{...ht,...vt,...ft,...bt,...wt,...Tt,...It,...St,...yt,...Ct,...xt,...Ot}}
/*! End */

),At={version:mt,isEditModeOnAll:!0,isPointerCursor:!1,importedChoicesIsOpen:!0,curVolume:100,isMute:!1,showMusicPlayer:!1,fadeTransitionColor:"#000000FF",fadeTransitionTime:.25,fadeTransitionIsOn:!1,hideBackpackBtn:0,btnBackpackIsOn:0,showAllAddons:0,tmpRow:[],tmpChoice:[],tmpRequired:[],tmpScore:[],tmpAddon:[],tmpGroup:[],rowIdLength:4,objectIdLength:4,words:[],groups:[],rowDesignGroups:[],objectDesignGroups:[],objectsPerRow:"col-6",globalRequirements:[],googleFonts:[],customFonts:[],compressImageAuto:!1,useTextEditor:!0,useToolbarBtn:!1,useChoiceEditBtn:!0,hideScoresUpdated:!1,hideChoiceDT:!1,hideImages:!1,preloadImages:!1,preloadExternalImages:!1,useVW:!1,addPrefix:!0,activated:[],rows:[],pointTypes:[],variables:[],mdObjects:[],categories:[],printThis:!1,autoSaveIsOn:!1,autoSaveInterval:10,buildAutoSaveIsOn:!1,buildAutoSaveInterval:10,tooltipDelay:1e3,checkDeleteRow:!0,checkDeleteObject:!1,checkSelectAll:!1,defaultRowTitle:"Row",defaultRowText:"This is a row, and inside of it, you can place choices. On both rows and choices Requirements can be placed, which will block a row from being viewed, or make the player unable to select a choice, depending on either Point-types or the Ids of other choices. Point-types can be made in Features then Manage Points. Hovering over buttons will explain what they do. The Design of the project can be changed in 'Modify Design' at the side navigation bar, and private styling for each row can be turned on in the rows Settings. Default text like this can be turned off in Features -> Manage Defaults.",defaultChoiceTitle:"Choice",defaultChoiceText:"This is a Choice, and inside of it, you can place images and text. Scores can be added to it, and have Point-types attached. Addons can be added underneath the image and text. In the Functions at the bottom of the choice, there is an array of different things that can be done. Default text like this can be turned off in Features then Manage Defaults.",defaultBeforePoint:"Cost:",defaultAfterPoint:"points",defaultBeforeReq:"Required:",defaultAfterReq:"choice",defaultAddonTitle:"Addon",defaultAddonText:"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.",enableShortcut:!0,orderOrReqText:"0",defaultOrReq:"of",orderSelReqText:"0",defaultSelReq:"choice from",defaultRowTemplate:1,defaultRowWidth:"col-md-3",defaultRowJustify:"start",defaultRowAllowedChoices:0,defaultChoiceTemplate:1,defaultChoiceWidth:"",defaultChoiceMaxNum:99,defaultAddonJustify:"start",defaultAddonTemplate:1,defaultAddonWidth:"col-12",defaultUseSeperateAddon:!1,defaultUseShowAddon:!1,defaultUseHideAddon:!1,defaultUseShowScore:!0,defaultUseHideValue:!1,defaultUseShowReq:!1,cropperPosition:4,enableSearch:!0,backpack:[{index:0,id:"default_backpack_row",isBackpack:!0,title:"Result",debugTitle:"",titleText:"",objectWidth:"col-md-3",image:"",template:1,rowJustify:"start",isButtonRow:!1,buttonType:!0,buttonId:"",buttonText:"Click",buttonRandom:!1,buttonRandomNumber:1,isResultRow:!0,resultGroupId:"",isInfoRow:!0,defaultAspectWidth:1,defaultAspectHeight:1,allowedChoices:0,currentChoices:0,requireds:[],isEditModeOn:!1,isRequirementOpen:!1,objects:[],rowDesignGroups:[]}],styling:{...ht,...vt,...ft,...bt,...wt,...Tt,...It,...St,...yt,...Ct,...xt,...Ot}},kt=i(new n),Bt=i(new n),Mt=i(new n),Dt=i(new n),Ft=i(new n),Rt=i(new n),jt=i(new n),qt=i(new n),Pt=i(new n),$t=i(new n),Vt=i(new n),Wt=i(new r),Nt=i([]),Ut=i({value:"appCyoaViewer"}),Lt=i({value:"light"}),Et={ALLOWED_TAGS:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr","font","iframe","img"],ADD_ATTR:["href","target","style","class"]},zt=d(null),Gt=d(null),Ht=i({isBgmInit:!1,bgmIsPlaying:!1,bgmPlayInterval:0,bgmTitleInterval:0,bgmFadeInterval:0,bgmFadeTimer:0,bgmTitle:"No Audio Title",curBgmTime:0,curBgmLength:0,isSeeking:!1,lastFadeTime:0,isFadingOut:!1,bgmObjectId:"",noCors:!1}),_t=i({currentDialog:"none"}),Yt=i({currentDialog:"none"}),Jt=i({currentDialog:"none"}),Zt=i({labelText:"",timeoutMs:4e3,isOpen:!1}),Xt=i({allowDeselect:!1,isSingleFile:!1}),Kt=i({stored:!1,name:"Auto Save",time:"",app:""}),Qt=i(Array.from({length:99},(e,t)=>({stored:!1,name:"Slot ".concat(t+1),time:"",app:""}))),eo=i(Array.from({length:99},(e,t)=>({stored:!1,name:"Slot ".concat(t+1),time:"",app:""})));i({backgroundColor:"",backgroundImage:"",barBgColor:""});const to=new Set,oo={value:!1},io=m(window.innerWidth,e=>{const t=()=>e(window.innerWidth);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)});let no=f(()=>[...app.rows.flatMap(e=>e.objects).filter(e=>!e.isNotSelectable&&!e.isNotSearchable).map(({id:e})=>e),...app.rows.flatMap(e=>e.objects).flatMap(e=>{var t;return null!=(t=e.addons)?t:[]}).filter(e=>e.isSelectable&&!e.isNotSelectable&&!e.isNotSearchable).map(({id:e})=>e)]);function ro(){return v(no)}let lo=null,ao=null;function so(){return new Promise((e,t)=>{const o=indexedDB.open("cyoaPlusDB");o.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("cyoaStore")||t.createObjectStore("cyoaStore"),t.objectStoreNames.contains("buildStore")||t.createObjectStore("buildStore")},o.onsuccess=t=>{const o=t.target.result;e(o)},o.onerror=t})}function co(){return new Promise((e,t)=>{if(lo)return e(lo);const o=indexedDB.open("cyoaDB");let i=!1,n=[],r=[],l=[];o.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("buildStore")||t.createObjectStore("buildStore",{keyPath:"title"}),i=!0},o.onsuccess=o=>{const a=o.target.result;if(1===a.version)if(i)so().then(t=>{lo=t,e(lo)}).catch(t).finally(()=>{a.close()});else if(a.objectStoreNames.contains("buildStore")){const o=a.transaction(["buildStore"],"readonly").objectStore("buildStore").getAll();o.onsuccess=()=>{const i=o.result;for(let e=0;e<i.length;e++){const t=o.result[e];eo[e].stored=!0,eo[e].name=t.title,eo[e].time="Unknown"}so().then(t=>{lo=t,e(lo)}).catch(t).finally(()=>{ao=a})},o.onerror=o=>{console.error(o),so().then(t=>{lo=t,e(lo)}).catch(t).finally(()=>{a.close()})}}else so().then(t=>{lo=t,e(lo)}).catch(t).finally(()=>{a.close()});else{const o=[new Promise((e,t)=>{if(a.objectStoreNames.contains("cyoaStore")){const o=a.transaction("cyoaStore","readonly").objectStore("cyoaStore").openCursor();o.onsuccess=t=>{const o=t.target.result;o?(n.push({key:o.key,value:o.value}),o.continue()):e()},o.onerror=t}else e()}),new Promise((e,t)=>{if(a.objectStoreNames.contains("buildStore")){const o=a.transaction("buildStore","readonly").objectStore("buildStore").openCursor();o.onsuccess=t=>{const o=t.target.result;o?(r.push({key:o.key,value:o.value}),o.continue()):e()},o.onerror=t}else e()})];Promise.all(o).then(()=>(a.close(),new Promise((e,t)=>{const o=indexedDB.deleteDatabase("cyoaDB");o.onsuccess=()=>{const o=indexedDB.open("cyoaDB",1);o.onupgradeneeded=e=>{e.target.result.createObjectStore("buildStore",{keyPath:"title"});const t=e.target.transaction;if(t){const e=t.objectStore("buildStore");let o=0;for(let t=0;t<r.length;t++){const i=r[t];void 0!==i.value.title?(e.put(i.value),eo[o].stored=!0,eo[o].name=i.title,eo[o].time="Unknown",o+=1):l.push(i)}}},o.onsuccess=t=>{const o=t.target.result;ao=o,e()},o.onerror=e=>{t(e)}},o.onerror=e=>{t(e)}}))).catch(e=>{console.error(e),a.close()}).finally(()=>{const o=indexedDB.open("cyoaPlusDB");o.onupgradeneeded=e=>{const t=e.target.result;!t.objectStoreNames.contains("cyoaStore")&&n.length>0&&t.createObjectStore("cyoaStore"),t.objectStoreNames.contains("buildStore")||t.createObjectStore("buildStore");const o=e.target.transaction;if(o){if(n.length>0){const e=o.objectStore("cyoaStore");for(let t=0;t<n.length;t++){const o=n[t];e.put(o.value,o.key)}}if(l.length>0){const e=o.objectStore("buildStore");for(let t=0;t<l.length;t++){const o=l[t];e.put(o.value,o.key)}}}},o.onsuccess=t=>{const o=t.target.result;lo=o,e(lo)},o.onerror=e=>{t(e)}})}},o.onerror=e=>{t(e)}})}let uo=null;function go(e,t){return new Promise((o,i)=>{const n=setTimeout(()=>o(),e);t&&t.addEventListener("abort",()=>{clearTimeout(n),i(new DOMException("Aborted","AbortError"))})})}async function po(){const e=new AbortController;uo=e;const t="".concat(location.pathname.replace(/\/index\.html$/,"/"),"autoSave");for(;app.buildAutoSaveIsOn;){try{await go(1e3*app.buildAutoSaveInterval*60,e.signal)}catch(o){break}if(!app.buildAutoSaveIsOn)break;const i=(await co()).transaction("buildStore","readwrite").objectStore("buildStore"),n=navigator.language,r=new Date,l=new Intl.DateTimeFormat(n,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(r),a={stored:!0,name:"Auto Save",time:l,app:ho()};try{await new Promise((e,o)=>{const n=i.put(a,t);n.onsuccess=()=>e(),n.onerror=()=>o(n.error)}),Kt.stored=!0,Kt.time=l,Zt.labelText="Auto-save completed successfully.",Zt.isOpen=!0}catch(o){console.error(o)}}}async function mo(e,t,o=!1){const i=o?await new Promise((e,t)=>ao?e(ao):t()):await co();return new Promise((o,n)=>{const r=i.transaction(t,"readonly").objectStore(t).get(e);r.onsuccess=()=>o(void 0!==r.result?r.result:null),r.onerror=n})}function ho(){let e=[];return Array.from(kt.entries()).forEach(([t,o])=>{if(o.isRowButton){if(void 0!==Dt.get(t)){let i="".concat(t,"/RP#").concat(o.rndPoint,"/NUM#").concat(o.pointNum);e.push(i)}}else if(o.isVariable){void 0!==Pt.get(t)&&e.push(t)}else{const i=Ft.get(t);if(void 0!==i){const n=i.choice;let r=t,l=[];if(0===o.multiple){for(let e=0;e<n.scores.length;e++){const t=n.scores[e];t.isRandom&&t.setValue&&l.push("".concat(e,":").concat(t.value))}l.length>0&&(r+="/RS#".concat(l.join("/AND#"))),n.isActivateRandom&&n.activatedRandom&&(r+="/RND#".concat(n.activatedRandom.join("/AND#").replace(/\/ON#/g,"/RON#"))),n.textfieldIsOn&&n.customTextfieldIsOn&&void 0!==n.wordChangeSelect&&(r+="/WORD#".concat(n.wordChangeSelect.replace(/,/g,"/CHAR#"))),n.isImageUpload&&n.image!==n.defaultImage&&(r+="/IMG#".concat(n.image.replace(/,/g,"/CHAR#"))),e.push(r)}else{r+="/ON#".concat(o.multiple);for(let e=0;e<n.scores.length;e++){const t=n.scores[e];t.isRandom&&t.setValue&&l.push("".concat(e,":").concat(t.value))}l.length>0&&(r+="/RS#".concat(l.join("/AND#"))),n.isActivateRandom&&n.activatedRandomMul&&(r+="/RND#".concat(n.activatedRandomMul.flat(2).join("/AND#").replace(/\/ON#/g,"/RON#"))),e.push(r)}}}}),e.join(",")}function vo(){const e=new Date,t=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0"),n=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0"),l=String(e.getSeconds()).padStart(2,"0");return"".concat(t,"-").concat(o,"-").concat(i,"_").concat(n,"-").concat(r,"-").concat(l)}function fo(e){switch(e.type){case"id":{const t=e.reqId.split("/ON#"),o=Ft.get(t[0]);if(void 0!==o){const e=o.choice;return"".concat(t.length>1?"".concat(t[1]," "):"").concat(e.title)}break}case"points":{const t=Mt.get(e.reqId);if(void 0!==t)return"".concat(e.reqPoints," ").concat(t.name);break}case"or":{const t=[];if(void 0!==e.orRequireds)for(let o=0;o<e.orRequireds.length;o++)t.push(fo(e.orRequireds[o]));return"1"===app.orderOrReqText?"".concat(t.join(", ")," ").concat(void 0!==e.orNum?"".concat(app.defaultOrReq," ").concat(e.orNum):"".concat(app.defaultOrReq," 1")):"".concat(void 0!==e.orNum?"".concat(e.orNum," ").concat(app.defaultOrReq):"1 ".concat(app.defaultOrReq)," ").concat(t.join(", "))}case"selFromGroups":if(void 0!==e.selGroups){const t=[];for(let o=0;o<e.selGroups.length;o++){const i=e.selGroups[o],n=Rt.get(i);void 0!==n&&t.push(n.name)}return"1"===app.orderSelReqText?"".concat(t.join(", ")," ").concat(app.defaultOrReq," ").concat(e.selNum):"".concat(e.selNum," ").concat(app.defaultOrReq," ").concat(t.join(", "))}case"selFromRows":if(void 0!==e.selRows){const t=[];for(let o=0;o<e.selRows.length;o++){const i=e.selRows[o],n=Dt.get(i);void 0!==n&&t.push(n.title)}return"1"===app.orderSelReqText?"".concat(t.join(", ")," ").concat(app.defaultOrReq," ").concat(e.selNum):"".concat(e.selNum," ").concat(app.defaultOrReq," ").concat(t.join(", "))}case"selFromWhole":return"1"===app.orderSelReqText?"".concat(app.defaultOrReq," ").concat(e.selNum):"".concat(e.selNum," ").concat(app.defaultOrReq)}return""}function bo(e){return e.customTextIsOn?void 0!==e.customText?e.customText:"":"".concat(e.beforeText," ").concat(fo(e)," ").concat(e.afterText)}function wo(e){return Dt.has(e)||Ft.has(e)||qt.has(e)||Mt.has(e)||$t.has(e)||Vt.has(e)||Rt.has(e)||Pt.has(e)}function To(e,t){let o=app.addPrefix?"row-":"",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return wo(o)?e>2?To(0,++t):To(++e,t):o}function Io(e,t){let o=app.addPrefix?"word-":"",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return wo(o)?e>2?Io(0,++t):Io(++e,t):o}function So(e,t,o=!1){let i=app.addPrefix?o?"addon-":"choice-":"",n="abcdefghijklmnopqrstuvwxyz0123456789";for(var r=0;r<t;r++)i+=n.charAt(Math.floor(36*Math.random()));return wo(i)?e>2?So(0,++t):So(++e,t):i}function yo(e,t,o){let i=app.addPrefix?"design-":"",n="abcdefghijklmnopqrstuvwxyz0123456789";for(var r=0;r<t;r++)i+=n.charAt(Math.floor(36*Math.random()));return wo(i)?e>2?yo(0,++t):yo(++e,t):i}function Co(e,t){let o=app.addPrefix?"group-":"",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return wo(o)?e>2?Co(0,++t):Co(++e,t):o}function xo(e,t){let o=app.addPrefix?"point-":"",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return wo(o)?e>2?xo(0,++t):xo(++e,t):o}function Oo(e,t){let o=app.addPrefix?"variable-":"",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return wo(o)?e>2?Oo(0,++t):Oo(++e,t):o}function Ao(e,t){let o="s-",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return Wt.has(o)?e>2?Ao(0,++t):Ao(++e,t):o}function ko(e){switch(e){case"col-sm-6":case"col-sm-5":return 2;case"col-md-4":return 3;case"col-md-3":return 4;case"w-20":return 5;case"col-lg-2":return 6;case"w-14":return 7;case"w-12":return 8;case"w-11":return 9;case"w-10":return 10;case"w-9":return 11;case"col-xl-1":return 12;default:return 1}}let Bo,Mo=[];function Do(){return function(){if(Mo.length!==app.words.length)return!0;for(let e=0;e<Mo.length;e++){if(Mo[e].id!==app.words[e].id)return!0;if(Mo[e].replaceText!==app.words[e].replaceText)return!0}return!1}()&&(Mo=JSON.parse(JSON.stringify(app.words)),Bo=new RegExp(app.words.map(e=>e.id).sort((e,t)=>t.length-e.length).map(e=>e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")).join("|"),"g")),Bo}function Fo(e){let t=e;return app.words&&(t=t.replace(Do(),e=>{const t=Mt.get(e);if(void 0!==t){return(t.startingSum%1==0?t.startingSum:parseFloat(t.startingSum.toFixed(void 0!==t.decimalPlaces?t.decimalPlaces:2))).toString()}{const t=Ft.get(e);if(void 0!==t){const e=t.choice;if(e.isSelectableMultiple&&e.isMultipleUseVariable)return e.multipleUseVariable.toString()}else{const t=qt.get(e);if(void 0!==t)return t.replaceText}}return e})),t}function Ro(e,t,o){if(void 0!==o){if(void 0!==o.styling&&o.isPrivateStyling&&o[e])return o.styling;if(void 0!==app.objectDesignGroups){if(o.objectDesignGroups)for(let t=0;t<o.objectDesignGroups.length;t++){const i=Vt.get(o.objectDesignGroups[t]);if(void 0!==i&&i[e]){const e=i.activatedId,t=jt.get(e);if(""===e||qo(i.activatedId))return i.styling;if(void 0!==app.globalRequirements&&void 0!==t&&Wo(t.requireds))return i.styling}}if(o.groups)for(let t=0;t<o.groups.length;t++){const i=Rt.get(o.groups[t]);if(void 0!==i&&void 0!==i.designGroups)for(let o=0;o<i.designGroups.length;o++){const o=Vt.get(i.designGroups[t]);if(void 0!==o&&o[e]){const e=o.activatedId,t=jt.get(e);if(""===e||qo(o.activatedId))return o.styling;if(void 0!==app.globalRequirements&&void 0!==t&&Wo(t.requireds))return o.styling}}}}}if(void 0!==t){if(void 0!==t.styling&&t.isPrivateStyling&&t[e])return t.styling;if(void 0!==app.rowDesignGroups){if(t.rowDesignGroups)for(let o=0;o<t.rowDesignGroups.length;o++){const i=$t.get(t.rowDesignGroups[o]);if(void 0!==i&&i[e]){const e=i.activatedId,t=jt.get(e);if(""===e||qo(i.activatedId))return i.styling;if(void 0!==app.globalRequirements&&void 0!==t&&Wo(t.requireds))return i.styling}}if(t.groups)for(let o=0;o<t.groups.length;o++){const i=Rt.get(t.groups[o]);if(void 0!==i&&void 0!==i.designGroups)for(let t=0;t<i.designGroups.length;t++){const t=$t.get(i.designGroups[o]);if(void 0!==t&&t[e]){const e=t.activatedId,o=jt.get(e);if(""===e||qo(t.activatedId))return t.styling;if(void 0!==app.globalRequirements&&void 0!==o&&Wo(o.requireds))return t.styling}}}}}return app.styling}function jo(e,t){if(t.has(e)){return jo("".concat(e,"_dup"),t)}return e}function qo(e,t=kt){var o;const[i,n="0"]=e.split("/ON#"),r=parseInt(n);if(r>0){return((null==(o=t.get(i))?void 0:o.multiple)||0)>=r}return t.has(i)}function Po(e,t=1){switch(e){case"5":case"4":case"3":return 10*t+1;default:return 10*t+2}}function $o(e){if("number"==typeof e)return e;if("string"==typeof e)return Number(e);const t=$o(e.left),o=$o(e.right);switch(e.operator){case"1":return t+o;case"2":return t-o;case"3":return t*o;case"4":return 0!==o?t/o:t;case"5":return 0!==o?t%o:t;default:return t}}function Vo(e,t=kt){if(e.required)switch(e.type){case"id":return qo(e.reqId,t);case"points":const o=Mt.get(e.reqId);if(void 0!==o){if(void 0===e.operator)return o.startingSum>e.reqPoints;switch(e.operator){case"1":return o.startingSum>e.reqPoints;case"2":return o.startingSum>=e.reqPoints;case"3":return o.startingSum==e.reqPoints;case"4":return o.startingSum<=e.reqPoints;case"5":return o.startingSum<e.reqPoints}}return!1;case"or":let i=void 0===e.orNum?1:e.orNum,n=0;if(e.orRequireds)for(let g=0;g<e.orRequireds.length;g++){Vo(e.orRequireds[g],t)&&n++}return n>=i;case"pointCompare":const r=Mt.get(e.reqId),l=Mt.get(e.reqId1);if(void 0!==r&&void 0!==l){let t=l.startingSum;if(e.more)for(let i=0;i<e.more.length;i++){let o=0;const n=e.more[i],r=n.operator||"1",l=Po(r,n.priority);if(n.id){const e=Mt.get(n.id);void 0!==e&&(o=e.startingSum)}else void 0!==n.points&&(o=n.points);const a={left:t,operator:r,right:o,priority:l};t="number"!=typeof t&&l<t.priority?{left:t.left,operator:t.operator,right:{left:t.right,operator:r,right:o,priority:l},priority:t.priority}:a}const o=$o(t);switch(e.operator){case"1":return r.startingSum>o;case"2":return r.startingSum>=o;case"3":return r.startingSum==o;case"4":return r.startingSum<=o;case"5":return r.startingSum<o;default:return!1}}return!1;case"selFromGroups":if(e.selGroups){let t=0,o=void 0===e.selFromOperators?"1":e.selFromOperators,i=void 0===e.selNum?1:e.selNum;for(let n=0;n<e.selGroups.length;n++){const o=Rt.get(e.selGroups[n]);if(void 0!==o){const e=o.elements;for(let o=0;o<e.length;o++)kt.has(e[o])&&t++}}switch(o){case"1":return!(i>t||0===i&&t>0);case"2":return i===t;case"3":return!(i<t||0===i&&t>0);default:return!1}}case"selFromRows":if(e.selRows){let t=0,o=void 0===e.selFromOperators?"1":e.selFromOperators,i=void 0===e.selNum?1:e.selNum;for(let n=0;n<e.selRows.length;n++){const o=Dt.get(e.selRows[n]);void 0!==o&&(t+=o.currentChoices)}switch(o){case"1":return!(i>t||0===i&&t>0);case"2":return i===t;case"3":return!(i<t||0===i&&t>0);default:return!1}}case"selFromWhole":let a=0,s=void 0===e.selFromOperators?"1":e.selFromOperators,c=void 0===e.selNum?1:e.selNum;for(let e=0;e<app.rows.length;e++)a+=app.rows[e].currentChoices;switch(s){case"1":return!(c>a||0===c&&a>0);case"2":return c===a;case"3":return!(c<a||0===c&&a>0);default:return!1}case"gid":const d=jt.get(e.reqId);return void 0!==d&&void 0!==app.globalRequirements&&Wo(d.requireds,t);case"word":const u=qt.get(e.reqId);if(void 0!==u){let t=0;for(let o=0;o<e.orRequired.length;o++){let i=e.orRequired[o].req;void 0!==i&&u.replaceText===i&&t++}return t>=1}return!1}else switch(e.type){case"id":return!qo(e.reqId,t);case"or":let o=void 0===e.orNum?1:e.orNum,i=0;if(e.orRequireds){for(let o=0;o<e.orRequireds.length;o++){Vo(e.orRequireds[o],t)&&i++}return i<e.orRequireds.length-o+1}case"gid":const n=jt.get(e.reqId);return void 0!==n&&void 0!==app.globalRequirements&&!Wo(n.requireds,t)}return!1}function Wo(e,t=kt){let o=!0;if(void 0!==e)for(let i=0;i<e.length;i++){const n=e[i];let r=!0;if(void 0!==n.requireds)for(let e=0;e<n.requireds.length;e++)r=r&&Vo(n.requireds[e],t);r&&(o=o&&Vo(e[i],t))}return o}function No(e){const t=new Audio;return t.controls=!1,t.preload="metadata",e&&(t.crossOrigin="anonymous"),function(e){let t=!1,o=1,i=!1,n=!0;return e.addEventListener("loadedmetadata",()=>{i=Number.isFinite(e.duration)&&e.seekable&&e.seekable.length>0,i&&(Ht.curBgmLength=e.duration)}),e.addEventListener("play",()=>{n=!1}),e.addEventListener("ended",()=>{n=!0}),{type:"audio",load(t,o){e.src=t,e.loop=!!(null==o?void 0:o.loop),e.load(),n=!0,i=!1},play:()=>e.play().catch(e=>{throw n=!0,console.warn(e),e}),pause:()=>e.pause(),stop:()=>{e.pause(),i&&(e.currentTime=0),n=!0},mute:()=>{t=!0,e.muted=!0},unMute:()=>{t=!1,e.muted=!1},setVolume:i=>{o=i/100,t||(e.volume=o)},isPlaying:()=>!e.paused&&!n,isStopped:()=>n,isMuted:()=>t,seekTo:t=>{if(!i)return!1;try{return e.currentTime=t,!0}catch(o){return!1}},getCurrentTime:()=>i?e.currentTime:0,getDuration:()=>i?e.duration:0,getTitle:()=>{var t;return null!=(t=e.src.split("/").pop())?t:""},getId:()=>e.src}}(t)}function Uo(e,t,o,i){function n(){const o=i.play();Ht.noCors=!1,Promise.resolve(o).catch(()=>{i=function(e,t){const o=No(!1);return o.load(e,{loop:t}),o.play(),zt.set(o),Ht.noCors=!0,o}(t,!e.bgmNoLoop)})}function r(){let r=0,l=0,a=0;if(o&&i.load(t,{loop:!e.bgmNoLoop}),e.bgmFadeIn&&void 0!==e.bgmFadeInSec&&e.bgmFadeInSec>0){const t=e.bgmFadeInSec/20;Ht.lastFadeTime=e.bgmFadeInSec,i.setVolume(0),n(),0!==Ht.bgmFadeInterval&&(window.clearInterval(Ht.bgmFadeInterval),Ht.bgmFadeInterval=0),0!==Ht.bgmPlayInterval&&(window.clearInterval(Ht.bgmPlayInterval),Ht.bgmPlayInterval=0),Ht.isFadingOut&&(Ht.isFadingOut=!1),Ht.bgmFadeInterval=window.setInterval(()=>{i.isPlaying()&&(r<app.curVolume?(r+=5,i.setVolume(r),Ht.lastFadeTime=Ht.lastFadeTime-t):(i.setVolume(app.curVolume),window.clearInterval(Ht.bgmFadeInterval),Ht.bgmFadeInterval=0,Ht.lastFadeTime=0))},t)}else Ht.isFadingOut&&(Ht.isFadingOut=!1,window.clearInterval(Ht.bgmFadeInterval),Ht.bgmFadeInterval=0),n(),i.setVolume(app.curVolume);Ht.bgmObjectId=e.id,app.showMusicPlayer&&(0!==Ht.bgmTitleInterval&&(window.clearInterval(Ht.bgmTitleInterval),Ht.bgmTitleInterval=0),Ht.bgmTitleInterval=window.setInterval(()=>{i.getId()!==t||""===i.getTitle()||0===i.getDuration()&&!Ht.noCors||(Ht.bgmTitle=i.getTitle(),Ht.curBgmLength=i.getDuration(),window.clearInterval(Ht.bgmTitleInterval),Ht.bgmTitleInterval=0)},1e3),0!==Ht.bgmPlayInterval&&(window.clearInterval(Ht.bgmPlayInterval),Ht.bgmPlayInterval=0),Ht.bgmPlayInterval=window.setInterval(()=>{if(!Ht.isSeeking&&i.isPlaying()){const e=Math.floor(i.getCurrentTime());e!==Ht.curBgmTime?l!==e?Ht.curBgmTime=e:(a++,a>Ht.curBgmLength&&(a=1),Ht.curBgmTime=a):(l=e,a=e+1,Ht.curBgmTime=a)}},1e3))}if(Ht.isFadingOut){const e=Ht.lastFadeTime;0!==Ht.bgmFadeTimer&&(window.clearTimeout(Ht.bgmFadeTimer),Ht.bgmFadeTimer=0),Ht.bgmFadeTimer=window.setTimeout(()=>{r()},e)}else r()}function Lo(e,t){const o=app.curVolume/5;if(e.bgmFadeOut&&void 0!==e.bgmFadeOutSec&&e.bgmFadeOutSec>0&&o>0){const i=e.bgmFadeOutSec/o;let n=app.curVolume;Ht.lastFadeTime=e.bgmFadeOutSec,Ht.isFadingOut=!0,0!==Ht.bgmFadeInterval&&(window.clearInterval(Ht.bgmFadeInterval),Ht.bgmFadeInterval=0),Ht.bgmFadeInterval=window.setInterval(()=>{void 0!==t.setVolume&&(n>0?(n-=5,t.setVolume(n),Ht.lastFadeTime-=i):Ht.isFadingOut&&(t.pause(),t.setVolume(app.curVolume),window.clearInterval(Ht.bgmFadeInterval),Ht.bgmFadeInterval=0,Ht.lastFadeTime=0,Ht.isFadingOut=!1,0!==Ht.bgmTitleInterval&&(window.clearInterval(Ht.bgmTitleInterval),Ht.bgmTitleInterval=0),0!==Ht.bgmPlayInterval&&(window.clearInterval(Ht.bgmPlayInterval),Ht.bgmPlayInterval=0),Ht.bgmTitle="No Audio Title",Ht.curBgmTime=0,Ht.curBgmLength=0))},i)}else t.pause(),0!==Ht.bgmTitleInterval&&(window.clearInterval(Ht.bgmTitleInterval),Ht.bgmTitleInterval=0),0!==Ht.bgmPlayInterval&&(window.clearInterval(Ht.bgmPlayInterval),Ht.bgmPlayInterval=0),Ht.bgmTitle="No Audio Title",Ht.curBgmTime=0,Ht.curBgmLength=0}function Eo(e,t,o){const i=u(Gt);let n=u(zt);if(e.useAudioURL?(!n||"audio"!==n.type||n.getId()!==t&&!0===Ht.noCors)&&(null==n||n.stop(),n=No(!0),zt.set(n)):!i||n&&"youtube"===n.type||(null==n||n.stop(),n=function(e){return{type:"youtube",load(t,o){(null==o?void 0:o.loop)?(e.loadPlaylist(t),e.setLoop(!0)):(e.loadVideoById(t),e.setLoop(!1))},play:()=>e.playVideo(),pause:()=>e.pauseVideo(),stop:()=>e.stopVideo(),mute:()=>e.mute(),unMute:()=>e.unMute(),setVolume:t=>e.setVolume(t),isPlaying:()=>1===e.getPlayerState(),isStopped:()=>2===e.getPlayerState(),isMuted:()=>e.isMuted(),seekTo:t=>(e.seekTo(t,!0),!0),getCurrentTime:()=>e.getCurrentTime(),getDuration:()=>e.getDuration(),getTitle:()=>{var t,o,i;return null!=(i=null==(o=null==(t=e.playerInfo)?void 0:t.videoData)?void 0:o.title)?i:""},getId:()=>{var t,o,i;return null!=(i=null==(o=null==(t=e.playerInfo)?void 0:t.videoData)?void 0:o.video_id)?i:""}}}(i),zt.set(n)),n){const o=Ht.bgmIsPlaying;n.getId()===t?Ht.bgmObjectId===e.id?o?(n.isStopped()||n.stop(),Uo(e,t,!1,n)):Lo(e,n):o?(n.stop(),Uo(e,t,!1,n)):Lo(e,n):o&&Uo(e,t,!0,n)}else o<10?window.setTimeout(()=>{Eo(e,t,++o)},200):console.log("Failed to play bgm")}async function zo(e){const t=new((await new Promise(e=>{if(window.YT&&window.YT.Player)e(window.YT);else{const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api",document.head.appendChild(t),window.onYouTubeIframeAPIReady=()=>e(window.YT)}})).Player)("bgm-player",{width:0,height:0,events:{onReady:()=>{Gt.set(t),Eo(e,e.bgmId||"",0),app.isMute&&!t.isMuted()&&t.mute()}}})}function Go(e,t,o=!1){if(void 0!==e){if(t){const t=["addonBorderRadiusTopLeft","addonBorderRadiusTopRight","addonBorderRadiusBottomLeft","addonBorderRadiusBottomRight","addonImgBorderRadiusTopLeft","addonImgBorderRadiusTopRight","addonImgBorderRadiusBottomLeft","addonImgBorderRadiusBottomRight","objectBorderRadiusTopLeft","objectBorderRadiusTopRight","objectBorderRadiusBottomLeft","objectBorderRadiusBottomRight","objectImgBorderRadiusTopLeft","objectImgBorderRadiusTopRight","objectImgBorderRadiusBottomLeft","objectImgBorderRadiusBottomRight","rowBorderRadiusTopLeft","rowBorderRadiusTopRight","rowBorderRadiusBottomLeft","rowBorderRadiusBottomRight","rowImgBorderRadiusTopLeft","rowImgBorderRadiusTopRight","rowImgBorderRadiusBottomLeft","rowImgBorderRadiusBottomRight"];for(let o=0;o<t.length;o++){const i=t[o];void 0!==e[i]&&(e[i]=10*e[i])}}const i=["selFilterBgColor","selFilterBorderColor","selFilterCTitleColor","selFilterCTextColor","selFilterATitleColor","selFilterATextColor","selFilterSTextColor","reqFilterBgColor","reqFilterBorderColor","reqFilterCTitleColor","reqFilterCTextColor","reqFilterATitleColor","reqFilterATextColor","reqFilterSTextColor","rowTitleColor","rowTextColor","objectTitleColor","objectTextColor","addonTitleColor","addonTextColor","scoreTextColor","objectImgBorderColor","rowImgBorderColor","addonImgBorderColor","backgroundColor","rowBgColor","objectBgColor","objectDropShadowColor","objectBorderColor","rowDropShadowColor","rowBorderColor","addonDropShadowColor","addonBorderColor","addonBgColor","barTextColor","barIconColor","barBackgroundColor","backpackBgColor","barPointNeg","barPointPos"];for(let t=0;t<i.length;t++){const o=i[t];"object"==typeof e[o]&&(e[o]=e[o].hexa)}o&&(void 0===e.customMultiTextFont&&(e.customMultiTextFont=!1),void 0===e.multiChoiceCounterPosition&&(e.multiChoiceCounterPosition=0),void 0===e.multiChoiceCounterSize&&(e.multiChoiceCounterSize=170),void 0===e.multiChoiceTextFont&&(e.multiChoiceTextFont="Times New Roman"),void 0===e.multiChoiceTextSize&&(e.multiChoiceTextSize=100))}}function Ho(e,t,o){switch(t){case"1":return e-o;case"2":return e+o;case"3":return e*o;case"4":return e/o;case"5":return o;default:return e}}function _o(e){delete e.tmpDiscount,delete e.discountTextA,delete e.discountTextB,delete e.dupTextA,delete e.dupTextB,delete e.discountedFrom,delete e.discountIsOn,delete e.discountScore,delete e.discountScoreCal,delete e.notStackableDiscount,delete e.discountShow,delete e.discountBeforeText,delete e.discountAfterText,delete e.isChangeDiscount,delete e.tmpDisScore,delete e.appliedDiscount,delete e.replaceText,delete e.hideDisValue,delete e.hideDisIcon}function Yo(e,t){var o,i,n,r,l,a;for(let s=0;s<t.scores.length;s++){const c=t.scores[s],d=c.appliedDiscount;if(!c.isNotDiscountable&&(void 0===e.discountPointTypes||0===e.discountPointTypes.length||-1!==e.discountPointTypes.indexOf(c.id))){const s=Mt.get(c.id);if(void 0!==s&&void 0!==e.discountOperator&&void 0!==e.discountValue){let u=s.allowFloat?c.value:Math.floor(c.value),g=c.discountIsOn&&void 0!==c.discountScore?c.discountScore:c.value;g=s.allowFloat?g:Math.floor(g);let p=0,m=0,h=[],v=!1,f=0;if(e.stackableDiscount){if(c.notStackableDiscount){if(void 0!==c.tmpDiscount){for(let e=0;e<c.tmpDiscount.length;e++)c.tmpDiscount[e].isStackable&&(h=c.tmpDiscount[e].discountedFrom,u=c.tmpDiscount[e].discountedValue,f=e);c.tmpDiscount.splice(f,1)}}else if(void 0!==c.discountedFrom){let n=c.discountedFrom.indexOf(e.id);if(c.discountedFrom.splice(n,1),c.discountedFrom.length>0){let n=!1,r=!1,l=!1;p=u;for(let e=0;e<c.discountedFrom.length;e++){const t=Ft.get(c.discountedFrom[e]);if(void 0!==t){const e=t.choice;void 0!==e.discountOperator&&void 0!==e.discountValue&&(p=Ho(p,e.discountOperator,e.discountValue),p=s.allowFloat?p:Math.floor(p),m=p,e.replaceScoreText&&(n=e.replaceScoreText),e.hideScoreValue&&(r=e.hideScoreValue),e.hideScoreIcon&&(l=e.hideScoreIcon),e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(p=Math.max(p,e.discountLowLimit)))}}if(e.discountShow){let t=void 0!==e.discountAfterText&&void 0!==c.discountTextA?c.discountTextA.indexOf(e.discountAfterText):-1,n=void 0!==e.discountBeforeText&&void 0!==c.discountTextB?c.discountTextB.indexOf(e.discountBeforeText):-1;e.discountTextDuplicated?(-1!==t&&void 0!==c.dupTextA&&void 0!==e.discountAfterText&&(c.dupTextA[e.discountAfterText]-=1,0===c.dupTextA[e.discountAfterText]&&(null==(o=c.discountTextA)||o.splice(t,1),delete c.dupTextA[e.discountAfterText])),-1!==n&&void 0!==c.dupTextB&&void 0!==e.discountBeforeText&&(c.dupTextB[e.discountBeforeText]-=1,0===c.dupTextB[e.discountBeforeText]&&(null==(i=c.discountTextB)||i.splice(t,1),delete c.dupTextB[e.discountBeforeText]))):(-1!==t&&void 0!==c.discountTextA&&(c.discountTextA.splice(t,1),c.discountAfterText=c.discountTextA.join(" ")),-1!==n&&void 0!==c.discountTextB&&(c.discountTextB.splice(n,1),c.discountBeforeText=c.discountTextB.join(" ")))}if(c.discountScore=p,c.discountScoreCal=m,c.replaceText=n,c.hideDisValue=r,c.hideDisIcon=l,e.useDiscountCount&&c.appliedDiscount){c.tmpDisScore=g-c.value,t.isActive&&(c.isChangeDiscount=!0);continue}}else{if(void 0!==c.tmpDiscount)for(let e=0;e<c.tmpDiscount.length;e++)c.tmpDiscount[e].isStackable||p>c.tmpDiscount[e].discountedValue&&(h=c.tmpDiscount[e].discountedFrom,m=c.tmpDiscount[e].calcValue,p=c.tmpDiscount[e].discountedValue,f=e,v=!0);v&&void 0!==c.tmpDiscount?0===h.length?c.tmpDiscount.splice(f,1):(c.discountedFrom=h,c.tmpDiscount[f].showDiscount&&(c.discountBeforeText=c.tmpDiscount[f].beforeText,c.discountAfterText=c.tmpDiscount[f].afterText,c.replaceText=c.tmpDiscount[f].replaceText||!1,c.hideDisValue=c.tmpDiscount[f].hideValue||!1,c.hideDisIcon=c.tmpDiscount[f].hideIcon||!1),c.tmpDiscount.splice(f,1),c.notStackableDiscount=!0):_o(c)}}}else if(c.notStackableDiscount)if(void 0!==c.discountedFrom&&c.discountedFrom.length>0&&void 0!==c.tmpDiscount){if(-1!==c.discountedFrom.indexOf(e.id)){if(c.tmpDiscount.length>0){u=c.tmpDiscount[0].discountedValue,v=!0;for(let e=1;e<c.tmpDiscount.length;e++)u>c.tmpDiscount[e].discountedValue&&(u=c.tmpDiscount[e].discountedValue,f=e)}v?(c.discountScore=u,c.discountScoreCal=c.tmpDiscount[f].calcValue,c.discountedFrom=c.tmpDiscount[f].discountedFrom,c.notStackableDiscount=!c.tmpDiscount[f].isStackable,c.discountShow=c.tmpDiscount[f].showDiscount,c.tmpDiscount[f].isStackable&&c.tmpDiscount[f].showDiscount?(c.discountBeforeText=null==(n=c.discountTextB)?void 0:n.join(""),c.discountAfterText=null==(r=c.discountTextA)?void 0:r.join("")):c.tmpDiscount[f].showDiscount?(c.discountBeforeText=c.tmpDiscount[f].beforeText,c.discountAfterText=c.tmpDiscount[f].afterText,c.replaceText=c.tmpDiscount[f].replaceText||!1,c.hideDisValue=c.tmpDiscount[f].hideValue||!1,c.hideDisIcon=c.tmpDiscount[f].hideIcon||!1):(c.discountBeforeText="",c.discountAfterText="",c.replaceText=!1,c.hideDisValue=!1,c.hideDisIcon=!1),c.tmpDiscount.splice(f,1)):_o(c)}else for(let t=0;t<c.tmpDiscount.length;t++)if(-1!==c.tmpDiscount[t].discountedFrom.indexOf(e.id)){c.tmpDiscount.splice(t,1);break}}else _o(c);else if(void 0!==c.tmpDiscount){if(c.tmpDiscount=c.tmpDiscount.filter(t=>-1!==t.discountedFrom.indexOf(e.id)),c.tmpDiscount.length>0){u=c.tmpDiscount[0].discountedValue,v=!0;for(let e=1;e<c.tmpDiscount.length;e++)u>c.tmpDiscount[e].discountedValue&&(u=c.tmpDiscount[e].discountedValue,f=e)}v?(c.discountScore=u,c.discountScoreCal=c.tmpDiscount[f].calcValue,c.discountedFrom=c.tmpDiscount[f].discountedFrom,c.notStackableDiscount=!c.tmpDiscount[f].isStackable,c.notStackableDiscount?c.tmpDiscount[f].showDiscount?(c.discountBeforeText=c.tmpDiscount[f].beforeText,c.discountAfterText=c.tmpDiscount[f].afterText,c.replaceText=c.tmpDiscount[f].replaceText||!1,c.hideDisValue=c.tmpDiscount[f].hideValue||!1,c.hideDisIcon=c.tmpDiscount[f].hideIcon||!1):(c.discountBeforeText="",c.discountAfterText="",c.replaceText=!1,c.hideDisValue=!1,c.hideDisIcon=!1):(c.discountBeforeText=null==(l=c.discountTextB)?void 0:l.join(""),c.discountAfterText=null==(a=c.discountTextA)?void 0:a.join("")),c.tmpDiscount.splice(f,1)):_o(c)}else _o(c);let b=void 0!==c.discountScore?c.discountScore:c.value;b=s.allowFloat?b:Math.floor(b),b!==g&&d?(c.tmpDisScore=g-b,t.isActive&&(c.isChangeDiscount=!0)):t.isActive&&(c.isChangeDiscount=!1)}}}}function Jo(e,t){for(let o=0;o<t.scores.length;o++){const i=t.scores[o];if(!i.isNotDiscountable&&(void 0===e.discountPointTypes||0===e.discountPointTypes.length||-1!==e.discountPointTypes.indexOf(i.id))){const o=Mt.get(i.id);if(void 0!==o&&void 0!==e.discountOperator&&void 0!==e.discountValue){let n,r=o.allowFloat?i.value:Math.floor(i.value),l=i.discountIsOn&&void 0!==i.discountScore?i.discountScore:r,a=0,s=0,c=[],d=!1,u=0;if(void 0===i.discountedFrom&&(i.discountedFrom=[]),e.stackableDiscount)if(i.notStackableDiscount){if(void 0!==i.tmpDiscount){for(let t=0;t<i.tmpDiscount.length;t++)i.tmpDiscount[t].isStackable&&(c=i.tmpDiscount[t].discountedFrom,c.push(e.id),r=i.tmpDiscount[t].discountedValue,d=!0,u=t);a=Ho(r,e.discountOperator,e.discountValue),a=o.allowFloat?a:Math.floor(a),s=a,e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(a=Math.max(a,e.discountLowLimit)),void 0!==i.discountScore&&i.discountScore>a?(i.tmpDisScore=i.discountScore-a,t.isActive&&(i.isChangeDiscount=!0),n={isStackable:!1,discountedFrom:i.discountedFrom,calcValue:void 0!==i.discountScoreCal?i.discountScoreCal:i.discountScore,discountedValue:i.discountScore,showDiscount:!1,replaceText:!1,hideValue:!1,hideIcon:!1},i.discountShow&&(n.showDiscount=!0,n.beforeText=e.discountBeforeText,n.afterText=e.discountAfterText,e.replaceScoreText&&(n.replaceText=!0),e.hideScoreValue&&(n.hideValue=!0),e.hideScoreIcon&&(n.hideIcon=!0)),i.discountScore=a,i.discountScoreCal=s,e.discountShow&&(i.discountShow=!0,Zo(e,i)),void 0!==i.discountTextA&&(i.discountAfterText=i.discountTextA.join(" ")),void 0!==i.discountTextB&&(i.discountBeforeText=i.discountTextB.join(" ")),i.discountedFrom.push(...c),d&&i.tmpDiscount.splice(u,1),i.tmpDiscount.push(n),i.notStackableDiscount=!1):(t.isActive&&(i.isChangeDiscount=!1),c.push(e.id),e.discountShow&&Zo(e,i),d?(i.tmpDiscount[u].discountedFrom=c,i.tmpDiscount[u].calcValue=s,i.tmpDiscount[u].discountedValue=a):(n={isStackable:e.stackableDiscount||!1,discountedFrom:c,calcValue:s,discountedValue:a,showDiscount:e.discountShow||!1,replaceText:e.replaceScoreText||!1,hideValue:e.hideScoreValue||!1,hideIcon:e.hideScoreIcon||!1},i.tmpDiscount.push(n)))}}else r=i.discountIsOn&&void 0!==i.discountScoreCal?i.discountScoreCal:i.value,r=o.allowFloat?r:Math.floor(r),l=i.discountIsOn&&void 0!==i.discountScore?i.discountScore:i.value,l=o.allowFloat?l:Math.floor(l),a=Ho(r,e.discountOperator,e.discountValue),a=o.allowFloat?a:Math.floor(a),s=a,e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(a=Math.max(a,e.discountLowLimit)),Array.isArray(i.discountedFrom)||(i.discountedFrom=[]),i.discountScore=a,i.discountScoreCal=s,i.discountedFrom.push(e.id),i.discountScore!==l?(i.tmpDisScore=l-i.discountScore,t.isActive&&(i.isChangeDiscount=!0)):!i.appliedDiscount&&e.useDiscountCount&&e.discountCount?(void 0===e.appliedDisChoices&&(e.appliedDisChoices=[]),i.tmpDisScore=i.value-i.discountScore,t.isActive&&(i.isChangeDiscount=!0)):t.isActive&&(i.isChangeDiscount=!1),i.discountIsOn||(i.discountIsOn=!0),e.discountShow&&(i.discountShow=!0,Zo(e,i)),void 0!==i.discountTextA&&(i.discountAfterText=i.discountTextA.join(" ")),void 0!==i.discountTextB&&(i.discountBeforeText=i.discountTextB.join(" "));else void 0===i.tmpDiscount&&(i.tmpDiscount=[]),a=Ho(r,e.discountOperator,e.discountValue),a=o.allowFloat?a:Math.floor(a),s=a,e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(a=Math.max(a,e.discountLowLimit)),i.discountIsOn?void 0!==i.discountScore&&(i.discountScore>a?(n={isStackable:!i.notStackableDiscount,discountedFrom:i.discountedFrom,calcValue:void 0!==i.discountScoreCal?i.discountScoreCal:i.discountScore,discountedValue:i.discountScore,showDiscount:i.discountShow||!1},i.discountShow&&(n.showDiscount=!0,n.beforeText=i.discountBeforeText,n.afterText=i.discountAfterText,n.replaceText=i.replaceText||!1,n.hideValue=i.hideDisValue||!1,n.hideIcon=i.hideDisIcon||!1),i.discountScore=a,i.discountScoreCal=s,i.discountShow=e.discountShow,i.discountBeforeText=e.discountBeforeText,i.discountAfterText=e.discountAfterText,i.discountedFrom=[e.id],i.notStackableDiscount=!0,i.replaceText=e.replaceScoreText||!1,i.hideDisValue=e.hideScoreValue||!1,i.hideDisIcon=e.hideScoreIcon||!1):(n={isStackable:e.stackableDiscount||!1,discountedFrom:[e.id],calcValue:s,discountedValue:a,showDiscount:e.discountShow||!1,replaceText:i.replaceText||!1,hideValue:i.hideDisValue||!1,hideIcon:i.hideDisIcon||!1},e.discountShow&&(n.showDiscount=!0,n.beforeText=e.discountBeforeText,n.afterText=e.discountAfterText,e.replaceScoreText&&(n.replaceText=!0),e.hideScoreValue&&(n.hideValue=!0),e.hideScoreIcon&&(n.hideIcon=!0))),i.tmpDiscount.push(n)):(i.discountScore=a,i.discountScoreCal=s,e.discountShow&&(i.discountShow=e.discountShow,i.discountBeforeText=e.discountBeforeText,i.discountAfterText=e.discountAfterText,i.replaceText=e.replaceScoreText||!1,i.hideDisValue=e.hideScoreValue||!1,i.hideDisIcon=e.hideScoreIcon||!1),Array.isArray(i.discountedFrom)||(i.discountedFrom=[]),i.discountIsOn=!0,i.discountedFrom.push(e.id),i.notStackableDiscount=!0),void 0!==i.discountScore&&i.discountScore!==l?(i.tmpDisScore=l-i.discountScore,t.isActive&&(i.isChangeDiscount=!0)):t.isActive&&(i.isChangeDiscount=!1)}}}}function Zo(e,t){void 0===t.discountTextA&&(t.discountTextA=[]),void 0===t.discountTextB&&(t.discountTextB=[]),void 0===t.dupTextA&&(t.dupTextA={}),void 0===t.dupTextB&&(t.dupTextB={}),e.discountTextDuplicated?(void 0!==e.discountAfterText&&(-1!==t.discountTextA.indexOf(e.discountAfterText)?t.dupTextA[e.discountAfterText]=(t.dupTextA[e.discountAfterText]||0)+1:(t.dupTextA[e.discountAfterText]=1,t.discountTextA.push(e.discountAfterText))),void 0!==e.discountBeforeText&&(-1!==t.discountTextB.indexOf(e.discountBeforeText)?t.dupTextB[e.discountBeforeText]=(t.dupTextB[e.discountBeforeText]||0)+1:(t.dupTextB[e.discountBeforeText]=1,t.discountTextB.push(e.discountBeforeText)))):(void 0!==e.discountAfterText&&t.discountTextA.push(e.discountAfterText),void 0!==e.discountBeforeText&&t.discountTextB.push(e.discountBeforeText)),t.replaceText=e.replaceScoreText||!1,t.hideDisValue=e.hideScoreValue||!1,t.hideDisIcon=e.hideScoreIcon||!1}function Xo(e,t){if(t.discountedFrom&&t.discountedFrom.length>0)for(let o=0;o<t.discountedFrom.length;o++){const i=Ft.get(t.discountedFrom[o]);if(void 0!==i){const o=i.choice;let n=Ho(t.value,o.discountOperator,o.discountValue);n=e.allowFloat?n:Math.floor(n);let r=n;o.discountLowLimitIsOn&&void 0!==o.discountLowLimit&&(n=Math.max(n,o.discountLowLimit)),t.discountScore=n,t.discountScoreCal=r}}}function Ko(e,t){let o=!0;const i=new Map,r=new n(JSON.parse(JSON.stringify([...kt]))),l=r.get(e.id);t?e.isSelectableMultiple&&e.isMultipleUseVariable?void 0!==l?l.multiple+=1:r.set(e.id,{multiple:e.multipleUseVariable+1}):r.set(e.id,{multiple:0}):void 0!==l&&r.delete(e.id);for(let n=0;n<e.scores.length;n++){const l=e.scores[n],s=Mt.get(l.id);if(void 0!==s){if(l.useExpression&&!l.setValue){if(l.isRandom&&l.expMinValue&&l.expMaxValue)try{const t=l.expMinValue.replace(/\{([^{}]+)\}/g,(e,t)=>{const o=i.get(t);if(void 0!==o)return"".concat(o);{const e=Mt.get(t);if(void 0!==e)return"".concat(e.startingSum)}throw new Error('Undefined variable: "'.concat(t,'"'))}),o=l.expMaxValue.replace(/\{([^{}]+)\}/g,(e,t)=>{const o=i.get(t);if(void 0!==o)return"".concat(o);{const e=Mt.get(t);if(void 0!==e)return"".concat(e.startingSum)}throw new Error('Undefined variable: "'.concat(t,'"'))}),n=g(t),r=g(o);l.value=Math.floor(Math.random()*(r-n+1))+n,l.value=s.allowFloat?l.value:Math.floor(l.value),l.setValue=!0,e.isSelectableMultiple&&e.isMultipleUseVariable&&(void 0===l.mulValue&&(l.mulValue=[]),l.mulValue.push(l.value))}catch(a){console.error(a)}else if(l.expValue)try{const t=l.expValue.replace(/\{([^{}]+)\}/g,(e,t)=>{const o=i.get(t);if(void 0!==o)return"".concat(o);{const e=Mt.get(t);if(void 0!==e)return"".concat(e.startingSum)}throw new Error('Undefined variable: "'.concat(t,'"'))});l.value=g(t),l.value=s.allowFloat?l.value:Math.floor(l.value),l.setValue=!0,e.isSelectableMultiple&&e.isMultipleUseVariable&&(void 0===l.mulValue&&(l.mulValue=[]),l.mulValue.push(l.value))}catch(a){console.error(a)}}else l.isRandom&&!l.setValue&&Qo(s,l);let n=l.discountIsOn&&void 0!==l.discountScore&&l.appliedDiscount?l.discountScore:l.value;if(l.multiplyByTimes&&(n*=Math.abs(e.multipleUseVariable)+1),Wo(l.requireds,r)&&!l.isActive){const e=i.get(l.id);void 0!==e?(s.belowZeroNotAllowed&&(o=o&&(t?e-n>=0:e+n>=0)),i.set(l.id,e-n)):(s.belowZeroNotAllowed&&(o=o&&(t?s.startingSum-n>=0:s.startingSum+n>=0)),i.set(l.id,s.startingSum-n))}}}if(e.multiplyPointtypeIsOnCheck&&void 0!==e.pointTypeToMultiply){let t=0;for(let i=0;i<e.pointTypeToMultiply.length;i++){let n=Mt.get(e.pointTypeToMultiply[i]);if(void 0!==n&&n.belowZeroNotAllowed){let r=n.startingSum;for(let o=Nt.length-1;o>=0;o--){let l=Nt[o];if(l.multiplyPointtypeIsOnCheck&&void 0!==l.startingSumAtMultiply){let e=l.startingSumAtMultiply[i].value*l.startingSumAtMultiply[i].calcVal;e=n.allowFloat?e:Math.floor(e),r-=e,r+=l.startingSumAtMultiply[i].value}if(l.dividePointtypeIsOnCheck&&void 0!==l.startingSumAtDivide){let e=l.startingSumAtDivide[i].value/l.startingSumAtDivide[i].calcVal;e=n.allowFloat?e:Math.floor(e),r-=e,r+=l.startingSumAtDivide[i].value}if(l.setPointtypeIsOnCheck&&void 0!==l.startingSumAtSet&&(r=l.startingSumAtSet[i].value),l.id===e.id){t=o;break}}for(let e=t+1;e<Nt.length;e++){let t=Nt[e];t.multiplyPointtypeIsOnCheck&&void 0!==t.startingSumAtMultiply&&(r*=t.startingSumAtMultiply[i].calcVal,r=n.allowFloat?r:Math.floor(r)),t.dividePointtypeIsOnCheck&&void 0!==t.startingSumAtDivide&&(r/=t.startingSumAtDivide[i].calcVal,r=n.allowFloat?r:Math.floor(r)),t.setPointtypeIsOnCheck&&void 0!==t.startingSumAtSet&&(r=t.startingSumAtSet[i].calcVal,r=n.allowFloat?r:Math.floor(r))}o=o&&r>=0}}}if(e.dividePointtypeIsOnCheck&&void 0!==e.pointTypeToDivide){let t=0;for(let i=0;i<e.pointTypeToDivide.length;i++){let n=Mt.get(e.pointTypeToDivide[i]);if(void 0!==n&&n.belowZeroNotAllowed){let r=n.startingSum;for(let o=Nt.length-1;o>=0;o--){let l=Nt[o];if(l.multiplyPointtypeIsOnCheck&&void 0!==l.startingSumAtMultiply){let e=l.startingSumAtMultiply[i].value*l.startingSumAtMultiply[i].calcVal;e=n.allowFloat?e:Math.floor(e),r-=e,r+=l.startingSumAtMultiply[i].value}if(l.dividePointtypeIsOnCheck&&void 0!==l.startingSumAtDivide){let e=l.startingSumAtDivide[i].value/l.startingSumAtDivide[i].calcVal;e=n.allowFloat?e:Math.floor(e),r-=e,r+=l.startingSumAtDivide[i].value}if(l.setPointtypeIsOnCheck&&void 0!==l.startingSumAtSet&&(r=l.startingSumAtSet[i].value),l.id===e.id){t=o;break}}for(let e=t+1;e<Nt.length;e++){let t=Nt[e];t.multiplyPointtypeIsOnCheck&&void 0!==t.startingSumAtMultiply&&(r*=t.startingSumAtMultiply[i].calcVal,r=n.allowFloat?r:Math.floor(r)),t.dividePointtypeIsOnCheck&&void 0!==t.startingSumAtDivide&&(r/=t.startingSumAtDivide[i].calcVal,r=n.allowFloat?r:Math.floor(r)),t.setPointtypeIsOnCheck&&void 0!==t.startingSumAtSet&&(r=t.startingSumAtSet[i].calcVal,r=n.allowFloat?r:Math.floor(r))}o=o&&r>=0}}}if(e.setPointtypeIsOnCheck&&void 0!==e.pointTypeToSet){let t=0;for(let i=0;i<e.pointTypeToSet.length;i++){let n=Mt.get(e.pointTypeToSet[i]);if(void 0!==n&&n.belowZeroNotAllowed){let r=n.startingSum;for(let o=Nt.length-1;o>=0;o--){let l=Nt[o];if(l.multiplyPointtypeIsOnCheck&&void 0!==l.startingSumAtMultiply){let e=l.startingSumAtMultiply[i].value*l.startingSumAtMultiply[i].calcVal;e=n.allowFloat?e:Math.floor(e),r-=e,r+=l.startingSumAtMultiply[i].value}if(l.dividePointtypeIsOnCheck&&void 0!==l.startingSumAtDivide){let e=l.startingSumAtDivide[i].value/l.startingSumAtDivide[i].calcVal;e=n.allowFloat?e:Math.floor(e),r-=e,r+=l.startingSumAtDivide[i].value}if(l.setPointtypeIsOnCheck&&void 0!==l.startingSumAtSet&&(r=l.startingSumAtSet[i].value),l.id===e.id){t=o;break}}for(let e=t+1;e<Nt.length;e++){let t=Nt[e];t.multiplyPointtypeIsOnCheck&&void 0!==t.startingSumAtMultiply&&(r*=t.startingSumAtMultiply[i].calcVal,r=n.allowFloat?r:Math.floor(r)),t.dividePointtypeIsOnCheck&&void 0!==t.startingSumAtDivide&&(r/=t.startingSumAtDivide[i].calcVal,r=n.allowFloat?r:Math.floor(r)),t.setPointtypeIsOnCheck&&void 0!==t.startingSumAtSet&&(r=t.startingSumAtSet[i].calcVal,r=n.allowFloat?r:Math.floor(r))}o=o&&r>=0}}}return o}function Qo(e,t){t.isRandom&&void 0!==t.maxValue&&void 0!==t.minValue&&(t.value=Math.floor(Math.random()*(t.maxValue-t.minValue+1))+t.minValue,t.value=e.allowFloat?t.value:Math.floor(t.value),t.setValue=!0)}function ei(){const e=new Set,t=new Set;function o(i){if(i.activateOtherChoice&&void 0!==i.activateThisChoice)if(i.activatedRandom){if(i.isSelectableMultiple){for(let r=0;r<i.multipleUseVariable;r++)if(void 0!==i.activatedRandomMul)for(var n=0;n<i.activatedRandomMul[n].length;n++){const l=i.activatedRandomMul[r][n].split("/ON#"),a=Ft.get(l[0]);if(void 0!==a){const n=a.choice;if(kt.has(n.id)||i.activateAfterReset)i.isAllowDeselect&&!i.activateAfterReset||(i.activateAfterReset&&t.add(n.id),e.add(n.id),l.length>1&&n.isSelectableMultiple&&(void 0===n.tempMultipleValue?n.tempMultipleValue=parseInt(l[1]):n.tempMultipleValue+=parseInt(l[1])),o(n));else{const e=Bt.get(n.id);void 0!==e?l.length>1&&(e.multiple+=parseInt(l[1])):Bt.set(n.id,{multiple:l.length>1?parseInt(l[1]):0,isAllowDeselect:n.isAllowDeselect||!1})}}}}else if(void 0!==i.activatedRandom)for(let r=0;r<i.activatedRandom.length;r++){const n=i.activatedRandom[r].split("/ON#"),l=Ft.get(n[0]);if(void 0!==l){const r=l.choice;if(kt.has(r.id)||i.activateAfterReset)i.isAllowDeselect&&!i.activateAfterReset||(i.activateAfterReset&&t.add(r.id),e.add(r.id),n.length>1&&r.isSelectableMultiple&&(void 0===r.tempMultipleValue?r.tempMultipleValue=parseInt(n[1]):r.tempMultipleValue+=parseInt(n[1])),o(r));else{const e=Bt.get(r.id);void 0!==e?n.length>1&&(e.multiple+=parseInt(n[1])):Bt.set(r.id,{multiple:n.length>1?parseInt(n[1]):0,isAllowDeselect:r.isAllowDeselect||!1})}}}}else{const n=i.activateThisChoice.split(",");for(let r=0;r<n.length;r++){const l=n[r].split("/ON#"),a=Ft.get(l[0]);if(void 0!==a){const n=a.choice;if(kt.has(n.id)||i.activateAfterReset)i.isAllowDeselect&&!i.activateAfterReset||(i.activateAfterReset&&t.add(n.id),e.add(n.id),l.length>1&&n.isSelectableMultiple&&(void 0===n.tempMultipleValue?n.tempMultipleValue=parseInt(l[1]):n.tempMultipleValue+=parseInt(l[1])),o(n));else{const e=Bt.get(n.id);void 0!==e?l.length>1&&(e.multiple+=parseInt(l[1])):Bt.set(n.id,{multiple:l.length>1?parseInt(l[1]):0,isAllowDeselect:i.isAllowDeselect||!1})}}}}}function i(e){if(delete e.activatedRandom,delete e.activatedRandomMul,e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=Dt.get(e.hiddenContentsRow[t]);if(void 0!==o)for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":delete o.objectTitleRemoved;break;case"2":delete o.objectImageRemoved;break;case"3":delete o.objectTextRemoved;break;case"4":delete o.objectScoreRemoved;break;case"5":delete o.objectRequirementRemoved;break;case"6":delete o.addonTitleRemoved;break;case"7":delete o.addonImageRemoved;break;case"8":delete o.addonTextRemoved}}if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Pt.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!0:"2"===e.changeType?o.isTrue=!1:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.textfieldIsOn&&void 0!==e.idOfTheTextfieldWord&&void 0!==e.wordChangeSelect){const t=qt.get(e.idOfTheTextfieldWord);void 0!==t&&(t.replaceText=void 0===e.wordChangeDeselect?"":e.wordChangeDeselect)}if(e.isImageUpload&&void 0!==e.defaultImage&&(e.image=e.defaultImage),e.setBgmIsOn&&zt&&e.bgmId){const t=u(zt);t&&t.getId()===e.bgmId&&(t.stop(),Ht.bgmIsPlaying=!1,0!==Ht.bgmFadeInterval&&(window.clearInterval(Ht.bgmFadeInterval),Ht.bgmFadeInterval=0),0!==Ht.bgmTitleInterval&&(window.clearInterval(Ht.bgmTitleInterval),Ht.bgmTitleInterval=0),0!==Ht.bgmPlayInterval&&(window.clearInterval(Ht.bgmPlayInterval),Ht.bgmPlayInterval=0),Ht.lastFadeTime=0,Ht.isFadingOut=!1,Ht.bgmTitle="No Audio Title",Ht.curBgmTime=0,Ht.curBgmLength=0)}void 0!==e.initMultipleTimesMinus&&(e.numMultipleTimesMinus=e.initMultipleTimesMinus),e.multipleUseVariable=0,e.isActive=!1,kt.delete(e.id)}Bt.clear(),Array.from(kt.entries()).forEach(([t])=>{const i=Ft.get(t);if(void 0!==i){const t=i.choice;(t.notDeselectedByClean||t.isAutoActive)&&(e.add(t.id),o(t))}else{const e=Pt.get(t);void 0!==e&&(e.isTrue=!e.isTrue),kt.delete(t)}});let n=new Set;for(let l of kt.keys())n.add(l);for(let[l,a]of Ft)a.choice.isActive?n.add(l):a.choice.isAutoActive&&Bt.set(l,{multiple:0});let r=[...n,...t];for(let l=r.length-1;l>=0;l--){const o=Ft.get(r[l]);if(void 0!==o){const n=o.choice;if(delete n.multiplyPointtypeIsOnCheck,delete n.startingSumAtMultiply,delete n.dividePointtypeIsOnCheck,delete n.startingSumAtDivide,delete n.numDiscountChoices,delete n.appliedDisChoices,n.addToAllowChoice&&void 0!==n.idOfAllowChoice&&void 0!==n.numbAddToAllowChoice)for(let e=0;e<n.idOfAllowChoice.length;e++){const t=Dt.get(n.idOfAllowChoice[e]);void 0!==t&&(t.allowedChoices-=n.numbAddToAllowChoice)}if(n.muteBgm&&zt){const e=u(zt);app.isMute=!1,e&&"function"==typeof e.unMute&&e.unMute()}e.has(n.id)?(n.isSelectableMultiple&&n.isMultipleUseVariable&&void 0!==n.tempMultipleValue&&(n.multipleUseVariable=n.tempMultipleValue,delete n.tempMultipleValue),t.has(n.id)&&(n.isActive=!0,kt.set(n.id,{multiple:n.isSelectableMultiple&&n.isMultipleUseVariable?n.multipleUseVariable:0}))):i(n)}else kt.delete(r[l])}for(let l=0;l<app.pointTypes.length;l++){const e=app.pointTypes[l];e.startingSum=e.initValue}for(let l=0;l<app.rows.length;l++){const e=app.rows[l];e.isEditModeOn=!1,e.currentChoices=0,e.index=l,delete e.isSimpleEditMode,delete e.templateStack,delete e.widthStack;for(let t=0;t<e.objects.length;t++){const o=e.objects[t];o.index=t,delete o.isEditModeOn,void 0!==o.defaultTemplate&&(o.template=o.defaultTemplate),void 0!==o.defaultWidth&&(o.width=o.defaultWidth),o.isActive||(delete o.forcedActivated,delete o.activatedFrom,delete o.numDiscountChoices,delete o.appliedDisChoices),delete o.templateStack,delete o.widthStack;for(let e=0;e<o.scores.length;e++){const t=o.scores[e];o.isSelectableMultiple?(delete t.isActiveMul,delete t.isActiveMulMinus):delete t.isActive,o.notDeselectedByClean||delete t.setValue,_o(t)}}}for(let l=0;l<app.backpack.length;l++){const e=app.backpack[l];e.isEditModeOn=!1,e.currentChoices=0,e.index=l,delete e.isSimpleEditMode,delete e.templateStack,delete e.widthStack;for(let t=0;t<e.objects.length;t++){const o=e.objects[t];o.index=t,delete o.isEditModeOn,void 0!==o.defaultTemplate&&(o.template=o.defaultTemplate),void 0!==o.defaultWidth&&(o.width=o.defaultWidth),o.isActive||(delete o.forcedActivated,delete o.activatedFrom,delete o.numDiscountChoices,delete o.appliedDisChoices),delete o.templateStack,delete o.widthStack;for(let e=0;e<o.scores.length;e++){const t=o.scores[e];o.isSelectableMultiple?(delete t.isActiveMul,delete t.isActiveMulMinus):delete t.isActive,o.notDeselectedByClean||delete t.setValue,_o(t)}}}if(void 0!==app.defaultBgColor&&(app.styling.backgroundColor=app.defaultBgColor,delete app.defaultBgColor),void 0!==app.defaultBgImage&&(app.styling.backgroundImage=app.defaultBgImage,delete app.defaultBgImage),void 0!==app.defaultBarBgColor&&(app.styling.barBackgroundColor=app.defaultBarBgColor,delete app.defaultBarBgColor),void 0!==app.defaultBarIconColor&&(app.styling.barIconColor=app.defaultBarIconColor,delete app.defaultBarIconColor),void 0!==app.defaultBarTextColor&&(app.styling.barTextColor=app.defaultBarTextColor,delete app.defaultBarTextColor),delete app.bgColorStack,delete app.bgImageStack,delete app.barBgColorStack,delete app.barIconColorStack,delete app.barTextColorStack,app.btnBackpackIsOn=0,app.showAllAddons=0,app.isMute=!1,app.curVolume=100,zt){const e=u(zt);e&&"function"==typeof e.unMute&&e.unMute()}Nt.splice(0),r=[...kt.keys()];for(let l=0;l<r.length;l++){const e=Ft.get(r[l]);if(void 0!==e){const t=e.choice;if(Wo(t.requireds)&&Ko(t,!0)){if(t.discountOther&&void 0!==t.discountOperator&&void 0!==t.discountValue)if(t.isDisChoices){if(void 0!==t.discountChoices)for(let e=0;e<t.discountChoices.length;e++){const o=Ft.get(t.discountChoices[e]);void 0!==o&&Jo(t,o.choice)}}else if(void 0!==t.discountGroups)for(let e=0;e<t.discountGroups.length;e++){const o=Rt.get(t.discountGroups[e]);if(void 0!==o)for(let e=0;e<o.elements.length;e++){const i=Ft.get(o.elements[e]);void 0!==i&&Jo(t,i.choice)}}if(t.addToAllowChoice&&void 0!==t.idOfAllowChoice&&void 0!==t.numbAddToAllowChoice)for(let e=0;e<t.idOfAllowChoice.length;e++){const o=Dt.get(t.idOfAllowChoice[e]);void 0!==o&&(o.allowedChoices+=t.numbAddToAllowChoice)}}else{const e=t.multipleUseVariable||0;delete t.forcedActivated,delete t.activatedFrom,delete t.numDiscountChoices,delete t.appliedDisChoices,i(t),Bt.set(t.id,{multiple:e})}}}for(let l=0;l<r.length;l++){const e=Ft.get(r[l]);if(void 0!==e){const t=e.choice,o=e.row;if(Wo(t.requireds)&&Ko(t,!0)){for(let e=0;e<t.scores.length;e++){const o=t.scores[e],i=Mt.get(o.id);if(void 0!==i)if(t.isSelectableMultiple&&t.isMultipleUseVariableultiple)for(let e=0;e<t.multipleUseVariable;e++)Wo(o.requireds)&&(void 0===o.isActiveMul&&(o.isActiveMul=[]),o.isActiveMul[e]||(o.multiplyByTimes?i.startingSum-=o.discountIsOn&&void 0!==o.discountScore?o.discountScore*(e+1):o.value*(e+1):i.startingSum-=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value,o.isActiveMul[e]=!0));else t.isSelectableMultiple||Wo(o.requireds)&&!o.isActive&&(i.startingSum-=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value,o.isActive=!0)}if(t.multiplyPointtypeIsOn&&void 0!==t.pointTypeToMultiply&&void 0!==t.multiplyWithThis){let e=0;t.multiplyPointtypeIsOnCheck=!0,"object"!=typeof t.startingSumAtMultiply&&(t.startingSumAtMultiply=[]);for(let o=0;o<t.pointTypeToMultiply.length;o++){let i=Mt.get(t.pointTypeToMultiply[o]);if(void 0!==i)if(t.multiplyPointtypeIsId&&"string"==typeof t.multiplyWithThis){let n=Mt.get(t.multiplyWithThis);void 0!==n?(t.startingSumAtMultiply[o]={value:i.startingSum,calcVal:n.startingSum},i.startingSum*=n.startingSum):e++}else"number"==typeof t.multiplyWithThis&&(t.startingSumAtMultiply[o]={value:i.startingSum,calcVal:t.multiplyWithThis},i.startingSum*=t.multiplyWithThis);else e++}e===t.pointTypeToMultiply.length&&delete t.multiplyPointtypeIsOnCheck,t.multiplyPointtypeIsOnCheck&&Nt.push(t)}if(t.dividePointtypeIsOn&&void 0!==t.pointTypeToDivide&&void 0!==t.divideWithThis){let e=0;t.dividePointtypeIsOnCheck=!0,"object"!=typeof t.startingSumAtDivide&&(t.startingSumAtDivide=[]);for(let o=0;o<t.pointTypeToDivide.length;o++){let i=Mt.get(t.pointTypeToDivide[o]);if(void 0!==i)if(t.dividePointtypeIsId&&"string"==typeof t.divideWithThis){let n=Mt.get(t.divideWithThis);void 0!==n?0===n.startingSum?e++:(t.startingSumAtDivide[o]={value:i.startingSum,calcVal:n.startingSum},i.startingSum/=n.startingSum):e++}else"number"==typeof t.divideWithThis&&(0===t.dividedWithThis?e++:(t.startingSumAtDivide[o]={value:i.startingSum,calcVal:t.divideWithThis},i.startingSum/=t.divideWithThis));else e++}e===t.pointTypeToDivide.length&&delete t.dividePointtypeIsOnCheck,!t.multiplyPointtypeIsOnCheck&&t.dividePointtypeIsOnCheck&&Nt.push(t)}if(t.changeBackground&&(t.changeBgImage?void 0!==t.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage||""),app.bgImageStack.push({id:t.id,data:t.bgImage}),app.styling.backgroundImage=t.bgImage):void 0!==t.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor||""),app.bgColorStack.push({id:t.id,data:t.changedBgColorCode}),app.styling.backgroundColor=t.changedBgColorCode)),t.changePointBar&&(t.changeBarBgColorIsOn&&void 0!==t.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor||"#FFFFFFFF"),app.barBgColorStack.push({id:t.id,data:t.changedBarBgColor}),app.styling.barBackgroundColor=t.changedBarBgColor),t.changeBarIconColorIsOn&&void 0!==t.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor||"#0000008A"),app.barIconColorStack.push({id:t.id,data:t.changedBarIconColor}),app.styling.barIconColor=t.changedBarIconColor),t.changeBarTextColorIsOn&&void 0!==t.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor||"#000000"),app.barTextColorStack.push({id:t.id,data:t.changedBarTextColor}),app.styling.barTextColor=t.changedBarTextColor)),t.changeTemplates&&t.changeTemplatesList&&t.changeToThisTemplate){const e=t.changeTemplatesList.split(",");for(let o=0;o<e.length;o++){const i=e[o],n=Ft.get(i);if(void 0!==n){const e=n.choice;if(Ji(e,t.id,t.changeToThisTemplate),t.changeAddonTemplate)for(let o=0;o<e.addons.length;o++){Ji(e.addons[o],t.id,t.changeToThisTemplate)}continue}const r=Dt.get(i);if(void 0!==r){Ji(r,t.id,t.changeToThisTemplate);continue}const l=Rt.get(i);if(void 0!==l){const e=l.rowElements;for(let i=0;i<e.length;i++){const o=Dt.get(e[i]);void 0!==o&&Ji(o,t.id,t.changeToThisTemplate)}const o=l.elements;for(let i=0;i<o.length;i++){const e=Ft.get(o[i]);if(void 0!==e){Ji(e.choice,t.id,t.changeToThisTemplate)}}continue}}}if(t.changeWidth&&t.changeWidthList&&t.changeToThisWidth){const e=t.changeWidthList.split(",");for(let o=0;o<e.length;o++){const i=e[o],n=Ft.get(i);if(void 0!==n){Xi(n.choice,t.id,t.changeToThisWidth);continue}const r=Dt.get(i);if(void 0!==r){Xi(r,t.id,t.changeToThisWidth);continue}const l=Rt.get(i);if(void 0!==l){const e=l.rowElements;for(let i=0;i<e.length;i++){const o=Dt.get(e[i]);void 0!==o&&Xi(o,t.id,t.changeToThisWidth)}const o=l.elements;for(let i=0;i<o.length;i++){const e=Ft.get(o[i]);if(void 0!==e){Xi(e.choice,t.id,t.changeToThisWidth)}}continue}}}if(t.muteBgm&&zt){const e=u(zt);app.isMute=!0,e&&"function"==typeof e.mute&&e.mute()}t.backpackBtnRequirement&&(app.btnBackpackIsOn+=1),t.showAllAddons&&(app.showAllAddons+=1),o.currentChoices+=1}else{if(t.discountOther&&void 0!==t.discountOperator&&void 0!==t.discountValue)if(t.isDisChoices){if(void 0!==t.discountChoices)for(let e=0;e<t.discountChoices.length;e++){const o=Ft.get(t.discountChoices[e]);void 0!==o&&Yo(t,o.choice)}}else if(void 0!==t.discountGroups)for(let e=0;e<t.discountGroups.length;e++){const o=Rt.get(t.discountGroups[e]);if(void 0!==o)for(let e=0;e<o.elements.length;e++){const i=Ft.get(o.elements[e]);void 0!==i&&Yo(t,i.choice)}}if(t.addToAllowChoice&&void 0!==t.idOfAllowChoice&&void 0!==t.numbAddToAllowChoice)for(let e=0;e<t.idOfAllowChoice.length;e++){const o=Dt.get(t.idOfAllowChoice[e]);void 0!==o&&(o.allowedChoices-=t.numbAddToAllowChoice)}kt.delete(t.id),t.forcedActivated&&(delete t.forcedActivated,Bt.set(t.id,{multiple:t.multipleUseVariable}))}}else kt.delete(r[l])}ai({linkedObjects:[]})}function ti(e,t,o=!1,i={linkedObjects:[]}){let n=t;if(t.isResultRow||t.isGroupRow){const t=Ft.get(e.id);void 0!==t&&(n=t.row)}!Wo(e.requireds)||t.isInfoRow||o&&e.isNotSelectable||(e.isActive?e.selectOnce||e.forcedActivated||si(e,n,i):ci(e,n,i))}function oi(e,t,o,i,n){if(!t.isNotSelectable||!e.isNotActiveUnselectable){let r=!1;if(t.activateOtherChoice&&void 0!==t.activateThisChoice&&-1===n.linkedObjects.indexOf(e.id)&&t.activateThisChoice.split(",").some(t=>t.split("/ON#")[0]===e.id)&&(n.linkedObjects.push(e.id),r=!0),t.isSelectableMultiple){if(t.isMultipleUseVariable&&void 0!==t.numMultipleTimesMinus&&void 0!==t.numMultipleTimesPluss){let r=t.multipleUseVariable;if(i>0){e.isAllowDeselect||!t.customTextfieldIsOn&&!t.confirmIsOn||(Yt.isForced=!0);for(let l=0;l<i;l++)di(t,o,n),r++,e.isAllowDeselect||(t.numMultipleTimesMinus+=1)}else if(i<0)for(let l=0;l>-1*i;l++)ui(t,o,n),r--,e.isAllowDeselect||(t.numMultipleTimesPluss-=1);if(t.multipleUseVariable!==r){const o=Math.abs(t.numMultipleTimesMinus-t.numMultipleTimesPluss);if(t.numMultipleTimesMinus>t.numMultipleTimePluss){const n=Bt.get(t.id);i>0?(t.numMultipleTimesMinus-=o,void 0!==n?n.multiple+=o:Bt.set(t.id,{multiple:o,isAllowDeselect:e.isAllowDeselect||!1})):i<0&&(void 0!==n?n.multiple-=o:Bt.set(t.id,{multiple:-o,isAllowDeselect:e.isAllowDeselect||!1}))}}}}else t.isActive||((t.customTextfieldIsOn||t.confirmIsOn)&&(Yt.isForced=!0),ti(t,o,!1,n)),e.isAllowDeselect||(t.forcedActivated=!0),void 0===t.activatedFrom&&(t.activatedFrom=0),r||t.activatedFrom++;if(t.isSelectDelayed&&void 0!==t.selectDelayTime){const o=()=>{t.selectDelayTimer?setTimeout(o,1e3):e.isActive?t.isActive||(delete t.forcedActivated,Bt.set(t.id,{multiple:i,isAllowDeselect:e.isAllowDeselect||!1})):delete t.forcedActivated};setTimeout(o,t.selectDelayTime+1e3)}else t.isActive||(delete t.forcedActivated,Bt.set(t.id,{multiple:i,isAllowDeselect:e.isAllowDeselect||!1}))}}function ii(e,t,o,i,n){if(n.isOverDlg=!0,n.isOverImg=!0,t.activateOtherChoice&&void 0!==t.activateThisChoice&&-1===n.linkedObjects.indexOf(e.id)&&t.activateThisChoice.split(",").some(t=>t.split("/ON#")[0]===e.id)&&n.linkedObjects.push(e.id),t.isSelectableMultiple){if(t.isMultipleUseVariable&&void 0!==t.numMultipleTimesMinus&&void 0!==t.numMultipleTimesPluss)if(t.isActive){if(i>0)for(let r=0;r<i;r++)e.isAllowDeselect||(t.numMultipleTimesMinus-=1),e.isNotDeactivate||ui(t,o,n);else if(i<0)for(let r=0;r>-1*i;r++)e.isAllowDeselect||(t.numMultipleTimesPluss+=1),e.isNotDeactivate||di(t,o,n)}else{const o=Bt.get(t.id);let n=0;void 0!==o?(n=o.multiple-i,0===n?Bt.delete(t.id):Bt.set(t.id,{multiple:n,isAllowDeselect:e.isAllowDeselect||!1})):Bt.delete(t.id)}}else void 0!==t.activatedFrom?(t.activatedFrom--,(t.activatedFrom<=0||-1!==n.linkedObjects.indexOf(e.id))&&(t.isActive?(delete t.activatedFrom,delete t.forcedActivated,e.isNotDeactivate||si(t,o,n)):Bt.delete(t.id))):(delete t.forcedActivated,!e.isNotDeactivate&&t.isActive&&si(t,o,n));!t.isActive&&t.selectDelayTimer&&(clearTimeout(t.selectDelayTimer),delete t.selectDelayTimer,delete t.forcedActivated,Bt.delete(t.id))}function ni(e,t){if(void 0!==e.activateThisChoice){let o=e.activateThisChoice.split(","),i=new Map;for(let e=0;e<o.length;e++){let[t,n="0"]=o[e].split("/ON#"),r=parseInt(n),l=Rt.get(t);if(void 0!==l)for(let e=0;e<l.elements.length;e++){const t=Ft.get(l.elements[e]);if(void 0!==t){const e=t.choice,o=e.isSelectableMultiple&&e.isMultipleUseVariable&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss>=e.multipleUseVariable+r&&!e.isInfoRow&&!e.isNotSelectable&&Wo(e.requireds);kt.has(e.id)&&!o||i.set(e.id,r)}}else{const e=Ft.get(t);if(void 0!==e){const o=e.choice,n=o.isSelectableMultiple&&o.isMultipleUseVariable&&void 0!==o.numMultipleTimesPluss&&o.numMultipleTimesPluss>=o.multipleUseVariable+r&&!o.isInfoRow&&!o.isNotSelectable&&Wo(o.requireds);kt.has(t)&&!n||i.set(t,r)}}}let n=[...i.keys()],r=Math.min(n.length,e.numActivateRandom||0),l=r;for(let e=n.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[n[e],n[t]]=[n[t],n[e]]}let a=[];for(let s=0;s<r;){const o=n[s],c=Ft.get(o);if(void 0!==c){const d=c.row,u=c.choice,g=i.get(o)||0,p=u.multipleUseVariable;if(oi(e,u,d,g,t),!u.isActive||u.isSelectableMultiple&&u.isMultipleUseVariable&&u.multipleUseVariable===p){if(a.length<r&&n.length>l){n[s]=n[l++],void 0!==u.activatedFrom&&(u.activatedFrom--,0===u.activatedFrom&&Bt.delete(u.id));continue}break}let m=g>0?"".concat(o,"/ON#").concat(g):o;a.push(m)}s++}e.isSelectableMultiple?(void 0===e.activatedRandomMul&&(e.activatedRandomMul=[]),e.activatedRandomMul[e.multipleUseVariable-1]=[...a]):e.activatedRandom=[...a]}}function ri(e,t,o,i=new Set,r=[],l){const a=Array.from(kt.keys());for(let s=a.length-1;s>=0;s--){const c=a[s],d=Ft.get(c);if(void 0!==d){const a=d.row,s=d.choice,c=new n,u=new Set,g=new Set;let p=new Set,m=!1,h=!1,v=e.appliedDisChoices?e.appliedDisChoices.indexOf(s.id):-1;for(let o=0;o<s.scores.length;o++){const r=s.scores[o];if(!r.isNotRecalculatable){const o=Mt.get(r.id);if(void 0!==o){if(e.discountOther&&r.isChangeDiscount&&r.isActive&&void 0!==r.tmpDisScore&&(!e.useDiscountCount||e.useDiscountCount&&e.appliedDisChoices)){const t=s.multipleUseVariable;let i=!1;if(e.useDiscountCount&&r.discountedFrom&&r.discountedFrom.length>0)if(-1!==v)for(let o=0;o<r.discountedFrom.length;o++){const t=Ft.get(r.discountedFrom[o]);if(void 0!==t){const o=t.choice,n=o.isSelectableMultiple&&o.isMultipleUseVariable&&o.stackableDiscount&&o.discountCount?o.discountCount*o.multipleUseVariable+Number(e.id===o.id):o.discountCount;o.useDiscountCount&&o.appliedDisChoices&&n&&n>o.appliedDisChoices.length&&(o.id!==e.id&&p.add(o),i=!0)}}else i=!0;if(i){delete r.isChangeDiscount,delete r.tmpDisScore;continue}if(s.isSelectableMultiple&&s.isMultipleUseVariable&&void 0!==s.numMultipleTimesMinus){for(let e=t-1;e>=0;e--)s.isActive&&(o.belowZeroNotAllowed&&o.startingSum+r.tmpDisScore<0?s.forcedActivated&&s.isActive?(s.forcedActivated=!1,s.numMultipleTimesMinus--,ui(s,a,l),s.forcedActivated=!0):ui(s,a,l):o.startingSum+=r.tmpDisScore);s.isActive&&(c.set(r.id,r.tmpDisScore),delete r.isChangeDiscount,delete r.tmpDisScore)}else if(!s.isSelectableMultiple)if(o.belowZeroNotAllowed&&o.startingSum+r.tmpDisScore<0)if(s.forcedActivated&&(delete s.forcedActivated,Bt.set(s.id,{multiple:s.multipleUseVariable})),s.isSelectableMultiple&&s.isMultipleUseVariable)for(let e=0;e<s.multipleUseVariable;e++)s.isActive&&ui(s,a,l);else s.isActive&&si(s,a,l);else o.startingSum+=r.tmpDisScore,c.set(r.id,r.tmpDisScore),delete r.isChangeDiscount,delete r.tmpDisScore;m=e.id!==s.id,r.discountIsOn||delete r.appliedDiscount,h=!0}if(!i.has(r.idx)){const d=e.scores.length>0,p=e.scores.length||1;for(let h=0;h<p;h++){const p=d?e.scores[h]:null,v=p&&t.get(p.id)||0,f=p?Mt.get(p.id):null;if((!d||d&&f)&&s.isActive){const t=Wo(r.requireds),d=new n(JSON.parse(JSON.stringify([...kt])));d.set(e.id,{multiple:e.multipleUseVariable}),a.currentChoices+=1,f&&(f.startingSum+=v);const p=Wo(r.requireds,d);if(a.currentChoices-=1,f&&(f.startingSum-=v),p!==t){r.setValue||Qo(o,r);let e=r.discountIsOn&&void 0!==r.discountScore&&r.appliedDiscount?r.discountScore:r.value;e=o.allowFloat?e:Math.floor(e);let t=!1;if(p){if(s.isSelectableMultiple&&s.isMultipleUseVariable&&void 0!==s.numMultipleTimesMinus){for(let i=s.multipleUseVariable-1;i>=0;i--)void 0!==r.isActiveMul&&r.isActiveMul[i]&&(o.belowZeroNotAllowed&&o.startingSum+e<0?s.forcedActivated&&s.isActive?(s.forcedActivated=!1,s.numMultipleTimesMinus--,ui(s,a,l),s.forcedActivated=!0):ui(s,a,l):(o.startingSum+=e,c.set(r.id,e),r.isActiveMul[i]=!1,t||(t=!0)))}else s.isSelectableMultiple||r.isActive&&(o.belowZeroNotAllowed&&o.startingSum+e<0?(s.forcedActivated&&delete s.forcedActivated,si(s,a,l)):(o.startingSum+=e,c.set(r.id,e),delete r.isActive,t=!0));if(t&&r.discountIsOn&&r.appliedDiscount&&r.discountedFrom)for(let e=0;e<r.discountedFrom.length;e++){const t=Ft.get(r.discountedFrom[e]);if(void 0!==t){const e=t.choice;if(e.useDiscountCount&&void 0!==e.discountCount&&e.appliedDisChoices&&-1!==e.appliedDisChoices.indexOf(s.id)){delete r.appliedDiscount,g.add(e);break}delete r.appliedDiscount;break}}r.setValue&&delete r.setValue}else{if(s.isSelectableMultiple&&s.isMultipleUseVariable&&void 0!==s.numMultipleTimesMinus){const i=s.multipleUseVariable;void 0===r.isActiveMul&&(r.isActiveMul=[]);for(let n=i-1;n>=0;n--)r.isActiveMul[n]||(o.belowZeroNotAllowed&&o.startingSum+e<0?s.forcedActivated&&s.isActive?(s.forcedActivated=!1,s.numMultipleTimesMinus--,ui(s,a,l),s.forcedActivated=!0):ui(s,a,l):(o.startingSum-=e,c.set(r.id,e),r.isActiveMul[n]=!0,t||(t=!0)))}else s.isSelectableMultiple||r.isActive||(o.belowZeroNotAllowed&&o.startingSum-e<0?(s.forcedActivated&&delete s.forcedActivated,si(s,a,l)):(o.startingSum-=e,c.set(r.id,e),r.isActive=!0,t=!0));if(t&&r.discountIsOn&&!r.appliedDiscount&&r.discountedFrom)for(let e=0;e<r.discountedFrom.length;e++){const t=Ft.get(r.discountedFrom[e]);if(void 0!==t){const e=t.choice;if(!e.useDiscountCount||void 0===e.discountCount){r.appliedDiscount=!0;break}{const t=e.isSelectableMultiple&&e.isMultipleUseVariable&&e.stackableDiscount?e.discountCount*e.multipleUseVariable:e.discountCount;if(e.appliedDisChoices||(e.appliedDisChoices=[]),t>e.appliedDisChoices.length||-1!==e.appliedDisChoices.indexOf(s.id)){r.appliedDiscount=!0,u.add(e);break}}}}}m||(m=!0),i.add(r.idx)}}}}}}}if(p.size>0){const t=Array.from(p);for(let o=0;o<t.length;o++){const i=t[o];i.appliedDisChoices||(i.appliedDisChoices=[]),-1===i.appliedDisChoices.indexOf(s.id)&&i.appliedDisChoices.push(s.id),-1!==v&&e.appliedDisChoices.splice(v,1)}}h&&e.appliedDisChoices&&-1!==v&&e.appliedDisChoices.splice(v,1),g.size>0&&g.forEach(e=>{if(e.appliedDisChoices&&!e.scores.some(e=>e.appliedDiscount)){const t=e.appliedDisChoices.indexOf(s.id);-1!==t&&e.appliedDisChoices.splice(t,1)}}),u.size>0&&u.forEach(e=>{e.appliedDisChoices&&-1===e.appliedDisChoices.indexOf(s.id)&&e.appliedDisChoices.push(s.id)}),m&&(0===r.length?r.push("Scores Updated On: ".concat(s.title)):r.push(", ".concat(s.title)),ri(s,c,o+1,i,r,l))}}if(0===o){if(r.length>0&&!app.hideScoresUpdated){const e=document.createElement("div");e.innerHTML=r.join(""),Zt.labelText=e.textContent,Zt.isOpen=!0}r.splice(0)}}function li(e,t,o,i=new Set,r=[],l){const a=Array.from(kt.keys());for(let s=0;s<a.length;s++){const c=a[s],d=Ft.get(c);if(void 0!==d){const a=d.row,s=d.choice,c=new n,u=new Set,g=new Set;let p=!1,m=!1;e&&e.useDiscountCount&&!e.appliedDisChoices&&(e.appliedDisChoices=[]);for(let o=0;o<s.scores.length;o++){const r=s.scores[o];if(!r.isNotRecalculatable){const o=Mt.get(r.id);if(void 0!==o){if(e&&e.discountOther&&r.isChangeDiscount&&r.isActive&&void 0!==r.tmpDisScore&&s.id!==e.id){const t=s.multipleUseVariable,i=e.isSelectableMultiple&&e.isMultipleUseVariable&&e.stackableDiscount&&e.discountCount?e.discountCount*e.multipleUseVariable:e.discountCount;if(!e.useDiscountCount||e.useDiscountCount&&i&&i>e.appliedDisChoices.length){if(s.isSelectableMultiple&&s.isMultipleUseVariable&&void 0!==s.numMultipleTimesMinus){for(let e=t-1;e>=0;e--)s.isActive&&(o.belowZeroNotAllowed&&o.startingSum+r.tmpDisScore<0?s.forcedActivated&&s.isActive?(s.forcedActivated=!1,s.numMultipleTimesMinus--,ui(s,a,l),s.forcedActivated=!0):ui(s,a,l):o.startingSum+=r.tmpDisScore);s.isActive&&(c.set(r.id,r.tmpDisScore),delete r.isChangeDiscount,delete r.tmpDisScore)}else s.isSelectableMultiple||(o.belowZeroNotAllowed&&o.startingSum+r.tmpDisScore<0?(s.forcedActivated&&delete s.forcedActivated,si(s,a,l)):(o.startingSum+=r.tmpDisScore,c.set(r.id,r.tmpDisScore),delete r.isChangeDiscount,delete r.tmpDisScore));m=!0,s.isActive&&(r.appliedDiscount=!0,p=!0)}}if(!i.has(r.idx)){const d=e&&e.scores.length>0,p=e&&e.scores.length||1;for(let h=0;h<p;h++){const p=d?e.scores[h]:null,v=p&&t.get(p.id)||0,f=p?Mt.get(p.id):null,b=e?null:Mt.get(t.keys().next().value||""),w=b&&t.values().next().value||0;if((!d||d&&f)&&s.isActive&&!r.isChanged){const t=Wo(r.requireds),d=new n(JSON.parse(JSON.stringify([...kt])));e?(d.delete(e.id),a.currentChoices-=1,f&&(f.startingSum+=v)):b&&(b.startingSum-=w);const p=Wo(r.requireds,d);if(e?(a.currentChoices+=1,f&&(f.startingSum-=v)):b&&(b.startingSum+=w),p!==t){r.setValue||Qo(o,r);let e=r.discountIsOn&&void 0!==r.discountScore&&r.appliedDiscount?r.discountScore:r.value;e=o.allowFloat?e:Math.floor(e);let t=!1;if(p){if(s.isSelectableMultiple&&s.isMultipleUseVariable&&void 0!==s.numMultipleTimesMinus){for(let i=s.multipleUseVariable-1;i>=0;i--)void 0!==r.isActiveMul&&r.isActiveMul[i]&&(o.belowZeroNotAllowed&&o.startingSum+e<0?s.forcedActivated&&s.isActive?(s.forcedActivated=!1,s.numMultipleTimesMinus--,ui(s,a,l),s.forcedActivated=!0):ui(s,a,l):(o.startingSum+=e,c.set(r.id,e),r.isActiveMul[i]=!1,t||(t=!0)))}else s.isSelectableMultiple||r.isActive&&(o.belowZeroNotAllowed&&o.startingSum+e<0?(s.forcedActivated&&delete s.forcedActivated,si(s,a,l)):(o.startingSum+=e,c.set(r.id,e),delete r.isActive,t=!0));if(t&&r.discountIsOn&&r.appliedDiscount&&r.discountedFrom)for(let e=0;e<r.discountedFrom.length;e++){const t=Ft.get(r.discountedFrom[e]);if(void 0!==t){const e=t.choice;if(e.useDiscountCount&&void 0!==e.discountCount&&e.appliedDisChoices&&-1!==e.appliedDisChoices.indexOf(s.id)){delete r.appliedDiscount,g.add(e);break}delete r.appliedDiscount;break}}r.setValue&&delete r.setValue}else{if(s.isSelectableMultiple&&s.isMultipleUseVariable&&void 0!==s.numMultipleTimesMinus){const i=s.multipleUseVariable;void 0===r.isActiveMul&&(r.isActiveMul=[]);for(let n=i-1;n>=0;n--)r.isActiveMul[n]||(o.belowZeroNotAllowed&&o.startingSum+e<0?s.forcedActivated&&s.isActive?(s.forcedActivated=!1,s.numMultipleTimesMinus--,ui(s,a,l),s.forcedActivated=!0):ui(s,a,l):(o.startingSum-=e,c.set(r.id,e),r.isActiveMul[n]=!0,t||(t=!0)))}else s.isSelectableMultiple||r.isActive||(o.belowZeroNotAllowed&&o.startingSum-e<0?(s.forcedActivated&&delete s.forcedActivated,si(s,a,l)):(o.startingSum-=e,c.set(r.id,e),r.isActive=!0,t=!0));if(t&&r.discountIsOn&&!r.appliedDiscount&&r.discountedFrom)for(let e=0;e<r.discountedFrom.length;e++){const t=Ft.get(r.discountedFrom[e]);if(void 0!==t){const e=t.choice;if(!e.useDiscountCount||void 0===e.discountCount){r.appliedDiscount=!0;break}{const t=e.isSelectableMultiple&&e.isMultipleUseVariable&&e.stackableDiscount?e.discountCount*e.multipleUseVariable:e.discountCount;if(e.appliedDisChoices||(e.appliedDisChoices=[]),t>e.appliedDisChoices.length||-1!==e.appliedDisChoices.indexOf(s.id)){r.appliedDiscount=!0,u.add(e);break}}}}}m||(m=!0),i.add(r.idx)}}}}}}}p&&e&&e.appliedDisChoices&&-1===e.appliedDisChoices.indexOf(s.id)&&e.appliedDisChoices.push(s.id),g.size>0&&g.forEach(e=>{if(e.appliedDisChoices&&!e.scores.some(e=>e.appliedDiscount)){const t=e.appliedDisChoices.indexOf(s.id);-1!==t&&e.appliedDisChoices.splice(t,1)}}),u.size>0&&u.forEach(e=>{e.appliedDisChoices&&-1===e.appliedDisChoices.indexOf(s.id)&&e.appliedDisChoices.push(s.id)}),m&&(0===r.length?r.push("Scores Updated On: ".concat(s.title)):r.push(", ".concat(s.title)),li(s,c,o+1,i,r,l))}}if(0===o){if(r.length>0&&!app.hideScoresUpdated){const e=document.createElement("div");e.innerHTML=r.join(""),Zt.labelText=e.textContent,Zt.isOpen=!0}r.splice(0)}}function ai(e){let t=!1;Array.from(Bt.entries()).forEach(([o,i])=>{const n=Ft.get(o);if(void 0!==n){const r=n.row,l=n.choice;l.isActive||(ti(l,r,!1,e),l.isActive&&(Bt.delete(o),t=!0,i.isAllowDeselect||(l.forcedActivated=!0)))}}),t&&ai(e)}function si(e,t,o){const i=void 0===e.parentId,r=Ko(e,!1),l=!i||function(e,t,o){if(e.addons&&e.addons.length>0){const i=e.addons.filter(e=>!0===e.isSelectable);for(let e=0;e<i.length;e++){const n=i[e];if(n.isActive){if(n.selectOnce)return!1;if(n.isSelectableMultiple&&n.isMultipleUseVariable){const e=n.multipleUseVariable;for(let i=0;i<Math.abs(e);i++)e>0?ui(n,t,o):di(n,t,o)}else si(n,t,o);if(n.isActive)return!1}}}return!0}(e,t,o);if(r&&l){const r=()=>{const r=new n;let l=new Set;for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(Wo(o.requireds)&&o.isActive||o.isActive){const e=Mt.get(o.id);if(void 0!==e){let t=o.value;if(o.discountIsOn&&void 0!==o.discountScore&&o.appliedDiscount){if(o.discountedFrom&&o.discountedFrom.length>0)for(let e=0;e<o.discountedFrom.length;e++){const t=Ft.get(o.discountedFrom[e]);if(void 0!==t){const e=t.choice;if(e.useDiscountCount&&void 0!==e.discountCount&&e.appliedDisChoices&&e.appliedDisChoices.length>0){l.add(e);break}}}t=o.discountScore}t=e.allowFloat?t:Math.floor(t),e.startingSum+=t;let i=r.get(o.id);void 0!==i?r.set(o.id,-t+i):r.set(o.id,-t),delete o.isActive,delete o.setValue,delete o.appliedDiscount}}else delete o.setValue,delete o.appliedDiscount}if(l.size>0&&l.forEach(t=>{if(t.appliedDisChoices){const o=t.appliedDisChoices.indexOf(e.id);-1!==o&&t.appliedDisChoices.splice(o,1)}}),e.activateOtherChoice&&void 0!==e.activateThisChoice)if(e.isActivateRandom&&void 0!==e.activatedRandom){for(let t=0;t<e.activatedRandom.length;t++){const i=Ft.get(e.activatedRandom[t]);if(void 0!==i){const t=i.row,n=i.choice;ii(e,n,t,0,o)}}delete e.activatedRandom}else{const t=e.activateThisChoice.split(",");for(let i=0;i<t.length;i++){const n=t[i].split("/ON#"),r=n.length>1?parseInt(n[1]):0,l=Ft.get(n[0]);if(void 0!==l){const t=l.row,i=l.choice;ii(e,i,t,r,o)}else{const t=Rt.get(n[0]);if(void 0!==t){const i=t.elements;for(let t=0;t<i.length;t++){const n=Ft.get(i[t]);if(void 0!==n){const t=n.row,i=n.choice;ii(e,i,t,r,o)}}}}}}if(e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue)if(void 0===e.discountPointTypes&&(e.discountPointTypes=[]),e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let o=0;o<e.discountRows.length;o++){const i=Dt.get(e.discountRows[o]);if(void 0!==i)for(let o=0;o<i.objects.length;o++){const n=i.objects[o];Yo(e,n),t.add(n.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const t=Ft.get(e.discountChoices[o]);void 0!==t&&Yo(e,t.choice)}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Rt.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=Ft.get(o.elements[t]);void 0!==i&&Yo(e,i.choice)}}if(e.isActive=!1,i&&(t.currentChoices-=1),kt.delete(e.id),Array.from(kt.entries()).forEach(([t,i])=>{const n=Ft.get(t);if(void 0!==n){const t=n.row,r=n.choice;if(r.id!==e.id&&!Wo(r.requireds))if(r.forcedActivated&&(delete r.forcedActivated,Bt.set(r.id,{multiple:i.multiple})),0===i.multiple)r.isActive&&si(r,t,o);else if(i.multiple>0)for(let e=0;e<i.multiple;e++)r.isActive&&ui(r,t,o)}}),e.multiplyPointtypeIsOnCheck&&void 0!==e.pointTypeToMultiply){let t=0;for(let o=0;o<e.pointTypeToMultiply.length;o++){let i=Mt.get(e.pointTypeToMultiply[o]);if(void 0!==i){for(let n=Nt.length-1;n>=0;n--){let r=Nt[n];if(r.multiplyPointtypeIsOnCheck&&void 0!==r.startingSumAtMultiply){let e=r.startingSumAtMultiply[o].value*r.startingSumAtMultiply[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=r.startingSumAtMultiply[o].value}if(r.dividePointtypeIsOnCheck&&void 0!==r.startingSumAtDivide){let e=r.startingSumAtDivide[o].value/r.startingSumAtDivide[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=r.startingSumAtDivide[o].value}if(r.setPointtypeIsOnCheck&&void 0!==r.startingSumAtSet&&(i.startingSum=r.startingSumAtSet[o].value),r.id===e.id){t=n;break}}for(let e=t+1;e<Nt.length;e++){let t=Nt[e];t.multiplyPointtypeIsOnCheck&&void 0!==t.startingSumAtMultiply&&(t.startingSumAtMultiply[o].value=i.startingSum,i.startingSum*=t.startingSumAtMultiply[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)),t.dividePointtypeIsOnCheck&&void 0!==t.startingSumAtDivide&&(t.startingSumAtDivide[o].value=i.startingSum,i.startingSum/=t.startingSumAtDivide[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)),t.setPointtypeIsOnCheck&&void 0!==t.startingSumAtSet&&(t.startingSumAtSet[o].value=i.startingSum,i.startingSum=t.startingSumAtSet[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum))}}}delete e.multiplyPointtypeIsOnCheck,delete e.startingSumAtMultiply,e.dividePointtypeIsOnCheck||e.setPointtypeIsOnCheck||Nt.splice(t,1)}if(e.dividePointtypeIsOnCheck&&void 0!==e.pointTypeToDivide){let t=0;for(let o=0;o<e.pointTypeToDivide.length;o++){let i=Mt.get(e.pointTypeToDivide[o]);if(void 0!==i){for(let n=Nt.length-1;n>=0;n--){let r=Nt[n];if(r.multiplyPointtypeIsOnCheck&&void 0!==r.startingSumAtMultiply){let e=r.startingSumAtMultiply[o].value*r.startingSumAtMultiply[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=r.startingSumAtMultiply[o].value}if(r.dividePointtypeIsOnCheck&&void 0!==r.startingSumAtDivide){let e=r.startingSumAtDivide[o].value/r.startingSumAtDivide[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=r.startingSumAtDivide[o].value}if(r.setPointtypeIsOnCheck&&void 0!==r.startingSumAtSet&&(i.startingSum=r.startingSumAtSet[o].value),r.id===e.id){t=n;break}}for(let e=t+1;e<Nt.length;e++){let t=Nt[e];t.multiplyPointtypeIsOnCheck&&void 0!==t.startingSumAtMultiply&&(t.startingSumAtMultiply[o].value=i.startingSum,i.startingSum*=t.startingSumAtMultiply[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)),t.dividePointtypeIsOnCheck&&void 0!==t.startingSumAtDivide&&(t.startingSumAtDivide[o].value=i.startingSum,i.startingSum/=t.startingSumAtDivide[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)),t.setPointtypeIsOnCheck&&void 0!==t.startingSumAtSet&&(t.startingSumAtSet[o].value=i.startingSum,i.startingSum=t.startingSumAtSet[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum))}}}delete e.dividePointtypeIsOnCheck,delete e.startingSumAtDivide,e.setPointtypeIsOnCheck||Nt.splice(t,1)}if(e.setPointtypeIsOnCheck&&void 0!==e.pointTypeToSet){let t=0;for(let o=0;o<e.pointTypeToSet.length;o++){let i=Mt.get(e.pointTypeToSet[o]);if(void 0!==i){for(let n=Nt.length-1;n>=0;n--){let r=Nt[n];if(r.multiplyPointtypeIsOnCheck&&void 0!==r.startingSumAtMultiply){let e=r.startingSumAtMultiply[o].value*r.startingSumAtMultiply[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=r.startingSumAtMultiply[o].value}if(r.dividePointtypeIsOnCheck&&void 0!==r.startingSumAtDivide){let e=r.startingSumAtDivide[o].value/r.startingSumAtDivide[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=r.startingSumAtDivide[o].value}if(r.setPointtypeIsOnCheck&&void 0!==r.startingSumAtSet&&(i.startingSum=r.startingSumAtSet[o].value),r.id===e.id){t=n;break}}for(let e=t+1;e<Nt.length;e++){let t=Nt[e];t.multiplyPointtypeIsOnCheck&&void 0!==t.startingSumAtMultiply&&(t.startingSumAtMultiply[o].value=i.startingSum,i.startingSum*=t.startingSumAtMultiply[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)),t.dividePointtypeIsOnCheck&&void 0!==t.startingSumAtDivide&&(t.startingSumAtDivide[o].value=i.startingSum,i.startingSum/=t.startingSumAtDivide[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)),t.setPointtypeIsOnCheck&&void 0!==t.startingSumAtSet&&(t.startingSumAtSet[o].value=i.startingSum,i.startingSum=t.startingSumAtSet[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum))}}}delete e.setPointtypeIsOnCheck,delete e.startingSumAtSet,Nt.splice(t,1)}if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Pt.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!1:"2"===e.changeType?o.isTrue=!0:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const i=Dt.get(e.idOfAllowChoice[t]);if(void 0!==i&&(i.allowedChoices-=e.numbAddToAllowChoice,i.allowedChoices>0&&i.currentChoices>=i.allowedChoices))for(let e=0;e<i.objects.length;e++){const t=i.objects[e];if(t.isActive&&!t.forcedActivated)if(t.isSelectableMultiple){let e=t.multipleUseVariable;for(let n=0;n<e;n++)ui(t,i,o)}else si(t,i,o);if(i.allowedChoices>=i.currentChoices)break}}if(e.textfieldIsOn&&void 0!==e.idOfTheTextfieldWord&&void 0!==e.wordChangeSelect){const t=qt.get(e.idOfTheTextfieldWord);void 0!==t&&(t.replaceText=void 0===e.wordChangeDeselect?"":e.wordChangeDeselect)}if(e.isImageUpload&&void 0!==e.defaultImage&&(e.image=e.defaultImage),e.backpackBtnRequirement&&void 0!==app.btnBackpackIsOn&&(app.btnBackpackIsOn-=1),e.showAllAddons&&void 0!==app.showAllAddons&&(app.showAllAddons-=1),e.changeBackground)if(e.changeBgImage){if(void 0!==app.bgImageStack){const t=app.bgImageStack.findIndex(t=>t.id===e.id);-1!==t&&app.bgImageStack.splice(t,1);const o=app.bgImageStack.length;o>0?app.styling.backgroundImage=app.bgImageStack[o-1].data:(app.styling.backgroundImage=app.defaultBgImage||"",delete app.bgImageStack)}}else if(void 0!==e.changedBgColorCode&&void 0!==app.bgColorStack){const t=app.bgColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.bgColorStack.splice(t,1);const o=app.bgColorStack.length;o>0?app.styling.backgroundColor=app.bgColorStack[o-1].data:(app.styling.backgroundColor=app.defaultBgColor||"#FFFFFFFF",delete app.bgColorStack)}if(e.changePointBar){if(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&void 0!==app.barBgColorStack){const t=app.barBgColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barBgColorStack.splice(t,1);const o=app.barBgColorStack.length;o>0?app.styling.barBackgroundColor=app.barBgColorStack[o-1].data:(app.styling.barBackgroundColor=app.defaultBarBgColor||"#FFFFFFFF",delete app.barBgColorStack)}if(e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&void 0!==app.barIconColorStack){const t=app.barIconColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barIconColorStack.splice(t,1);const o=app.barIconColorStack.length;o>0?app.styling.barIconColor=app.barIconColorStack[o-1].data:(app.styling.barIconColor=app.defaultBarIconColor||"#0000008A",delete app.barIconColorStack)}if(e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&void 0!==app.barTextColorStack){const t=app.barTextColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barTextColorStack.splice(t,1);const o=app.barTextColorStack.length;o>0?app.styling.barTextColor=app.barTextColorStack[o-1].data:(app.styling.barTextColor=app.defaultBarIconColor||"#000000",delete app.barTextColorStack)}}if(e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=Ft.get(i);if(void 0!==n){const t=n.choice;if(Zi(t,e.id),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){Zi(t.addons[o],e.id)}continue}const r=Dt.get(i);if(void 0!==r){Zi(r,e.id);continue}const l=Rt.get(i);if(void 0!==l){const t=l.rowElements;for(let i=0;i<t.length;i++){const o=Dt.get(t[i]);void 0!==o&&Zi(o,e.id)}const o=l.elements;for(let i=0;i<o.length;i++){const t=Ft.get(o[i]);if(void 0!==t){const o=t.choice;if(Zi(o,e.id),e.changeAddonTemplate)for(let t=0;t<o.addons.length;t++){Zi(o.addons[t],e.id)}}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=Ft.get(i);if(void 0!==n){Ki(n.choice,e.id);continue}const r=Dt.get(i);if(void 0!==r){Ki(r,e.id);continue}const l=Rt.get(i);if(void 0!==l){const t=l.rowElements;for(let i=0;i<t.length;i++){const o=Dt.get(t[i]);void 0!==o&&Ki(o,e.id)}const o=l.elements;for(let i=0;i<o.length;i++){const t=Ft.get(o[i]);if(void 0!==t){Ki(t.choice,e.id)}}continue}}}if(e.setBgmIsOn&&zt&&e.bgmId&&(Ht.bgmIsPlaying=!1,Eo(e,e.bgmId,0)),e.muteBgm&&zt){const e=u(zt);app.isMute=!1,e&&"function"==typeof e.unMute&&e.unMute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=Dt.get(e.hiddenContentsRow[t]);if(void 0!==o)for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":delete o.objectTitleRemoved;break;case"2":delete o.objectImageRemoved;break;case"3":delete o.objectTextRemoved;break;case"4":delete o.objectScoreRemoved;break;case"5":delete o.objectRequirementRemoved;break;case"6":delete o.addonTitleRemoved;break;case"7":delete o.addonImageRemoved;break;case"8":delete o.addonTextRemoved}}if(delete e.tempSlots,ri(e,r,0,void 0,void 0,o),ai(o),delete e.appliedDisChoices,e.isAutoActive&&Bt.set(e.id,{multiple:0}),!e.isActive&&e.deselectParent&&e.parentId){const i=Ft.get(e.parentId);if(void 0!==i){const e=i.choice;if(e.isActive)if(e.isSelectableMultiple&&e.isMultipleUseVariable){const i=e.multipleUseVariable;for(let n=0;n<Math.abs(i);n++)i>0?ui(e,t,o):di(e,t,o)}else si(e,t,o)}}};if(e.isSelectDelayed&&void 0!==e.selectDelayTime&&!e.selectDelayTimer)e.selectDelayTimer=window.setTimeout(()=>e.customTextfieldIsOn&&!o.isOverDlg?(Yt.choice=e,Yt.row=t,Yt.context=void 0!==e.wordPromptText?e.wordPromptText:"",Yt.prevText=e.wordChangeSelect||"",Yt.isWord=!0,Yt.currentDialog="dlgCommon",Yt.isDeselect=!0,void(Yt.cFunc=(i,n)=>{if("deselect"===i.detail.action)o.isOverDlg=!0,si(e,t,o);else if("accept"===i.detail.action&&Yt.choice&&Yt.choice.idOfTheTextfieldWord){if(Yt.isWord){Yt.choice.wordChangeSelect=n;const e=qt.get(Yt.choice.idOfTheTextfieldWord);void 0!==e&&(e.replaceText=Yt.choice.wordChangeSelect||"")}o.isOverDlg=!0}delete Yt.isDeselect})):e.isImageUpload&&!o.isOverImg?(Jt.currentDialog="appImageUpload",Jt.data=e,Jt.imgProp="image",Jt.isDeselect=!0,void(Jt.cFunc=i=>{"deselect"===i.detail.action&&(o.isOverImg=!0,si(e,t,o)),delete Jt.isDeselect})):(-1===o.linkedObjects.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,r()},1e3*app.fadeTransitionTime)):r()),0===o.linkedObjects.indexOf(e.id)&&o.linkedObjects.splice(0),e.selectDelayTimer=0,void delete e.selectDelayTimer),e.selectDelayTime);else{if(e.customTextfieldIsOn&&!o.isOverDlg)return Yt.choice=e,Yt.row=t,Yt.context=void 0!==e.wordPromptText?e.wordPromptText:"",Yt.prevText=e.wordChangeSelect||"",Yt.isWord=!0,Yt.currentDialog="dlgCommon",Yt.isDeselect=!0,void(Yt.cFunc=(i,n)=>{if("deselect"===i.detail.action)o.isOverDlg=!0,si(e,t,o);else if("accept"===i.detail.action&&Yt.choice&&Yt.choice.idOfTheTextfieldWord){if(Yt.isWord){Yt.choice.wordChangeSelect=n;const e=qt.get(Yt.choice.idOfTheTextfieldWord);void 0!==e&&(e.replaceText=Yt.choice.wordChangeSelect||"")}o.isOverDlg=!0}delete Yt.isDeselect});if(e.isImageUpload&&!o.isOverImg)return Jt.currentDialog="appImageUpload",Jt.data=e,Jt.imgProp="image",Jt.isDeselect=!0,void(Jt.cFunc=i=>{"deselect"===i.detail.action&&(o.isOverImg=!0,si(e,t,o)),delete Jt.isDeselect});-1===o.linkedObjects.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,r()},1e3*app.fadeTransitionTime)):r()),0===o.linkedObjects.indexOf(e.id)&&o.linkedObjects.splice(0)}}}function ci(e,t,o){const i=void 0===e.parentId;let r=!0;if(i&&t.allowedChoices>0&&t.currentChoices>=t.allowedChoices){let e=0;for(let i=0;i<t.objects.length;i++){const n=t.objects[i];if(n.isActive){if(!n.forcedActivated&&!n.selectOnce){if(n.isSelectableMultiple){let e=n.multipleUseVariable;for(let i=0;i<e;i++)ui(n,t,o)}else ti(n,t,!1,o);break}e++}}e>=t.allowedChoices&&(r=!1)}if(r){if(Ko(e,!0)){const r=()=>{const r=new n;if(e.isActive=!0,kt.set(e.id,{multiple:0}),i&&(t.currentChoices+=1),e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue)if(e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let o=0;o<e.discountRows.length;o++){const i=Dt.get(e.discountRows[o]);if(void 0!==i)for(let o=0;o<i.objects.length;o++){const n=i.objects[o];Jo(e,n),t.add(n.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const t=Ft.get(e.discountChoices[o]);void 0!==t&&Jo(e,t.choice)}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Rt.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=Ft.get(o.elements[t]);void 0!==i&&Jo(e,i.choice)}}let l=new Set;for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(Wo(o.requireds)&&!o.isActive){const e=Mt.get(o.id);if(void 0!==e){let t=o.value;if(o.useExpression&&o.setValue&&Xo(e,o),o.appliedDiscount&&void 0!==o.discountScore)t=o.discountScore;else if(o.discountIsOn&&void 0!==o.discountScore&&o.discountedFrom&&o.discountedFrom.length>0){let e=!1;for(let i=0;i<o.discountedFrom.length;i++){const n=Ft.get(o.discountedFrom[i]);if(void 0!==n){const i=n.choice;if(!i.useDiscountCount||void 0===i.discountCount){t=o.discountScore,o.appliedDiscount=!0,e=!0;break}{const n=i.isSelectableMultiple&&i.isMultipleUseVariable&&i.stackableDiscount?i.discountCount*i.multipleUseVariable:i.discountCount;if(i.appliedDisChoices||(i.appliedDisChoices=[]),n>i.appliedDisChoices.length){l.add(i),t=o.discountScore,o.appliedDiscount=!0,e=!0;break}}}}if(!e&&void 0!==o.tmpDiscount)for(let i=0;i<o.tmpDiscount.length;i++)t>o.tmpDiscount[i].discountedValue&&(t=o.tmpDiscount[i].discountedValue)}t=e.allowFloat?t:Math.floor(t),e.startingSum-=t,o.isActive=!0;let i=r.get(o.id);void 0!==i?r.set(o.id,t+i):r.set(o.id,t)}}}if(l.size>0&&l.forEach(t=>{t.appliedDisChoices&&-1===t.appliedDisChoices.indexOf(e.id)&&t.appliedDisChoices.push(e.id)}),e.duplicateRow&&void 0!==e.duplicateRowId&&void 0!==e.duplicateRowPlace&&fi(e),e.activateOtherChoice&&void 0!==e.activateThisChoice)if(e.isActivateRandom){const t={...o};t.isOverDlg=!1,t.isOverImg=!1,ni(e,t)}else{const t=e.activateThisChoice.split(",");for(let i=0;i<t.length;i++){const n=t[i].split("/ON#"),r=n.length>1?parseInt(n[1]):0,l=Ft.get(n[0]);if(void 0!==l){const t=l.row,i=l.choice,n={...o};n.isOverDlg=!1,n.isOverImg=!1,oi(e,i,t,r,n)}else{const t=Rt.get(n[0]);if(void 0!==t){const i=t.elements;for(let t=0;t<i.length;t++){const n=Ft.get(i[t]);if(void 0!==n){const t=n.row,i=n.choice,l={...o};l.isOverDlg=!1,l.isOverImg=!1,oi(e,i,t,r,l)}}}}}}if(e.deactivateOtherChoice&&void 0!==e.deactivateThisChoice){const t=e.deactivateThisChoice.split(",");for(let e=0;e<t.length;e++){const i=t[e].split("/ON#"),n=i.length>1?parseInt(i[1]):0,r=Ft.get(i[0]);if(void 0!==r){const e=r.row,t=r.choice;if(t.isActive)if(t.isSelectableMultiple&&t.isMultipleUseVariable)for(let i=0;i<n;i++){const i={...o};i.isOverDlg=!0,i.isOverImg=!0,ui(t,e,i)}else{const i={...o};i.isOverDlg=!0,i.isOverImg=!0,si(t,e,i)}}else{const e=Rt.get(i[0]);if(void 0!==e){const t=e.elements;for(let e=0;e<t.length;e++){const i=Ft.get(t[e]);if(void 0!==i){const e=i.row,t=i.choice;if(t.isActive)if(t.isSelectableMultiple&&t.isMultipleUseVariable)for(let i=0;i<n;i++){const i={...o};i.isOverDlg=!0,i.isOverImg=!0,ui(t,e,i)}else{const i={...o};i.isOverDlg=!0,i.isOverImg=!0,si(t,e,i)}}}}}}}if(Array.from(kt.entries()).forEach(([t,i])=>{const n=Ft.get(t);if(void 0!==n){const t=n.row,r=n.choice;if(r.id!==e.id&&!Wo(r.requireds))if(r.forcedActivated&&(delete r.forcedActivated,Bt.set(r.id,{multiple:i.multiple})),0===i.multiple){if(r.isActive){const e={...o};e.isOverDlg=!0,e.isOverImg=!0,si(r,t,e)}}else if(i.multiple>0)for(let e=0;e<i.multiple;e++)if(r.isActive){const e={...o};e.isOverDlg=!0,e.isOverImg=!0,ui(r,t,e)}}}),e.multiplyPointtypeIsOn&&void 0!==e.pointTypeToMultiply&&void 0!==e.multiplyWithThis){let t=0;e.multiplyPointtypeIsOnCheck=!0,"object"!=typeof e.startingSumAtMultiply&&(e.startingSumAtMultiply=[]);for(let o=0;o<e.pointTypeToMultiply.length;o++){let i=Mt.get(e.pointTypeToMultiply[o]);if(void 0!==i)if(e.multiplyPointtypeIsId&&"string"==typeof e.multiplyWithThis){let n=Mt.get(e.multiplyWithThis);void 0!==n?(e.startingSumAtMultiply[o]={value:i.startingSum,calcVal:n.startingSum},i.startingSum*=n.startingSum,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)):t++}else"number"==typeof e.multiplyWithThis&&(e.startingSumAtMultiply[o]={value:i.startingSum,calcVal:e.multiplyWithThis},i.startingSum*=e.multiplyWithThis,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum));else t++}t===e.pointTypeToMultiply.length&&delete e.multiplyPointtypeIsOnCheck,e.multiplyPointtypeIsOnCheck&&Nt.push(e)}if(e.dividePointtypeIsOn&&void 0!==e.pointTypeToDivide&&void 0!==e.divideWithThis){let t=0;e.dividePointtypeIsOnCheck=!0,"object"!=typeof e.startingSumAtDivide&&(e.startingSumAtDivide=[]);for(let o=0;o<e.pointTypeToDivide.length;o++){let i=Mt.get(e.pointTypeToDivide[o]);void 0!==i?0===e.dividedWithThis?t++:(e.startingSumAtDivide[o]={value:i.startingSum,calcVal:e.divideWithThis},i.startingSum/=e.divideWithThis,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)):t++}t===e.pointTypeToDivide.length&&delete e.dividePointtypeIsOnCheck,!e.multiplyPointtypeIsOnCheck&&e.dividePointtypeIsOnCheck&&Nt.push(e)}if(e.setPointtypeIsOn&&void 0!==e.pointTypeToSet&&void 0!==e.setWithThis){let t=0;e.setPointtypeIsOnCheck=!0,"object"!=typeof e.startingSumAtSet&&(e.startingSumAtSet=[]);for(let o=0;o<e.pointTypeToSet.length;o++){let i=Mt.get(e.pointTypeToSet[o]);if(void 0!==i){let t=0;try{const o=e.setWithThis.replace(/\{([^{}]+)\}/g,(e,t)=>{const o=Mt.get(t);if(void 0!==o)return"".concat(o.startingSum);throw new Error('Undefined variable: "'.concat(t,'"'))});t=g(o),t=i.allowFloat?t:Math.floor(t)}catch(a){console.error(a)}e.startingSumAtSet[o]={value:i.startingSum,calcVal:t},i.startingSum=t}else t++}t===e.pointTypeToSet.length&&delete e.setPointtypeIsOnCheck,e.multiplyPointtypeIsOnCheck||e.dividePointtypeIsOnCheck||!e.setPointtypeIsOnCheck||Nt.push(e)}if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Pt.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!0:"2"===e.changeType?o.isTrue=!1:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const i=Dt.get(e.idOfAllowChoice[t]);if(void 0!==i&&(i.allowedChoices+=e.numbAddToAllowChoice,i.allowedChoices>0&&i.currentChoices>=i.allowedChoices))for(let e=0;e<i.objects.length;e++){const t=i.objects[e];if(t.isActive&&!t.forcedActivated)if(t.isSelectableMultiple){let e=t.multipleUseVariable;for(let n=0;n<e;n++){const e={...o};e.isOverDlg=!1,e.isOverImg=!1,ui(t,i,e)}}else{const e={...o};e.isOverDlg=!1,e.isOverImg=!1,si(t,i,e)}if(i.allowedChoices>=i.currentChoices)break}}if(e.textfieldIsOn&&void 0!==e.idOfTheTextfieldWord&&void 0!==e.wordChangeSelect){const t=qt.get(e.idOfTheTextfieldWord);void 0!==t&&(t.replaceText=e.wordChangeSelect)}if(e.isImageUpload&&(e.defaultImage=e.image,Jt.currentDialog="appImageUpload",Jt.data=e,Jt.imgProp="image"),e.backpackBtnRequirement&&(app.btnBackpackIsOn+=1),e.showAllAddons&&(app.showAllAddons+=1),e.changeBackground&&(e.changeBgImage?void 0!==e.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage||""),app.bgImageStack.push({id:e.id,data:e.bgImage}),app.styling.backgroundImage=e.bgImage):void 0!==e.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor||""),app.bgColorStack.push({id:e.id,data:e.changedBgColorCode}),app.styling.backgroundColor=e.changedBgColorCode)),e.changePointBar&&(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor||"#FFFFFFFF"),app.barBgColorStack.push({id:e.id,data:e.changedBarBgColor}),app.styling.barBackgroundColor=e.changedBarBgColor),e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor||"#0000008A"),app.barIconColorStack.push({id:e.id,data:e.changedBarIconColor}),app.styling.barIconColor=e.changedBarIconColor),e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor||"#000000"),app.barTextColorStack.push({id:e.id,data:e.changedBarTextColor}),app.styling.barTextColor=e.changedBarTextColor)),e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=Ft.get(i);if(void 0!==n){const t=n.choice;if(Ji(t,e.id,e.changeToThisTemplate),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){Ji(t.addons[o],e.id,e.changeToThisTemplate)}continue}const r=Dt.get(i);if(void 0!==r){Ji(r,e.id,e.changeToThisTemplate);continue}const l=Rt.get(i);if(void 0!==l){const t=l.rowElements;for(let i=0;i<t.length;i++){const o=Dt.get(t[i]);void 0!==o&&Ji(o,e.id,e.changeToThisTemplate)}const o=l.elements;for(let i=0;i<o.length;i++){const t=Ft.get(o[i]);if(void 0!==t){const o=t.choice;if(Ji(o,e.id,e.changeToThisTemplate),e.changeAddonTemplate)for(let t=0;t<o.addons.length;t++){Ji(o.addons[t],e.id,e.changeToThisTemplate)}}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=Ft.get(i);if(void 0!==n){Xi(n.choice,e.id,e.changeToThisWidth);continue}const r=Dt.get(i);if(void 0!==r){Xi(r,e.id,e.changeToThisWidth);continue}const l=Rt.get(i);if(void 0!==l){const t=l.rowElements;for(let i=0;i<t.length;i++){const o=Dt.get(t[i]);void 0!==o&&Xi(o,e.id,e.changeToThisWidth)}const o=l.elements;for(let i=0;i<o.length;i++){const t=Ft.get(o[i]);if(void 0!==t){Xi(t.choice,e.id,e.changeToThisWidth)}}continue}}}if(e.setBgmIsOn&&e.bgmId&&(Ht.bgmIsPlaying=!0,Ht.isBgmInit||e.useAudioURL?Eo(e,e.bgmId,0):(zo(e),Ht.isBgmInit=!0)),e.muteBgm&&zt){const e=u(zt);app.isMute=!0,e&&"function"==typeof e.mute&&e.mute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=Dt.get(e.hiddenContentsRow[t]);if(void 0!==o){o.textIsRemoved||(o.textIsRemoved=!0);for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":o.objectTitleRemoved=!0;break;case"2":o.objectImageRemoved=!0;break;case"3":o.objectTextRemoved=!0;break;case"4":o.objectScoreRemoved=!0;break;case"5":o.objectRequirementRemoved=!0;break;case"6":o.addonTitleRemoved=!0;break;case"7":o.addonImageRemoved=!0;break;case"8":o.addonTextRemoved=!0}}}e.scrollToRow&&p().then(()=>{setTimeout(()=>{var t,i,n,r,l;if(e.scrollToObject){if(e.scrollObjectId){const l=Ft.get(e.scrollObjectId);if(void 0!==l){const e=l.choice,a=l.row,s=app.useToolbarBtn||!o.bCreatorMode||"appCyoaViewer"===Ut.value?a.index:a.index+1,c="appCyoaViewer"===Ut.value?0:1,d=null==(r=null==(n=null==(i=null==(t=o.mainDiv)?void 0:t.children[s])?void 0:i.children[c])?void 0:n.children[1])?void 0:r.children;if(void 0!==d){if(o.isBackpack){const t=document.getElementById("backpackDialog");null==t||t.scrollTo({top:d[e.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}window.scrollTo({top:d[e.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}}}}else if(e.scrollRowId){const t=Dt.get(e.scrollRowId);if(void 0!==t){const e=null==(l=o.mainDiv)?void 0:l.children;if(void 0!==e){const i=app.useToolbarBtn||!o.bCreatorMode?t.index:t.index+1;if(o.isBackpack){const t=document.getElementById("backpackDialog");null==t||t.scrollTo({top:e[i].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}else window.scrollTo({top:e[i].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}}}},10)}),e.cleanACtivatedOnSelect&&ei(),li(e,r,0,void 0,void 0,o),ai(o),!Wo(e.requireds)&&e.isActive&&si(e,t,o)};if(e.isSelectDelayed&&void 0!==e.selectDelayTime&&!e.selectDelayTimer)e.selectDelayTimer=window.setTimeout(()=>e.customTextfieldIsOn&&!o.isOverDlg?(Yt.choice=e,Yt.row=t,Yt.context=void 0!==e.wordPromptText?e.wordPromptText:"",Yt.prevText=e.wordChangeSelect||"",Yt.isWord=!0,Yt.currentDialog="dlgCommon",void(Yt.cFunc=(e,t)=>{"accept"===e.detail.action&&Yt.choice&&Yt.row&&(Yt.isWord&&(Yt.choice.wordChangeSelect=t),o.isOverDlg=!0,Yt.isForced=!1,Bt.delete(Yt.choice.id),ci(Yt.choice,Yt.row,o))})):e.confirmIsOn&&!o.isOverDlg?(Yt.choice=e,Yt.row=t,Yt.context=void 0!==e.wordPromptText?e.wordPromptText:"",Yt.isWord=!1,Yt.currentDialog="dlgCommon",void(Yt.cFunc=e=>{"accept"===e.detail.action&&Yt.choice&&Yt.row&&(o.isOverDlg=!0,Yt.isForced=!1,Bt.delete(Yt.choice.id),ci(Yt.choice,Yt.row,o))})):(-1===o.linkedObjects.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,r()},1e3*app.fadeTransitionTime)):r()),0===o.linkedObjects.indexOf(e.id)&&o.linkedObjects.splice(0),e.selectDelayTimer=0,void delete e.selectDelayTimer),e.selectDelayTime);else{if(e.customTextfieldIsOn&&!o.isOverDlg)return Yt.choice=e,Yt.row=t,Yt.context=void 0!==e.wordPromptText?e.wordPromptText:"",Yt.prevText=e.wordChangeSelect||"",Yt.isWord=!0,Yt.currentDialog="dlgCommon",void(Yt.cFunc=(e,t)=>{"accept"===e.detail.action&&Yt.choice&&Yt.row&&(Yt.isWord&&(Yt.choice.wordChangeSelect=t),o.isOverDlg=!0,Yt.isForced=!1,Bt.delete(Yt.choice.id),ci(Yt.choice,Yt.row,o))});if(e.confirmIsOn&&!o.isOverDlg)return Yt.choice=e,Yt.row=t,Yt.context=void 0!==e.wordPromptText?e.wordPromptText:"",Yt.isWord=!1,Yt.currentDialog="dlgCommon",void(Yt.cFunc=e=>{"accept"===e.detail.action&&Yt.choice&&Yt.row&&(o.isOverDlg=!0,Yt.isForced=!1,Bt.delete(Yt.choice.id),ci(Yt.choice,Yt.row,o))});-1===o.linkedObjects.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,r()},1e3*app.fadeTransitionTime)):r()),0===o.linkedObjects.indexOf(e.id)&&o.linkedObjects.splice(0)}}else for(let t=0;t<e.scores.length;t++){const o=e.scores[t];o.setValue&&delete o.setValue}}}function di(e,t,o){const i=void 0===e.parentId,r=Wo(e.requireds)&&!t.isInfoRow&&!e.isNotSelectable;let l=!0,a=t;if(t.isResultRow){const t=Ft.get(e.id);void 0!==t&&(a=t.row)}if(r&&i&&e.isMultipleUseVariable&&0===e.multipleUseVariable&&a.allowedChoices>0&&a.currentChoices>=a.allowedChoices){let e=0;for(let t=0;t<a.objects.length;t++){const i=a.objects[t];if(i.isActive){if(!i.forcedActivated&&!i.selectOnce){if(i.isSelectableMultiple){let e=i.multipleUseVariable;for(let t=0;t<e;t++)ui(i,a,o)}else ti(i,a,!1,o);break}e++}}e>=a.allowedChoices&&(l=!1)}if(l){if(Ko(e,!0)){const l=()=>{const r=new n,l=e.isActive,s=e.multipleUseVariable>=0,c=Math.abs(e.multipleUseVariable);if(e.multipleUseVariable+=1,0===e.multipleUseVariable?(kt.delete(e.id),e.isActive=!1,i&&(a.currentChoices-=1)):(1===e.multipleUseVariable&&(e.isActive=!0,i&&(a.currentChoices+=1)),kt.set(e.id,{multiple:e.multipleUseVariable})),s){if(e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue&&(e.stackableDiscount||!e.stackableDiscount&&1===e.multipleUseVariable))if(e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let o=0;o<e.discountRows.length;o++){const i=Dt.get(e.discountRows[o]);if(void 0!==i)for(let o=0;o<i.objects.length;o++){const n=i.objects[o];Jo(e,n),t.add(n.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const t=Ft.get(e.discountChoices[o]);void 0!==t&&Jo(e,t.choice)}}else if(void 0!==e.discountGroups)for(let o=0;o<e.discountGroups.length;o++){const t=Rt.get(e.discountGroups[o]);if(void 0!==t)for(let o=0;o<t.elements.length;o++){const i=Ft.get(t.elements[o]);void 0!==i&&Jo(e,i.choice)}}let t=new Set;for(let o=0;o<e.scores.length;o++){const i=e.scores[o];if(void 0===i.isActiveMul&&(i.isActiveMul=[]),Wo(i.requireds)&&!i.isActiveMul[c]){const e=Mt.get(i.id);if(void 0!==e){let o=i.value;if(i.useExpression&&i.setValue&&Xo(e,i),i.appliedDiscount&&void 0!==i.discountScore)o=i.discountScore;else if(i.discountIsOn&&void 0!==i.discountScore&&i.discountedFrom&&i.discountedFrom.length>0){let e=!1;for(let n=0;n<i.discountedFrom.length;n++){const r=Ft.get(i.discountedFrom[n]);if(void 0!==r){const n=r.choice;if(!n.useDiscountCount||void 0===n.discountCount){o=i.discountScore,i.appliedDiscount=!0,e=!0;break}{const r=n.isSelectableMultiple&&n.isMultipleUseVariable&&n.stackableDiscount?n.discountCount*n.multipleUseVariable:n.discountCount;if(n.appliedDisChoices||(n.appliedDisChoices=[]),r>n.appliedDisChoices.length){t.add(n),o=i.discountScore,i.appliedDiscount=!0,e=!0;break}}}}if(!e&&void 0!==i.tmpDiscount)for(let t=0;t<i.tmpDiscount.length;t++)o>i.tmpDiscount[t].discountedValue&&(o=i.tmpDiscount[t].discountedValue)}o=e.allowFloat?o:Math.floor(o),i.multiplyByTimes&&(o*=c+1),e.startingSum-=o,i.isActiveMul[c]=!0;let n=r.get(i.id);void 0!==n?r.set(i.id,o+n):r.set(i.id,o)}}}t.size>0&&t.forEach(t=>{t.appliedDisChoices&&-1===t.appliedDisChoices.indexOf(e.id)&&t.appliedDisChoices.push(e.id)})}else for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(void 0===o.isActiveMulMinus&&(o.isActiveMulMinus=[]),Wo(o.requireds)&&o.isActiveMulMinus[c]||o.isActiveMulMinus[c]){const e=Mt.get(o.id);if(void 0!==e){let t=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value;t=e.allowFloat?t:Math.floor(t),o.multiplyByTimes&&(t*=Math.abs(c)),e.startingSum-=t;let i=r.get(o.id);void 0!==i?r.set(o.id,t+i):r.set(o.id,t),delete o.isActiveMulMinus[c]}}}if(s&&(e.duplicateRow&&void 0!==e.duplicateRowId&&void 0!==e.duplicateRowPlace&&fi(e),e.activateOtherChoice&&void 0!==e.activateThisChoice))if(e.isActivateRandom)ni(e,o);else{const t=e.activateThisChoice.split(",");for(let i=0;i<t.length;i++){const n=t[i].split("/ON#"),r=n.length>1?parseInt(n[1]):0,a=Ft.get(n[0]);if(void 0!==a){const t=a.row,i=a.choice;!i.isSelectableMultiple&&l||oi(e,i,t,r,o)}else{const t=Rt.get(n[0]);if(void 0!==t){const i=t.elements;for(let t=0;t<i.length;t++){const n=Ft.get(i[t]);if(void 0!==n){const t=n.row,i=n.choice;!i.isSelectableMultiple&&l||oi(e,i,t,r,o)}}}}}}if(Array.from(kt.entries()).forEach(([t,i])=>{const n=Ft.get(t);if(void 0!==n){const t=n.row,r=n.choice;if(r.id!==e.id&&!Wo(r.requireds))if(r.forcedActivated&&(delete r.forcedActivated,Bt.set(r.id,{multiple:i.multiple})),0===i.multiple){if(r.isActive){const e={...o};e.isOverDlg=!1,e.isOverImg=!1,si(r,t,e)}}else if(i.multiple>0)for(let e=0;e<i.multiple;e++)if(r.isActive){const e={...o};e.isOverDlg=!1,e.isOverImg=!1,ui(r,t,e)}}}),e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const i=Dt.get(e.idOfAllowChoice[t]);if(void 0!==i&&(i.allowedChoices+=e.numbAddToAllowChoice,i.allowedChoices>0&&i.currentChoices>=i.allowedChoices))for(let e=0;e<i.objects.length;e++){const t=i.objects[e];if(t.isActive&&!t.forcedActivated)if(t.isSelectableMultiple){let e=t.multipleUseVariable;for(let n=0;n<e;n++){const e={...o};e.isOverDlg=!1,e.isOverImg=!1,ui(t,i,e)}}else if(t.isActive){const e={...o};e.isOverDlg=!1,e.isOverImg=!1,si(t,i,e)}if(i.allowedChoices>=i.currentChoices)break}}if(!l){if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Pt.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!0:"2"===e.changeType?o.isTrue=!1:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.textfieldIsOn&&void 0!==e.idOfTheTextfieldWord&&void 0!==e.wordChangeSelect){const t=qt.get(e.idOfTheTextfieldWord);void 0!==t&&(t.replaceText=e.wordChangeSelect)}if(e.isImageUpload&&(e.defaultImage=e.image,Jt.currentDialog="appImageUpload",Jt.data=e,Jt.imgProp="image"),e.backpackBtnRequirement&&(app.btnBackpackIsOn+=1),e.showAllAddons&&(app.showAllAddons+=1),e.changeBackground&&(e.changeBgImage?void 0!==e.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage||""),app.bgImageStack.push({id:e.id,data:e.bgImage}),app.styling.backgroundImage=e.bgImage):void 0!==e.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor||""),app.bgColorStack.push({id:e.id,data:e.changedBgColorCode}),app.styling.backgroundColor=e.changedBgColorCode)),e.changePointBar&&(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor||"#FFFFFFFF"),app.barBgColorStack.push({id:e.id,data:e.changedBarBgColor}),app.styling.barBackgroundColor=e.changedBarBgColor),e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor||"#0000008A"),app.barIconColorStack.push({id:e.id,data:e.changedBarIconColor}),app.styling.barIconColor=e.changedBarIconColor),e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor||"#000000"),app.barTextColorStack.push({id:e.id,data:e.changedBarTextColor}),app.styling.barTextColor=e.changedBarTextColor)),e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=Ft.get(i);if(void 0!==n){const t=n.choice;if(Ji(t,e.id,e.changeToThisTemplate),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){Ji(t.addons[o],e.id,e.changeToThisTemplate)}continue}const r=Dt.get(i);if(void 0!==r){Ji(r,e.id,e.changeToThisTemplate);continue}const l=Rt.get(i);if(void 0!==l){const t=l.rowElements;for(let i=0;i<t.length;i++){const o=Dt.get(t[i]);void 0!==o&&Ji(o,e.id,e.changeToThisTemplate)}const o=l.elements;for(let i=0;i<o.length;i++){const t=Ft.get(o[i]);if(void 0!==t){const o=t.choice;if(Ji(o,e.id,e.changeToThisTemplate),e.changeAddonTemplate)for(let t=0;t<o.addons.length;t++){Ji(o.addons[t],e.id,e.changeToThisTemplate)}}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=Ft.get(i);if(void 0!==n){Xi(n.choice,e.id,e.changeToThisWidth);continue}const r=Dt.get(i);if(void 0!==r){Xi(r,e.id,e.changeToThisWidth);continue}const l=Rt.get(i);if(void 0!==l){const t=l.rowElements;for(let i=0;i<t.length;i++){const o=Dt.get(t[i]);void 0!==o&&Xi(o,e.id,e.changeToThisWidth)}const o=l.elements;for(let i=0;i<o.length;i++){const t=Ft.get(o[i]);if(void 0!==t){Xi(t.choice,e.id,e.changeToThisWidth)}}continue}}}if(e.setBgmIsOn&&e.bgmId&&(Ht.bgmIsPlaying=!0,Ht.isBgmInit||e.useAudioURL?Eo(e,e.bgmId,0):(zo(e),Ht.isBgmInit=!0)),e.muteBgm&&Gt){const e=u(Gt);app.isMute=!0,e&&"function"==typeof e.mute&&e.mute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=Dt.get(e.hiddenContentsRow[t]);if(void 0!==o){o.textIsRemoved||(o.textIsRemoved=!0);for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":o.objectTitleRemoved=!0;break;case"2":o.objectImageRemoved=!0;break;case"3":o.objectTextRemoved=!0;break;case"4":o.objectScoreRemoved=!0;break;case"5":o.objectRequirementRemoved=!0;break;case"6":o.addonTitleRemoved=!0;break;case"7":o.addonImageRemoved=!0;break;case"8":o.addonTextRemoved=!0}}}e.scrollToRow&&p().then(()=>{setTimeout(()=>{var t,i,n,r,l;if(e.scrollToObject){if(e.scrollObjectId){const l=Ft.get(e.scrollObjectId);if(void 0!==l){const e=l.choice,a=l.row,s=app.useToolbarBtn||!o.bCreatorMode||"appCyoaViewer"===Ut.value?a.index:a.index+1,c="appCyoaViewer"===Ut.value?0:1,d=null==(r=null==(n=null==(i=null==(t=o.mainDiv)?void 0:t.children[s])?void 0:i.children[c])?void 0:n.children[1])?void 0:r.children;if(void 0!==d){if(o.isBackpack){const t=document.getElementById("backpackDialog");null==t||t.scrollTo({top:d[e.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}window.scrollTo({top:d[e.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}}}}else if(e.scrollRowId){const t=Dt.get(e.scrollRowId);if(void 0!==t){const e=null==(l=o.mainDiv)?void 0:l.children;if(void 0!==e){const i=app.useToolbarBtn||!o.bCreatorMode?t.index:t.index+1;if(o.isBackpack){const t=document.getElementById("backpackDialog");null==t||t.scrollTo({top:e[i].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}else window.scrollTo({top:e[i].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}}}},10)})}if(li(e,r,0,void 0,void 0,o),ai(o),!Wo(e.requireds)&&e.isActive&&ui(e,t,o),!e.isActive&&e.deselectParent&&e.parentId){const i=Ft.get(e.parentId);if(void 0!==i){const e=i.choice;if(e.isActive)if(e.isSelectableMultiple&&e.isMultipleUseVariable){const i=e.multipleUseVariable;for(let n=0;n<Math.abs(i);n++)i>0?ui(e,t,o):di(e,t,o)}else si(e,t,o)}}};if(r)if(e.isMultipleUseVariable){if(void 0===e.multipleUseVariable&&(e.multipleUseVariable=0),void 0===e.numMultipleTimesPluss&&(e.numMultipleTimesPluss=0),e.numMultipleTimesPluss>e.multipleUseVariable)if(e.isSelectDelayed&&void 0!==e.selectDelayTime)e.selectDelayTimer||(e.selectDelayTimer=window.setTimeout(()=>!e.customTextfieldIsOn||o.isOverDlg||e.isActive?e.confirmIsOn&&!o.isOverDlg?(Yt.choice=e,Yt.row=t,Yt.context=void 0!==e.wordPromptText?e.wordPromptText:"",Yt.isWord=!1,Yt.currentDialog="dlgCommon",void(Yt.cFunc=e=>{"accept"===e.detail.action&&Yt.choice&&Yt.row&&(o.isOverDlg=!0,Yt.isForced=!1,Bt.delete(Yt.choice.id),di(Yt.choice,Yt.row,o))})):(-1===o.linkedObjects.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,l()},1e3*app.fadeTransitionTime)):l()),0===o.linkedObjects.indexOf(e.id)&&o.linkedObjects.splice(0),e.selectDelayTimer=0,void delete e.selectDelayTimer):(Yt.choice=e,Yt.row=t,Yt.context=void 0!==e.wordPromptText?e.wordPromptText:"",Yt.prevText=e.wordChangeSelect||"",Yt.isWord=!0,Yt.currentDialog="dlgCommon",void(Yt.cFunc=(e,t)=>{"accept"===e.detail.action&&Yt.choice&&Yt.row&&(Yt.isWord&&(Yt.choice.wordChangeSelect=t),o.isOverDlg=!0,Yt.isForced=!1,Bt.delete(Yt.choice.id),di(Yt.choice,Yt.row,o))})),e.selectDelayTime));else{if(e.customTextfieldIsOn&&!o.isOverDlg&&!e.isActive)return Yt.choice=e,Yt.row=t,Yt.context=void 0!==e.wordPromptText?e.wordPromptText:"",Yt.prevText=e.wordChangeSelect||"",Yt.isWord=!0,Yt.currentDialog="dlgCommon",void(Yt.cFunc=(e,t)=>{"accept"===e.detail.action&&Yt.choice&&Yt.row&&(Yt.isWord&&(Yt.choice.wordChangeSelect=t),o.isOverDlg=!0,Yt.isForced=!1,Bt.delete(Yt.choice.id),di(Yt.choice,Yt.row,o))});if(e.confirmIsOn&&!o.isOverDlg)return Yt.choice=e,Yt.row=t,Yt.context=void 0!==e.wordPromptText?e.wordPromptText:"",Yt.isWord=!1,Yt.currentDialog="dlgCommon",void(Yt.cFunc=e=>{"accept"===e.detail.action&&Yt.choice&&Yt.row&&(o.isOverDlg=!0,Yt.isForced=!1,Bt.delete(Yt.choice.id),di(Yt.choice,Yt.row,o))});-1===o.linkedObjects.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,l()},1e3*app.fadeTransitionTime)):l()),0===o.linkedObjects.indexOf(e.id)&&o.linkedObjects.splice(0)}}else if(void 0!==e.multipleScoreId){const t=Mt.get(e.multipleScoreId);void 0!==t&&(void 0===e.numMultipleTimesPluss&&(e.numMultipleTimesPluss=0),e.numMultipleTimesPluss>t.startingSum&&(t.startingSum+=1))}}else for(let t=0;t<e.scores.length;t++){const o=e.scores[t];o.setValue&&delete o.setValue}}}function ui(e,t,o){const i=void 0===e.parentId,r=Ko(e,!1);let l=t;if(t.isResultRow){const t=Ft.get(e.id);void 0!==t&&(l=t.row)}if(r){const r=()=>{const r=new n,a=e.multipleUseVariable>0,s=Math.abs(e.multipleUseVariable-1);if(a){for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(void 0!==o.isActiveMul&&(Wo(o.requireds)&&o.isActiveMul[s]||o.isActiveMul[s])){const e=Mt.get(o.id);if(void 0!==e){let t=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.useExpression&&o.mulValue&&o.mulValue[s]?o.mulValue[s]:o.value;t=e.allowFloat?t:Math.floor(t),o.multiplyByTimes&&(t*=s+1),e.startingSum+=t;let i=r.get(o.id);void 0!==i?r.set(o.id,-t+i):r.set(o.id,-t),delete o.isActiveMul[s],o.mulValue&&delete o.mulValue[s],0===s&&delete o.setValue}}}if(e.activateOtherChoice&&void 0!==e.activateThisChoice)if(e.isActivateRandom&&void 0!==e.activatedRandomMul&&void 0!==e.activatedRandomMul[s]){for(let t=0;t<e.activatedRandomMul[s].length;t++){const i=e.activatedRandomMul[s][t].split("/ON#"),n=Ft.get(i[0]);if(void 0!==n){const t=n.row,r=n.choice,l=i.length>1?Number(i[1]):0,a={...o};a.isOverDlg=!1,a.isOverImg=!1,ii(e,r,t,l,a)}}e.activatedRandomMul.splice(s,1)}else{const t=e.activateThisChoice.split(",");for(let i=0;i<t.length;i++){const n=t[i].split("/ON#"),r=n.length>1?parseInt(n[1]):0,l=Ft.get(n[0]);if(void 0!==l){const t=l.row,i=l.choice;if(0===s||i.isSelectableMultiple){const n={...o};n.isOverDlg=!1,n.isOverImg=!1,ii(e,i,t,r,n)}}else{const t=Rt.get(n[0]);if(void 0!==t){const i=t.elements;for(let t=0;t<i.length;t++){const n=Ft.get(i[t]);if(void 0!==n){const t=n.row,i=n.choice;if(0===s||i.isSelectableMultiple){const n={...o};n.isOverDlg=!1,n.isOverImg=!1,ii(e,i,t,r,n)}}}}}}}if(e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue&&(e.stackableDiscount||!e.stackableDiscount&&1===e.multipleUseVariable))if(void 0===e.discountPointTypes&&(e.discountPointTypes=[]),e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let o=0;o<e.discountRows.length;o++){const i=Dt.get(e.discountRows[o]);if(void 0!==i)for(let o=0;o<i.objects.length;o++){const n=i.objects[o];Yo(e,n),t.add(n.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const t=Ft.get(e.discountChoices[o]);void 0!==t&&Yo(e,t.choice)}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Rt.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=Ft.get(o.elements[t]);void 0!==i&&Yo(e,i.choice)}}}else for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(void 0===o.isActiveMulMinus&&(o.isActiveMulMinus=[]),Wo(o.requireds)&&!o.isActiveMulMinus[s]){const e=Mt.get(o.id);if(void 0!==e){let t=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value;t=e.allowFloat?t:Math.floor(t),o.multiplyByTimes&&(t*=s),e.startingSum+=t;let i=r.get(o.id);void 0!==i?r.set(o.id,-t+i):r.set(o.id,-t),o.isActiveMulMinus[s]=!0}}}if(e.multipleUseVariable-=1,0===e.multipleUseVariable?(e.isActive=!1,i&&(l.currentChoices-=1),kt.delete(e.id)):(-1===e.multipleUseVariable&&(e.isActive=!0,i&&(l.currentChoices+=1)),kt.set(e.id,{multiple:e.multipleUseVariable})),Array.from(kt.entries()).forEach(([t,i])=>{const n=Ft.get(t);if(void 0!==n){const t=n.row,r=n.choice;if(r.id!==e.id&&!Wo(r.requireds))if(r.forcedActivated&&(delete r.forcedActivated,Bt.set(r.id,{multiple:i.multiple})),0===i.multiple){if(r.forcedActivated&&delete r.forcedActivated,r.isActive){const e={...o};e.isOverDlg=!1,e.isOverImg=!1,si(r,t,e)}}else if(i.multiple>0)for(let e=0;e<i.multiple;e++)if(r.isActive){const e={...o};e.isOverDlg=!1,e.isOverImg=!1,ui(r,t,e)}}}),e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const i=Dt.get(e.idOfAllowChoice[t]);if(void 0!==i&&(i.allowedChoices-=e.numbAddToAllowChoice,i.allowedChoices>0&&i.currentChoices>=i.allowedChoices))for(let e=0;e<i.objects.length;e++){const t=i.objects[e];if(t.isActive&&!t.forcedActivated)if(t.isSelectableMultiple){let e=t.multipleUseVariable;for(let n=0;n<e;n++){const e={...o};e.isOverDlg=!1,e.isOverImg=!1,ui(t,i,e)}}else if(t.isActive){const e={...o};e.isOverDlg=!1,e.isOverImg=!1,si(t,i,e)}if(i.allowedChoices>=i.currentChoices)break}}if(0===s){if(e.textfieldIsOn&&void 0!==e.idOfTheTextfieldWord&&void 0!==e.wordChangeSelect){const t=qt.get(e.idOfTheTextfieldWord);void 0!==t&&(t.replaceText=void 0===e.wordChangeDeselect?"":e.wordChangeDeselect)}if(e.isImageUpload&&void 0!==e.defaultImage&&(e.image=e.defaultImage),e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Pt.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!1:"2"===e.changeType?o.isTrue=!0:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.backpackBtnRequirement&&void 0!==app.btnBackpackIsOn&&(app.btnBackpackIsOn-=1),e.showAllAddons&&void 0!==app.showAllAddons&&(app.showAllAddons-=1),e.changeBackground)if(e.changeBgImage){if(void 0!==app.bgImageStack){const t=app.bgImageStack.findIndex(t=>t.id===e.id);-1!==t&&app.bgImageStack.splice(t,1);const o=app.bgImageStack.length;o>0?app.styling.backgroundImage=app.bgImageStack[o-1].data:(app.styling.backgroundImage=app.defaultBgImage||"",delete app.bgImageStack)}}else if(void 0!==e.changedBgColorCode&&void 0!==app.bgColorStack){const t=app.bgColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.bgColorStack.splice(t,1);const o=app.bgColorStack.length;o>0?app.styling.backgroundColor=app.bgColorStack[o-1].data:(app.styling.backgroundColor=app.defaultBgColor||"#FFFFFFFF",delete app.bgColorStack)}if(e.changePointBar){if(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&void 0!==app.barBgColorStack){const t=app.barBgColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barBgColorStack.splice(t,1);const o=app.barBgColorStack.length;o>0?app.styling.barBackgroundColor=app.barBgColorStack[o-1].data:(app.styling.barBackgroundColor=app.defaultBarBgColor||"#FFFFFFFF",delete app.barBgColorStack)}if(e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&void 0!==app.barIconColorStack){const t=app.barIconColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barIconColorStack.splice(t,1);const o=app.barIconColorStack.length;o>0?app.styling.barIconColor=app.barIconColorStack[o-1].data:(app.styling.barIconColor=app.defaultBarIconColor||"#0000008A",delete app.barIconColorStack)}if(e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&void 0!==app.barTextColorStack){const t=app.barTextColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barTextColorStack.splice(t,1);const o=app.barTextColorStack.length;o>0?app.styling.barTextColor=app.barTextColorStack[o-1].data:(app.styling.barTextColor=app.defaultBarIconColor||"#000000",delete app.barTextColorStack)}}if(e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=Ft.get(i);if(void 0!==n){const t=n.choice;if(Zi(t,e.id),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){Zi(t.addons[o],e.id)}continue}const r=Dt.get(i);if(void 0!==r){Zi(r,e.id);continue}const l=Rt.get(i);if(void 0!==l){const t=l.rowElements;for(let i=0;i<t.length;i++){const o=Dt.get(t[i]);void 0!==o&&Zi(o,e.id)}const o=l.elements;for(let i=0;i<o.length;i++){const t=Ft.get(o[i]);if(void 0!==t){const o=t.choice;if(Zi(o,e.id),e.changeAddonTemplate)for(let t=0;t<o.addons.length;t++){Zi(o.addons[t],e.id)}}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=Ft.get(i);if(void 0!==n){Ki(n.choice,e.id);continue}const r=Dt.get(i);if(void 0!==r){Ki(r,e.id);continue}const l=Rt.get(i);if(void 0!==l){const t=l.rowElements;for(let i=0;i<t.length;i++){const o=Dt.get(t[i]);void 0!==o&&Ki(o,e.id)}const o=l.elements;for(let i=0;i<o.length;i++){const t=Ft.get(o[i]);if(void 0!==t){Ki(t.choice,e.id)}}continue}}}if(e.setBgmIsOn&&Gt&&e.bgmId&&(Ht.bgmIsPlaying=!1,Eo(e,e.bgmId,0)),e.muteBgm&&Gt){const e=u(Gt);app.isMute=!1,e&&"function"==typeof e.unMute&&e.unMute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=Dt.get(e.hiddenContentsRow[t]);if(void 0!==o)for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":o.objectTitleRemoved=!1;break;case"2":o.objectImageRemoved=!1;break;case"3":o.objectTextRemoved=!1;break;case"4":o.objectScoreRemoved=!1;break;case"5":o.objectRequirementRemoved=!1;break;case"6":o.addonTitleRemoved=!1;break;case"7":o.addonImageRemoved=!1;break;case"8":o.addonTextRemoved=!1}}}if(ri(e,r,0,void 0,void 0,o),ai(o),!e.isActive&&e.deselectParent&&e.parentId){const i=Ft.get(e.parentId);if(void 0!==i){const e=i.choice;if(e.isActive)if(e.isSelectableMultiple&&e.isMultipleUseVariable){const i=e.multipleUseVariable;for(let n=0;n<Math.abs(i);n++)i>0?ui(e,t,o):di(e,t,o)}else si(e,t,o)}}};if(!t.isInfoRow&&!e.isNotSelectable&&!e.selectOnce)if(e.isMultipleUseVariable){if(void 0===e.numMultipleTimesMinus&&(e.numMultipleTimesMinus=0),e.multipleUseVariable>e.numMultipleTimesMinus)if(e.isSelectDelayed&&void 0!==e.selectDelayTime)e.selectDelayTimer||(e.selectDelayTimer=window.setTimeout(()=>{if(e.customTextfieldIsOn&&!o.isOverDlg&&e.multipleUseVariable===e.numMultipleTimesMinus+1)return Yt.choice=e,Yt.row=t,Yt.context=void 0!==e.wordPromptText?e.wordPromptText:"",Yt.prevText=e.wordChangeSelect||"",Yt.isWord=!0,Yt.currentDialog="dlgCommon",Yt.isDeselect=!0,void(Yt.cFunc=(i,n)=>{if("deselect"===i.detail.action)o.isOverDlg=!0,ui(e,t,o);else if("accept"===i.detail.action&&Yt.choice&&Yt.choice.idOfTheTextfieldWord){if(Yt.isWord){Yt.choice.wordChangeSelect=n;const e=qt.get(Yt.choice.idOfTheTextfieldWord);void 0!==e&&(e.replaceText=Yt.choice.wordChangeSelect||"")}o.isOverDlg=!0}delete Yt.isDeselect});-1===o.linkedObjects.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,r()},1e3*app.fadeTransitionTime)):r()),0===o.linkedObjects.indexOf(e.id)&&o.linkedObjects.splice(0),e.selectDelayTimer=0,delete e.selectDelayTimer},e.selectDelayTime));else{if(e.customTextfieldIsOn&&!o.isOverDlg&&e.multipleUseVariable===e.numMultipleTimesMinus+1)return Yt.choice=e,Yt.row=t,Yt.context=void 0!==e.wordPromptText?e.wordPromptText:"",Yt.prevText=e.wordChangeSelect||"",Yt.isWord=!0,Yt.currentDialog="dlgCommon",Yt.isDeselect=!0,void(Yt.cFunc=(i,n)=>{if("deselect"===i.detail.action)o.isOverDlg=!0,ui(e,t,o);else if("accept"===i.detail.action&&Yt.choice&&Yt.choice.idOfTheTextfieldWord){if(Yt.isWord){Yt.choice.wordChangeSelect=n;const e=qt.get(Yt.choice.idOfTheTextfieldWord);void 0!==e&&(e.replaceText=Yt.choice.wordChangeSelect||"")}o.isOverDlg=!0}delete Yt.isDeselect});-1===o.linkedObjects.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,r()},1e3*app.fadeTransitionTime)):r()),0===o.linkedObjects.indexOf(e.id)&&o.linkedObjects.splice(0)}}else if(void 0!==e.multipleScoreId){const t=Mt.get(e.multipleScoreId);void 0!==t&&(void 0===e.numMultipleTimesMinus&&(e.numMultipleTimesMinus=0),t.startingSum>e.numMultipleTimesMinus&&(t.startingSum-=1))}}}function gi(e,t,o,i=new Set){const r=Array.from(kt.keys());for(let l=0;l<r.length;l++){const a=r[l],s=Ft.get(a);if(void 0!==s){const r=s.row,l=s.choice,a=new n;let c=!1,d=!1;e.useDiscountCount&&!e.appliedDisChoices&&(e.appliedDisChoices=[]);for(let o=0;o<l.scores.length;o++){const s=l.scores[o];if(!s.isNotRecalculatable){const o=Mt.get(s.id);if(void 0!==o){if(e.discountOther&&s.isChangeDiscount&&void 0!==s.tmpDisScore){const t=l.multipleUseVariable,i=e.isSelectableMultiple&&e.isMultipleUseVariable&&e.stackableDiscount&&e.discountCount?e.discountCount*e.multipleUseVariable:e.discountCount;if(!e.useDiscountCount||e.useDiscountCount&&i&&i>e.appliedDisChoices.length){if(l.isSelectableMultiple&&l.isMultipleUseVariable&&void 0!==l.numMultipleTimesMinus){for(let e=t-1;e>=0;e--)l.isActive&&(o.startingSum+=s.tmpDisScore);l.isActive&&(a.set(s.id,s.tmpDisScore),delete s.isChangeDiscount,delete s.tmpDisScore)}else l.isSelectableMultiple||(o.startingSum+=s.tmpDisScore,a.set(s.id,s.tmpDisScore),delete s.isChangeDiscount,delete s.tmpDisScore);d=!0,l.isActive&&(s.appliedDiscount=!0,c=!0)}}if(!i.has(s.idx)){const c=e.scores.length>0,u=e.scores.length||1;for(let g=0;g<u;g++){const u=c?e.scores[g]:null,p=u&&t.get(u.id)||0,m=u?Mt.get(u.id):null;if((!c||c&&m)&&l.isActive){const t=Wo(s.requireds),c=new n(JSON.parse(JSON.stringify([...kt])));c.delete(e.id),r.currentChoices-=1,m&&(m.startingSum+=p);const u=Wo(s.requireds,c);if(r.currentChoices+=1,m&&(m.startingSum-=p),u!==t){s.setValue||Qo(o,s);let e=s.discountIsOn&&s.appliedDiscount&&void 0!==s.discountScore?s.discountScore:s.value;if(e=o.allowFloat?e:Math.floor(e),u)if(l.isSelectableMultiple&&l.isMultipleUseVariable&&void 0!==l.numMultipleTimesMinus){for(let t=l.multipleUseVariable-1;t>=0;t--)void 0!==s.isActiveMul&&s.isActiveMul[t]&&(o.startingSum+=e,a.set(s.id,e),s.isActiveMul[t]=!1)}else l.isSelectableMultiple||s.isActive&&(o.startingSum+=e,a.set(s.id,e),delete s.isActive);else if(l.isSelectableMultiple&&l.isMultipleUseVariable&&void 0!==l.numMultipleTimesMinus){const t=l.multipleUseVariable;void 0===s.isActiveMul&&(s.isActiveMul=[]);for(let i=t-1;i>=0;i--)s.isActiveMul[i]||(o.startingSum-=e,a.set(s.id,e),s.isActiveMul[i]=!0)}else l.isSelectableMultiple||s.isActive||(o.startingSum-=e,a.set(s.id,e),s.isActive=!0);d||(d=!0),i.add(s.idx)}}}}}}}c&&e.appliedDisChoices&&-1===e.appliedDisChoices.indexOf(l.id)&&e.appliedDisChoices.push(l.id),d&&gi(l,a,++o,i)}}}function pi(e,t){let o=e.split("/IMG#");const i=o.length>1?o[1].replace(/\/CHAR#/g,","):"";o=o[0].split("/WORD#");const r=o.length>1?o[1].replace(/\/CHAR#/g,","):"";o=o[0].split("/RND#");const l=o.length>1?o[1].split("/AND#"):"";o=o[0].split("/RS#");const a=o.length>1?o[1]:"",s=o[0],c=Ft.get(s);if(void 0!==c){const e=c.row,o=c.choice,s=new Map,p=void 0===o.parentId;if(a){const e=a.split("/AND#");for(let t=0;t<e.length;t++){const o=e[t].split(":"),i=Number(o[0]),n=Number(o[1]);Number.isNaN(i)||s.set(i,Number.isNaN(n)?0:n)}}for(let t=0;t<o.scores.length;t++){const e=o.scores[t],i=Mt.get(e.id);void 0===i||e.setValue||(s.size>0&&s.has(t)?(e.value=s.get(t),e.setValue=!0):Qo(i,e))}const m=new n;if(o.isActive=!0,kt.set(o.id,{multiple:0}),p&&(e.currentChoices+=1),o.discountOther&&void 0!==o.discountOperator&&void 0!==o.discountValue)if(o.isDisChoices){const e=new Set;if(void 0!==o.discountRows)for(let t=0;t<o.discountRows.length;t++){const i=Dt.get(o.discountRows[t]);if(void 0!==i)for(let t=0;t<i.objects.length;t++){const n=i.objects[t];Jo(o,n),e.add(n.id)}}if(void 0!==o.discountChoices)for(let t=0;t<o.discountChoices.length;t++)if(!e.has(o.discountChoices[t])){const e=Ft.get(o.discountChoices[t]);if(void 0!==e){const t=e.choice;Jo(o,t)}}}else if(void 0!==o.discountGroups)for(let t=0;t<o.discountGroups.length;t++){const e=Rt.get(o.discountGroups[t]);if(void 0!==e)for(let t=0;t<e.elements.length;t++){const i=Ft.get(e.elements[t]);if(void 0!==i){const e=i.choice;Jo(o,e)}}}let h=new Set;for(let t=0;t<o.scores.length;t++){const e=o.scores[t];if(Wo(e.requireds)&&!e.isActive){const t=Mt.get(e.id);if(void 0!==t){let o=e.value;if(e.useExpression&&e.setValue&&Xo(t,e),e.appliedDiscount&&void 0!==e.discountScore)o=e.discountScore;else if(e.discountIsOn&&void 0!==e.discountScore&&e.discountedFrom&&e.discountedFrom.length>0){let t=!1;for(let i=0;i<e.discountedFrom.length;i++){const n=Ft.get(e.discountedFrom[i]);if(void 0!==n){const i=n.choice;if(!i.useDiscountCount||void 0===i.discountCount){o=e.discountScore,e.appliedDiscount=!0,t=!0;break}{const n=i.isSelectableMultiple&&i.isMultipleUseVariable&&i.stackableDiscount?i.discountCount*i.multipleUseVariable:i.discountCount;if(i.appliedDisChoices||(i.appliedDisChoices=[]),n>i.appliedDisChoices.length){h.add(i),o=e.discountScore,e.appliedDiscount=!0,t=!0;break}}}}if(!t&&void 0!==e.tmpDiscount)for(let i=0;i<e.tmpDiscount.length;i++)o>e.tmpDiscount[i].discountedValue&&(o=e.tmpDiscount[i].discountedValue)}o=t.allowFloat?o:Math.floor(o),t.startingSum-=o,e.isActive=!0;let i=m.get(e.id);void 0!==i?m.set(e.id,o+i):m.set(e.id,o)}}}if(h.size>0&&h.forEach(e=>{e.appliedDisChoices&&-1===e.appliedDisChoices.indexOf(o.id)&&e.appliedDisChoices.push(o.id)}),o.duplicateRow&&void 0!==o.duplicateRowId&&void 0!==o.duplicateRowPlace&&fi(o),o.activateOtherChoice&&void 0!==o.activateThisChoice){const e=new Set(t.map(e=>e.split("/ON#")[0]));if(o.isActivateRandom&&void 0!==o.numActivateRandom)if(""===l){let t=o.activateThisChoice.split(",").filter(t=>e.has(t.split("/ON#")[0]));const i=o.numActivateRandom>t.length?t.length:o.numActivateRandom;let n=new Set;for(let e=0;e<t.length;e++){const o=Ft.get(t[e]);if(void 0!==o){if(!Wo(o.choice.requireds)){const o=t[e];t.splice(e,1),t.push(o)}}}for(let e=t.length-1;e>=0;e--)n.add(t[e]);t=[...n].reverse(),o.activatedRandom=t.slice(0,i);for(let e=0;e<i;e++){const t=o.activatedRandom[e].split("/ON#"),i=Ft.get(t[0]);if(void 0!==i){const e=i.choice;if(!o.isAllowDeselect){if(e.isSelectableMultiple&&e.isMultipleUseVariable){const o=parseInt(t[1]);for(let t=0;t<Math.abs(o);t++)o>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:o<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--}e.forcedActivated=!0}e.isSelectableMultiple||(void 0===e.activatedFrom&&(e.activatedFrom=0),e.activatedFrom+=1)}}}else{let t=l.filter(t=>e.has(t.split("/RON#")[0]));o.activatedRandom=t;for(let e=0;e<t.length;e++){const t=o.activatedRandom[e].split("/RON#"),i=Ft.get(t[0]);if(void 0!==i){const e=i.choice;if(!o.isAllowDeselect){if(e.isSelectableMultiple&&e.isMultipleUseVariable){const o=parseInt(t[1]);for(let t=0;t<Math.abs(o);t++)o>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:o<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--}e.forcedActivated=!0}e.isSelectableMultiple||(void 0===e.activatedFrom&&(e.activatedFrom=0),e.activatedFrom+=1)}}}else{const t=o.activateThisChoice.split(","),i=t.filter(t=>e.has(t.split("/ON#")[0])),n=t.filter(t=>!e.has(t.split("/ON#")[0]));for(let e=0;e<i.length;e++){const t=i[e].split("/ON#"),n=t.length>1?parseInt(t[1]):0,r=Ft.get(t[0]);if(void 0!==r){const e=r.choice;if(!o.isAllowDeselect){if(e.isSelectableMultiple&&e.isMultipleUseVariable)if(o.isSelectableMultiple&&o.isMultipleUseVariable)for(let t=0;t<Math.abs(o.multipleUseVariable);t++)for(let o=0;o<Math.abs(n);o++)n>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:n<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--;else for(let t=0;t<Math.abs(n);t++)n>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:n<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--;e.forcedActivated=!0}e.isSelectableMultiple||(void 0===e.activatedFrom&&(e.activatedFrom=0),e.activatedFrom+=1)}else{const e=Rt.get(t[0]);if(void 0!==e){const t=e.elements;for(let e=0;e<t.length;e++){const i=Ft.get(t[e]);if(void 0!==i){const e=i.choice;if(!o.isAllowDeselect){if(e.isSelectableMultiple&&e.isMultipleUseVariable)if(o.isSelectableMultiple&&o.isMultipleUseVariable)for(let t=0;t<Math.abs(o.multipleUseVariable);t++)for(let o=0;o<Math.abs(n);o++)n>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:n<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--;else for(let t=0;t<Math.abs(n);t++)n>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:n<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--;e.forcedActivated=!0}e.isSelectableMultiple||(void 0===e.activatedFrom&&(e.activatedFrom=0),e.activatedFrom+=1)}}}}}for(let e=0;e<n.length;e++){const t=n[e].split("/ON#"),i=t.length>1?parseInt(t[1]):0,r=Ft.get(t[0]);if(void 0!==r){const e=r.choice;Bt.set(e.id,{multiple:i,isAllowDeselect:o.isAllowDeselect||!1})}}}}if(o.multiplyPointtypeIsOn&&void 0!==o.pointTypeToMultiply&&void 0!==o.multiplyWithThis){let e=0;o.multiplyPointtypeIsOnCheck=!0,"object"!=typeof o.startingSumAtMultiply&&(o.startingSumAtMultiply=[]);for(let t=0;t<o.pointTypeToMultiply.length;t++){let i=Mt.get(o.pointTypeToMultiply[t]);if(void 0!==i)if(o.multiplyPointtypeIsId&&"string"==typeof o.multiplyWithThis){let n=Mt.get(o.multiplyWithThis);void 0!==n?(o.startingSumAtMultiply[t]={value:i.startingSum,calcVal:n.startingSum},i.startingSum*=n.startingSum,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)):e++}else"number"==typeof o.multiplyWithThis&&(o.startingSumAtMultiply[t]={value:i.startingSum,calcVal:o.multiplyWithThis},i.startingSum*=o.multiplyWithThis,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum));else e++}e===o.pointTypeToMultiply.length&&delete o.multiplyPointtypeIsOnCheck,o.multiplyPointtypeIsOnCheck&&Nt.push(o)}if(o.dividePointtypeIsOn&&void 0!==o.pointTypeToDivide&&void 0!==o.divideWithThis){let e=0;o.dividePointtypeIsOnCheck=!0,"object"!=typeof o.startingSumAtDivide&&(o.startingSumAtDivide=[]);for(let t=0;t<o.pointTypeToDivide.length;t++){let i=Mt.get(o.pointTypeToDivide[t]);void 0!==i?0===o.dividedWithThis?e++:(o.startingSumAtDivide[t]={value:i.startingSum,calcVal:o.divideWithThis},i.startingSum/=o.divideWithThis,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)):e++}e===o.pointTypeToDivide.length&&delete o.dividePointtypeIsOnCheck,!o.multiplyPointtypeIsOnCheck&&o.dividePointtypeIsOnCheck&&Nt.push(o)}if(o.setPointtypeIsOn&&void 0!==o.pointTypeToSet&&void 0!==o.setWithThis){let e=0;o.setPointtypeIsOnCheck=!0,"object"!=typeof o.startingSumAtSet&&(o.startingSumAtSet=[]);for(let t=0;t<o.pointTypeToSet.length;t++){let i=Mt.get(o.pointTypeToSet[t]);if(void 0!==i){let e=0;try{const t=o.setWithThis.replace(/\{([^{}]+)\}/g,(e,t)=>{const o=Mt.get(t);if(void 0!==o)return"".concat(o.startingSum);throw new Error('Undefined variable: "'.concat(t,'"'))});e=g(t),e=i.allowFloat?e:Math.floor(e)}catch(d){console.error(d)}o.startingSumAtSet[t]={value:i.startingSum,calcVal:e},i.startingSum=e}else e++}e===o.pointTypeToSet.length&&delete o.setPointtypeIsOnCheck,o.multiplyPointtypeIsOnCheck||o.dividePointtypeIsOnCheck||!o.setPointtypeIsOnCheck||Nt.push(o)}if(o.isChangeVariables&&void 0!==o.changedVariables)for(let t=0;t<o.changedVariables.length;t++){const e=Pt.get(o.changedVariables[t]);void 0!==e&&("1"===o.changeType?e.isTrue=!0:"2"===o.changeType?e.isTrue=!1:"3"===o.changeType&&(e.isTrue=!e.isTrue))}if(o.addToAllowChoice&&void 0!==o.idOfAllowChoice&&void 0!==o.numbAddToAllowChoice)for(let t=0;t<o.idOfAllowChoice.length;t++){const e=Dt.get(o.idOfAllowChoice[t]);void 0!==e&&(e.allowedChoices+=o.numbAddToAllowChoice)}if(o.textfieldIsOn&&void 0!==o.idOfTheTextfieldWord&&void 0!==o.wordChangeSelect){const e=qt.get(o.idOfTheTextfieldWord);void 0!==e&&(o.customTextfieldIsOn?e.replaceText=r:e.replaceText=o.wordChangeSelect)}if(o.isImageUpload&&(o.defaultImage=o.image,o.image=i),o.backpackBtnRequirement&&(void 0===app.btnBackpackIsOn&&(app.btnBackpackIsOn=0),app.btnBackpackIsOn+=1),o.showAllAddons&&(void 0===app.showAllAddons&&(app.showAllAddons=0),app.showAllAddons+=1),o.changeBackground&&(o.changeBgImage?void 0!==o.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage||""),app.bgImageStack.push({id:o.id,data:o.bgImage}),app.styling.backgroundImage=o.bgImage):void 0!==o.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor||""),app.bgColorStack.push({id:o.id,data:o.changedBgColorCode}),app.styling.backgroundColor=o.changedBgColorCode)),o.changePointBar&&(o.changeBarBgColorIsOn&&void 0!==o.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor||"#FFFFFFFF"),app.barBgColorStack.push({id:o.id,data:o.changedBarBgColor}),app.styling.barBackgroundColor=o.changedBarBgColor),o.changeBarIconColorIsOn&&void 0!==o.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor||"#0000008A"),app.barIconColorStack.push({id:o.id,data:o.changedBarIconColor}),app.styling.barIconColor=o.changedBarIconColor),o.changeBarTextColorIsOn&&void 0!==o.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor||"#000000"),app.barTextColorStack.push({id:o.id,data:o.changedBarTextColor}),app.styling.barTextColor=o.changedBarTextColor)),o.changeTemplates&&o.changeTemplatesList&&o.changeToThisTemplate){const e=o.changeTemplatesList.split(",");for(let t=0;t<e.length;t++){const i=e[t],n=Ft.get(i);if(void 0!==n){const e=n.choice;if(Ji(e,o.id,o.changeToThisTemplate),o.changeAddonTemplate)for(let t=0;t<e.addons.length;t++){Ji(e.addons[t],o.id,o.changeToThisTemplate)}continue}const r=Dt.get(i);if(void 0!==r){Ji(r,o.id,o.changeToThisTemplate);continue}const l=Rt.get(i);if(void 0!==l){const e=l.rowElements;for(let i=0;i<e.length;i++){const t=Dt.get(e[i]);void 0!==t&&Ji(t,o.id,o.changeToThisTemplate)}const t=l.elements;for(let i=0;i<t.length;i++){const e=Ft.get(t[i]);if(void 0!==e){const t=e.choice;if(Ji(t,o.id,o.changeToThisTemplate),o.changeAddonTemplate)for(let e=0;e<t.addons.length;e++){Ji(t.addons[e],o.id,o.changeToThisTemplate)}}}continue}}}if(o.changeWidth&&o.changeWidthList&&o.changeToThisWidth){const e=o.changeWidthList.split(",");for(let t=0;t<e.length;t++){const i=e[t],n=Ft.get(i);if(void 0!==n){Xi(n.choice,o.id,o.changeToThisWidth);continue}const r=Dt.get(i);if(void 0!==r){Xi(r,o.id,o.changeToThisWidth);continue}const l=Rt.get(i);if(void 0!==l){const e=l.rowElements;for(let i=0;i<e.length;i++){const t=Dt.get(e[i]);void 0!==t&&Xi(t,o.id,o.changeToThisWidth)}const t=l.elements;for(let i=0;i<t.length;i++){const e=Ft.get(t[i]);if(void 0!==e){Xi(e.choice,o.id,o.changeToThisWidth)}}continue}}}if(o.setBgmIsOn&&o.bgmId&&(Ht.bgmIsPlaying=!0,Ht.isBgmInit||o.useAudioURL?Eo(o,o.bgmId,0):(zo(o),Ht.isBgmInit=!0)),o.muteBgm&&Gt){const e=u(Gt);app.isMute=!0,e&&"function"==typeof e.mute&&e.mute()}if(o.isContentHidden&&void 0!==o.hiddenContentsRow&&void 0!==o.hiddenContentsType)for(let t=0;t<o.hiddenContentsRow.length;t++){const e=Dt.get(o.hiddenContentsRow[t]);if(void 0!==e){e.textIsRemoved||(e.textIsRemoved=!0);for(let t=0;t<o.hiddenContentsType.length;t++)switch(o.hiddenContentsType[t]){case"1":e.objectTitleRemoved=!0;break;case"2":e.objectImageRemoved=!0;break;case"3":e.objectTextRemoved=!0;break;case"4":e.objectScoreRemoved=!0;break;case"5":e.objectRequirementRemoved=!0;break;case"6":e.addonTitleRemoved=!0;break;case"7":e.addonImageRemoved=!0;break;case"8":e.addonTextRemoved=!0}}}gi(o,m,0)}}function mi(e,t){let o=e.split("/IMG#");const i=o.length>1?o[1].replace(/\/CHAR#/g,","):"";o=o[0].split("/WORD#");const r=o.length>1?o[1].replace(/\/CHAR#/g,","):"";o=o[0].split("/RND#");const l=o.length>1?o[1].split("/AND#"):"";o=o[0].split("/RS#");const a=o.length>1?o[1]:"",s=o[0].split("/ON#"),c=Ft.get(s[0]);if(void 0!==c){const e=c.choice,o=c.row,s=new Map,d=void 0===e.parentId;if(a){const e=a.split("/AND#");for(let t=0;t<e.length;t++){const o=e[t].split(":"),i=Number(o[0]),n=Number(o[1]);Number.isNaN(i)||s.set(i,Number.isNaN(n)?0:n)}}for(let t=0;t<e.scores.length;t++){const o=e.scores[t],i=Mt.get(o.id);void 0===i||o.setValue||(s.size>0&&s.has(t)?(o.value=s.get(t),o.setValue=!0):Qo(i,o))}const g=new n,p=e.isActive,m=e.multipleUseVariable>=0,h=Math.abs(e.multipleUseVariable);if(e.isActive||(e.isActive=!0,d&&(o.currentChoices+=1)),e.multipleUseVariable++,kt.set(e.id,{multiple:e.multipleUseVariable}),m&&e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue)if(e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let o=0;o<e.discountRows.length;o++){const i=Dt.get(e.discountRows[o]);if(void 0!==i)for(let o=0;o<i.objects.length;o++){const n=i.objects[o];Jo(e,n),t.add(n.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const t=Ft.get(e.discountChoices[o]);if(void 0!==t){const o=t.choice;Jo(e,o)}}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Rt.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=Ft.get(o.elements[t]);if(void 0!==i){const t=i.choice;Jo(e,t)}}}let v=new Set;for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(void 0===o.isActiveMul&&(o.isActiveMul=[]),Wo(o.requireds)&&!o.isActiveMul[h]){const e=Mt.get(o.id);if(void 0!==e){let t=o.value;if(o.useExpression&&o.setValue&&Xo(e,o),o.discountIsOn&&void 0!==o.discountScore&&o.discountedFrom&&o.discountedFrom.length>0){const e=Ft.get(o.discountedFrom[0]);if(void 0!==e){const i=e.choice;if(i.useDiscountCount&&void 0!==i.discountCount){if(i.appliedDisChoices||(i.appliedDisChoices=[]),i.discountCount>i.appliedDisChoices.length)v.add(i),t=o.discountScore,o.appliedDiscount=!0;else if(void 0!==o.tmpDiscount)for(let e=0;e<o.tmpDiscount.length;e++)t>o.tmpDiscount[e].discountedValue&&(t=o.tmpDiscount[e].discountedValue)}else t=o.discountScore,o.appliedDiscount=!0}}t=e.allowFloat?t:Math.floor(t),o.multiplyByTimes&&(t*=h+1),e.startingSum-=t,o.isActiveMul[h]=!0;let i=g.get(o.id);void 0!==i?g.set(o.id,t+i):g.set(o.id,t)}}}if(v.size>0&&v.forEach(t=>{t.appliedDisChoices&&-1===t.appliedDisChoices.indexOf(e.id)&&t.appliedDisChoices.push(e.id)}),m&&(e.duplicateRow&&void 0!==e.duplicateRowId&&void 0!==e.duplicateRowPlace&&fi(e),e.activateOtherChoice&&void 0!==e.activateThisChoice)){const o=new Set(t.map(e=>e.split("/ON#")[0]));if(e.isActivateRandom&&void 0!==e.numActivateRandom)if(void 0===e.activatedRandomMul&&(e.activatedRandomMul=[]),""===l){if(1===e.multipleUseVariable){let t=e.activateThisChoice.split(",").filter(e=>o.has(e.split("/ON#")[0]));e.numActivateRandom>t.length?t.length:e.numActivateRandom;let i=new Set;for(let e=0;e<t.length;e++){const o=Ft.get(t[e]);if(void 0!==o){if(!Wo(o.choice.requireds)){const o=t[e];t.splice(e,1),t.push(o)}}}for(let e=t.length-1;e>=0;e--)i.add(t[e]);t=[...i].reverse();let n=0,r=[];for(let o=0;o<e.numActivateRandom;o++){r[o]=t.length/(e.numActivateRandom*(o+1))<1?t.length%(e.numActivateRandom*(o+1)):e.numActivateRandom,e.activatedRandomMul.push(t.slice(n,r[o]+n));for(let t=0;t<r[o]-n;t++){const i=e.activatedRandomMul[o][t].split("/ON#"),n=i.length>1?parseInt(i[1]):0,r=Ft.get(i[0]);if(void 0!==r){const t=r.choice;if(!e.isAllowDeselect){if(t.isSelectableMultiple&&t.isMultipleUseVariable)for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;t.forcedActivated=!0}}}n+=r[o]}}}else{const t=(e.multipleUseVariable-1)*e.numActivateRandom,i=l.splice(t,t+e.numActivateRandom);e.activatedRandomMul.push(i);for(let n=0;n<e.activatedRandomMul[e.multipleUseVariable-1].length;n++){const t=e.activatedRandomMul[e.multipleUseVariable-1][n].split("/RON#"),i=t.length>1?parseInt(t[1]):0,r=Ft.get(t[0]);if(void 0!==r){const t=r.choice;if(!e.isAllowDeselect&&o.has(t.id)){if(t.isSelectableMultiple&&t.isMultipleUseVariable)for(let e=0;e<Math.abs(i);e++)i>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:i<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;t.forcedActivated=!0}}}}else{const t=e.activateThisChoice.split(","),i=t.filter(e=>o.has(e.split("/ON#")[0])),n=t.filter(e=>!o.has(e.split("/ON#")[0]));for(let o=0;o<i.length;o++){const t=i[o].split("/ON#"),n=t.length>1?parseInt(t[1]):0,r=Ft.get(t[0]);if(void 0!==r){const t=r.choice;if(!e.isAllowDeselect){if(t.isSelectableMultiple&&t.isMultipleUseVariable)if(e.isSelectableMultiple&&e.isMultipleUseVariable)for(let o=0;o<Math.abs(e.multipleUseVariable);o++)for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;else for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;t.forcedActivated=!0}}else{const o=Rt.get(t[0]);if(void 0!==o){const t=o.elements;for(let o=0;o<t.length;o++){const i=Ft.get(t[o]);if(void 0!==i){const t=i.choice;if(!e.isAllowDeselect){if(t.isSelectableMultiple&&t.isMultipleUseVariable)if(e.isSelectableMultiple&&e.isMultipleUseVariable)for(let o=0;o<Math.abs(e.multipleUseVariable);o++)for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;else for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;t.forcedActivated=!0}}}}}}for(let o=0;o<n.length;o++){const t=n[o].split("/ON#"),i=t.length>1?parseInt(t[1]):0,r=Ft.get(t[0]);if(void 0!==r){const t=r.choice;Bt.set(t.id,{multiple:i,isAllowDeselect:e.isAllowDeselect||!1})}}}}if(e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const o=Dt.get(e.idOfAllowChoice[t]);void 0!==o&&(o.allowedChoices+=e.numbAddToAllowChoice)}if(!p){if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Pt.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!0:"2"===e.changeType?o.isTrue=!1:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.textfieldIsOn&&void 0!==e.idOfTheTextfieldWord&&void 0!==e.wordChangeSelect){const t=qt.get(e.idOfTheTextfieldWord);void 0!==t&&(e.customTextfieldIsOn?t.replaceText=r:t.replaceText=e.wordChangeSelect)}if(e.isImageUpload&&(e.defaultImage=e.image,e.image=i),e.backpackBtnRequirement&&(app.btnBackpackIsOn+=1),e.showAllAddons&&(app.showAllAddons+=1),e.changeBackground&&(e.changeBgImage?void 0!==e.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage||""),app.bgImageStack.push({id:e.id,data:e.bgImage}),app.styling.backgroundImage=e.bgImage):void 0!==e.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor||""),app.bgColorStack.push({id:e.id,data:e.changedBgColorCode}),app.styling.backgroundColor=e.changedBgColorCode)),e.changePointBar&&(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor||"#FFFFFFFF"),app.barBgColorStack.push({id:e.id,data:e.changedBarBgColor}),app.styling.barBackgroundColor=e.changedBarBgColor),e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor||"#0000008A"),app.barIconColorStack.push({id:e.id,data:e.changedBarIconColor}),app.styling.barIconColor=e.changedBarIconColor),e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor||"#000000"),app.barTextColorStack.push({id:e.id,data:e.changedBarTextColor}),app.styling.barTextColor=e.changedBarTextColor)),e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=Ft.get(i);if(void 0!==n){const t=n.choice;if(Ji(t,e.id,e.changeToThisTemplate),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){Ji(t.addons[o],e.id,e.changeToThisTemplate)}continue}const r=Dt.get(i);if(void 0!==r){Ji(r,e.id,e.changeToThisTemplate);continue}const l=Rt.get(i);if(void 0!==l){const t=l.rowElements;for(let i=0;i<t.length;i++){const o=Dt.get(t[i]);void 0!==o&&Ji(o,e.id,e.changeToThisTemplate)}const o=l.elements;for(let i=0;i<o.length;i++){const t=Ft.get(o[i]);if(void 0!==t){const o=t.choice;if(Ji(o,e.id,e.changeToThisTemplate),e.changeAddonTemplate)for(let t=0;t<o.addons.length;t++){Ji(o.addons[t],e.id,e.changeToThisTemplate)}}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=Ft.get(i);if(void 0!==n){Xi(n.choice,e.id,e.changeToThisWidth);continue}const r=Dt.get(i);if(void 0!==r){Xi(r,e.id,e.changeToThisWidth);continue}const l=Rt.get(i);if(void 0!==l){const t=l.rowElements;for(let i=0;i<t.length;i++){const o=Dt.get(t[i]);void 0!==o&&Xi(o,e.id,e.changeToThisWidth)}const o=l.elements;for(let i=0;i<o.length;i++){const t=Ft.get(o[i]);if(void 0!==t){Xi(t.choice,e.id,e.changeToThisWidth)}}continue}}}if(e.setBgmIsOn&&e.bgmId&&(Ht.bgmIsPlaying=!0,Ht.isBgmInit||e.useAudioURL?Eo(e,e.bgmId,0):(zo(e),Ht.isBgmInit=!0)),e.muteBgm&&Gt){const e=u(Gt);app.isMute=!0,e&&"function"==typeof e.mute&&e.mute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=Dt.get(e.hiddenContentsRow[t]);if(void 0!==o){o.textIsRemoved||(o.textIsRemoved=!0);for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":o.objectTitleRemoved=!0;break;case"2":o.objectImageRemoved=!0;break;case"3":o.objectTextRemoved=!0;break;case"4":o.objectScoreRemoved=!0;break;case"5":o.objectRequirementRemoved=!0;break;case"6":o.addonTitleRemoved=!0;break;case"7":o.addonImageRemoved=!0;break;case"8":o.addonTextRemoved=!0}}}}gi(e,g,0)}}function hi(e,t){const o=new n,i=Math.abs(e.multipleUseVariable-1);for(let n=0;n<e.scores.length;n++){const t=e.scores[n];if(void 0===t.isActiveMulMinus&&(t.isActiveMulMinus=[]),Wo(t.requireds)&&!t.isActiveMulMinus[i]){const e=Mt.get(t.id);if(void 0!==e){let n=t.discountIsOn&&void 0!==t.discountScore?t.discountScore:t.value;n=e.allowFloat?n:Math.floor(n),t.multiplyByTimes&&(n*=Math.abs(i)),e.startingSum+=n;let r=o.get(t.id);void 0!==r?o.set(t.id,-n+r):o.set(t.id,-n),t.isActiveMulMinus[i]=!0}}}if(e.multipleUseVariable-=1,0===e.multipleUseVariable?(e.isActive=!1,t.currentChoices-=1,kt.delete(e.id)):(-1===e.multipleUseVariable&&(e.isActive=!0,t.currentChoices+=1),kt.set(e.id,{multiple:e.multipleUseVariable})),e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let n=0;n<e.idOfAllowChoice.length;n++){const t=Dt.get(e.idOfAllowChoice[n]);void 0!==t&&(t.allowedChoices-=e.numbAddToAllowChoice)}gi(e,o,0)}function vi(e){ei();const t=e.split(",");for(let o=0;o<t.length;o++){const e=t[o].split("/RP#");if(e.length>1){const t=e[1].split("/NUM#"),o=t.length>1?parseInt(t[1]):0,i=Mt.get(t[0]);void 0!==i&&(i.startingSum+=o),kt.set(e[0],{multiple:0,isRowButton:!0,rndPoint:t[0],pointNum:o})}else{const e=t[o].split(/\/(IMG|WORD|RND|RS)#/)[0].split("/ON#"),i=e.length>1?parseInt(e[1]):0,n=Ft.get(e[0]);if(void 0!==n){const e=n.choice;if(e.isSelectableMultiple&&e.isMultipleUseVariable)for(let r=0;r<Math.abs(i);r++)i>0?mi(t[o],t):hi(e,n.row);else pi(t[o],t)}else{const t=Pt.get(e[0]);void 0!==t&&(t.isTrue=!0,kt.set(t.id,{multiple:0,isVariable:!0}))}}}}function fi(e,t){if(void 0!==e.duplicateRowId&&void 0!==e.duplicateRowPlace){const t=e.duplicateRowId;let o=0;Array.from(Dt.entries()).forEach(([e])=>{e.split("/D#")[0]===t.split("/D#")[0]&&o++});const i=Dt.get(e.duplicateRowId),n=Dt.get(e.duplicateRowPlace),r="/D#".concat(o);if(void 0!==i&&void 0!==n){const t=JSON.parse(JSON.stringify(i));if(t.id="".concat(t.id.split("/D#")[0]).concat(r),n.isBackpack){app.backpack.splice(n.index+1,0,t),Dt.set(t.id,app.backpack[n.index+1]);for(let e=n.index+1;e<app.backpack.length;e++)app.backpack[e].index=e}else{app.rows.splice(n.index+1,0,t),Dt.set(t.id,app.rows[n.index+1]);for(let e=n.index+1;e<app.rows.length;e++)app.rows[e].index=e}for(let o=0;o<t.objects.length;o++){const i=t.objects[o];i.id="".concat(i.id.split("/D#")[0]).concat(r),i.isActive=!1,delete i.forcedActivated,delete i.appliedDisChoices;for(let e=0;e<i.scores.length;e++){const t=i.scores[e];t.idx=Ao(0,5),Wt.add(t.idx),i.isSelectableMultiple?(delete t.isActiveMul,delete t.isActiveMulMinus):delete t.isActive,delete t.setValue,_o(t)}for(let e=0;e<i.addons.length;e++){i.addons[e].parentId=i.id}if(!e.dRowAddSufReq){for(let e=0;e<i.requireds.length;e++){const t=i.requireds[e];if("id"===t.type){const e=t.reqId.split("/ON#"),o="".concat(e[0].split("/D#")[0]).concat(r);e.length>1?t.reqId="".concat(o,"/ON#").concat(e[1]):t.reqId=o}else if("or"===t.type)for(let e=0;e<t.orRequired.length;e++){const o=t.orRequired[e];if(void 0!==o.req){const e=o.req.split("/ON#"),t="".concat(e[0].split("/D#")[0]).concat(r);e.length>1?o.req="".concat(t,"/ON#").concat(e[1]):o.req=t}}if(void 0!==t.requireds)for(let o=0;o<t.requireds.length;o++){const t=i.requireds[e];if("id"===t.type){const e=t.reqId.split("/ON#"),o="".concat(e[0].split("/D#")[0]).concat(r);e.length>1?t.reqId="".concat(o,"/ON#").concat(e[1]):t.reqId=o}else if("or"===t.type)for(let e=0;e<t.orRequired.length;e++){const o=t.orRequired[e];if(void 0!==o.req){const e=o.req.split("/ON#"),t="".concat(e[0].split("/D#")[0]).concat(r);e.length>1?o.req="".concat(t,"/ON#").concat(e[1]):o.req=t}}}}for(let e=0;e<i.scores.length;e++){const t=i.scores[e];if(void 0!==t.requireds)for(let e=0;e<t.requireds.length;e++){const o=t.requireds[e];if("id"===o.type){const e=o.reqId.split("/ON#"),t="".concat(e[0].split("/D#")[0]).concat(r);e.length>1?o.reqId="".concat(t,"/ON#").concat(e[1]):o.reqId=t}else if("or"===o.type)for(let e=0;e<o.orRequired.length;e++){const t=o.orRequired[e];if(void 0!==t.req){const e=t.req.split("/ON#"),o="".concat(e[0].split("/D#")[0]).concat(r);e.length>1?t.req="".concat(o,"/ON#").concat(e[1]):t.req=o}}}}for(let e=0;e<i.addons.length;e++){const t=i.addons[e];if(void 0!==t.requireds)for(let e=0;e<t.requireds.length;e++){const o=t.requireds[e];if("id"===o.type){const e=o.reqId.split("/ON#"),t="".concat(e[0].split("/D#")[0]).concat(r);e.length>1?o.reqId="".concat(t,"/ON#").concat(e[1]):o.reqId=t}else if("or"===o.type)for(let e=0;e<o.orRequired.length;e++){const t=o.orRequired[e];if(void 0!==t.req){const e=t.req.split("/ON#"),o="".concat(e[0].split("/D#")[0]).concat(r);e.length>1?t.req="".concat(o,"/ON#").concat(e[1]):t.req=o}}}}}if(!e.dRowAddSufFunc){if(i.activateOtherChoice&&void 0!==i.activateThisChoice){const e=i.activateThisChoice.split(",");let t="";for(let o=0;o<e.length;o++){const i=e[o].split("/ON#"),n="".concat(i[0].split("/D#")[0]).concat(r);i.length>1?t+="".concat(n,"/ON#").concat(i[1],","):t+="".concat(n,",")}i.activateThisChoice=t}if(i.deactivateOtherChoice&&void 0!==i.deactivateThisChoice){const e=i.deactivateThisChoice.split(",");let t="";for(let o=0;o<e.length;o++){const i=e[o].split("/ON#"),n="".concat(i[0].split("/D#")[0]).concat(r);i.length>1?t+="".concat(n,"/ON#").concat(i[1],","):t+="".concat(n,",")}i.deactivateThisChoice=t}if(i.duplicateRow&&void 0!==i.duplicateRowId&&void 0!==i.duplicateRowPlace){const e=i.duplicateRowId,t=i.duplicateRowPlace;i.duplicateRowId="".concat(e.split("/D")[0]).concat(r),i.duplicateRowPlace="".concat(t.split("/D")[0]).concat(r)}}if(i.backpackBtnRequirement&&(void 0!==app.hideBackpackBtn?app.hideBackpackBtn+=1:delete i.backpackBtnRequirement),n.isBackpack?Ft.set(i.id,{choice:app.backpack[n.index+1].objects[o],row:app.backpack[n.index+1]}):Ft.set(i.id,{choice:app.rows[n.index+1].objects[o],row:app.rows[n.index+1]}),i.groups)for(let e=0;e<i.groups.length;e++){let t=Rt.get(i.groups[e]);if(void 0!==t){-1===t.elements.indexOf(i.id)&&t.elements.push(i.id)}}if(i.objectDesignGroups)for(let e=0;e<i.objectDesignGroups.length;e++){let t=Vt.get(i.objectDesignGroups[e]);if(void 0!==t){-1===t.elements.indexOf(i.id)&&t.elements.push(i.id)}}}}}}function bi(e){return/^data:[a-zA-Z]+\/[a-zA-Z]+;base64,/.test(e)}function wi(e){const t=e.match(/^data:(image\/[a-zA-Z0-9.+-]+);base64,/);if(!t)return!1;return"image/avif"===t[1].toLowerCase()}const Ti=l({selFilterBlur:a.number().optional(),selFilterBright:a.number().optional(),selFilterCont:a.number().optional(),selFilterGray:a.number().optional(),selFilterHue:a.number().optional(),selFilterInvert:a.number().optional(),selFilterOpac:a.number().optional(),selFilterSatur:a.number().optional(),selFilterSepia:a.number().optional(),reqFilterBlur:a.number().optional(),reqFilterBright:a.number().optional(),reqFilterCont:a.number().optional(),reqFilterGray:a.number().optional(),reqFilterHue:a.number().optional(),reqFilterInvert:a.number().optional(),reqFilterOpac:a.number().optional(),reqFilterSatur:a.number().optional(),reqFilterSepia:a.number().optional(),unselFilterBlur:a.number().optional(),unselFilterBright:a.number().optional(),unselFilterCont:a.number().optional(),unselFilterGray:a.number().optional(),unselFilterHue:a.number().optional(),unselFilterInvert:a.number().optional(),unselFilterOpac:a.number().optional(),unselFilterSatur:a.number().optional(),unselFilterSepia:a.number().optional()}).passthrough(),Ii=l({rowTitleTextSize:a.number().optional(),rowTextTextSize:a.number().optional(),objectTitleTextSize:a.number().optional(),objectTextTextSize:a.number().optional(),addonTitleTextSize:a.number().optional(),addonTextTextSize:a.number().optional(),scoreTextSize:a.number().optional()}).passthrough(),Si=l({objectImgBorderWidth:a.number().optional(),objectImageWidth:a.number().optional(),objectImageMarginTop:a.number().optional(),objectImageMarginBottom:a.number().optional(),objectImgBorderRadiusTopLeft:a.number().optional(),objectImgBorderRadiusTopRight:a.number().optional(),objectImgBorderRadiusBottomRight:a.number().optional(),objectImgBorderRadiusBottomLeft:a.number().optional(),objectImageBoxWidth:a.number().optional()}).passthrough(),yi=l({rowImgBorderWidth:a.number().optional(),rowImageWidth:a.number().optional(),rowImageMarginTop:a.number().optional(),rowImageMarginBottom:a.number().optional(),rowImgBorderRadiusTopLeft:a.number().optional(),rowImgBorderRadiusTopRight:a.number().optional(),rowImgBorderRadiusBottomRight:a.number().optional(),rowImgBorderRadiusBottomLeft:a.number().optional(),rowImageBoxWidth:a.number().optional()}).passthrough(),Ci=l({addonImgBorderWidth:a.number().optional(),addonImageWidth:a.number().optional(),addonImageMarginTop:a.number().optional(),addonImageMarginBottom:a.number().optional(),addonImgBorderRadiusTopLeft:a.number().optional(),addonImgBorderRadiusTopRight:a.number().optional(),addonImgBorderRadiusBottomRight:a.number().optional(),addonImgBorderRadiusBottomLeft:a.number().optional(),addonImageBoxWidth:a.number().optional()}).passthrough(),xi=l({objectMargin:a.number().optional(),objectTextPadding:a.number().optional(),objectBorderWidth:a.number().optional(),objectDropShadowH:a.number().optional(),objectDropShadowV:a.number().optional(),objectDropShadowBlur:a.number().optional(),objectDropShadowSpread:a.number().optional(),objectBorderRadiusTopLeft:a.number().optional(),objectBorderRadiusTopRight:a.number().optional(),objectBorderRadiusBottomRight:a.number().optional(),objectBorderRadiusBottomLeft:a.number().optional(),objectBorderImageWidth:a.number().optional(),objectBorderImageSliceTop:a.number().optional(),objectBorderImageSliceBottom:a.number().optional(),objectBorderImageSliceLeft:a.number().optional(),objectBorderImageSliceRight:a.number().optional()}).passthrough(),Oi=l({rowMargin:a.number().optional(),rowBodyMarginSides:a.number().optional(),rowBodyMarginTop:a.number().optional(),rowBodyMarginBottom:a.number().optional(),rowTextPaddingY:a.number().optional(),rowTextPaddingX:a.number().optional(),rowDropShadowH:a.number().optional(),rowDropShadowV:a.number().optional(),rowDropShadowBlur:a.number().optional(),rowDropShadowSpread:a.number().optional(),rowButtonXPadding:a.number().optional(),rowButtonYPadding:a.number().optional(),rowBorderRadiusTopLeft:a.number().optional(),rowBorderRadiusTopRight:a.number().optional(),rowBorderRadiusBottomRight:a.number().optional(),rowBorderRadiusBottomLeft:a.number().optional(),rowBorderWidth:a.number().optional(),rowBorderImageWidth:a.number().optional(),rowBorderImageSliceTop:a.number().optional(),rowBorderImageSliceBottom:a.number().optional(),rowBorderImageSliceLeft:a.number().optional(),rowBorderImageSliceRight:a.number().optional()}).passthrough(),Ai=l({addonMargin:a.number().optional(),addonTextPadding:a.number().optional(),addonBorderWidth:a.number().optional(),addonDropShadowH:a.number().optional(),addonDropShadowV:a.number().optional(),addonDropShadowBlur:a.number().optional(),addonDropShadowSpread:a.number().optional(),addonBorderRadiusTopLeft:a.number().optional(),addonBorderRadiusTopRight:a.number().optional(),addonBorderRadiusBottomRight:a.number().optional(),addonBorderRadiusBottomLeft:a.number().optional(),addonBorderImageWidth:a.number().optional(),addonBorderImageSliceTop:a.number().optional(),addonBorderImageSliceBottom:a.number().optional(),addonBorderImageSliceLeft:a.number().optional(),addonBorderImageSliceRight:a.number().optional()}).passthrough(),ki=l({multiChoiceCounterPosition:a.number().optional(),multiChoiceCounterSize:a.number().optional(),multiChoiceTextSize:a.number().optional()}).passthrough(),Bi=l({barTextPadding:a.number().optional(),barTextMargin:a.number().optional(),barPadding:a.number().optional(),barMargin:a.number().optional(),barTextSize:a.number().optional()}).passthrough(),Mi=l({backPackWidth:a.number().optional()}).passthrough(),Di=s(e=>""===e?{}:e,Ti.merge(Ii).merge(Si).merge(yi).merge(Ci).merge(xi).merge(Oi).merge(Ai).merge(ki).merge(Bi).merge(Mi).passthrough()),Fi=l({template:a.number().optional()}).passthrough(),Ri=l({value:a.number().optional(),minValue:a.number().optional(),maxValue:a.number().optional(),discountScore:a.number().optional(),discountScoreCal:a.number().optional(),tmpDisScore:a.number().optional()}).passthrough(),ji=l({index:a.number().optional(),template:a.number().optional(),multipleUseVariable:a.number().optional(),initMultipleTimesMinus:a.number().optional(),selectedThisManyTimesProp:a.number().optional(),addons:c(Fi).optional(),scores:c(Ri).optional(),styling:Di.optional(),numMultipleTimesMinus:a.number().optional(),numMultipleTimesPluss:a.number().optional(),numActivateRandom:a.number().optional(),discountLowLimit:a.number().optional(),discountValue:a.number().optional(),numbAddToAllowChoice:a.number().optional(),bgmFadeInSec:a.number().optional(),bgmFadeOutSec:a.number().optional(),fadeTransitionTime:a.number().optional(),divideWithThis:a.number().optional(),activatedFrom:a.number().optional()}).passthrough(),qi=l({index:a.number().optional(),template:a.number().optional(),buttonRandomNumber:a.number().optional(),defaultAspectWidth:a.number().optional(),defaultAspectHeight:a.number().optional(),allowedChoices:a.number().optional(),currentChoices:a.number().optional(),objects:c(ji).optional(),styling:Di.optional(),objectImgObjectFillHeight:a.number().optional(),randomMin:a.number().optional(),randomMax:a.number().optional()}).passthrough(),Pi=l({startingSum:a.number().optional(),initValue:a.number().optional(),iconWidth:a.number().optional(),iconHeight:a.number().optional(),negativeIconWidth:a.number().optional(),negativeIconHeight:a.number().optional()}).passthrough(),$i=l({styling:Di.optional()}).passthrough(),Vi=l({styling:Di.optional()}).passthrough(),Wi=l({curVolume:a.number().optional(),fadeTransitionTime:a.number().optional(),hideBackpackBtn:a.number().optional(),btnBackpackIsOn:a.number().optional(),rowIdLength:a.number().optional(),objectIdLength:a.number().optional(),rowDesignGroups:c($i).optional(),objectDesignGroups:c(Vi).optional(),rows:c(qi).optional(),pointTypes:c(Pi).optional(),backpack:c(qi).optional(),styling:Di.optional()}).passthrough(),Ni=["autoSaveInterval","bgmFadeInterval","bgmFadeTimer","bgmIsPlaying","bgmObjectId","bgmPlayInterval","bgmTitle","bgmTitleInterval","cancelForcedActivated","comp","compG","compODG","compR","compRDG","curBgmTime","curBgmLength","isSeeking","isFadingOut","lastFadeTime","objectMap","pointTypeMap","wordMap"];function Ui(e){if(Array.isArray(e))return e.map(Ui).filter(e=>null!==e&&!("object"==typeof e&&0===Object.keys(e).length));if(e&&"object"==typeof e){const t={},o=Object.keys(e);for(let i=0;i<o.length;i++){const n=o[i],r=Ui(e[n]);null!==r&&(t[n]=r)}return Object.keys(t).length>0?t:null}return e}function Li(e){e.isPrivateStyling&&e.privateFilterIsOn&&void 0!==e.styling&&(void 0===e.styling.unselFilterBlurIsOn&&(e.styling.unselFilterBlurIsOn=!1),void 0===e.styling.unselFilterBlur&&(e.styling.unselFilterBlur=0),void 0===e.styling.unselFilterBrightIsOn&&(e.styling.unselFilterBrightIsOn=!1),void 0===e.styling.unselFilterBright&&(e.styling.unselFilterBright=100),void 0===e.styling.unselFilterCont&&(e.styling.unselFilterCont=100),void 0===e.styling.unselFilterGrayIsOn&&(e.styling.unselFilterGrayIsOn=!1),void 0===e.styling.unselFilterGray&&(e.styling.unselFilterGray=0),void 0===e.styling.unselFilterHueIsOn&&(e.styling.unselFilterHueIsOn=!1),void 0===e.styling.unselFilterHue&&(e.styling.unselFilterHue=0),void 0===e.styling.unselFilterInvertIsOn&&(e.styling.unselFilterInvertIsOn=!1),void 0===e.styling.unselFilterInvert&&(e.styling.unselFilterInvert=0),void 0===e.styling.unselFilterOpacIsOn&&(e.styling.unselFilterOpacIsOn=!1),void 0===e.styling.unselFilterOpac&&(e.styling.unselFilterOpac=100),void 0===e.styling.unselFilterSaturIsOn&&(e.styling.unselFilterSaturIsOn=!1),void 0===e.styling.unselFilterSatur&&(e.styling.unselFilterSatur=0),void 0===e.styling.unselFilterSepiaIsOn&&(e.styling.unselFilterSepiaIsOn=!1),void 0===e.styling.unselFilterSepia&&(e.styling.unselFilterSepia=0))}function Ei(e,t){if(e.isPrivateStyling&&void 0===e.privateFilterIsOn&&void 0!==e.styling){const t=Object.keys(ht);for(let o=0;o<t.length;o++){const i=t[o];if(e.styling.hasOwnProperty(i)){e.privateFilterIsOn=!0;break}e.privateFilterIsOn=!1}}if(e.isPrivateStyling&&void 0===e.privateTextIsOn&&void 0!==e.styling){const t=Object.keys(vt);for(let o=0;o<t.length;o++){const i=t[o];if(e.styling.hasOwnProperty(i)){e.privateTextIsOn=!0;break}e.privateTextIsOn=!1}}if(e.isPrivateStyling&&void 0===e.privateObjectImageIsOn&&void 0!==e.styling){const t=Object.keys(ft);for(let o=0;o<t.length;o++){const i=t[o];if(e.styling.hasOwnProperty(i)){e.privateObjectImageIsOn=!0;break}e.privateObjectImageIsOn=!1}}if(e.isPrivateStyling&&void 0===e.privateObjectIsOn&&void 0!==e.styling){const t=Object.keys(It);for(let o=0;o<t.length;o++){const i=t[o];if(e.styling.hasOwnProperty(i)){e.privateObjectIsOn=!0;break}e.privateObjectIsOn=!1}}if(e.isPrivateStyling&&void 0===e.privateAddonImageIsOn&&void 0!==e.styling){const t=Object.keys(wt);for(let o=0;o<t.length;o++){const i=t[o];if(e.styling.hasOwnProperty(i)){e.privateAddonImageIsOn=!0;break}e.privateAddonImageIsOn=!1}}if(e.isPrivateStyling&&void 0===e.privateAddonIsOn&&void 0!==e.styling){const t=Object.keys(yt);for(let o=0;o<t.length;o++){const i=t[o];if(e.styling.hasOwnProperty(i)){e.privateAddonIsOn=!0;break}e.privateAddonIsOn=!1}}if(e.isPrivateStyling&&void 0===e.privateBackgroundIsOn&&void 0!==e.styling){const t=Object.keys(Tt);for(let o=0;o<t.length;o++){const i=t[o];if(e.styling.hasOwnProperty(i)){e.privateBackgroundIsOn=!0;break}e.privateBackgroundIsOn=!1}}if(t){if(e.isPrivateStyling&&void 0===e.privateRowImageIsOn&&void 0!==e.styling){const t=Object.keys(bt);for(let o=0;o<t.length;o++){const i=t[o];if(e.styling.hasOwnProperty(i)){e.privateRowImageIsOn=!0;break}e.privateRowImageIsOn=!1}}if(e.isPrivateStyling&&void 0===e.privateRowIsOn&&void 0!==e.styling){const t=Object.keys(St);for(let o=0;o<t.length;o++){const i=t[o];if(e.styling.hasOwnProperty(i)){e.privateRowIsOn=!0;break}e.privateRowIsOn=!1}}}Li(e),e.isPrivateStyling||void 0===e.styling||(void 0!==e.styling.objectImgObjectFillHeight&&(e.objectImgObjectFillHeight=e.styling.objectImgObjectFillHeight),delete e.styling),e.isPrivateStyling&&e.privateAddonIsOn&&!e.styling.useAddonDesign&&(e.styling.useAddonDesign=!0),e.isPrivateStyling&&e.privateAddonImageIsOn&&!e.styling.useAddonImage&&(e.styling.useAddonImage=!0)}function zi(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const o=t[n];if(-1!==Ni.indexOf(o))delete e[o];else if(Array.isArray(e[o])){if("rows"===o||"backpack"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];if(i.index=t,"backpack"===o&&(i.isBackpack=!0),Ei(i,!0),void 0!==i.styling&&Go(i.styling,void 0===e.version||"2.0.0-beta"===e.version),void 0!==i.rowDesignGroups)for(let e=0;e<i.rowDesignGroups.length;e++)"object"==typeof i.rowDesignGroups[e]&&(i.rowDesignGroups[e]=i.rowDesignGroups[e].id);if("string"==typeof i.width&&(i.width=!1),"boolean"==typeof i.defaultWidth&&delete i.defaultWidth,i.image,bi(i.image)?oo.value||(oo.value=wi(i.image)):to.add(i.image),void 0!==i.requireds)for(let e=0;e<i.requireds.length;e++){const t=i.requireds[e];if("or"===t.type&&t.orRequired&&void 0===t.orRequireds){t.orRequireds=[];for(let e=0;e<t.orRequired.length;e++)t.orRequireds.push({required:!0,requireds:[],orRequired:[],orRequireds:[],id:"",type:"id",reqId:t.orRequired[e].req||"",reqId1:"",reqId2:"",reqId3:"",reqPoints:0,showRequired:t.showRequired,operator:t.operator,afterText:t.afterText,beforeText:t.beforeText,orNum:t.orNum,selNum:t.selNum,selFromOperators:"1",more:[]})}if(void 0!==t.requireds)for(let e=0;e<t.requireds.length;e++){const o=t.requireds[e];if("or"===o.type&&o.orRequired&&void 0===o.orRequireds){o.orRequireds=[];for(let e=0;e<o.orRequired.length;e++)o.orRequireds.push({required:!0,requireds:[],orRequired:[],orRequireds:[],id:"",type:"id",reqId:o.orRequired[e].req||"",reqId1:"",reqId2:"",reqId3:"",reqPoints:0,showRequired:o.showRequired,operator:o.operator,afterText:o.afterText,beforeText:o.beforeText,orNum:o.orNum,selNum:o.selNum,selFromOperators:"1",more:[]})}}}if(void 0!==i.objects)for(let t=0;t<i.objects.length;t++){const o=i.objects[t];if(o.index=t,Ei(o,!1),void 0!==o.styling&&Go(o.styling,void 0===e.version||"2.0.0-beta"===e.version),o.multiplyPointtypeIsOn&&("string"==typeof o.pointTypeToMultiply&&(o.pointTypeToMultiply=[o.pointTypeToMultiply]),"number"==typeof o.startingSumAtMultiply&&(o.startingSumAtMultiply=[o.startingSumAtMultiply])),o.dividePointtypeIsOn&&("string"==typeof o.pointTypeToDivide&&(o.pointTypeToDivide=[o.pointTypeToDivide]),"number"==typeof o.startingSumAtDivide&&(o.startingSumAtDivide=[o.startingSumAtDivide])),o.fadeTransitionIsOn&&void 0!==o.fadeTransitionTime&&(o.fadeInTransitionTime=o.fadeTransitionTime,o.fadeOutTransitionTime=o.fadeTransitionTime,delete o.fadeTransitionTime),o.addToAllowChoice&&"string"==typeof o.idOfAllowChoice&&(o.idOfAllowChoice=[o.idOfAllowChoice]),void 0!==o.groups)for(let e=0;e<o.groups.length;e++)"object"==typeof o.groups[e]&&(o.groups[e]=o.groups[e].id);if(void 0!==o.objectDesignGroups)for(let e=0;e<o.objectDesignGroups.length;e++)"object"==typeof o.objectDesignGroups[e]&&(o.objectDesignGroups[e]=o.objectDesignGroups[e].id);if(o.isSelectableMultiple&&void 0!==o.numMultipleTimesMinus&&void 0===o.initMultipleTimesMinus&&(o.initMultipleTimesMinus=o.forcedActivated?0:o.numMultipleTimesMinus),"string"==typeof o.width&&delete o.width,"boolean"==typeof o.defaultWidth&&delete o.defaultWidth,o.image,bi(o.image)?oo.value||(oo.value=wi(o.image)):to.add(o.image),void 0!==o.scores)for(let e=0;e<o.scores.length;e++){const t=o.scores[e];if(void 0!==t.requireds)for(let e=0;e<t.requireds.length;e++){const o=t.requireds[e];if("or"===o.type&&o.orRequired&&void 0===o.orRequireds){o.orRequireds=[];for(let e=0;e<o.orRequired.length;e++)o.orRequireds.push({required:!0,requireds:[],orRequired:[],orRequireds:[],id:"",type:"id",reqId:o.orRequired[e].req||"",reqId1:"",reqId2:"",reqId3:"",reqPoints:0,showRequired:o.showRequired,operator:o.operator,afterText:o.afterText,beforeText:o.beforeText,orNum:o.orNum,selNum:o.selNum,selFromOperators:"1",more:[]})}if(void 0!==o.requireds)for(let e=0;e<o.requireds.length;e++){const t=o.requireds[e];if("or"===t.type&&t.orRequired&&void 0===t.orRequireds){t.orRequireds=[];for(let e=0;e<t.orRequired.length;e++)t.orRequireds.push({required:!0,requireds:[],orRequired:[],orRequireds:[],id:"",type:"id",reqId:t.orRequired[e].req||"",reqId1:"",reqId2:"",reqId3:"",reqPoints:0,showRequired:t.showRequired,operator:t.operator,afterText:t.afterText,beforeText:t.beforeText,orNum:t.orNum,selNum:t.selNum,selFromOperators:"1",more:[]})}}}}if(void 0!==o.requireds)for(let e=0;e<o.requireds.length;e++){const t=o.requireds[e];if("or"===t.type&&t.orRequired&&void 0===t.orRequireds){t.orRequireds=[];for(let e=0;e<t.orRequired.length;e++)t.orRequireds.push({required:!0,requireds:[],orRequired:[],orRequireds:[],id:"",type:"id",reqId:t.orRequired[e].req||"",reqId1:"",reqId2:"",reqId3:"",reqPoints:0,showRequired:t.showRequired,operator:t.operator,afterText:t.afterText,beforeText:t.beforeText,orNum:t.orNum,selNum:t.selNum,selFromOperators:"1",more:[]})}if(void 0!==t.requireds)for(let e=0;e<t.requireds.length;e++){const o=t.requireds[e];if("or"===o.type&&o.orRequired&&void 0===o.orRequireds){o.orRequireds=[];for(let e=0;e<o.orRequired.length;e++)o.orRequireds.push({required:!0,requireds:[],orRequired:[],orRequireds:[],id:"",type:"id",reqId:o.orRequired[e].req||"",reqId1:"",reqId2:"",reqId3:"",reqPoints:0,showRequired:o.showRequired,operator:o.operator,afterText:o.afterText,beforeText:o.beforeText,orNum:o.orNum,selNum:o.selNum,selFromOperators:"1",more:[]})}}}for(let e=0;e<o.addons.length;e++){const t=o.addons[e];if(void 0!==t.template&&0!==t.template||(t.template=1),t.parentId=o.id,t.image,bi(t.image)?oo.value||(oo.value=wi(t.image)):to.add(t.image),void 0!==t.requireds)for(let e=0;e<t.requireds.length;e++){const o=t.requireds[e];if("or"===o.type&&o.orRequired&&void 0===o.orRequireds){o.orRequireds=[];for(let e=0;e<o.orRequired.length;e++)o.orRequireds.push({required:!0,requireds:[],orRequired:[],orRequireds:[],id:"",type:"id",reqId:o.orRequired[e].req||"",reqId1:"",reqId2:"",reqId3:"",reqPoints:0,showRequired:o.showRequired,operator:o.operator,afterText:o.afterText,beforeText:o.beforeText,orNum:o.orNum,selNum:o.selNum,selFromOperators:"1",more:[]})}if(void 0!==o.requireds)for(let e=0;e<o.requireds.length;e++){const t=o.requireds[e];if("or"===t.type&&t.orRequired&&void 0===t.orRequireds){t.orRequireds=[];for(let e=0;e<t.orRequired.length;e++)t.orRequireds.push({required:!0,requireds:[],orRequired:[],orRequireds:[],id:"",type:"id",reqId:t.orRequired[e].req||"",reqId1:"",reqId2:"",reqId3:"",reqPoints:0,showRequired:t.showRequired,operator:t.operator,afterText:t.afterText,beforeText:t.beforeText,orNum:t.orNum,selNum:t.selNum,selFromOperators:"1",more:[]})}}}}}}else if("objectDesignGroups"===o||"rowDesignGroups"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];void 0===i.activatedId&&(i.activatedId=""),void 0===i.elements&&(i.elements=[]),void 0===i.backpackElements&&(i.backpackElements=[]),void 0===i.groupElements&&(i.groupElements=[]);for(let e=0;e<i.elements.length;e++)"object"==typeof i.elements[e]&&(i.elements[e]=i.elements[e].id);for(let e=0;e<i.backpackElements.length;e++)"object"==typeof i.backpackElements[e]&&(i.backpackElements[e]=i.backpackElements[e].id);Li(i),Go(i.styling,void 0===e.version||"2.0.0-beta"===e.version)}else if("pointTypes"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];void 0===i.initValue&&(i.initValue=i.startingSum),"object"==typeof i.positiveColor&&void 0!==i.positiveColor.hexa&&(i.positiveColor=i.positiveColor.hexa),"object"==typeof i.negativeColor&&void 0!==i.negativeColor.hexa&&(i.negativeColor=i.negativeColor.hexa),"object"==typeof i.privateColor&&void 0!==i.privateColor.hexa&&(i.privateColor=i.privateColor.hexa),"object"==typeof i.privateNegativeColor&&void 0!==i.privateNegativeColor.hexa&&(i.privateNegativeColor=i.privateNegativeColor.hexa)}else if("groups"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];void 0===i.elements&&(i.elements=[]),void 0===i.rowElements&&(i.rowElements=[]);for(let e=0;e<i.elements.length;e++)"object"==typeof i.elements[e]&&(i.elements[e]=i.elements[e].id);for(let e=0;e<i.rowElements.length;e++)"object"==typeof i.rowElements[e]&&(i.rowElements[e]=i.rowElements[e].id)}else if("globalRequirements"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];if(void 0!==i.requireds)for(let e=0;e<i.requireds.length;e++){const t=i.requireds[e];if("or"===t.type&&t.orRequired&&void 0===t.orRequireds){t.orRequireds=[];for(let e=0;e<t.orRequired.length;e++)t.orRequireds.push({required:!0,requireds:[],orRequired:[],orRequireds:[],id:"",type:"id",reqId:t.orRequired[e].req||"",reqId1:"",reqId2:"",reqId3:"",reqPoints:0,showRequired:t.showRequired,operator:t.operator,afterText:t.afterText,beforeText:t.beforeText,orNum:t.orNum,selNum:t.selNum,selFromOperators:"1",more:[]})}if(void 0!==t.requireds)for(let e=0;e<t.requireds.length;e++){const o=t.requireds[e];if("or"===o.type&&o.orRequired&&void 0===o.orRequireds){o.orRequireds=[];for(let e=0;e<o.orRequired.length;e++)o.orRequireds.push({required:!0,requireds:[],orRequired:[],orRequireds:[],id:"",type:"id",reqId:o.orRequired[e].req||"",reqId1:"",reqId2:"",reqId3:"",reqPoints:0,showRequired:o.showRequired,operator:o.operator,afterText:o.afterText,beforeText:o.beforeText,orNum:o.orNum,selNum:o.selNum,selFromOperators:"1",more:[]})}}}}}else"object"==typeof e[o]&&"styling"===o&&Go(e[o],void 0===e.version||"2.0.0-beta"===e.version,!0)}kt.clear(),Mt.clear(),Dt.clear(),Ft.clear(),Rt.clear(),jt.clear(),qt.clear(),Pt.clear(),$t.clear(),Vt.clear(),Nt.splice(0),Wt.clear();const o=Object.keys(At);for(let n=0;n<o.length;n++){const e=o[n];At.hasOwnProperty(e)?app[e]=At[e]:delete app[e]}const i=Object.keys(e);for(let n=0;n<i.length;n++){const t=i[n];app[t]=e[t]}for(let n=0;n<app.googleFonts.length;n++){const e=app.googleFonts[n].replace(/ /g,"+"),t="https://fonts.googleapis.com/css2?family=".concat(e,"&display=swap"),o=document.createElement("link");o.id=e,o.rel="stylesheet",o.href=t,o.crossOrigin="anonymous",document.head.appendChild(o)}for(let n=0;n<app.customFonts.length;n++){const e=app.customFonts[n],t=document.createElement("link");t.id=e,t.rel="stylesheet",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}for(let n=0;n<app.pointTypes.length;n++){const e=app.pointTypes[n];void 0!==e.id&&""!==e.id||(e.id=xo(0,4)),e.id=jo(e.id,Mt),void 0===e.initValue&&(e.initValue=e.startingSum),void 0===e.isNotShownObjects&&""!==e.activatedId&&(e.isNotShownObjects=!0),void 0===e.isNotShownPointBar&&""!==e.activatedId&&(e.isNotShownPointBar=!0),Mt.set(e.id,e)}for(let n=0;n<app.rows.length;n++){const e=app.rows[n];void 0!==e.id&&""!==e.id||(e.id=To(0,4)),e.id=jo(e.id,Dt),Dt.set(e.id,e);for(let t=0;t<e.objects.length;t++){const o=e.objects[t];void 0!==o.id&&""!==o.id||(o.id=So(0,4)),o.id=jo(o.id,Ft),Ft.set(o.id,{choice:o,row:e});for(let e=0;e<o.scores.length;e++){const t=o.scores[e];void 0!==t.idx&&""!==t.idx||(t.idx=Ao(0,5)),t.idx=jo(t.idx,Wt),Wt.add(t.idx)}if(o.addons&&o.addons.length>0)for(let t=0;t<o.addons.length;t++){const i=o.addons[t];if(i.isSelectable&&(i.id=jo(i.id,Ft),Ft.set(i.id,{choice:i,row:e}),i.scores&&i.scores.length>0))for(let e=0;e<i.scores.length;e++){const t=i.scores[e];void 0!==t.idx&&""!==t.idx||(t.idx=Ao(0,5)),t.idx=jo(t.idx,Wt),Wt.add(t.idx)}}}}for(let n=0;n<app.backpack.length;n++){const e=app.backpack[n];void 0!==e.id&&""!==e.id||(e.id=To(0,4)),e.id=jo(e.id,Dt),Dt.set(e.id,e);for(let t=0;t<e.objects.length;t++){const o=e.objects[t];void 0!==o.id&&""!==o.id||(o.id=So(0,4)),o.id=jo(o.id,Ft),Ft.set(o.id,{choice:o,row:e});for(let e=0;e<o.scores.length;e++){const t=o.scores[e];void 0!==t.idx&&""!==t.idx||(t.idx=Ao(0,5)),t.idx=jo(t.idx,Wt),Wt.add(t.idx)}if(o.addons&&o.addons.length>0)for(let t=0;t<o.addons.length;t++){const i=o.addons[t];if(i.isSelectable&&(i.id=jo(i.id,Ft),Ft.set(i.id,{choice:i,row:e}),i.scores&&i.scores.length>0))for(let e=0;e<i.scores.length;e++){const t=i.scores[e];void 0!==t.idx&&""!==t.idx||(t.idx=Ao(0,5)),t.idx=jo(t.idx,Wt),Wt.add(t.idx)}}}}for(let n=0;n<app.groups.length;n++){const e=app.groups[n];void 0!==e.id&&""!==e.id||(e.id=Co(0,4)),e.id=jo(e.id,Rt),Rt.set(e.id,app.groups[n]);for(let t=e.elements.length-1;t>=0;t--)Ft.has(e.elements[t])||e.elements.splice(t,1);for(let t=e.rowElements.length-1;t>=0;t--)Dt.has(e.rowElements[t])||e.rowElements.splice(t,1)}for(let n=0;n<app.rows.length;n++){const e=app.rows[n];if(void 0!==e.groups)for(let t=e.groups.length-1;t>=0;t--)Rt.has(e.groups[t])||e.groups.splice(t,1);for(let t=0;t<e.objects.length;t++){const o=e.objects[t];if(void 0!==o.groups)for(let e=o.groups.length-1;e>=0;e--)Rt.has(o.groups[e])||o.groups.splice(e,1)}}for(let n=0;n<app.backpack.length;n++){const e=app.backpack[n];if(void 0!==e.groups)for(let t=e.groups.length-1;t>=0;t--)Rt.has(e.groups[t])||e.groups.splice(t,1);for(let t=0;t<e.objects.length;t++){const o=e.objects[t];if(void 0!==o.groups)for(let e=o.groups.length-1;e>=0;e--)Rt.has(o.groups[e])||o.groups.splice(e,1)}}for(let n=0;n<app.words.length;n++){const e=app.words[n];void 0!==e.id&&""!==e.id||(e.id=Io(0,4)),e.id=jo(e.id,qt),qt.set(e.id,app.words[n])}for(let n=0;n<app.variables.length;n++){const e=app.variables[n];void 0!==e.id&&""!==e.id||(e.id=Oo(0,4)),e.id=jo(e.id,Pt),Pt.set(e.id,app.variables[n])}if(void 0!==app.rowDesignGroups)for(let n=0;n<app.rowDesignGroups.length;n++){const e=app.rowDesignGroups[n];void 0!==e.id&&""!==e.id||(e.id=yo(0,4)),e.id=jo(e.id,$t);for(let t=e.elements.length-1;t>=0;t--)Dt.has(e.elements[t])||e.elements.splice(t,1);for(let t=e.backpackElements.length-1;t>=0;t--)Dt.has(e.backpackElements[t])||e.backpackElements.splice(t,1);if(void 0!==e.groupElements)for(let t=e.groupElements.length-1;t>=0;t--)Rt.has(e.groupElements[t])||e.groupElements.splice(t,1);$t.set(e.id,e)}if(void 0!==app.objectDesignGroups)for(let n=0;n<app.objectDesignGroups.length;n++){const e=app.objectDesignGroups[n];void 0!==e.id&&""!==e.id||(e.id=yo(0,4)),e.id=jo(e.id,Vt);for(let t=e.elements.length-1;t>=0;t--)Ft.has(e.elements[t])||e.elements.splice(t,1);for(let t=e.backpackElements.length-1;t>=0;t--)Ft.has(e.backpackElements[t])||e.backpackElements.splice(t,1);if(void 0!==e.groupElements)for(let t=e.groupElements.length-1;t>=0;t--)Rt.has(e.groupElements[t])||e.groupElements.splice(t,1);Vt.set(app.objectDesignGroups[n].id,app.objectDesignGroups[n])}for(let n=0;n<app.groups.length;n++){const e=app.groups[n];if(void 0!==e.designGroups)for(let t=e.designGroups.length-1;t>=0;t--)$t.has(e.designGroups[t])||Vt.has(e.designGroups[t])||e.designGroups.splice(t,1)}if(void 0!==app.globalRequirements)for(let n=0;n<app.globalRequirements.length;n++){const e=app.globalRequirements[n];jt.set(e.id,e)}app.activated.length>0&&vi(app.activated.join(",")),void 0!==app.customCSS&&function(e){let t=document.getElementById("customCSS");t?""===e?(t.remove(),delete app.customCSS):(t.textContent=e,app.customCSS=e):(t=document.createElement("style"),t.id="customCSS",t.textContent=e,app.customCSS=e,document.head.appendChild(t))}(app.customCSS),app.buildAutoSaveIsOn&&(uo&&uo.abort(),po()),"boolean"!=typeof app.isMute&&(app.curVolume=100,app.isMute=!1)}async function Gi(e){const t=e.querySelectorAll("img"),o=Array.from(t).map(e=>e.complete?Promise.resolve():new Promise(t=>{e.onload=t,e.onerror=t}));return Promise.all(o).then(()=>{})}function Hi(e){e.querySelectorAll("img").forEach(e=>{"lazy"===e.loading&&(e.loading="eager")})}async function _i(e){const t=e.querySelectorAll("*"),o=[];t.forEach(e=>{const t=getComputedStyle(e).borderImageSource.match(/url\(["']?(.*?)["']?\)/);t&&t[1]&&o.push(t[1])});const i=o.map(e=>new Promise(t=>{const o=new Image;o.src=e,o.onload=t,o.onerror=t}));await Promise.all(i)}function Yi(e=2){return new Promise(t=>{let o=0;requestAnimationFrame(function i(){if(++o>=e)return t();requestAnimationFrame(i)})})}function Ji(e,t,o){void 0===e.templateStack&&(e.templateStack=[],e.defaultTemplate=void 0!==e.template?e.template:1),e.templateStack.push({id:t,data:o}),e.template=o}function Zi(e,t){if(void 0!==e.templateStack){const o=e.templateStack.findIndex(e=>e.id===t);-1!==o&&e.templateStack.splice(o,1);const i=e.templateStack.length;i>0?e.template=e.templateStack[i-1].data:(e.template=void 0!==e.defaultTemplate?e.defaultTemplate:1,delete e.templateStack)}}function Xi(e,t,o){void 0===e.widthStack&&(e.widthStack=[],e.defaultWidth=void 0!==e.objectWidth?e.objectWidth:"col-md-3"),e.widthStack.push({id:t,data:o}),e.objectWidth=o}function Ki(e,t){if(void 0!==e.widthStack){const o=e.widthStack.findIndex(e=>e.id===t);-1!==o&&e.widthStack.splice(o,1);const i=e.widthStack.length;i>0?e.objectWidth=e.widthStack[i-1].data:(e.objectWidth=void 0!==e.defaultWidth?e.defaultWidth:"col-md-3",delete e.widthStack)}}const Qi=CSS.supports("color","#00000080");function en(e){if(void 0===e)return"";if(Qi||!/^#([\da-f]{8})$/i.test(e))return e;const t=parseInt(e.slice(1,3),16),o=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16),n=parseInt(e.slice(7,9),16)/255;return"rgba(".concat(t,", ").concat(o,", ").concat(i,", ").concat(n.toFixed(3),")")}function tn(e,t,o){let i=e,n=!1;for(;i;){for(const e of i.classList){if(e.startsWith(t))return!0;e.startsWith(o)&&(n=!0)}if(n)return!1;i=i.parentElement}return!1}const on=i({anchor:null,text:"",isVisible:!0});let nn=0;function rn(e,t){let o="string"==typeof t?t:t.text;function i(){let i="string"==typeof t?void 0!==app.tooltipDelay?app.tooltipDelay:1e3:t.delay;0!==nn&&(clearTimeout(nn),nn=0),i>0?nn=window.setTimeout(()=>{on.anchor=e,on.text=o,on.isVisible=!0},i):(on.anchor=e,on.text=o,on.isVisible=!0)}function n(){0!==nn&&(clearTimeout(nn),nn=0),on.isVisible=!1}return e.addEventListener("mouseenter",i),e.addEventListener("mouseleave",n),e.addEventListener("focusin",i),e.addEventListener("focusout",n),{destroy(){on.isVisible=!1,on.anchor=null,e.removeEventListener("mouseenter",i),e.removeEventListener("mouseleave",n),e.removeEventListener("focusin",i),e.removeEventListener("focusout",n)}}}var ln=T('<div class="mdc-tooltip" role="tooltip" style="z-index: 9999;"><div class="mdc-tooltip__surface"><!></div></div>');var an=T("<div><!></div>");const sn=function(e,t){let o=R(t,"text",3,""),i=R(t,"innerClass",3,"");var n=an(),r=D(n);j(r,()=>{var e;return null!=(e=t.children)?e:q}),P(n,(e,t)=>null==rn?void 0:rn(e,t),()=>({text:o(),delay:0})),$(()=>V(n,1,W(i()))),y(e,n)};var cn=T("<input/>");function dn(e,t){x(t,!0);let o,n=R(t,"use",19,()=>[]),r=R(t,"class",3,""),l=R(t,"type",3,"text"),a=R(t,"placeholder",3," "),s=R(t,"value",15),c=R(t,"files",15,null),d=R(t,"dirty",15,!1),u=R(t,"invalid",15,!1),g=R(t,"updateInvalid",3,!0),p=R(t,"initialInvalid",3,!1),m=R(t,"emptyValueNull",19,()=>null===s()),h=R(t,"emptyValueUndefined",19,()=>void 0===s()),v=R(t,"step",3,"any"),f=L(t,["$$slots","$$events","$$legacy","use","class","type","placeholder","value","files","dirty","invalid","updateInvalid","initialInvalid","emptyValueNull","emptyValueUndefined","step"]),w=i({}),T=i({});function I(e){return""===e?Number.NaN:+e}function O(e){if("file"!==l())if(""===e.currentTarget.value&&m())s(null);else if(""===e.currentTarget.value&&h())s(void 0);else switch(l()){case"number":/^-?0\d+/.test(e.currentTarget.value)&&(e.currentTarget.value=e.currentTarget.value.replace(/^(-?)0+(\d+)/,"$1$2")),"number"!=typeof s()&&"-0"!==e.currentTarget.value&&(s(I(e.currentTarget.value)),isNaN(s())&&(s(0),e.currentTarget.value="0")),function(e){return"inputType"in e&&"data"in e}(e)&&(""!==e.currentTarget.value&&"0"!==e.currentTarget.value||("-"===e.data?(s("-0"),e.currentTarget.value="-0"):"deleteContentBackward"===e.inputType?""===e.currentTarget.value&&("number"==typeof s()&&s()<0?(s("-0"),e.currentTarget.value="-0"):(s(0),e.currentTarget.value="0")):"insertFromPaste"===e.inputType&&e.data&&!isNaN(parseInt(e.data))?(s(parseFloat(e.data)),e.currentTarget.value=parseFloat(e.data).toString()):"."!==e.data&&(s(0),e.currentTarget.value="0")));break;case"range":s(I(e.currentTarget.value));break;default:s(e.currentTarget.value)}else c(e.currentTarget.files)}function A(){return o}b(()=>{"file"===l()?delete T.value:T.value=null==s()?"":s()}),E(()=>{g()&&p()&&u(A().matches(":invalid"))});var k={getAttr:function(e){return e in w?void 0!==w[e]?w[e]:null:A().getAttribute(e)},addAttr:function(e,t){w[e]!==t&&(w[e]=t)},removeAttr:function(e){e in w&&null==w[e]||(w[e]=void 0)},focus:function(){A().focus()},blur:function(){A().blur()},getElement:A},B=cn(),M=e=>{var o;"file"!==l()&&O(e),null==(o=t.oninput)||o.call(t,e)},D=e=>{var o;!function(e){"file"!==l()&&"range"!==l()||O(e),"number"===l()&&s(parseFloat(e.currentTarget.value)),d(!0),g()&&u(A().matches(":invalid"))}(e),null==(o=t.onchange)||o.call(t,e)};return z(B,e=>({class:e,type:l(),placeholder:a(),...T,...w,step:v(),...f,oninput:M,onchange:D}),[()=>G({"mdc-text-field__input":!0,[r()]:!0})],void 0,void 0,!0),S(B,e=>o=e,()=>o),P(B,(e,t)=>{var o;return null==(o=H)?void 0:o(e,t)},n),y(e,B),C(k)}var un=T("<textarea></textarea>");function gn(e,t){x(t,!0);let o,n=R(t,"use",19,()=>[]),r=R(t,"class",3,""),l=R(t,"style",3,""),a=R(t,"value",15,""),s=R(t,"dirty",15,!1),c=R(t,"invalid",15,!1),d=R(t,"updateInvalid",3,!0),u=R(t,"initialInvalid",3,!1),g=R(t,"resizable",3,!0),p=L(t,["$$slots","$$events","$$legacy","use","class","style","value","dirty","invalid","updateInvalid","initialInvalid","resizable"]),m=i({});function h(){return o}E(()=>{d()&&u()&&c(h().matches(":invalid"))});var v={getAttr:function(e){return e in m?void 0!==m[e]?m[e]:null:h().getAttribute(e)},addAttr:function(e,t){m[e]!==t&&(m[e]=t)},removeAttr:function(e){e in m&&null==m[e]||(m[e]=void 0)},focus:function(){h().focus()},blur:function(){h().blur()},getElement:h},f=un(),b=e=>{var o;s(!0),d()&&c(h().matches(":invalid")),null==(o=t.onchange)||o.call(t,e)};return z(f,e=>({class:e,style:"".concat(g()?"":"resize: none; ").concat(l()),...m,...p,onchange:b}),[()=>G({"mdc-text-field__input":!0,[r()]:!0})]),S(f,e=>o=e,()=>o),P(f,(e,t)=>{var o;return null==(o=H)?void 0:o(e,t)},n),_(()=>Y(f,a)),y(e,f),C(v)}var pn=T('<span class="mdc-text-field__ripple"></span>'),mn=T("<!> <!>",1),hn=T("<span><!> <!></span>"),vn=T("<!> <!> <!>",1),fn=T("<label><!> <!> <!> <!> <!> <!> <!></label>"),bn=T("<div><!> <!> <!> <!> <!></div>"),wn=T("<!> <!>",1);function Tn(e,t){x(t,!0);const{applyPassive:o}=Q;let n=()=>{};function r(e){return e===n}let l=R(t,"use",19,()=>[]),a=R(t,"class",3,""),s=R(t,"style",3,""),c=R(t,"ripple",3,!0),d=R(t,"disabled",3,!1),u=R(t,"required",3,!1),g=R(t,"textarea",3,!1),m=R(t,"variant",19,()=>g()?"outlined":"standard"),h=R(t,"noLabel",3,!1),T=R(t,"type",3,"text"),I=R(t,"value",15),A=R(t,"files",15,n),M=R(t,"invalid",15,n),_=R(t,"updateInvalid",19,()=>r(M())),Y=R(t,"initialInvalid",3,!1),ge=R(t,"dirty",15,!1),pe=R(t,"validateOnValueChange",19,_),me=R(t,"useNativeValidation",19,_),he=R(t,"withLeadingIcon",3,n),ve=R(t,"withTrailingIcon",3,n),fe=R(t,"input",7),be=R(t,"floatingLabel",7),we=R(t,"lineRipple",7),Te=R(t,"notchedOutline",7),Ie=R(t,"alwaysFloat",3,!1),Se=L(t,["$$slots","$$events","$$legacy","use","class","style","ripple","disabled","required","textarea","variant","noLabel","label","type","value","files","invalid","updateInvalid","initialInvalid","dirty","prefix","suffix","validateOnValueChange","useNativeValidation","withLeadingIcon","withTrailingIcon","input","floatingLabel","lineRipple","notchedOutline","children","leadingIcon","trailingIcon","internalCounter","line","helper","alwaysFloat"]);const ye=void 0!==I()||void 0===I()&&t.input$emptyValueUndefined||!r(A());r(A())&&A(null),r(M())&&M(!1);let Ce,xe,Oe,Ae,ke,Be,Me=O(i(document.createElement("div"))),De=O(void 0),Fe=new K,Re=i({}),je=i({}),qe=O(void 0),Pe=O(!1),$e=O(i(Y())),Ve=J("SMUI:addLayoutListener"),We=new Promise(e=>xe=e);const Ne=f(()=>fe()&&fe().getElement());b(()=>{(ge()||v($e)||!_())&&v(De)&&v(De).isValid()!==!M()&&(_()?M(!v(De).isValid()):v(De).setValid(!M()))}),b(()=>{v(De)&&v(De).getValidateOnValueChange()!==pe()&&v(De).setValidateOnValueChange(!r(pe())&&pe())}),b(()=>{v(De)&&v(De).setUseNativeValidation(!!r(me())||me())}),b(()=>{v(De)&&v(De).setDisabled(d())});let Ue=I();function Le(e){return e in Re?void 0!==Re[e]&&Re[e]:_e().classList.contains(e)}function Ee(e){Re[e]||(Re[e]=!0)}function ze(e){e in Re&&!Re[e]||(Re[e]=!1)}function Ge(e,t){je[e]!=t&&(""===t||null==t?delete je[e]:je[e]=t)}function He(){if(v(De)){const e=v(De).shouldFloat;v(De).notchOutline(e)}}function _e(){return v(Me)}b(()=>{if(v(De)&&ye&&Ue!==I()){Ue=I();const e="".concat(null==I()?"":I());v(De).getValue()!==e&&v(De).setValue(e)}}),Ve&&(Ce=Ve(He)),Z("SMUI:textfield:leading-icon:mount",e=>{Oe=e}),Z("SMUI:textfield:leading-icon:unmount",()=>{Oe=void 0}),Z("SMUI:textfield:trailing-icon:mount",e=>{Ae=e}),Z("SMUI:textfield:trailing-icon:unmount",()=>{Ae=void 0}),Z("SMUI:textfield:helper-text:id",e=>{F(qe,e,!0)}),Z("SMUI:textfield:helper-text:mount",e=>{ke=e}),Z("SMUI:textfield:helper-text:unmount",()=>{F(qe,void 0),ke=void 0}),Z("SMUI:textfield:character-counter:mount",e=>{Be=e}),Z("SMUI:textfield:character-counter:unmount",()=>{Be=void 0}),E(()=>{var e;if(F(De,new X({addClass:Ee,removeClass:ze,hasClass:Le,registerTextFieldInteractionHandler:(e,t)=>Fe.on(_e(),e,t),deregisterTextFieldInteractionHandler:(e,t)=>Fe.off(_e(),e,t),registerValidationAttributeChangeHandler:e=>{const t=new MutationObserver(t=>{me()&&e((e=>e.map(e=>e.attributeName).filter(e=>e))(t))}),o={attributes:!0};return fe()&&t.observe(fe().getElement(),o),t},deregisterValidationAttributeChangeHandler:e=>{e.disconnect()},getNativeInput:()=>{var e;return void 0!==(null==(e=fe())?void 0:e.getElement())?fe().getElement():null},setInputAttr:(e,t)=>{var o;null==(o=fe())||o.addAttr(e,t)},removeInputAttr:e=>{var t;null==(t=fe())||t.removeAttr(e)},isFocused:()=>{var e;return document.activeElement===(null==(e=fe())?void 0:e.getElement())},registerInputInteractionHandler:(e,t)=>{var i;const n=null==(i=fe())?void 0:i.getElement();if(n){const i=o();Fe.on(n,e,t,"boolean"==typeof i?{capture:i}:i)}},deregisterInputInteractionHandler:(e,t)=>{var o;const i=null==(o=fe())?void 0:o.getElement();i&&Fe.off(i,e,t)},floatLabel:e=>be()&&be().float(e||Ie()),getLabelWidth:()=>be()?be().getWidth():0,hasLabel:()=>!!be(),shakeLabel:e=>be()&&be().shake(e),setLabelRequired:e=>be()&&be().setRequired(e),activateLineRipple:()=>we()&&we().activate(),deactivateLineRipple:()=>we()&&we().deactivate(),setLineRippleTransformOrigin:e=>we()&&we().setRippleCenter(e),closeOutline:()=>Te()&&Te().closeNotch(),hasOutline:()=>!!Te(),notchOutline:e=>Te()&&Te().notch(e)},{get helperText(){return ke},get characterCounter(){return Be},get leadingIcon(){return Oe},get trailingIcon(){return Ae}}),!0),ye){if(null==fe())throw new Error("SMUI Textfield must be initialized with either a non-undefined initial value or an Input component.");null==(e=v(De))||e.init()}else p().then(()=>{var e;if(null==fe())throw new Error("SMUI Textfield must be initialized with either a non-undefined initial value or an Input component.");null==(e=v(De))||e.init()});return xe(),()=>{var e;null==(e=v(De))||e.destroy(),Fe.clear()}}),w(()=>{Ce&&Ce()});var Ye={focus:function(){var e;null==(e=fe())||e.focus()},blur:function(){var e;null==(e=fe())||e.blur()},layout:He,getElement:_e},Je=wn(),Ze=B(Je),Xe=e=>{var o=fn();z(o,(e,t,o)=>({class:e,style:t,for:void 0,...o}),[()=>G({"mdc-text-field":!0,"mdc-text-field--disabled":d(),"mdc-text-field--textarea":g(),"mdc-text-field--filled":"filled"===m(),"mdc-text-field--outlined":"outlined"===m(),"smui-text-field--standard":"standard"===m()&&!g(),"mdc-text-field--no-label":h()||null==t.label,"mdc-text-field--label-floating":v(Pe)||null!=I()&&""!==I(),"mdc-text-field--with-leading-icon":r(he())?t.leadingIcon:he(),"mdc-text-field--with-trailing-icon":r(ve())?t.trailingIcon:ve(),"mdc-text-field--with-internal-counter":g()&&t.internalCounter,"mdc-text-field--invalid":M(),...Re,[a()]:!0}),()=>Object.entries(je).map(([e,t])=>"".concat(e,": ").concat(t,";")).concat([s()]).join(" "),()=>oe(Se,["input$","label$","ripple$","outline$","helperLine$"])]);var i=D(o),n=e=>{var o=mn(),i=B(o),n=e=>{var t=pn();y(e,t)};ee(i,e=>{"filled"===m()&&e(n)});var r=te(i,2),l=e=>{{let o=f(()=>v(Pe)||Ie()||null!=I()&&""!==I()&&("number"!=typeof I()||!isNaN(I()))),i=f(()=>re(Se,"label$"));S(ae(e,U({get floatAbove(){return v(o)},get required(){return u()},wrapped:!0},()=>v(i),{children:(e,o)=>{var i=k(),n=B(i),r=e=>{},l=e=>{var o=k(),i=B(o),n=e=>{var o=se();$(()=>ce(o,t.label)),y(e,o)},r=e=>{var o=k(),i=B(o);j(i,()=>t.label),y(e,o)};ee(i,e=>{"string"==typeof t.label?e(n):e(r,!1)},!0),y(e,o)};ee(n,e=>{null==t.label?e(r):e(l,!1)}),y(e,i)},$$slots:{default:!0}})),e=>be(e),()=>be())}};ee(r,e=>{h()||null==t.label||e(l)}),y(e,o)};ee(i,e=>{"outlined"!==m()&&e(n)});var p=te(i,2),b=e=>{{let o=f(()=>h()||null==t.label),i=f(()=>re(Se,"outline$"));S(le(e,U({get noLabel(){return v(o)}},()=>v(i),{children:(e,o)=>{var i=k(),n=B(i),r=e=>{{let o=f(()=>v(Pe)||Ie()||null!=I()&&""!==I()&&("number"!=typeof I()||!isNaN(I()))),i=f(()=>re(Se,"label$"));S(ae(e,U({get floatAbove(){return v(o)},get required(){return u()},wrapped:!0},()=>v(i),{children:(e,o)=>{var i=k(),n=B(i),r=e=>{},l=e=>{var o=k(),i=B(o),n=e=>{var o=se();$(()=>ce(o,t.label)),y(e,o)},r=e=>{var o=k(),i=B(o);j(i,()=>t.label),y(e,o)};ee(i,e=>{"string"==typeof t.label?e(n):e(r,!1)},!0),y(e,o)};ee(n,e=>{null==t.label?e(r):e(l,!1)}),y(e,i)},$$slots:{default:!0}})),e=>be(e),()=>be())}};ee(n,e=>{h()||null==t.label||e(r)}),y(e,i)},$$slots:{default:!0}})),e=>Te(e),()=>Te())}};ee(p,e=>{"outlined"===m()&&e(b)});var w=te(p,2);ie(w,{key:"SMUI:textfield:icon:leading",value:!0,children:(e,o)=>{var i=k(),n=B(i);j(n,()=>{var e;return null!=(e=t.leadingIcon)?e:q}),y(e,i)},$$slots:{default:!0}});var O=te(w,2);j(O,()=>{var e;return null!=(e=t.children)?e:q});var R=te(O,2),E=e=>{var o=hn(),i=D(o);{let e=f(()=>re(Se,"input$"));S(gn(i,U({get disabled(){return d()},get required(){return u()},get updateInvalid(){return _()},get initialInvalid(){return v($e)},get"aria-controls"(){return v(qe)},get"aria-describedby"(){return v(qe)}},()=>v(e),{onblur:e=>{var o;F(Pe,!1),F($e,!0),de(_e(),"blur",e),null==(o=t.input$onblur)||o.call(t,e)},onfocus:e=>{var o;F(Pe,!0),de(_e(),"focus",e),null==(o=t.input$onfocus)||o.call(t,e)},get value(){return I()},set value(e){I(e)},get dirty(){return ge()},set dirty(e){ge(e)},get invalid(){return M()},set invalid(e){M(e)}})),e=>fe(e),()=>fe())}var n=te(i,2);j(n,()=>{var e;return null!=(e=t.internalCounter)?e:q}),$(e=>V(o,1,e),[()=>W(G({"mdc-text-field__resizer":!("input$resizable"in Se)||t.input$resizable}))]),y(e,o)},Y=e=>{var o=vn(),i=B(o),n=e=>{var o=k(),i=B(o),n=e=>{!function(e,t){x(t,!0);let o,i=L(t,["$$slots","$$events","$$legacy","children"]);var n={getElement:function(){return o.getElement()}};S(N(e,U({_smuiClass:"mdc-text-field__affix mdc-text-field__affix--prefix",tag:"span"},()=>i,{children:(e,o)=>{var i=k(),n=B(i);j(n,()=>{var e;return null!=(e=t.children)?e:q}),y(e,i)},$$slots:{default:!0}})),e=>o=e,()=>o),C(n)}(e,{children:(e,o)=>{var i=se();$(()=>ce(i,t.prefix)),y(e,i)},$$slots:{default:!0}})},r=e=>{var o=k(),i=B(o);j(i,()=>{var e;return null!=(e=t.prefix)?e:q}),y(e,o)};ee(i,e=>{"string"==typeof t.prefix?e(n):e(r,!1)}),y(e,o)};ee(i,e=>{null!=t.prefix&&e(n)});var r=te(i,2);{let e=f(()=>re(Se,"input$"));S(dn(r,U({get type(){return T()},get disabled(){return d()},get required(){return u()},get updateInvalid(){return _()},get initialInvalid(){return v($e)},get"aria-controls"(){return v(qe)},get"aria-describedby"(){return v(qe)}},()=>h()&&null!=t.label&&"string"==typeof t.label?{placeholder:t.label}:{},()=>v(e),{onblur:e=>{var o;F(Pe,!1),F($e,!0),de(_e(),"blur",e),null==(o=t.input$onblur)||o.call(t,e)},onfocus:e=>{var o;F(Pe,!0),de(_e(),"focus",e),null==(o=t.input$onfocus)||o.call(t,e)},get value(){return I()},set value(e){I(e)},get files(){return A()},set files(e){A(e)},get dirty(){return ge()},set dirty(e){ge(e)},get invalid(){return M()},set invalid(e){M(e)}})),e=>fe(e),()=>fe())}var l=te(r,2),a=e=>{var o=k(),i=B(o),n=e=>{!function(e,t){x(t,!0);let o,i=L(t,["$$slots","$$events","$$legacy","children"]);var n={getElement:function(){return o.getElement()}};S(N(e,U({_smuiClass:"mdc-text-field__affix mdc-text-field__affix--suffix",tag:"span"},()=>i,{children:(e,o)=>{var i=k(),n=B(i);j(n,()=>{var e;return null!=(e=t.children)?e:q}),y(e,i)},$$slots:{default:!0}})),e=>o=e,()=>o),C(n)}(e,{children:(e,o)=>{var i=se();$(()=>ce(i,t.suffix)),y(e,i)},$$slots:{default:!0}})},r=e=>{var o=k(),i=B(o);j(i,()=>{var e;return null!=(e=t.suffix)?e:q}),y(e,o)};ee(i,e=>{"string"==typeof t.suffix?e(n):e(r,!1)}),y(e,o)};ee(l,e=>{null!=t.suffix&&e(a)}),y(e,o)};ee(R,e=>{g()&&"string"==typeof I()?e(E):e(Y,!1)});var J=te(R,2);ie(J,{key:"SMUI:textfield:icon:leading",value:!1,children:(e,o)=>{var i=k(),n=B(i);j(n,()=>{var e;return null!=(e=t.trailingIcon)?e:q}),y(e,i)},$$slots:{default:!0}});var Z=te(J,2),X=e=>{{let t=f(()=>re(Se,"ripple$"));S(ue(e,U(()=>v(t))),e=>we(e),()=>we())}};ee(Z,e=>{"outlined"!==m()&&c()&&e(X)}),S(o,e=>F(Me,e),()=>v(Me)),P(o,(e,t)=>{var o;return null==(o=ne)?void 0:o(e,t)},()=>({ripple:"filled"===m(),unbounded:!1,addClass:Ee,removeClass:ze,addStyle:Ge,eventTarget:v(Ne),activeTarget:v(Ne),initPromise:We})),P(o,(e,t)=>{var o;return null==(o=H)?void 0:o(e,t)},l),y(e,o)},Ke=e=>{var o=bn();z(o,(e,t,o)=>({class:e,style:t,...o}),[()=>G({"mdc-text-field":!0,"mdc-text-field--disabled":d(),"mdc-text-field--textarea":g(),"mdc-text-field--filled":"filled"===m(),"mdc-text-field--outlined":"outlined"===m(),"smui-text-field--standard":"standard"===m()&&!g(),"mdc-text-field--no-label":h()||null==t.label,"mdc-text-field--with-leading-icon":t.leadingIcon,"mdc-text-field--with-trailing-icon":t.trailingIcon,"mdc-text-field--invalid":M(),...Re,[a()]:!0}),()=>Object.entries(je).map(([e,t])=>"".concat(e,": ").concat(t,";")).concat([s()]).join(" "),()=>oe(Se,["input$","label$","ripple$","outline$","helperLine$"])]);var i=D(o),n=e=>{var o=k(),i=B(o);j(i,()=>{var e;return null!=(e=t.label)?e:q}),y(e,o)};ee(i,e=>{"string"!=typeof t.label&&e(n)});var r=te(i,2);ie(r,{key:"SMUI:textfield:icon:leading",value:!0,children:(e,o)=>{var i=k(),n=B(i);j(n,()=>{var e;return null!=(e=t.leadingIcon)?e:q}),y(e,i)},$$slots:{default:!0}});var u=te(r,2);j(u,()=>{var e;return null!=(e=t.children)?e:q});var p=te(u,2);ie(p,{key:"SMUI:textfield:icon:leading",value:!1,children:(e,o)=>{var i=k(),n=B(i);j(n,()=>{var e;return null!=(e=t.trailingIcon)?e:q}),y(e,i)},$$slots:{default:!0}});var f=te(p,2);j(f,()=>{var e;return null!=(e=t.line)?e:q}),S(o,e=>F(Me,e),()=>v(Me)),P(o,(e,t)=>{var o;return null==(o=ne)?void 0:o(e,t)},()=>({ripple:c(),unbounded:!1,addClass:Ee,removeClass:ze,addStyle:Ge})),P(o,(e,t)=>{var o;return null==(o=H)?void 0:o(e,t)},l),y(e,o)};ee(Ze,e=>{ye?e(Xe):e(Ke,!1)});var Qe=te(Ze,2),et=e=>{{let o=f(()=>re(Se,"helperLine$"));!function(e,t){x(t,!0);let o,i=L(t,["$$slots","$$events","$$legacy","children"]);var n={getElement:function(){return o.getElement()}};S(N(e,U({_smuiClass:"mdc-text-field-helper-line",tag:"div"},()=>i,{children:(e,o)=>{var i=k(),n=B(i);j(n,()=>{var e;return null!=(e=t.children)?e:q}),y(e,i)},$$slots:{default:!0}})),e=>o=e,()=>o),C(n)}(e,U(()=>v(o),{children:(e,o)=>{var i=k(),n=B(i);j(n,()=>{var e;return null!=(e=t.helper)?e:q}),y(e,i)},$$slots:{default:!0}}))}};return ee(Qe,e=>{t.helper&&e(et)}),y(e,Je),C(Ye)}var In=T('<div class="row"><div class="col-12 mt-4 mb-2"><!></div> <div class="col-sm-6 col-12 mb-4"><!></div> <div class="col-sm-6 col-12 mb-4"><!></div> <div class="col-12"><!> <!></div></div>'),Sn=T("<!> <!> <!>",1);function yn(e,t){x(t,!0);let o=R(t,"open",7),i=O(""),n=O(!1);function r(){let e=[],t=Array.from(kt.keys()),o="";if(t.sort((e,t)=>{let o=Ft.get(e),i=Ft.get(t);return void 0!==o&&void 0!==i?o.row.index!==i.row.index?o.row.index-i.row.index:o.choice.index-i.choice.index:0}),v(n)){let i="";for(let o=0;o<t.length;o++){let n=Ft.get(t[o]);if(void 0!==n){const t=n.row,o=n.choice;""!==o.title&&(t.id!==i?(""!==i&&e.push("\n"),e.push("**".concat(""!==t.title?t.title:t.debugTitle||"","**\n")),o.isSelectableMultiple?e.push("".concat(o.title,"(x").concat(o.multipleUseVariable,")")):e.push("".concat(o.title)),i=t.id):o.isSelectableMultiple?e.push(", ".concat(o.title,"(x").concat(o.multipleUseVariable,")")):e.push(", ".concat(o.title)))}}o=e.join("")}else{for(let o=0;o<t.length;o++){let i=Ft.get(t[o]);if(void 0!==i){const t=i.choice;""!==t.title&&(t.isSelectableMultiple?e.push("".concat(t.title,"(x").concat(t.multipleUseVariable,")")):e.push("".concat(t.title)))}}o=e.join(", ")}const i=document.createElement("div");return i.innerHTML=o,i.textContent}ge(e,{surface$style:"width: 1920px; max-width: calc(100vw - 32px);",get onSMUIDialogClosed(){return t.onclose},get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=Sn(),l=B(o);pe(l,{class:"px-3 pb-0 toolbar toolbar__dialog",tabindex:0,autofocus:!0,children:(e,t)=>{var o=se("Build Form");y(e,o)},$$slots:{default:!0}});var a=te(l,2);me(a,{children:(e,t)=>{var o=In(),l=D(o),a=D(l);he(a,{label:e=>{var t=se("Separate Choice Titles by Row");y(e,t)},children:(e,t)=>{ve(e,{color:"secondary",class:"switch-scale",get checked(){return v(n)},set checked(e){F(n,e,!0)}})},$$slots:{label:!0,default:!0}});var s=te(l,2),c=D(s);{let e=f(r);Tn(c,{textarea:!0,get value(){return v(e)},label:"Current Activated Choices Titles",variant:"filled",input$rows:5})}var d=te(s,2),u=D(d);{let e=f(ho);Tn(u,{textarea:!0,get value(){return v(e)},label:"Current Activated Choices ID's",variant:"filled",input$rows:5})}var g=te(d,2),p=D(g);Tn(p,{textarea:!0,label:"Area To Import Activated Choices With Lists Of Id's",variant:"filled",input$rows:5,get value(){return v(i)},set value(e){F(i,e,!0)}});var m=te(p,2);fe(m,{onclickcapture:()=>vi(v(i)),variant:"raised",children:(e,t)=>{be(e,{children:(e,t)=>{var o=se("Import Choices/Clean if empty");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}});var s=te(a,2);we(s,{children:(e,t)=>{fe(e,{action:"close",children:(e,t)=>{be(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=se("Cancel");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}}),C()}let Cn=0;var xn=T("<div><!></div>");let On=0;var An=T("<input/>"),kn=T('<span class="mdc-select__ripple"></span>'),Bn=T('<div><!> <div><!> <!> <!> <!> <span><span> </span></span> <span><svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false"><polygon class="mdc-select__dropdown-icon-inactive" stroke="none" fill-rule="evenodd" points="7 10 12 15 17 10"></polygon><polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd" points="7 15 12 10 17 15"></polygon></svg></span> <!></div> <!></div> <!>',1);function Mn(e,t){x(t,!0);const o=()=>Oe(Ke,"$selectedTextStore",n),[n,r]=Ae();let l=()=>{};function a(e){return e===l}let s=R(t,"use",19,()=>[]),c=R(t,"class",3,""),u=R(t,"style",3,""),g=R(t,"ripple",3,!0),p=R(t,"disabled",3,!1),m=R(t,"variant",3,"standard"),h=R(t,"noLabel",3,!1),T=R(t,"label",3,void 0),I=R(t,"value",15),A=R(t,"key",3,e=>e),M=R(t,"dirty",15,!1),V=R(t,"invalid",15,l),W=R(t,"updateInvalid",19,()=>a(V())),N=R(t,"required",3,!1),_=R(t,"inputId",19,()=>"SMUI-select-"+On++),Y=R(t,"hiddenInput",3,!1),X=R(t,"withLeadingIcon",3,l),K=R(t,"anchor$use",19,()=>[]),Q=R(t,"anchor$class",3,""),ie=R(t,"selectedTextContainer$use",19,()=>[]),ge=R(t,"selectedTextContainer$class",3,""),pe=R(t,"selectedText$use",19,()=>[]),me=R(t,"selectedText$class",3,""),he=R(t,"dropdownIcon$use",19,()=>[]),ve=R(t,"dropdownIcon$class",3,""),fe=R(t,"menu$class",3,""),be=R(t,"alwaysFloat",3,!1),we=L(t,["$$slots","$$events","$$legacy","use","class","style","ripple","disabled","variant","noLabel","label","value","key","dirty","invalid","updateInvalid","required","inputId","hiddenInput","withLeadingIcon","anchor$use","anchor$class","selectedTextContainer$use","selectedTextContainer$class","selectedText$use","selectedText$class","dropdownIcon$use","dropdownIcon$class","menu$class","children","leadingIcon","helperText","alwaysFloat"]);const ke=a(V());let Be;a(V())&&V(!1);let Me,De=O(void 0),Fe=i({}),Re=i({}),je=i({}),qe=O(-1);const Pe=f(()=>void 0!==we.menu$id?we.menu$id:_()+"-menu");let $e,Ve,We,Ne,Ue=O(void 0),Le=J("SMUI:addLayoutListener"),Ee=O(!1),ze=i({}),Ge=O(void 0),He=O(void 0),_e=O(!1),Ye=J("SMUI:select:context"),Je=O(void 0),Ze=O(void 0),Xe=O(void 0);Z("SMUI:list:role",""),Z("SMUI:list:nav",!1);const Ke=d("");Z("SMUI:select:selectedText",Ke);const Qe=d(I());b(()=>{Ie(Qe,I())}),Z("SMUI:select:value",Qe),b(()=>{v(De)&&v(De).getValue()!==A()(I())&&v(De).setValue(A()(I()))});let et=v(qe);function tt(e){return e in Fe?Fe[e]:pt().classList.contains(e)}function ot(e){Fe[e]||(Fe[e]=!0)}function it(e){e in Fe&&!Fe[e]||(Fe[e]=!1)}function nt(e,t){Re[e]!=t&&(""===t||null==t?delete Re[e]:Re[e]=t)}function rt(e){ze[e]||(ze[e]=!0)}function lt(e){e in ze&&!ze[e]||(ze[e]=!1)}function at(e){return e in je?void 0!==je[e]?je[e]:null:pt().getAttribute(e)}function st(e,t){je[e]!==t&&(je[e]=t)}function ct(e){e in je&&null==je[e]||(je[e]=void 0)}function dt(){return Ve.getOrderedList().map(e=>e.getValue())}function ut(e){var t;null==(t=v(De))||t.setUseDefaultValidation(e)}function gt(){var e;null==(e=v(De))||e.layout()}function pt(){return Be}b(()=>{if(et!==v(qe))if(et=v(qe),v(De))v(De).setSelectedIndex(v(qe),!1,!0);else{const e=dt();I()!==e[v(qe)]&&I(e[v(qe)])}}),b(()=>{v(De)&&v(De).getDisabled()!==p()&&v(De).setDisabled(p())}),b(()=>{v(De)&&M()&&v(De).isValid()!==!V()&&(W()?V(!v(De).isValid()):v(De).setValid(!V()))}),b(()=>{v(De)&&v(De).getRequired()!==N()&&v(De).setRequired(N())}),Le&&($e=Le(gt)),Z("SMUI:select:leading-icon:mount",e=>{We=e}),Z("SMUI:select:leading-icon:unmount",()=>{We=void 0}),Z("SMUI:list:mount",e=>{Ve=e}),Z("SMUI:select:helper-text:id",e=>{F(Ue,e,!0)}),Z("SMUI:select:helper-text:mount",e=>{Ne=e}),Z("SMUI:select:helper-text:unmount",()=>{F(Ue,void 0),Ne=void 0}),E(()=>(F(De,new Se({setSelectedText:e=>{Ie(Ke,e)},isSelectAnchorFocused:()=>document.activeElement===Me,getSelectAnchorAttr:at,setSelectAnchorAttr:st,removeSelectAnchorAttr:ct,addMenuClass:rt,removeMenuClass:lt,openMenu:()=>{F(Ee,!0)},closeMenu:()=>{F(Ee,!1)},getAnchorElement:()=>Me,setMenuAnchorElement:e=>{F(Ge,e,!0)},setMenuAnchorCorner:e=>{F(He,e,!0)},setMenuWrapFocus:e=>{F(_e,e,!0)},getSelectedIndex:()=>v(qe),setSelectedIndex:e=>{et=e,F(qe,e,!0),I(dt()[v(qe)])},focusMenuItemAtIndex:e=>{Ve.focusItemAtIndex(e)},getMenuItemCount:()=>Ve.items.length,getMenuItemValues:()=>dt().map(A()),getMenuItemTextAtIndex:e=>Ve.getPrimaryTextAtIndex(e),isTypeaheadInProgress:()=>Ve.typeaheadInProgress,typeaheadMatchItem:(e,t)=>Ve.typeaheadMatchItem(e,t),addClass:ot,removeClass:it,hasClass:tt,setRippleCenter:e=>v(Ze)&&v(Ze).setRippleCenter(e),activateBottomLine:()=>v(Ze)&&v(Ze).activate(),deactivateBottomLine:()=>v(Ze)&&v(Ze).deactivate(),notifyChange:e=>{var t;M(!0),W()&&V(!(null==(t=v(De))?void 0:t.isValid())),de(pt(),"SMUISelectChange",{value:I(),index:v(qe)})},hasOutline:()=>!!v(Xe),notchOutline:e=>v(Xe)&&v(Xe).notch(e),closeOutline:()=>v(Xe)&&v(Xe).closeNotch(),hasLabel:()=>!!v(Je),floatLabel:e=>v(Je)&&v(Je).float(e||be()),getLabelWidth:()=>v(Je)?v(Je).getWidth():0,setLabelRequired:e=>v(Je)&&v(Je).setRequired(e)},{get helperText(){return Ne},get leadingIcon(){return We}}),!0),F(qe,dt().indexOf(I()),!0),v(De).init(),ut(ke),()=>{var e;null==(e=v(De))||e.destroy()})),w(()=>{$e&&$e()});var mt={getUseDefaultValidation:function(){if(null==v(De))throw new Error("Instance is undefined.");return v(De).getUseDefaultValidation()},setUseDefaultValidation:ut,focus:function(){Me.focus()},layout:gt,getElement:pt},ht=Bn(),vt=B(ht);z(vt,(e,t,o)=>({class:e,style:t,...o}),[()=>G({"mdc-select":!0,"mdc-select--required":N(),"mdc-select--disabled":p(),"mdc-select--filled":"filled"===m(),"mdc-select--outlined":"outlined"===m(),"smui-select--standard":"standard"===m(),"mdc-select--with-leading-icon":a(X())?t.leadingIcon:X(),"mdc-select--no-label":h()||null==T(),"mdc-select--invalid":V(),"mdc-select--activated":v(Ee),"mdc-data-table__pagination-rows-per-page-select":"data-table:pagination"===Ye,...Fe,[c()]:!0}),()=>Object.entries(Re).map(([e,t])=>"".concat(e,": ").concat(t,";")).concat([u()]).join(" "),()=>oe(we,["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])]);var ft=D(vt),bt=e=>{var t=An();z(t,e=>({type:"hidden",required:N(),disabled:p(),value:I(),...e}),[()=>re(we,"input$")],void 0,void 0,!0),y(e,t)};ee(ft,e=>{Y()&&e(bt)});var wt=te(ft,2),Tt=e=>{var o;Me.focus(),v(De)&&v(De).handleClick(function(e){const t=e.currentTarget.getBoundingClientRect();return(function(e){return"touches"in e}(e)?e.touches[0].clientX:e.clientX)-t.left}(e)),null==(o=t.anchor$onclick)||o.call(t,e)},It=e=>{var o;v(De)&&v(De).handleKeydown(e),null==(o=t.onkeydown)||o.call(t,e)},St=e=>{var o;v(De)&&v(De).handleBlur(),de(pt(),"blur",e),null==(o=t.anchor$onblur)||o.call(t,e)},yt=e=>{var o;v(De)&&v(De).handleFocus(),de(pt(),"focus",e),null==(o=t.anchor$onfocus)||o.call(t,e)};z(wt,(e,t)=>({class:e,"aria-required":N()?"true":void 0,"aria-disabled":p()?"true":void 0,"aria-controls":v(Pe),"aria-expanded":v(Ee)?"true":"false","aria-describedby":v(Ue),role:"combobox",tabindex:"0",...je,...t,onclick:Tt,onkeydown:It,onblur:St,onfocus:yt}),[()=>G({[Q()]:!0,"mdc-select__anchor":!0}),()=>re(we,"anchor$")]);var Ct=D(wt),xt=e=>{var t=kn();y(e,t)};ee(Ct,e=>{"filled"===m()&&e(xt)});var Ot=te(Ct,2),At=e=>{{let t=f(()=>_()+"-smui-label"),i=f(()=>""!==o()||be()),n=f(()=>re(we,"label$"));S(ae(e,U({get id(){return v(t)},get floatAbove(){return v(i)},get required(){return N()}},()=>v(n),{children:(e,t)=>{var o=k(),i=B(o),n=e=>{},r=e=>{var t=k(),o=B(t),i=e=>{var t=se();$(()=>ce(t,T())),y(e,t)},n=e=>{var t=k(),o=B(t);j(o,T),y(e,t)};ee(o,e=>{"string"==typeof T()?e(i):e(n,!1)},!0),y(e,t)};ee(i,e=>{null==T()?e(n):e(r,!1)}),y(e,o)},$$slots:{default:!0}})),e=>F(Je,e,!0),()=>v(Je))}};ee(Ot,e=>{"outlined"===m()||h()||null==T()||e(At)});var kt=te(Ot,2),Bt=e=>{{let t=f(()=>h()||null==T()),i=f(()=>re(we,"outline$"));S(le(e,U({get noLabel(){return v(t)}},()=>v(i),{children:(e,t)=>{var i=k(),n=B(i),r=e=>{{let t=f(()=>_()+"-smui-label"),i=f(()=>""!==o()||be()),n=f(()=>re(we,"label$"));S(ae(e,U({get id(){return v(t)},get floatAbove(){return v(i)},get required(){return N()}},()=>v(n),{children:(e,t)=>{var o=k(),i=B(o),n=e=>{},r=e=>{var t=k(),o=B(t),i=e=>{var t=se();$(()=>ce(t,T())),y(e,t)},n=e=>{var t=k(),o=B(t);j(o,T),y(e,t)};ee(o,e=>{"string"==typeof T()?e(i):e(n,!1)},!0),y(e,t)};ee(i,e=>{null==T()?e(n):e(r,!1)}),y(e,o)},$$slots:{default:!0}})),e=>F(Je,e,!0),()=>v(Je))}};ee(n,e=>{h()||null==T()||e(r)}),y(e,i)},$$slots:{default:!0}})),e=>F(Xe,e,!0),()=>v(Xe))}};ee(kt,e=>{"outlined"===m()&&e(Bt)});var Mt=te(kt,2);j(Mt,()=>{var e;return null!=(e=t.leadingIcon)?e:q});var Dt=te(Mt,2);z(Dt,(e,t)=>({class:e,...t}),[()=>G({[ge()]:!0,"mdc-select__selected-text-container":!0}),()=>re(we,"selectedTextContainer$")]);var Ft=D(Dt);z(Ft,(e,t)=>({id:_()+"-smui-selected-text",class:e,role:"button","aria-haspopup":"listbox","aria-labelledby":_()+"-smui-label",...t}),[()=>G({[me()]:!0,"mdc-select__selected-text":!0}),()=>re(we,"selectedText$")]);var Rt=D(Ft);P(Ft,(e,t)=>{var o;return null==(o=H)?void 0:o(e,t)},pe),P(Dt,(e,t)=>{var o;return null==(o=H)?void 0:o(e,t)},ie);var jt=te(Dt,2);z(jt,(e,t)=>({class:e,...t}),[()=>G({[ve()]:!0,"mdc-select__dropdown-icon":!0}),()=>re(we,"dropdownIcon$")]),P(jt,(e,t)=>{var o;return null==(o=H)?void 0:o(e,t)},he);var qt=te(jt,2),Pt=e=>{{let t=f(()=>re(we,"ripple$"));S(ue(e,U(()=>v(t))),e=>F(Ze,e,!0),()=>v(Ze))}};ee(qt,e=>{"outlined"!==m()&&g()&&e(Pt)}),S(wt,e=>Me=e,()=>Me),P(wt,(e,t)=>{var o;return null==(o=H)?void 0:o(e,t)},K);var $t=te(wt,2);{let e=f(()=>G({[fe()]:!0,"mdc-select__menu":!0,...ze})),o=f(()=>re(we,"menu$"));ye($t,U({get class(){return v(e)},get id(){return v(Pe)},fullWidth:!0,anchor:!1,get anchorElement(){return v(Ge)},get anchorCorner(){return v(He)}},()=>v(o),{onSMUIMenuSelected:e=>{var o;v(De)&&v(De).handleMenuItemAction(e.detail.index),null==(o=t.onSMUIMenuSelected)||o.call(t,e)},onSMUIMenuSurfaceClosing:e=>{var o;v(De)&&v(De).handleMenuClosing(),null==(o=t.onSMUIMenuSurfaceClosing)||o.call(t,e)},onSMUIMenuSurfaceClosed:e=>{var o;v(De)&&v(De).handleMenuClosed(),null==(o=t.onSMUIMenuSurfaceClosed)||o.call(t,e)},onSMUIMenuSurfaceOpened:e=>{var o;v(De)&&v(De).handleMenuOpened(),null==(o=t.onSMUIMenuSurfaceOpened)||o.call(t,e)},get open(){return v(Ee)},set open(e){F(Ee,e,!0)},children:(e,o)=>{{let o=f(()=>re(we,"list$"));Ce(e,U({role:"listbox",get wrapFocus(){return v(_e)}},()=>v(o),{style:"max-height: 296px",get selectedIndex(){return v(qe)},set selectedIndex(e){F(qe,e,!0)},children:(e,o)=>{var i=k(),n=B(i);j(n,()=>{var e;return null!=(e=t.children)?e:q}),y(e,i)},$$slots:{default:!0}}))}},$$slots:{default:!0}}))}S(vt,e=>Be=e,()=>Be),P(vt,(e,t)=>{var o;return null==(o=ne)?void 0:o(e,t)},()=>({ripple:"filled"===m(),unbounded:!1,addClass:ot,removeClass:it,addStyle:nt})),P(vt,(e,t)=>{var o;return null==(o=xe)?void 0:o(e,t)},()=>({addClass:ot,removeClass:it})),P(vt,(e,t)=>{var o;return null==(o=H)?void 0:o(e,t)},s);var Vt=te(vt,2),Wt=e=>{{let o=f(()=>re(we,"helperText$"));!function(e,t){x(t,!0);let o,n=R(t,"use",19,()=>[]),r=R(t,"class",3,""),l=R(t,"id",19,()=>"SMUI-select-helper-text-"+Cn++),a=R(t,"persistent",3,!1),s=R(t,"validationMsg",3,!1),c=L(t,["$$slots","$$events","$$legacy","use","class","id","persistent","validationMsg","children"]),d=O(void 0),u=i({}),g=i({}),p=O(void 0);const m=J("SMUI:select:helper-text:id"),h=J("SMUI:select:helper-text:mount"),f=J("SMUI:select:helper-text:unmount");function b(e){return e in u?u[e]:V().classList.contains(e)}function w(e){u[e]||(u[e]=!0)}function T(e){e in u&&!u[e]||(u[e]=!1)}function I(e){return e in g?void 0!==g[e]?g[e]:null:V().getAttribute(e)}function A(e,t){g[e]!==t&&(g[e]=t)}function M(e){e in g&&null==g[e]||(g[e]=void 0)}function V(){return o}E(()=>(F(d,new Te({addClass:w,removeClass:T,hasClass:b,getAttr:I,setAttr:A,removeAttr:M,setContent:e=>{F(p,e,!0)}}),!0),m&&m(l()),h&&h(v(d)),v(d).init(),()=>{var e;f&&v(d)&&f(v(d)),null==(e=v(d))||e.destroy()}));var W={getElement:V},N=xn();z(N,e=>({class:e,"aria-hidden":a()?void 0:"true",id:l(),...g,...c}),[()=>G({"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":s(),"mdc-select-helper-text--validation-msg-persistent":a(),...u,[r()]:!0})]);var U=D(N),_=e=>{var o=k(),i=B(o);j(i,()=>{var e;return null!=(e=t.children)?e:q}),y(e,o)},Y=e=>{var t=se();$(()=>ce(t,v(p))),y(e,t)};ee(U,e=>{null==v(p)?e(_):e(Y,!1)}),S(N,e=>o=e,()=>o),P(N,(e,t)=>{var o;return null==(o=H)?void 0:o(e,t)},n),y(e,N),C(W)}(e,U(()=>v(o),{children:(e,o)=>{var i=k(),n=B(i);j(n,()=>{var e;return null!=(e=t.helperText)?e:q}),y(e,i)},$$slots:{default:!0}}))}};ee(Vt,e=>{t.helperText&&e(Wt)}),$(()=>ce(Rt,o())),y(e,ht);var Nt=C(mt);return r(),Nt}function Dn(e,t){x(t,!0);const[o,i]=Ae();let n=R(t,"use",19,()=>[]);R(t,"class",3,"");let r,l=R(t,"value",3,""),a=L(t,["$$slots","$$events","$$legacy","use","class","value","children"]);const s=J("SMUI:select:selectedText"),c=J("SMUI:select:value");Z("SMUI:list:item:role","option");const d=f(()=>null!=l()&&""!==l()&&Oe(c,"$selectedValue",o)===l());function u(){v(d)&&r&&Ie(s,r.getPrimaryText())}E(u),w(u);var g={getElement:function(){return r.getElement()}};S(ke(e,U({get use(){return n()},get"data-value"(){return l()},get value(){return l()},get selected(){return v(d)}},()=>a,{children:(e,o)=>{var i=k(),n=B(i);j(n,()=>{var e;return null!=(e=t.children)?e:q}),y(e,i)},$$slots:{default:!0}})),e=>r=e,()=>r);var p=C(g);return i(),p}var Fn=T('<div class="col-12 px-3 mt-0"><!></div>'),Rn=T('<div class="container-fluid p-0"><div class="row gy-3"><div class="col-12"><!></div> <div class="col-12"><!></div> <!> <div class="col-12"><!></div> <div class="col-12"><!></div> <div class="col-12"><!></div> <div class="col-12"><!></div> <div class="col-12"><!></div> <div class="col-12"><!></div></div></div>'),jn=T("<b>Interactive CYOA Creator Plus</b>"),qn=T('<div class="container-fluid p-0"><div class="row gy-3"><div class="col-12 text-right"> <br/></div></div></div>'),Pn=T("<!> <!>",1),$n=T("<!> <!>",1),Vn=T("<!> <!> <!>",1);function Wn(e,t){x(t,!0);let o=R(t,"open",7);const i=[{text:"2 per row",value:"col-6"},{text:"3 per row",value:"col-4"},{text:"4 per row",value:"col-3"}],n=[{text:"top-left",value:0},{text:"top-center",value:1},{text:"top-right",value:2},{text:"middle-left",value:3},{text:"center",value:4},{text:"middle-right",value:5},{text:"bottom-left",value:6},{text:"bottom-center",value:7},{text:"bottom-right",value:8}];let r=O("General");function l(){uo&&uo.abort(),po()}function a(){const e=Xt.allowDeselect;for(let t=0;t<app.backpack.length;t++){const o=app.backpack[t];o.isResultRow&&(o.isInfoRow=!e)}}ge(e,{surface$style:"width: 600px; max-width: calc(100vw - 32px);",get onSMUIDialogClosed(){return t.onclose},get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=Vn(),s=B(o);pe(s,{class:"text-left dialog-title",tabindex:0,autofocus:!0,children:(e,t)=>{var o=se("Settings");y(e,o)},$$slots:{default:!0}});var c=te(s,2);me(c,{children:(e,t)=>{var o=$n(),s=B(o);{const e=(e,t=q)=>{Me(e,{get tab(){return t()},children:(e,o)=>{be(e,{children:(e,o)=>{var i=se();$(()=>ce(i,t())),y(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})};Be(s,{tabs:["General","About"],get active(){return v(r)},set active(e){F(r,e,!0)},tab:e,$$slots:{tab:!0}})}var c=te(s,2),d=e=>{De(e,{role:"tabpanel",variant:"unelevated",children:(e,t)=>{Fe(e,{children:(e,t)=>{var o=Rn(),r=D(o),s=D(r);{const e=e=>{var t=se("Maximum Number of Choices per Row for Screens Between 720px and 1280px.");y(e,t)};Mn(D(s),{label:"Choices per row",variant:"standard",alwaysFloat:!0,get value(){return app.objectsPerRow},set value(e){app.objectsPerRow=e},helperText:e,children:(e,t)=>{var o=k(),n=B(o);Re(n,17,()=>i,e=>e.text,(e,t)=>{Dn(e,{get value(){return v(t).value},children:(e,o)=>{var i=se();$(()=>ce(i,v(t).text)),y(e,i)},$$slots:{default:!0}})}),y(e,o)},$$slots:{helperText:!0,default:!0}})}var c=te(s,2),d=D(c);he(d,{label:e=>{var t=se("Enable Auto Save");y(e,t)},children:(e,t)=>{ve(e,{get checked(){return app.buildAutoSaveIsOn||!1},set checked(e){var t;t=e,app.buildAutoSaveIsOn=t},onSMUISwitchChange:()=>{app.buildAutoSaveIsOn&&l()},color:"secondary",class:"switch-scale"})},$$slots:{label:!0,default:!0}});var g=te(c,2),p=e=>{var t=Fn(),o=D(t);Tn(o,{get value(){return app.buildAutoSaveInterval||10},set value(e){var t;t=e,app.buildAutoSaveInterval=t},label:"Auto Save Interval",type:"number",suffix:"min",variant:"standard",style:"max-width: 200px",input$class:"text-right",input$min:"1",onchange:()=>{app.buildAutoSaveInterval<1&&(app.buildAutoSaveInterval=1),l()}}),y(e,t)};ee(g,e=>{app.buildAutoSaveIsOn&&e(p)});var m=te(g,2),h=D(m);he(h,{label:e=>{var t=se("Preload Images in Backpack");y(e,t)},children:(e,t)=>{ve(e,{get checked(){return app.preloadImages||!1},set checked(e){var t;t=e,app.preloadImages=t},color:"secondary",class:"switch-scale"})},$$slots:{label:!0,default:!0}});var f=te(m,2),b=D(f);he(b,{label:e=>{var t=se("Allow Deselecting Choices in Backpack");y(e,t)},children:(e,t)=>{ve(e,{onSMUISwitchChange:a,color:"secondary",class:"switch-scale",get checked(){return Xt.allowDeselect},set checked(e){Xt.allowDeselect=e}})},$$slots:{label:!0,default:!0}});var w=te(f,2),T=D(w);sn(T,{text:"Enabling this option may cause image downloads to fail or reduce the image resolution.",children:(e,t)=>{he(e,{label:e=>{var t=se("Download Images as Single File");y(e,t)},children:(e,t)=>{ve(e,{color:"secondary",class:"switch-scale",get checked(){return Xt.isSingleFile},set checked(e){Xt.isSingleFile=e}})},$$slots:{label:!0,default:!0}})},$$slots:{default:!0}});var I=te(w,2),S=D(I);he(S,{label:e=>{var t=se("Show Background Music Player");y(e,t)},children:(e,t)=>{ve(e,{get checked(){return app.showMusicPlayer||!1},set checked(e){var t;t=e,app.showMusicPlayer=t},color:"secondary",class:"switch-scale",onchange:()=>{if(app.showMusicPlayer){const e=u(zt);if(e){let t=0,o=0;0!==Ht.bgmTitleInterval&&(clearInterval(Ht.bgmTitleInterval),Ht.bgmTitleInterval=0),Ht.bgmTitleInterval=window.setInterval(()=>{if(""!==Ht.bgmObjectId){const t=Ft.get(Ht.bgmObjectId);if(void 0!==t){const o=t.choice;e.getId()===o.bgmId&&""!==e.getTitle()&&(Ht.bgmTitle=e.getTitle(),Ht.curBgmLength=e.getDuration(),clearInterval(Ht.bgmTitleInterval),Ht.bgmTitleInterval=0)}}},1e3),0!==Ht.bgmPlayInterval&&(clearInterval(Ht.bgmPlayInterval),Ht.bgmPlayInterval=0),Ht.bgmPlayInterval=window.setInterval(()=>{if(!Ht.isSeeking&&e.isPlaying()){const i=Math.floor(e.getCurrentTime());i!==Ht.curBgmTime?t!==i?Ht.curBgmTime=i:(o++,o>Ht.curBgmLength&&(o=1),Ht.curBgmTime=o):(t=i,o=i+1,Ht.curBgmTime=o)}},1e3)}}else Ht.bgmIsPlaying&&(0!==Ht.bgmTitleInterval&&(clearInterval(Ht.bgmTitleInterval),Ht.bgmTitleInterval=0),0!==Ht.bgmPlayInterval&&(clearInterval(Ht.bgmPlayInterval),Ht.bgmPlayInterval=0))}})},$$slots:{label:!0,default:!0}});var C=te(I,2);{const e=e=>{var t=se("Default position of the image cropper");y(e,t)};Mn(D(C),{label:"Image Cropper Position",variant:"standard",alwaysFloat:!0,get value(){return app.cropperPosition},set value(e){app.cropperPosition=e},helperText:e,children:(e,t)=>{var o=k(),i=B(o);Re(i,17,()=>n,e=>e.text,(e,t)=>{Dn(e,{get value(){return v(t).value},children:(e,o)=>{var i=se();$(()=>ce(i,v(t).text)),y(e,i)},$$slots:{default:!0}})}),y(e,o)},$$slots:{helperText:!0,default:!0}})}var x=te(C,2),O=D(x);Tn(O,{get value(){return app.styling.backPackWidth||1200},set value(e){var t;t=e,app.styling.backPackWidth=t},label:"Backpack Width",type:"number",suffix:"px",variant:"standard",input$min:"0",onchange:()=>{void 0!==app.styling.backPackWidth&&app.styling.backPackWidth<0&&(app.styling.backPackWidth=0)}}),y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},g=e=>{var t=k(),o=B(t),i=e=>{De(e,{role:"tabpanel",variant:"unelevated",children:(e,t)=>{var o=Pn(),i=B(o);je(i,{class:"text-center",children:(e,t)=>{var o=jn();y(e,o)},$$slots:{default:!0}});var n=te(i,2);Fe(n,{children:(e,t)=>{var o=qn(),i=D(o),n=D(i),r=D(n);$(()=>ce(r,"v".concat(mt))),y(e,o)},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}})};ee(o,e=>{"About"===v(r)&&e(i)},!0),y(e,t)};ee(c,e=>{"General"===v(r)?e(d):e(g,!1)}),y(e,o)},$$slots:{default:!0}});var d=te(c,2);we(d,{children:(e,t)=>{fe(e,{action:"close",children:(e,t)=>{be(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=se("Close");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}}),C()}var Nn=T('<div><span class="d-flex text-prewrap align-items-center"><!> <!> <span translate="no"> </span> <!> <!></span></div>');var Un=T('<div class="col-12"><!></div>'),Ln=T('<div class="row pt-4"><div class="col-12"><!></div> <!></div>'),En=T('<div class="col-12"><!></div>'),zn=T('<div class="container-fluid"><div class="row"><!> <div class="col-6"><!></div> <div class="col-6"><!></div></div></div>'),Gn=T("<!> <!> <!>",1);function Hn(e,t){x(t,!0);let o=R(t,"open",7),n=R(t,"title",3,""),r=R(t,"defaultRow",3,5),l=R(t,"textLabel",3,""),a=O(i(t.isWord&&t.prevText?t.prevText:""));{let i=f(()=>t.isForced?"":"close"),s=f(()=>t.isForced?"":"close");ge(e,{surface$style:"width: 400px; max-width: calc(100vw - 32px);",onSMUIDialogClosed:function(e){t.isWord?t.closeHandler(e,v(a)):t.closeHandler(e),t.onclose()},get scrimClickAction(){return v(i)},get escapeKeyAction(){return v(s)},get open(){return o()},set open(e){o(e)},children:(e,o)=>{var i=Gn(),s=B(i);pe(s,{class:"px-3 pb-0 toolbar toolbar__dialog",children:(e,t)=>{var o=k(),i=B(o);M(i,n),y(e,o)},$$slots:{default:!0}});var c=te(s,2);me(c,{children:(e,o)=>{var i=Ln(),n=D(i),s=D(n);M(s,()=>t.context);var c=te(n,2),d=e=>{var t=Un(),o=D(t),i=e=>{Tn(e,{get label(){return l()},variant:"filled",get value(){return v(a)},set value(e){F(a,e,!0)}})},n=e=>{Tn(e,{textarea:!0,get label(){return l()},variant:"filled",get input$rows(){return r()},get value(){return v(a)},set value(e){F(a,e,!0)}})};ee(o,e=>{1===r()?e(i):e(n,!1)}),y(e,t)};ee(c,e=>{t.isWord&&e(d)}),y(e,i)},$$slots:{default:!0}});var d=te(c,2);we(d,{children:(e,o)=>{var i=zn(),n=D(i),r=D(n),l=e=>{var t=En(),o=D(t);fe(o,{action:"deselect",children:(e,t)=>{be(e,{children:(e,t)=>{var o=se("Deselect");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),y(e,t)};ee(r,e=>{t.isDeselect&&e(l)});var a=te(r,2),s=D(a);fe(s,{action:"close",get disabled(){return t.isForced},children:(e,t)=>{be(e,{children:(e,t)=>{var o=se("Cancel");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var c=te(a,2),d=D(c);fe(d,{action:"accept",children:(e,t)=>{be(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=se("OK");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),y(e,i)},$$slots:{default:!0}}),y(e,i)},$$slots:{default:!0}})}C()}var _n=T('<i class="mdi mdi-play"></i>'),Yn=T('<i class="mdi mdi-clipboard-outline"></i>'),Jn=T('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div> <div class="col-sm-10 col-8"><div class="col-12 pt-1"><div> </div> <div> </div></div></div> <div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div></div>'),Zn=T('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-12" style="height: 48px">Empty</div></div>'),Xn=T('<i class="mdi mdi-alpha-a-box-outline"></i>'),Kn=T('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div> <div class="col-sm-11 col-10"><div class="col-12 pt-1"><div> </div> <div> </div></div></div></div>'),Qn=T('<i class="mdi mdi-play"></i>'),er=T('<i class="mdi mdi-trash-can"></i>'),tr=T('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div> <div class="col-sm-10 col-8"><div class="col-12 pt-1"><div> </div> <div> </div></div></div> <div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div></div>'),or=T('<i class="mdi mdi-content-save"></i>'),ir=T('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div> <div class="col-sm-11 col-10"><div class="col-12"><!></div></div></div>'),nr=T("<!> <!>",1),rr=T('<i class="mdi mdi-menu-left"></i>'),lr=T('<i class="mdi mdi-menu-right"></i>'),ar=T('<div class="container-fluid pb-2 mb-2" style="border: 1px solid"><!></div> <div class="row gy-2"><div class="col pb-2"><!></div> <div class="col pb-2"><div class="d-row align-items-center justify-end"><!> <span class="list-text px-2"> </span> <!></div></div></div> <div class="row gy-2"><div class="col-12"><!></div></div>',1),sr=T("<!> <!> <!>",1),cr=T("<!> <!>",1);function dr(e,t){x(t,!0);let o=R(t,"open",7);const i={action:()=>{},title:"Warning",context:""};let n=O("none"),r=O(1),l=f(()=>9*(v(r)-1)),a=f(()=>Math.min(v(l)+9-1,99)),s=f(()=>Array.from({length:v(a)-v(l)+1},(e,t)=>Qt[v(l)+t])),c=f(()=>Array.from({length:v(a)-v(l)+1},(e,t)=>eo[v(l)+t])),d=O(!1),u=f(()=>9*(v(r)-1));function g(e){const t="".concat(location.pathname.replace(/\/index\.html$/,"/"),"slot-").concat(e),o=navigator.language,i=new Date,n=new Intl.DateTimeFormat(o,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(i);!async function(e,t,o,i,n){const r=(await co()).transaction(i,"readwrite").objectStore(i);try{await new Promise((o,i)=>{const n=r.put(e,t);n.onsuccess=()=>o(),n.onerror=()=>i(n.error)}),n&&(Qt[o].stored=!0,Qt[o].time=e.time,Qt[o].name=e.name)}catch(l){console.error(l)}}({stored:!0,name:Qt[e].name,time:n,app:ho()},t,e,"buildStore",!0)}function p(e){!async function(e,t,o,i){const n=(await co()).transaction(o,"readwrite").objectStore(o);try{await new Promise((t,o)=>{const i=n.delete(e);i.onsuccess=()=>t(),i.onerror=()=>o(i.error)}),i&&(Qt[t].stored=!1,Qt[t].name="Slot ".concat(t+1),Qt[t].time="")}catch(r){console.error(r)}}("".concat(location.pathname.replace(/\/index\.html$/,"/"),"slot-").concat(e),e,"buildStore",!0)}var m=cr(),h=B(m);ge(h,{surface$style:"width: 700px; max-width: calc(100vw - 32px);",get onSMUIDialogClosed(){return t.onclose},id:"dialog",get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=sr(),l=B(o);pe(l,{class:"text-left dialog-title",tabindex:0,autofocus:!0,children:(e,t)=>{var o=se("Save/Load Build");y(e,o)},$$slots:{default:!0}});var a=te(l,2);me(a,{class:"pt-3",children:(e,t)=>{var o=ar(),l=B(o),a=D(l),m=e=>{var t=k(),o=B(t);Re(o,17,()=>v(c),$e,(e,t,o)=>{var r=k(),l=B(r),a=e=>{var r=Jn(),l=D(r),a=D(l);Pe(a,{onclickcapture:()=>{i.action=()=>async function(e){const t=v(c)[e].name,o=await mo(t,"buildStore",!0);vi(Array.isArray(o.value)?o.value.join(","):o.value)}(v(u)+o),i.context="Are you sure you want to load this build?<br>Any unsaved changes will be lost.",F(n,"dlgCommon")},children:(e,t)=>{var o=_n();y(e,o)},$$slots:{default:!0}});var s=te(l,2),d=D(s),g=D(d),p=D(g),m=te(g,2),h=D(m),f=te(s,2),b=D(f);Pe(b,{onclickcapture:()=>async function(e){const t=v(c)[e].name,o=await mo(t,"buildStore",!0),i=Array.isArray(o.value)?o.value.join(","):o.value;navigator.clipboard.writeText(i).then(()=>{Zt.labelText="Build code copied to clipboard.",Zt.isOpen=!0}).catch(e=>{Zt.labelText="Failed to copy build code to clipboard.",Zt.isOpen=!0,console.error(e)})}(v(u)+o),children:(e,t)=>{var o=Yn();y(e,o)},$$slots:{default:!0}}),$(()=>{ce(p,v(t).name),ce(h,v(t).time)}),y(e,r)},s=e=>{var t=Zn();y(e,t)};ee(l,e=>{v(t).stored?e(a):e(s,!1)}),y(e,r)}),y(e,t)},h=e=>{var t=nr(),o=B(t),r=e=>{var t=Kn(),o=D(t),r=D(o);Pe(r,{onclickcapture:()=>{i.action=()=>async function(){const e="".concat(location.pathname.replace(/\/index\.html$/,"/"),"autoSave");vi((await mo(e,"buildStore")).app)}(),i.context="Are you sure you want to load this build?<br>Any unsaved changes will be lost.",F(n,"dlgCommon")},children:(e,t)=>{var o=Xn();y(e,o)},$$slots:{default:!0}});var l=te(o,2),a=D(l),s=D(a),c=D(s),d=te(s,2),u=D(d);$(()=>{ce(c,Kt.name),ce(u,Kt.time)}),y(e,t)};ee(o,e=>{Kt.stored&&e(r)});var l=te(o,2);Re(l,17,()=>v(s),$e,(e,t,o)=>{var r=k(),l=B(r),a=e=>{var r=tr(),l=D(r),a=D(l);Pe(a,{onclickcapture:()=>{i.action=()=>async function(e){const t="".concat(location.pathname.replace(/\/index\.html$/,"/"),"slot-").concat(e);vi((await mo(t,"buildStore")).app)}(v(u)+o),i.context="Are you sure you want to load this build?<br>Any unsaved changes will be lost.",F(n,"dlgCommon")},children:(e,t)=>{var o=Qn();y(e,o)},$$slots:{default:!0}});var s=te(l,2),c=D(s),d=D(c),g=D(d),m=te(d,2),h=D(m),f=te(s,2),b=D(f);Pe(b,{onclickcapture:()=>{i.action=()=>p(v(u)+o),i.context="Are you sure you want to delete this build?<br>This action cannot be undone.",F(n,"dlgCommon")},children:(e,t)=>{var o=er();y(e,o)},$$slots:{default:!0}}),$(()=>{ce(g,v(t).name),ce(h,v(t).time)}),y(e,r)},s=e=>{var i=ir(),n=D(i),r=D(n);Pe(r,{onclickcapture:()=>g(v(u)+o),children:(e,t)=>{var o=or();y(e,o)},$$slots:{default:!0}});var l=te(n,2),a=D(l);Tn(D(a),{onclickcapture:()=>v(t).name="",onblur:()=>{""===v(t).name&&(v(t).name="Slot ".concat(v(u)+o+1))},input$onkeydown:e=>{"Enter"===e.key&&g(v(u)+o)},class:"textbox-mini",variant:"standard",get value(){return v(t).name},set value(e){v(t).name=e}}),y(e,i)};ee(l,e=>{v(t).stored?e(a):e(s,!1)}),y(e,r)}),y(e,t)};ee(a,e=>{v(d)?e(m):e(h,!1)});var f=te(l,2),b=D(f),w=D(b);he(w,{style:"height: 48px",label:e=>{var t=se("Load from Legacy Version");y(e,t)},children:(e,t)=>{ve(e,{onSMUISwitchChange:()=>F(r,1),color:"secondary",class:"switch-scale",get checked(){return v(d)},set checked(e){F(d,e,!0)}})},$$slots:{label:!0,default:!0}});var T=te(b,2),I=D(T),S=D(I);Pe(S,{onclickcapture:()=>v(r)>1?F(r,v(r)-1):F(r,11),children:(e,t)=>{var o=rr();y(e,o)},$$slots:{default:!0}});var C=te(S,2),x=D(C),O=te(C,2);Pe(O,{onclickcapture:()=>v(r)<11?F(r,v(r)+1):F(r,1),children:(e,t)=>{var o=lr();y(e,o)},$$slots:{default:!0}});var A=te(f,2),M=D(A),R=D(M);fe(R,{onclickcapture:()=>F(n,"appBuildForm"),variant:"raised",children:(e,t)=>{be(e,{children:(e,t)=>{var o=se("Open Build Form");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),$(()=>{var e;return ce(x,"Page ".concat(null!=(e=v(r))?e:""))}),y(e,o)},$$slots:{default:!0}});var m=te(a,2);we(m,{children:(e,t)=>{fe(e,{action:"close",children:(e,t)=>{be(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=se("Close");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}});var b=te(h,2),w=e=>{{let t=f(()=>"dlgCommon"===v(n));Hn(e,{get open(){return v(t)},onclose:()=>F(n,"none"),get title(){return i.title},get context(){return i.context},closeHandler:e=>{"accept"===e.detail.action&&i.action()}})}},T=e=>{var t=k(),o=B(t),i=e=>{{let t=f(()=>"appBuildForm"===v(n));yn(e,{get open(){return v(t)},onclose:()=>F(n,"none")})}};ee(o,e=>{"appBuildForm"===v(n)&&e(i)},!0),y(e,t)};ee(b,e=>{"dlgCommon"===v(n)?e(w):e(T,!1)}),y(e,m),C()}var ur=T("<i><!></i>");let gr=0;var pr=(e,t,o)=>{t()||F(o,!0)},mr=(e,t)=>{F(t,-1)},hr=T("<i></i>"),vr=T("<!> <!>",1),fr=T("<!> <!>",1),br=T('<div style="max-height: 288px; overflow-y: auto;"><!></div>'),wr=T('<div><div role="combobox" tabindex="0"><!></div> <!></div>');function Tr(e,t){var o;x(t,!0);let n,r,l=R(t,"use",19,()=>[]),a=R(t,"class",3,""),s=R(t,"options",19,()=>[]),c=R(t,"value",15),d=R(t,"getOptionDisabled",3,()=>!1),u=R(t,"getOptionLabel",3,e=>null==e?"":"".concat(e)),g=R(t,"text",31,()=>i(u()(c()))),m=R(t,"disabled",3,!1),h=R(t,"toggle",3,!1),w=R(t,"combobox",3,!1),T=R(t,"clearOnBlur",19,()=>!w()),I=R(t,"selectOnExactMatch",3,!0),A=R(t,"showMenuWithNoInput",3,!0),M=R(t,"noMatchesActionDisabled",3,!0),N=R(t,"search",3,async e=>{const t=e.toLowerCase(),o="function"==typeof s()?await s()():s()||[];if(""===t)return o;const i=o.filter(e=>u()(e).toLowerCase().includes(t));return i.sort((e,o)=>{const i=u()(e).toLowerCase(),n=u()(o).toLowerCase();return i.startsWith(t)&&!n.startsWith(t)?-1:n.startsWith(t)&&!i.startsWith(t)?1:0}),i}),_=R(t,"menu$class",3,""),Y=R(t,"menu$anchor",3,!1),X=R(t,"menu$anchorCorner",3,"BOTTOM_START"),Q=R(t,"multiple",3,!1),ie=R(t,"isSearch",3,!1),ne=L(t,["$$slots","$$events","$$legacy","use","class","options","value","getOptionDisabled","getOptionLabel","text","label","disabled","toggle","combobox","clearOnBlur","selectOnExactMatch","showMenuWithNoInput","noMatchesActionDisabled","search","menu$class","menu$anchor","menu$anchorCorner","children","loading","error","match","noMatches","multiple","multipleValue","parentElement","onfocuslost","isSearch"]),le=O(i(document.createElement("div"))),ae=O(0),ue=O(!1),ge=O(!1),pe=O(i([])),me=O(-1),he=O(void 0),ve=null!=(o=ne.menu$id)?o:"SMUI-autocomplete-"+gr+++"-menu",fe=O(!1),be=O(24),we=O(!1),Te=O(i([]));const Ie=f(()=>v(ge)&&(""!==g()||A())&&(v(ae)>0||!w()&&!(1===v(pe).length&&v(pe)[0]===c())||h()||w()&&!!v(pe).length&&!(1===v(pe).length&&v(pe)[0]===c())));let Se=g();b(()=>{Se!==g()&&v(ge)&&(Fe(),Se=g())});let Be=!1;b(()=>{s()&&!Be&&(Be=!0,Fe().then(()=>{Be=!1}))});let Me,De=c();async function Fe(){v(ge)&&!function(){if(n)return document.activeElement===n.querySelector("input.mdc-text-field__input")}()&&Ge(),F(ae,v(ae)+1),F(ue,!1);try{const e=await N()(g());if(!1!==e&&(F(pe,e,!0),I())){const e=v(pe).find(e=>u()(e)===g());null!=e&&u()(c())!==g()&&je(e)}}catch(e){F(ue,!0)}F(ae,v(ae)-1)}function je(e,o=!0){if(!de(_e(),"SMUIAutocompleteSelected",e,{bubbles:!0,cancelable:!0}).defaultPrevented)return ie()?(g(u()(e)),Fe(),void p().then(()=>{F(Te,v(pe),!0),He()})):void(Q()&&t.multipleValue?(t.multipleValue.push(e),o&&g("")):(o&&g(u()(e)),c(e),o||(De=e),p().then(()=>He())))}function qe(e,o=!0){if(!de(_e(),"SMUIAutocompleteDeselected",e,{bubbles:!0,cancelable:!0}).defaultPrevented)if(Q()&&t.multipleValue){let o=t.multipleValue.indexOf(e);t.multipleValue.splice(o,1)}else o&&g(""),c(void 0),o||(De=void 0),F(be,24)}function Pe(){return r?r.getOrderedList().filter(e=>!e.disabled):[]}async function We(e){var o;document.hasFocus()?(null==(o=e.currentTarget)?void 0:o.contains(e.relatedTarget))||(v(ge)&&t.onfocuslost&&t.onfocuslost(),F(me,-1),F(ge,!1),T()&&(null==c()?g(""):""==g()&&qe(c()))):ze(window,"focus",()=>{var t;(null==(t=_e())?void 0:t.contains(document.activeElement))||We(e)},{once:!0})}function Ge(){if(n){const e=n.querySelector("input.mdc-text-field__input");e&&e.focus()}}function He(){if(n){const e=n.querySelector("input.mdc-text-field__input");e&&e.blur(),v(fe)&&F(fe,!1)}}function _e(){return v(le)}function Ye(){function e(){for(let e=0;e<v(pe).length;e++){let o=v(pe)[e];v(we)?t.multipleValue&&t.multipleValue.includes(o)&&qe(o):t.multipleValue&&!t.multipleValue.includes(o)&&je(o)}F(we,!v(we))}app.checkSelectAll?(_t.currentDialog="dlgCommon",_t.context="Are you sure you want to ".concat(v(we)?"deselect":"select"," all items?"),_t.title="",_t.cFunc=t=>{"accept"===t.detail.action&&e()}):e()}function Je(e){const t=e.target;t.scrollTop+t.clientHeight>=t.scrollHeight-48&&F(be,Math.min(v(be)+12,v(pe).length),!0)}b(()=>{De!==c()?(g(u()(c())),De=c()):w()&&c()!==g()&&(c(g()),De=c())}),b(()=>{if(Me!==v(me)){const o=Pe();-1===v(me)?F(he,void 0):(F(he,o[v(me)],!0),v(he)&&(v(he).activated=!0,e=v(he).element,(t=e.getBoundingClientRect()).top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)||v(he).element.scrollIntoView({block:"end",inline:"nearest"}))),o.forEach((e,t)=>{t!==v(me)&&(e.activated=!1)}),r&&r.getOrderedList().forEach(e=>{e.tabindex=-1}),Me=v(me)}var e,t}),Z("SMUI:list:mount",e=>{r||(r=e)});var Ze={get sResult(){return v(Te)},set sResult(e){F(Te,i(e))},focus:Ge,blur:He,getElement:_e,isExpanded:function(){return v(Ie)}},Xe=wr(),Ke=e=>{var o;m()||We(e),null==(o=t.onfocusout)||o.call(t,e)};z(Xe,(e,t)=>({class:e,...t,onfocusout:Ke}),[()=>G({"smui-autocomplete":!0,[a()]:!0}),()=>oe(ne,["menu$","textfield$","list$"])]);var Qe=D(Xe);Qe.__focusin=[pr,m,ge],Qe.__input=[mr,me];var et=D(Qe),tt=e=>{var o=k(),i=B(o);j(i,()=>{var e;return null!=(e=t.children)?e:q}),y(e,o)},ot=e=>{var o=k(),n=B(o),r=e=>{{const o=e=>{!function(e,t){x(t,!0);const[o,n]=Ae();let r,l=R(t,"use",19,()=>[]),a=R(t,"class",3,""),s=R(t,"tabindex",19,()=>"button"===t.role?0:-1),c=R(t,"disabled",3,!1),d=L(t,["$$slots","$$events","$$legacy","use","class","role","tabindex","disabled","children"]),u=O(void 0),g=new K,p=i({});const m=J("SMUI:textfield:icon:leading"),h=Oe(m,"$leadingStore",o);let b=O(void 0);const w=f(()=>({role:t.role,tabindex:s()})),T=J("SMUI:textfield:leading-icon:mount"),I=J("SMUI:textfield:leading-icon:unmount"),A=J("SMUI:textfield:trailing-icon:mount"),M=J("SMUI:textfield:trailing-icon:unmount");function V(e){var t;return e in p?null!=(t=p[e])?t:null:U().getAttribute(e)}function W(e,t){p[e]!==t&&(p[e]=t)}function N(e){e in p&&null==p[e]||(p[e]=void 0)}function U(){return r}E(()=>(F(u,new Ve({getAttr:V,setAttr:W,removeAttr:N,setContent:e=>{F(b,e,!0)},registerInteractionHandler:(e,t)=>g.on(U(),e,t),deregisterInteractionHandler:(e,t)=>g.off(U(),e,t),notifyIconAction:()=>de(U(),"SMUITextFieldIcon")}),!0),h?T&&T(v(u)):A&&A(v(u)),v(u).init(),()=>{var e;v(u)&&(h?I&&I(v(u)):M&&M(v(u))),null==(e=v(u))||e.destroy(),g.clear()}));var _={getElement:U},Y=ur();z(Y,e=>({class:e,"aria-hidden":-1===s()?"true":"false","aria-disabled":"button"===t.role?c()?"true":"false":void 0,...v(w),...p,...d}),[()=>G({[a()]:!0,"mdc-text-field__icon":!0,"mdc-text-field__icon--leading":h,"mdc-text-field__icon--trailing":!h})]);var Z=D(Y),X=e=>{var o=k(),i=B(o);j(i,()=>{var e;return null!=(e=t.children)?e:q}),y(e,o)},Q=e=>{var t=se();$(()=>ce(t,v(b))),y(e,t)};ee(Z,e=>{null==v(b)?e(X):e(Q,!1)}),S(Y,e=>r=e,()=>r),P(Y,(e,t)=>{var o;return null==(o=H)?void 0:o(e,t)},l),y(e,Y);var te=C(_);n()}(e,{class:"mdi mdi-magnify"})};let n=f(()=>re(ne,"textfield$"));Tn(e,U({get label(){return t.label},get disabled(){return m()}},()=>v(n),{onclick:e=>{const t=e.target;t&&t.classList.contains("mdc-text-field__input")&&F(fe,!v(fe))},input$enterkeyhint:"search",get value(){return g()},set value(e){g(e)},leadingIcon:o,$$slots:{leadingIcon:!0}}))}},l=e=>{{let o=f(()=>re(ne,"textfield$"));Tn(e,U({get label(){return t.label},get disabled(){return m()}},()=>v(o),{onclick:e=>{const t=e.target;t&&t.classList.contains("mdc-text-field__input")&&F(fe,!v(fe))},get value(){return g()},set value(e){g(e)}}))}};ee(n,e=>{ie()?e(r):e(l,!1)}),y(e,o)};ee(et,e=>{t.children?e(tt):e(ot,!1)}),S(Qe,e=>n=e,()=>n);var it=te(Qe,2);{let e=f(()=>G({[_()]:!0,"smui-autocomplete__menu":!0})),o=f(()=>re(ne,"menu$"));ye(it,U({get class(){return v(e)},get id(){return ve},managed:!0,neverRestoreFocus:!0,get open(){return v(Ie)},get anchor(){return Y()},get anchorCorner(){return X()}},()=>v(o),{style:"overflow-y: hidden",get anchorElement(){return v(le)},set anchorElement(e){F(le,e,!0)},children:(e,o)=>{var i=br(),n=D(i);{let e=f(()=>re(ne,"list$"));Ce(n,U(()=>v(e),{children:(e,o)=>{var i=k(),n=B(i),r=e=>{ke(e,{disabled:!0,children:(e,o)=>{var i=k(),n=B(i),r=e=>{var o=k(),i=B(o);j(i,()=>t.loading),y(e,o)},l=e=>{Ne(e,{children:(e,t)=>{var o=se("Loading...");y(e,o)},$$slots:{default:!0}})};ee(n,e=>{t.loading?e(r):e(l,!1)}),y(e,i)},$$slots:{default:!0}})},l=e=>{var o=k(),i=B(o),n=e=>{ke(e,{disabled:!0,children:(e,o)=>{var i=k(),n=B(i),r=e=>{var o=k(),i=B(o);j(i,()=>t.error),y(e,o)},l=e=>{Ne(e,{children:(e,t)=>{var o=se("Error while fetching suggestions.");y(e,o)},$$slots:{default:!0}})};ee(n,e=>{t.error?e(r):e(l,!1)}),y(e,i)},$$slots:{default:!0}})},r=e=>{var o=fr(),i=B(o),n=e=>{ke(e,{onSMUIAction:Ye,onfocusin:e=>{e.preventDefault(),Ge()},class:"b-line",children:(e,t)=>{Ne(e,{children:(e,t)=>{var o=se();$(()=>ce(o,v(we)?"Deselect All":"Select All")),y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};ee(i,e=>{Q()&&v(pe).length>0&&e(n)});var r=te(i,2);Re(r,17,()=>v(pe).slice(0,v(be)),$e,(e,o)=>{{let i=f(()=>d()(v(o))),n=f(()=>v(o)===c());ke(e,{get disabled(){return v(i)},get selected(){return v(n)},onSMUIAction:()=>{return h()?(e=v(o),void(Q()?t.multipleValue&&t.multipleValue.includes(e)?qe(e):je(e):e===c()?qe(e):je(e))):je(v(o));var e},onfocusin:e=>{e.preventDefault(),Ge()},children:(e,i)=>{var n=k(),r=B(n),l=e=>{var i=k(),n=B(i);j(n,()=>t.match,()=>v(o)),y(e,i)},a=e=>{var i=vr(),n=B(i),r=e=>{var i=hr();$(e=>V(i,1,e),[()=>W(t.multipleValue&&t.multipleValue.includes(v(o))?"mdi mdi-checkbox-outline button-icons":"mdi mdi-checkbox-blank-outline button-icons")]),y(e,i)};ee(n,e=>{Q()&&e(r)});var l=te(n,2);Ne(l,{children:(e,t)=>{var i=se();$(e=>ce(i,e),[()=>u()(v(o))]),y(e,i)},$$slots:{default:!0}}),y(e,i)};ee(r,e=>{t.match?e(l):e(a,!1)}),y(e,n)},$$slots:{default:!0}})}},e=>{ke(e,{get disabled(){return M()},onSMUIAction:e=>de(_e(),"SMUIAutocompleteNoMatchesAction",e),children:(e,o)=>{var i=k(),n=B(i),r=e=>{var o=k(),i=B(o);j(i,()=>t.noMatches),y(e,o)},l=e=>{Ne(e,{children:(e,t)=>{var o=se("No matches found.");y(e,o)},$$slots:{default:!0}})};ee(n,e=>{t.noMatches?e(r):e(l,!1)}),y(e,i)},$$slots:{default:!0}})}),y(e,o)};ee(i,e=>{v(ue)?e(n):e(r,!1)},!0),y(e,o)};ee(n,e=>{v(ae)?e(r):e(l,!1)}),y(e,i)},$$slots:{default:!0}}))}Ue("scroll",i,Je),y(e,i)},$$slots:{default:!0}}))}return S(Xe,e=>F(le,e),()=>v(le)),P(Xe,e=>{var t;return null==(t=xe)?void 0:t(e)}),P(Xe,(e,t)=>{var o;return null==(o=H)?void 0:o(e,t)},l),$(()=>{Le(Qe,"aria-controls",ve),Le(Qe,"aria-expanded",v(Ie)?"true":"false")}),Ue("keydown",Qe,function(e){if(!w()||v(pe).length)if("ArrowDown"===e.key)e.preventDefault(),-1===v(me)||v(me)===Pe().length-1?F(me,0):Ee(me);else if("ArrowUp"===e.key)e.preventDefault(),-1===v(me)||0===v(me)?F(me,Pe().length-1):Ee(me,-1);else if("Enter"===e.key){e.preventDefault();const t=Pe();v(he)?(t[v(me)]&&t[v(me)].action(e),F(me,-1)):""!=g()&&(Fe(),ie()&&p().then(()=>{F(Te,v(pe),!0),He()}))}else"Escape"===e.key&&(e.preventDefault(),He())},!0),y(e,Xe),C(Ze)}We(["focusin","input"]);var Ir=T('<div class="col req text-prewrap"><!></div>'),Sr=T('<div class="col req text-prewrap"><!></div>');function yr(e,t){x(t,!0);let o=f(()=>{let e=jt.get(t.required.reqId);return void 0!==e&&void 0!==app.globalRequirements?e.requireds:[]}),i=f(()=>{let e=!1;return t.required.showRequired&&(e=!0,t.required.hideRequired2&&(e=Wo(t.required.requireds)),t.required.hideRequired&&(e=t.required.requireds.length>0?Wo(t.required.requireds)&&!Vo(t.required):!Vo(t.required))),e}),n=f(()=>Fo(bo(t.required)));var r=k(),l=B(r),a=e=>{var i=k(),r=B(i),l=e=>{var i=k(),n=B(i);Re(n,17,()=>v(o),$e,(e,o)=>{var i=k(),n=B(i),r=e=>{var i=k(),n=B(i);I(n,()=>Fo(bo(v(o))),e=>{var i=Ir(),n=D(i);M(n,()=>Ge.sanitize(Fo(bo(v(o))),Et)),$(()=>qe(i,t.scoreText)),y(e,i)}),y(e,i)};ee(n,e=>{v(o).showRequired&&e(r)}),y(e,i)}),y(e,i)},a=e=>{var o=k(),i=B(o);I(i,()=>v(n),e=>{var o=Sr(),i=D(o);M(i,()=>Ge.sanitize(v(n),Et)),$(()=>qe(o,t.scoreText)),y(e,o)}),y(e,o)};ee(r,e=>{"gid"===t.required.type?e(l):e(a,!1)}),y(e,i)};ee(l,e=>{v(i)&&e(a)}),y(e,r),C()}var Cr=T('<img class="me-1" alt=""/>'),xr=T('<img class="mx-1" alt=""/>'),Or=T('<img class="mx-1" alt=""/>'),Ar=T('<img class="ms-1" alt=""/>'),kr=T("<!> <!><!> <!><!> <!><!>",1),Br=T('<p class="m-0 d-flex text-prewrap align-items-center"><!></p>'),Mr=T('<div class="row m-0"><div class="col-12 p-0 m-0 d-flex align-items-center justify-center"><!></div></div>');function Dr(e,t){x(t,!0);let o=f(()=>t.addon?t.addon:t.choice),i=f(()=>Ro("privateTextIsOn",t.row,t.choice)),n=f(()=>Ro("privateFilterIsOn",t.row,t.choice)),r=f(()=>Mt.get(t.score.id)),l=f(()=>Wo(v(o).requireds)),a=f(()=>{let e={isWithinCount:!1,isSimple:!1};if(!t.score.discountIsOn||!t.score.discountedFrom||0===t.score.discountedFrom.length)return e;for(let o=0;o<t.score.discountedFrom.length;o++){const i=Ft.get(t.score.discountedFrom[o]);if(void 0!==i){const t=i.choice;if(!t.useDiscountCount||void 0===t.discountCount||!t.appliedDisChoices){e.isSimple=!0;break}if((t.isSelectableMultiple&&t.isMultipleUseVariable?t.discountCount*t.multipleUseVariable:t.discountCount)>t.appliedDisChoices.length){e.isWithinCount=!0;break}}}return e}),s=f(()=>{let e=[];if(t.score.discountIsOn&&t.score.discountShow&&t.score.discountAfterText)if(t.score.appliedDiscount)t.score.replaceText||e.push("".concat(t.score.afterText)),e.push("".concat(t.score.discountAfterText));else if(v(a).isWithinCount)t.score.replaceText||e.push("".concat(t.score.afterText)),e.push("".concat(t.score.discountAfterText));else if(v(a).isSimple)t.score.replaceText||e.push("".concat(t.score.afterText)),e.push("".concat(t.score.discountAfterText));else if(void 0!==t.score.tmpDiscount){let o=t.score.value,i="",n=!1;for(let e=0;e<t.score.tmpDiscount.length;e++)t.score.tmpDiscount[e].showDiscount&&o>t.score.tmpDiscount[e].discountedValue&&(o=t.score.tmpDiscount[e].discountedValue,i=t.score.tmpDiscount[e].beforeText||"",n=t.score.tmpDiscount[e].replaceText||!1);n||e.push("".concat(t.score.afterText)),e.push("".concat(i))}else e.push("".concat(t.score.afterText));else e.push("".concat(t.score.afterText));return e.join(" ")}),c=f(()=>{let e=[];if(t.score.discountIsOn&&t.score.discountShow&&t.score.discountBeforeText)if(t.score.appliedDiscount)t.score.replaceText||e.push("".concat(t.score.beforeText)),e.push("".concat(t.score.discountBeforeText));else if(v(a).isWithinCount)t.score.replaceText||e.push("".concat(t.score.beforeText)),e.push("".concat(t.score.discountBeforeText));else if(v(a).isSimple)t.score.replaceText||e.push("".concat(t.score.beforeText)),e.push("".concat(t.score.discountBeforeText));else if(void 0!==t.score.tmpDiscount){let o=t.score.value,i="",n=!1;for(let e=0;e<t.score.tmpDiscount.length;e++)t.score.tmpDiscount[e].showDiscount&&o>t.score.tmpDiscount[e].discountedValue&&(o=t.score.tmpDiscount[e].discountedValue,i=t.score.tmpDiscount[e].beforeText||"",n=t.score.tmpDiscount[e].replaceText||!1);n||e.push("".concat(t.score.beforeText)),e.push("".concat(i))}else e.push("".concat(t.score.beforeText));else e.push("".concat(t.score.beforeText));return e.join(" ")}),d=f(()=>{var e,i;let n=t.score.value;if(!t.score.hideValue){if(t.score.isRandom&&!t.score.setValue)return v(u);if(!t.score.setValue&&t.score.useExpression&&t.score.expValue){if(void 0!==Mt.get(t.score.id))try{const e=t.score.expValue.replace(/\{([^{}]+)\}/g,(e,t)=>{const o=Mt.get(t);if(void 0!==o)return"".concat(o.startingSum);throw new Error('Undefined variable: "'.concat(t,'"'))});n=g(e)}catch(l){console.error(l)}}if(t.score.discountShow)if(t.score.appliedDiscount){if(t.score.replaceText&&t.score.hideDisValue)return"";void 0!==t.score.discountScore&&(n=t.score.discountScore)}else if(v(a).isWithinCount||v(a).isSimple){if(t.score.replaceText&&t.score.hideDisValue)return"";if(t.score.useExpression&&t.score.expValue){if(t.score.discountedFrom&&t.score.discountedFrom.length>0)for(let e=0;e<t.score.discountedFrom.length;e++){const o=Ft.get(t.score.discountedFrom[e]);if(void 0!==o){const e=o.choice;n=Ho(n,e.discountOperator,e.discountValue),e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(n=Math.max(n,e.discountLowLimit))}}}else void 0!==t.score.discountScore&&(n=t.score.discountScore)}else if(void 0!==t.score.tmpDiscount){let e=!1;for(let o=0;o<t.score.tmpDiscount.length;o++)t.score.tmpDiscount[o].showDiscount&&n>t.score.tmpDiscount[o].discountedValue&&(n=t.score.tmpDiscount[o].discountedValue,e=t.score.tmpDiscount[o].hideValue||!1);if(e)return""}if(n=Math.abs(n),n=(null==(e=v(r))?void 0:e.allowFloat)?n%1==0?n:parseFloat(n.toFixed(void 0!==v(r).decimalPlaces?v(r).decimalPlaces:2)):Math.floor(n),v(o).isSelectableMultiple&&v(o).isMultipleUseVariable&&t.score.multiplyByTimes&&t.score.displayMulScore&&(n*=v(o).multipleUseVariable+1),null==(i=v(r))?void 0:i.plussOrMinusAdded){let e=v(r).plussOrMinusInverted?v(p)?"-":"+":v(p)?"+":"-";return"".concat(e).concat(n)}return"".concat(n)}return""}),u=f(()=>{var e,o;let i=0,n=0,l=!1,a=!1;if(t.score.useExpression){if(t.score.expMaxValue)try{const e=t.score.expMaxValue.replace(/\{([^{}]+)\}/g,(e,t)=>{const o=Mt.get(t);if(void 0!==o)return"".concat(o.startingSum);throw new Error('Undefined variable: "'.concat(t,'"'))});i=g(e),l=i<0}catch(s){console.error(s)}if(t.score.expMinValue)try{const e=t.score.expMinValue.replace(/\{([^{}]+)\}/g,(e,t)=>{const o=Mt.get(t);if(void 0!==o)return"".concat(o.startingSum);throw new Error('Undefined variable: "'.concat(t,'"'))});n=g(e),a=n<0}catch(s){console.error(s)}}else void 0!==t.score.maxValue&&void 0!==t.score.minValue&&(l=t.score.maxValue<0,a=t.score.minValue<0,i=Math.abs(t.score.maxValue),n=Math.abs(t.score.minValue));if((null==(e=v(r))?void 0:e.allowFloat)?(i=i%1==0?i:parseFloat(i.toFixed(void 0!==v(r).decimalPlaces?v(r).decimalPlaces:2)),n=n%1==0?n:parseFloat(n.toFixed(void 0!==v(r).decimalPlaces?v(r).decimalPlaces:2))):(i=Math.floor(i),n=Math.floor(n)),null==(o=v(r))?void 0:o.plussOrMinusAdded){let e=v(r).plussOrMinusInverted?l?"-":"+":l?"+":"-",t=v(r).plussOrMinusInverted?a?"-":"+":a?"+":"-";return l?"".concat(e).concat(i," ~ ").concat(t).concat(n):"".concat(t).concat(n," ~ ").concat(e).concat(i)}return l?"".concat(i," ~ ").concat(n):"".concat(n," ~ ").concat(i)}),p=f(()=>t.score.discountShow?(void 0!==t.score.discountScore&&(t.score.appliedDiscount||v(a).isWithinCount||v(a).isSimple)?t.score.discountScore:t.score.value)<0:t.score.value<0),m=f(()=>{var e;let t=[];return t.push("font-family: '".concat(v(i).scoreText,"'; font-size: ").concat(v(i).scoreTextSize,"%; text-align: ").concat(v(i).scoreTextAlign,";")),(null==(e=v(r))?void 0:e.pointColorsIsOn)?v(p)?t.push("color: ".concat(en(v(r).positiveColor),";")):t.push("color: ".concat(en(v(r).negativeColor),";")):t.push("color: ".concat(en(v(i).scoreTextColor),";")),v(l)?v(o).isActive&&v(n).selScoreTextColorIsOn&&t.push("color: ".concat(en(v(n).selFilterSTextColor))):v(n).reqScoreTextColorIsOn&&t.push("color: ".concat(en(v(n).reqFilterSTextColor))),t.join(" ")}),h=f(()=>{if(!v(r)||!v(r).iconIsOn)return!1;if(t.score.discountIsOn&&t.score.discountShow)if(t.score.appliedDiscount){if(t.score.replaceText&&t.score.hideDisIcon)return!1}else if(v(a).isWithinCount){if(t.score.replaceText&&t.score.hideDisIcon)return!1}else if(v(a).isSimple){if(t.score.hideDisIcon)return!1}else if(void 0!==t.score.tmpDiscount){let e=t.score.value,o=!1;for(let i=0;i<t.score.tmpDiscount.length;i++)t.score.tmpDiscount[i].showDiscount&&e>t.score.tmpDiscount[i].discountedValue&&(e=t.score.tmpDiscount[i].discountedValue,o=t.score.tmpDiscount[i].hideIcon||!1);if(o)return!1}return!0}),b=f(()=>{var e;return(null==(e=v(r))?void 0:e.negativeIconIsOn)&&v(p)}),w=f(()=>!!v(r)&&(v(b)?v(r).useSeperatePosition?!!v(r).negativeImageSidePlacementInChoice:!!v(r).negativeImageSidePlacement:v(r).useSeperatePosition?!!v(r).imageSidePlacementInChoice:!!v(r).imageSidePlacement)),T=f(()=>!!v(r)&&(v(b)?v(r).useSeperatePosition?!!v(r).negativeImageOnSideInChoice:!!v(r).negativeImageOnSide:v(r).useSeperatePosition?!!v(r).imageOnSideInChoice:!!v(r).imageOnSide)),S=f(()=>{var e,t;return(v(b)?null==(e=v(r))?void 0:e.negativeImage:null==(t=v(r))?void 0:t.image)||""}),O=f(()=>{var e,t;return(v(b)?null==(e=v(r))?void 0:e.negativeIconWidth:null==(t=v(r))?void 0:t.iconWidth)||0}),A=f(()=>{var e,t;return(v(b)?null==(e=v(r))?void 0:e.negativeIconHeight:null==(t=v(r))?void 0:t.iconHeight)||0}),F=f(()=>!v(w)&&!v(T)),R=f(()=>!v(w)&&v(T)),j=f(()=>v(w)&&!v(T)),q=f(()=>v(w)&&v(T)),P=f(()=>"".concat(v(c)," ").concat(v(d)," ").concat(v(s)));var V=k(),W=B(V),N=e=>{var t=Mr(),o=D(t),i=D(o);I(i,()=>v(P),e=>{var t=Br(),o=D(t),i=e=>{var t=kr(),o=B(t),i=e=>{var t=Cr();$(()=>{var e,o;Le(t,"src",v(S)),qe(t,"width: ".concat(null!=(e=v(O))?e:"","px; height: ").concat(null!=(o=v(A))?o:"","px;"))}),y(e,t)};ee(o,e=>{v(F)&&e(i)});var n=te(o,2);M(n,()=>Ge.sanitize(v(c),Et));var r=te(n),l=e=>{var t=xr();$(()=>{var e,o;Le(t,"src",v(S)),qe(t,"width: ".concat(null!=(e=v(O))?e:"","px; height: ").concat(null!=(o=v(A))?o:"","px;"))}),y(e,t)};ee(r,e=>{v(R)&&e(l)});var a=te(r,2);M(a,()=>Ge.sanitize(v(d),Et));var u=te(a),g=e=>{var t=Or();$(()=>{var e,o;Le(t,"src",v(S)),qe(t,"width: ".concat(null!=(e=v(O))?e:"","px; height: ").concat(null!=(o=v(A))?o:"","px;"))}),y(e,t)};ee(u,e=>{v(j)&&e(g)});var p=te(u,2);M(p,()=>Ge.sanitize(v(s),Et));var m=te(p),h=e=>{var t=Ar();$(()=>{var e,o;Le(t,"src",v(S)),qe(t,"width: ".concat(null!=(e=v(O))?e:"","px; height: ").concat(null!=(o=v(A))?o:"","px;"))}),y(e,t)};ee(m,e=>{v(q)&&e(h)}),y(e,t)},n=e=>{var t=k(),o=B(t);M(o,()=>Ge.sanitize("".concat(v(c)," ").concat(v(d)," ").concat(v(s)),Et)),y(e,t)};ee(o,e=>{v(h)?e(i):e(n,!1)}),y(e,t)}),$(()=>qe(o,v(m))),y(e,t)};ee(W,e=>{(function(){if(t.score.showScore){if(void 0!==v(r)&&v(r).isNotShownObjects){if(void 0!==v(r).activatedId&&""!==v(r).activatedId){let e=jt.get(v(r).activatedId),t=Pt.get(v(r).activatedId);return void 0!==e?Wo(e.requireds):void 0!==t?t.isTrue:qo(v(r).activatedId)}return!1}return!0}return!1})()&&Wo(t.score.requireds)&&e(N)}),y(e,V),C()}var Fr=T('<i class="mdi mdi-minus"></i>'),Rr=T('<i class="mdi mdi-plus"></i>'),jr=T('<div class="px-5 w-100 multi-slider"><!></div>'),qr=T('<div class="d-row justify-space-around w-100 multi-counter"><!> <div translate="no"> </div> <!></div> <!>',1);function Pr(e,t){x(t,!0);let o=O(0),i=f(()=>t.addon?t.addon:t.choice),n=f(()=>{if(v(i).isMultipleUseVariable)return v(i).multipleUseVariable;if(void 0!==v(i).multipleScoreId){let e=Mt.get(v(i).multipleScoreId);if(void 0!==e)return e.startingSum}return 0}),r=f(()=>Ro("privateTextIsOn",t.row,t.choice)),l=f(()=>Ro("privateMultiChoiceIsOn",t.row,t.choice)),a=f(()=>"font-family: '".concat(v(l).multiChoiceTextFont,"'; color: ").concat(en(v(r).scoreTextColor),"; font-size: ").concat(v(l).multiChoiceTextSize,"%; align-content: center;")),s=f(()=>"font-size: ".concat(v(l).multiChoiceCounterSize,"%; color: ").concat(en(v(r).scoreTextColor),";"));function c(e){t.selectedOneMore()}function d(e){t.selectedOneLess()}function u(){const e=v(o)-v(n);for(let o=0;o<Math.abs(e);o++)e>0?t.selectedOneMore():t.selectedOneLess();document.activeElement&&document.activeElement.blur()}function g(e){t.isEnabled&&(_t.currentDialog="selectDialog",_t.choice=t.choice,_t.func=p)}function p(e){const o=e-t.choice.multipleUseVariable;for(let i=0;i<Math.abs(o);i++)o>0?t.selectedOneMore():t.selectedOneLess()}b(()=>{t.choice.useSlider&&F(o,v(n),!0)});var m=k(),h=B(m),w=e=>{var r=qr(),l=B(r),p=D(l),m=e=>{{let o=f(()=>!t.isEnabled);Pe(e,{class:"counter-icons",get disabled(){return v(o)},onclickcapture:d,children:(e,t)=>{var o=Fr();$(()=>qe(o,v(s))),y(e,o)},$$slots:{default:!0}})}};ee(p,e=>{v(i).hideCounter||e(m)});var h=te(p,2),b=D(h),w=te(h,2),T=e=>{{let o=f(()=>!t.isEnabled);Pe(e,{class:"counter-icons",get disabled(){return v(o)},onclickcapture:c,children:(e,t)=>{var o=Rr();$(()=>qe(o,v(s))),y(e,o)},$$slots:{default:!0}})}};ee(w,e=>{v(i).hideCounter||e(T)});var I=te(l,2),S=e=>{var n=jr(),r=D(n);{let e=f(()=>!t.isEnabled);He(r,{get min(){return v(i).numMultipleTimesMinus},get max(){return v(i).numMultipleTimesPluss},step:1,class:"mx-2",onpointerup:u,get disabled(){return v(e)},discrete:!0,get value(){return v(o)},set value(e){F(o,e,!0)}})}y(e,n)};ee(I,e=>{v(i).useSlider&&e(S)}),$(()=>{qe(h,v(a)),ce(b,v(n))}),Ue("click",h,g,!0),y(e,r)};ee(h,e=>{v(i).hideCounterUntilSelect&&0===v(i).multipleUseVariable||e(w)}),y(e,m),C()}var $r=T('<img alt=""/>'),Vr=T('<img alt=""/>'),Wr=T('<h3 class="m-0"><!></h3>'),Nr=T("<!> <!>",1),Ur=T("<!> <!>",1),Lr=T('<img alt=""/>'),Er=T('<img alt=""/>'),zr=T('<p class="mb-0"><!></p>'),Gr=T('<img alt=""/>'),Hr=T('<img alt=""/>'),_r=T("<div><!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!></div>"),Yr=T('<img alt=""/>'),Jr=T('<img alt=""/>'),Zr=T('<h2 class="mb-0"><!></h2>'),Xr=T("<!> <!>",1),Kr=T("<!> <!>",1),Qr=T('<p class="mb-0"><!></p>'),el=T('<div class="col p-0 text-center"><!></div> <div class="col p-0 text-center"><!> <!> <!> <!> <!> <!> <!> <!></div>',1),tl=T('<h2 class="mb-0"><!></h2>'),ol=T("<!> <!>",1),il=T("<!> <!>",1),nl=T('<p class="mb-0"><!></p>'),rl=T('<img alt=""/>'),ll=T('<img alt=""/>'),al=T('<div class="col p-0 text-center"><!> <!> <!> <!> <!> <!> <!> <!></div> <div class="col p-0 text-center"><!></div>',1),sl=T('<div class="row m-0 p-0 w-100"><!></div>'),cl=T("<div><!></div>");function dl(e,t){x(t,!0);const o=()=>Oe(io,"$winWidth",i),[i,n]=Ae();let r=R(t,"windowWidth",3,0),l=R(t,"preloadImages",3,!1),a=R(t,"isBackpack",3,!1);const s={linkedObjects:[],mainDiv:t.mainDiv,bCreatorMode:!1,isBackpack:a(),isOverDlg:!1,isOverImg:!1};let c=f(()=>void 0!==t.choice&&t.choice.isActive),d=f(()=>Ro("privateAddonImageIsOn",t.row,t.choice)),u=f(()=>Ro("privateAddonIsOn",t.row,t.choice)),g=f(()=>Ro("privateFilterIsOn",t.row,t.choice)),p=f(()=>Ro("privateObjectImageIsOn",t.row,t.choice)),m=f(()=>Ro("privateObjectIsOn",t.row,t.choice)),h=f(()=>Ro("privateTextIsOn",t.row,t.choice)),b=f(()=>Ro("privateMultiChoiceIsOn",t.row,t.choice)),w=f(()=>Wo(t.addon.requireds)),T=f(()=>Fo(t.addon.title)),S=f(()=>Fo(t.addon.text)),O=f(()=>void 0!==v(d).addonImageBoxWidth?v(d).addonImageBoxWidth:50),A=f(()=>!t.addon.hideMultipleCounter||t.isEnabled),F=f(()=>{let e=v(u).useAddonDesign,o=(e?v(u).addonBorderRadiusIsPixels:v(m).objectBorderRadiusIsPixels)?"px":"%";const i={},n={};return e&&(v(u).addonBorderImage&&(i.borderImage="border-image: url('".concat(v(u).addonBorderImage,"') ").concat(v(u).addonBorderImageSliceTop," ").concat(v(u).addonBorderImageSliceRight," ").concat(v(u).addonBorderImageSliceBottom," ").concat(v(u).addonBorderImageSliceLeft," / ").concat(v(u).addonBorderImageWidth,"px ").concat(v(u).addonBorderImageRepeat,"; border-style: solid; padding: ").concat(v(u).addonBorderImageWidth,"px;")),v(u).useAddonBackgroundImage&&v(u).addonBackgroundImage&&(i.bgImage="background-image: url('".concat(v(u).addonBackgroundImage,"'); ").concat(v(u).isObjectBackgroundRepeat?"background-repeat: repeat;":v(u).isObjectBackgroundFitIn?"background-size: 100% 100%;":"background-size: cover;")),v(u).addonBgColorIsOn&&(i.bgColor="background-color: ".concat(en(v(u).addonBgColor),";")),i.margin="margin: ".concat(v(u).addonMargin,"px;"),i.borderRadius="border-radius: ".concat(v(u).addonBorderRadiusTopLeft).concat(o," ").concat(v(u).addonBorderRadiusTopRight).concat(o," ").concat(v(u).addonBorderRadiusBottomRight).concat(o," ").concat(v(u).addonBorderRadiusBottomLeft).concat(o,";"),v(u).addonOverflowIsOn&&(i.overflow="overflow: hidden;"),v(u).addonBorderIsOn&&(i.border="border: ".concat(v(u).addonBorderWidth,"px ").concat(v(u).addonBorderStyle," ").concat(en(v(u).addonBorderColor),";")),v(u).addonGradientIsOn&&(i.bgImage="background-image: linear-gradient(".concat(v(u).addonGradient,");")),v(u).addonDropShadowIsOn&&(v(u).addonUseBoxShadowIsOn?i.boxShadow="box-shadow: ".concat(v(u).addonDropShadowH,"px ").concat(v(u).addonDropShadowV,"px ").concat(v(u).addonDropShadowBlur,"px ").concat(v(u).addonDropShadowSpread,"px ").concat(en(v(u).addonDropShadowColor),";"):n.dropShadow=" drop-shadow(".concat(v(u).addonDropShadowH,"px ").concat(v(u).addonDropShadowV,"px ").concat(v(u).addonDropShadowBlur,"px ").concat(en(v(u).addonDropShadowColor),")"))),t.isEnabled&&v(w)?t.addon.isActive||v(c)&&!t.addon.isSelectable?(e&&(v(g).selBorderColorIsOn&&(i.border="border: ".concat(v(u).addonBorderWidth,"px ").concat(v(u).addonBorderStyle," ").concat(en(v(g).selFilterBorderColor),";")),v(u).addonGradientIsOn&&(i.bgImage="background-image: linear-gradient(".concat(v(u).addonGradientOnSelect,");"))),t.addon.isSelectable&&(v(g).selBgColorIsOn&&(i.bgColor="background-color: ".concat(en(v(g).selFilterBgColor),";")),v(g).selFilterBlurIsOn&&(n.blur=" blur(".concat(v(g).selFilterBlur,"px)")),v(g).selFilterBrightIsOn&&(n.brightness=" brightness(".concat(v(g).selFilterBright,"%)")),v(g).selFilterContIsOn&&(n.contrast=" contrast(".concat(v(g).selFilterCont,"%)")),v(g).selFilterGrayIsOn&&(n.grayscale=" grayscale(".concat(v(g).selFilterGray,"%)")),v(g).selFilterHueIsOn&&(n.hueRotate=" hue-rotate(".concat(v(g).selFilterHue,"deg)")),v(g).selFilterInvertIsOn&&(n.invert=" invert(".concat(v(g).selFilterInvert,"%)")),v(g).selFilterOpacIsOn&&(n.opacity=" opacity(".concat(v(g).selFilterOpac,"%)")),v(g).selFilterSaturIsOn&&(n.saturate=" saturate(".concat(v(g).selFilterSatur,")")),v(g).selFilterSepiaIsOn&&(n.sepia=" sepia(".concat(v(g).selFilterGray,"%)")))):t.addon.isSelectable&&(e?v(u).objectGradientIsOn&&(i.bgImage="background-image: linear-gradient(".concat(v(u).addonGradient,");")):v(m).objectGradientIsOn&&(i.bgImage="background-image: linear-gradient(".concat(v(m).objectGradient,");")),v(g).unselFilterBlurIsOn&&(n.blur=" blur(".concat(v(g).unselFilterBlur,"px)")),v(g).unselFilterBrightIsOn&&(n.brightness=" brightness(".concat(v(g).unselFilterBright,"%)")),v(g).unselFilterContIsOn&&(n.contrast=" contrast(".concat(v(g).unselFilterCont,"%)")),v(g).unselFilterGrayIsOn&&(n.grayscale=" grayscale(".concat(v(g).unselFilterGray,"%)")),v(g).unselFilterHueIsOn&&(n.hueRotate=" hue-rotate(".concat(v(g).unselFilterHue,"deg)")),v(g).unselFilterInvertIsOn&&(n.invert=" invert(".concat(v(g).unselFilterInvert,"%)")),v(g).unselFilterOpacIsOn&&(n.opacity=" opacity(".concat(v(g).unselFilterOpac,"%)")),v(g).unselFilterSaturIsOn&&(n.saturate=" saturate(".concat(v(g).unselFilterSatur,")")),v(g).unselFilterSepiaIsOn&&(n.sepia=" sepia(".concat(v(g).unselFilterGray,"%)"))):(t.addon.isSelectable||t.isEnabled)&&(e?(v(g).reqBorderColorIsOn&&(i.border="border: ".concat(v(u).addonBorderWidth,"px ").concat(v(u).addonBorderStyle," ").concat(en(v(g).reqFilterBorderColor),";")),v(u).addonGradientIsOn&&(i.bgImage="background-image: linear-gradient(".concat(v(u).addonGradientOnReq,");"))):t.addon.isSelectable&&(v(g).reqBorderColorIsOn&&(i.border="border: ".concat(v(m).objectBorderWidth,"px ").concat(v(m).objectBorderStyle," ").concat(en(v(g).reqFilterBorderColor),";")),v(m).objectGradientIsOn&&(i.bgImage="background-image: linear-gradient(".concat(v(m).objectGradientOnReq,");"))),v(g).reqBgColorIsOn&&(i.bgColor="background-color: ".concat(en(v(g).reqFilterBgColor),";")),v(g).reqFilterBlurIsOn&&(n.blur=" blur(".concat(v(g).reqFilterBlur,"px)")),v(g).reqFilterBrightIsOn&&(n.brightness=" brightness(".concat(v(g).reqFilterBright,"%)")),v(g).reqFilterContIsOn&&(n.contrast=" contrast(".concat(v(g).reqFilterCont,"%)")),v(g).reqFilterGrayIsOn&&(n.grayscale=" grayscale(".concat(v(g).reqFilterGray,"%)")),v(g).reqFilterHueIsOn&&(n.hueRotate=" hue-rotate(".concat(v(g).reqFilterHue,"deg)")),v(g).reqFilterInvertIsOn&&(n.invert=" invert(".concat(v(g).reqFilterInvert,"%)")),v(g).reqFilterOpacIsOn&&(n.opacity=" opacity(".concat(v(g).reqFilterOpac,"%)")),v(g).reqFilterSaturIsOn&&(n.saturate=" saturate(".concat(v(g).reqFilterSatur,")")),v(g).reqFilterSepiaIsOn&&(n.sepia=" sepia(".concat(v(g).reqFilterGray,"%)"))),Object.keys(n).length>0&&(i.filter="filter:".concat(Object.values(n).join(""),";")),Object.values(i).join(" ")}),j=f(()=>{let e=[];return e.push("white-space: pre-line; font-family: '".concat(v(h).addonTitle,"'; font-size: ").concat(v(h).addonTitleTextSize,"%; text-align: ").concat(v(h).addonTitleAlign,";")),!t.isEnabled&&v(g).reqATitleColorIsOn?e.push("color: ".concat(en(v(g).reqFilterATitleColor),";")):(t.addon.isActive||v(c)&&!t.addon.isSelectable)&&v(g).selATitleColorIsOn?e.push("color: ".concat(en(v(g).selFilterATitleColor),";")):e.push("color: ".concat(en(v(h).addonTitleColor),";")),v(u).useAddonDesign?v(u).titlePaddingIsOn&&e.push("padding: ".concat(v(u).addonTextPadding,"px;")):v(m).titlePaddingIsOn&&e.push("padding: ".concat(v(m).objectTextPadding,"px;")),e.join(" ")}),q=f(()=>{let e=[];return e.push("white-space: pre-wrap; font-family: '".concat(v(h).addonText,"'; text-align: ").concat(v(h).addonTextAlign,"; font-size: ").concat(v(h).addonTextTextSize,"%;")),!t.isEnabled&&v(g).reqATextColorIsOn?e.push("color: ".concat(en(v(g).reqFilterATextColor),";")):(t.addon.isActive||v(c)&&!t.addon.isSelectable)&&v(g).selATextColorIsOn?e.push("color: ".concat(en(v(g).selFilterATextColor),";")):e.push("color: ".concat(en(v(h).addonTextColor),";")),v(u).useAddonDesign?e.push("padding: ".concat(v(u).addonTextPadding,"px;")):e.push("padding: ".concat(v(m).objectTextPadding,"px;")),e.join(" ")}),W=f(()=>{var e;let o=[],i=v(d).useAddonImage,n=(i?v(d).addonImgBorderRadiusIsPixels:v(p).objectImgBorderRadiusIsPixels)?"px":"%";if(i){if(o.push("width: ".concat(v(d).addonImageWidth,"%; margin-top: ").concat(v(d).addonImageMarginTop,"%; margin-bottom: ").concat(v(d).addonImageMarginBottom,"%;")),v(d).addonImgObjectFillIsOn){o.push("object-fit: ".concat(v(d).addonImgObjectFillStyle,";"));const e=t.choice.addonImgObjectFillHeight||v(p).addonImgObjectFillHeight;e&&o.push("height: ".concat(e,"px"))}if(o.push("border-radius: ".concat(v(d).addonImgBorderRadiusTopLeft).concat(n," ").concat(v(d).addonImgBorderRadiusTopRight).concat(n," ").concat(v(d).addonImgBorderRadiusBottomRight).concat(n," ").concat(v(d).addonImgBorderRadiusBottomLeft).concat(n,";")),v(d).addonImgOverflowIsOn&&o.push("overflow: hidden;"),v(d).addonImgBorderIsOn){const e=t.isEnabled?(t.addon.isActive||v(c)&&!t.addon.isSelectable)&&v(g).selImgBorderColorIsOn&&v(g).selFilterImgBorderColor||v(d).addonImgBorderColor:v(g).reqImgBorderColorIsOn&&v(g).reqFilterImgBorderColor||v(d).addonImgBorderColor;o.push("border: ".concat(v(d).addonImgBorderWidth,"px ").concat(v(d).addonImgBorderStyle," ").concat(en(e),";"))}}else{if(o.push("width: ".concat(v(p).objectImageWidth,"%; margin-top: ").concat(v(p).objectImageMarginTop,"%; margin-bottom: ").concat(v(p).objectImageMarginBottom,"%;")),v(p).objectImgObjectFillIsOn){o.push("object-fit: ".concat(v(p).objectImgObjectFillStyle,";"));const i=(null==(e=t.row)?void 0:e.objectImgObjectFillHeight)||v(p).objectImgObjectFillHeight;i&&o.push("height: ".concat(i,"px;"))}if(o.push("border-radius: ".concat(v(p).objectImgBorderRadiusTopLeft).concat(n," ").concat(v(p).objectImgBorderRadiusTopRight).concat(n," ").concat(v(p).objectImgBorderRadiusBottomRight).concat(n," ").concat(v(p).objectImgBorderRadiusBottomLeft).concat(n,";")),v(p).objectImgOverflowIsOn&&o.push("overflow: hidden;"),v(p).objectImgBorderIsOn){const e=t.isEnabled?(t.addon.isActive||v(c)&&!t.addon.isSelectable)&&v(g).selImgBorderColorIsOn&&v(g).selFilterImgBorderColor||v(p).objectImgBorderColor:v(g).reqImgBorderColorIsOn&&v(g).reqFilterImgBorderColor||v(p).objectImgBorderColor;o.push("border: ".concat(v(p).objectImgBorderWidth,"px ").concat(v(p).objectImgBorderStyle," ").concat(en(e),";"))}}return o.join(" ")}),N=f(()=>{let e=[];return e.push("font-family: '".concat(v(h).scoreText,"'; font-size: ").concat(v(h).scoreTextSize,"%; text-align: ").concat(v(h).scoreTextAlign,";")),!t.isEnabled&&v(g).reqScoreTextColorIsOn?e.push("color: ".concat(en(v(g).reqFilterSTextColor))):(t.addon.isActive||v(c)&&!t.addon.isSelectable)&&v(g).selScoreTextColorIsOn?e.push("color: ".concat(en(v(g).selFilterSTextColor))):e.push("color: ".concat(en(v(h).scoreTextColor),";")),e.join(" ")});function U(e){navigator.clipboard.writeText(t.addon.imageSourceTooltip).then(()=>{Zt.labelText="Tooltip copied to clipboard.",Zt.isOpen=!0}).catch(()=>{console.log(t.addon.imageSourceTooltip),Zt.labelText="Tooltip text logged to developer console.",Zt.isOpen=!0})}var L=cl(),E=D(L),z=e=>{var o=_r(),i=D(o),n=e=>{var o=k(),i=B(o),n=e=>{var o=$r();o.__contextmenu=U,P(o,(e,t)=>null==rn?void 0:rn(e,t),()=>t.addon.imageSourceTooltip),$(()=>{Le(o,"src",t.addon.image),qe(o,v(W)),Le(o,"loading",l()?"eager":"lazy")}),y(e,o)},r=e=>{var o=Vr();$(()=>{Le(o,"src",t.addon.image),qe(o,v(W)),Le(o,"loading",l()?"eager":"lazy")}),y(e,o)};ee(i,e=>{t.addon.imageSourceTooltip?e(n):e(r,!1)}),y(e,o)};ee(i,e=>{(1===t.addon.template||r()<=1280)&&t.addon.image&&!t.row.addonImageRemoved&&e(n)});var a=te(i,2),c=e=>{var t=k(),o=B(t);I(o,()=>v(T),e=>{var t=Wr(),o=D(t);M(o,()=>Ge.sanitize(v(T),Et)),$(()=>qe(t,v(j))),y(e,t)}),y(e,t)};ee(a,e=>{""===t.addon.title||t.row.addonTitleRemoved||e(c)});var d=te(a,2),u=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(d,e=>{t.addon.isSelectableMultiple&&v(A)&&0===v(b).multiChoiceCounterPosition&&e(u)});var g=te(d,2),p=e=>{var o=Nr(),i=B(o),n=e=>{var o=k(),i=B(o);Re(i,17,()=>t.choice.scores,$e,(e,o)=>{Dr(e,{get score(){return v(o)},get row(){return t.row},get choice(){return t.choice}})}),y(e,o)};ee(i,e=>{t.choice.showScoreInAddon&&t.isFirst&&e(n)});var r=te(i,2),l=e=>{var o=k(),i=B(o);Re(i,17,()=>t.addon.scores,$e,(e,o)=>{Dr(e,{get score(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon}})}),y(e,o)};ee(r,e=>{t.addon.scores&&e(l)}),y(e,o)};ee(g,e=>{t.row.objectScoreRemoved||e(p)});var m=te(g,2),h=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(m,e=>{t.addon.isSelectableMultiple&&v(A)&&1===v(b).multiChoiceCounterPosition&&e(h)});var w=te(m,2),C=e=>{var o=Ur(),i=B(o),n=e=>{var o=k(),i=B(o);Re(i,17,()=>t.choice.requireds,$e,(e,t)=>{yr(e,{get required(){return v(t)},get scoreText(){return v(N)}})}),y(e,o)};ee(i,e=>{t.choice.showReqInAddon&&t.isFirst&&e(n)});var r=te(i,2);Re(r,17,()=>t.addon.requireds,$e,(e,t)=>{yr(e,{get required(){return v(t)},get scoreText(){return v(N)}})}),y(e,o)};ee(w,e=>{t.row.objectRequirementRemoved||e(C)});var x=te(w,2),O=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(x,e=>{t.addon.isSelectableMultiple&&v(A)&&2===v(b).multiChoiceCounterPosition&&e(O)});var F=te(x,2),R=e=>{var o=k(),i=B(o),n=e=>{var o=Lr();o.__contextmenu=U,P(o,(e,t)=>null==rn?void 0:rn(e,t),()=>t.addon.imageSourceTooltip),$(()=>{Le(o,"src",t.addon.image),qe(o,v(W)),Le(o,"loading",l()?"eager":"lazy")}),y(e,o)},r=e=>{var o=Er();$(()=>{Le(o,"src",t.addon.image),qe(o,v(W)),Le(o,"loading",l()?"eager":"lazy")}),y(e,o)};ee(i,e=>{t.addon.imageSourceTooltip?e(n):e(r,!1)}),y(e,o)};ee(F,e=>{5===t.addon.template&&r()>1280&&t.addon.image&&!t.row.addonImageRemoved&&e(R)});var V=te(F,2),L=e=>{var t=k(),o=B(t);I(o,()=>v(S),e=>{var t=zr(),o=D(t);M(o,()=>Ge.sanitize(v(S),Et)),$(()=>qe(t,v(q))),y(e,t)}),y(e,t)};ee(V,e=>{""===t.addon.text||t.row.addonTextRemoved||e(L)});var E=te(V,2),z=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(E,e=>{t.addon.isSelectableMultiple&&v(A)&&3===v(b).multiChoiceCounterPosition&&e(z)});var G=te(E,2),H=e=>{var o=k(),i=B(o),n=e=>{var o=Gr();o.__contextmenu=U,P(o,(e,t)=>null==rn?void 0:rn(e,t),()=>t.addon.imageSourceTooltip),$(()=>{Le(o,"src",t.addon.image),qe(o,v(W)),Le(o,"loading",l()?"eager":"lazy")}),y(e,o)},r=e=>{var o=Hr();$(()=>{Le(o,"src",t.addon.image),qe(o,v(W)),Le(o,"loading",l()?"eager":"lazy")}),y(e,o)};ee(i,e=>{t.addon.imageSourceTooltip?e(n):e(r,!1)}),y(e,o)};ee(G,e=>{4===t.addon.template&&r()>1280&&t.addon.image&&!t.row.addonImageRemoved&&e(H)});var _=te(G,2),Y=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(_,e=>{t.addon.isSelectableMultiple&&v(A)&&4===v(b).multiChoiceCounterPosition&&e(Y)}),y(e,o)},G=e=>{var o=sl(),i=D(o),n=e=>{var o=el(),i=B(o),n=D(i),r=e=>{var o=k(),i=B(o),n=e=>{var o=Yr();o.__contextmenu=U,P(o,(e,t)=>null==rn?void 0:rn(e,t),()=>t.addon.imageSourceTooltip),$(()=>{Le(o,"src",t.addon.image),qe(o,v(W)),Le(o,"loading",l()?"eager":"lazy")}),y(e,o)},r=e=>{var o=Jr();$(()=>{Le(o,"src",t.addon.image),qe(o,v(W)),Le(o,"loading",l()?"eager":"lazy")}),y(e,o)};ee(i,e=>{t.addon.imageSourceTooltip?e(n):e(r,!1)}),y(e,o)};ee(n,e=>{t.addon.image&&!t.row.addonImageRemoved&&e(r)});var a=te(i,2),c=D(a),d=e=>{var t=k(),o=B(t);I(o,()=>v(T),e=>{var t=Zr(),o=D(t);M(o,()=>Ge.sanitize(v(T),Et)),$(()=>qe(t,v(j))),y(e,t)}),y(e,t)};ee(c,e=>{""===t.addon.title||t.row.addonTitleRemoved||e(d)});var u=te(c,2),g=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(u,e=>{t.addon.isSelectableMultiple&&v(A)&&0===v(b).multiChoiceCounterPosition&&e(g)});var p=te(u,2),m=e=>{var o=Xr(),i=B(o),n=e=>{var o=k(),i=B(o);Re(i,17,()=>t.choice.scores,$e,(e,o)=>{Dr(e,{get score(){return v(o)},get row(){return t.row},get choice(){return t.choice}})}),y(e,o)};ee(i,e=>{t.choice.showScoreInAddon&&t.isFirst&&e(n)});var r=te(i,2),l=e=>{var o=k(),i=B(o);Re(i,17,()=>t.addon.scores,$e,(e,o)=>{Dr(e,{get score(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon}})}),y(e,o)};ee(r,e=>{t.addon.scores&&e(l)}),y(e,o)};ee(p,e=>{t.row.objectScoreRemoved||e(m)});var h=te(p,2),w=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(h,e=>{t.addon.isSelectableMultiple&&v(A)&&1===v(b).multiChoiceCounterPosition&&e(w)});var C=te(h,2),x=e=>{var o=Kr(),i=B(o),n=e=>{var o=k(),i=B(o);Re(i,17,()=>t.choice.requireds,$e,(e,t)=>{yr(e,{get required(){return v(t)},get scoreText(){return v(N)}})}),y(e,o)};ee(i,e=>{t.choice.showReqInAddon&&t.isFirst&&e(n)});var r=te(i,2);Re(r,17,()=>t.addon.requireds,$e,(e,t)=>{yr(e,{get required(){return v(t)},get scoreText(){return v(N)}})}),y(e,o)};ee(C,e=>{t.row.objectRequirementRemoved||e(x)});var F=te(C,2),R=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(F,e=>{t.addon.isSelectableMultiple&&v(A)&&2===v(b).multiChoiceCounterPosition&&e(R)});var V=te(F,2),L=e=>{var t=k(),o=B(t);I(o,()=>v(S),e=>{var t=Qr(),o=D(t);M(o,()=>Ge.sanitize(v(S),Et)),$(()=>qe(t,v(q))),y(e,t)}),y(e,t)};ee(V,e=>{""===t.addon.text||t.row.addonTextRemoved||e(L)});var E=te(V,2),z=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(E,e=>{t.addon.isSelectableMultiple&&v(A)&&(3===v(b).multiChoiceCounterPosition||4===v(b).multiChoiceCounterPosition)&&e(z)}),$(()=>{var e;qe(i,"max-width: ".concat(null!=(e=v(O))?e:"","%")),qe(a,"max-width: ".concat(100-v(O),"%"))}),y(e,o)},r=e=>{var o=k(),i=B(o),n=e=>{var o=al(),i=B(o),n=D(i),r=e=>{var t=k(),o=B(t);I(o,()=>v(T),e=>{var t=tl(),o=D(t);M(o,()=>Ge.sanitize(v(T),Et)),$(()=>qe(t,v(j))),y(e,t)}),y(e,t)};ee(n,e=>{""===t.addon.title||t.row.addonTitleRemoved||e(r)});var a=te(n,2),c=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(a,e=>{t.addon.isSelectableMultiple&&v(A)&&0===v(b).multiChoiceCounterPosition&&e(c)});var d=te(a,2),u=e=>{var o=ol(),i=B(o),n=e=>{var o=k(),i=B(o);Re(i,17,()=>t.choice.scores,$e,(e,o)=>{Dr(e,{get score(){return v(o)},get row(){return t.row},get choice(){return t.choice}})}),y(e,o)};ee(i,e=>{t.choice.showScoreInAddon&&t.isFirst&&e(n)});var r=te(i,2),l=e=>{var o=k(),i=B(o);Re(i,17,()=>t.addon.scores,$e,(e,o)=>{Dr(e,{get score(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon}})}),y(e,o)};ee(r,e=>{t.addon.scores&&e(l)}),y(e,o)};ee(d,e=>{t.row.objectScoreRemoved||e(u)});var g=te(d,2),p=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(g,e=>{t.addon.isSelectableMultiple&&v(A)&&1===v(b).multiChoiceCounterPosition&&e(p)});var m=te(g,2),h=e=>{var o=il(),i=B(o),n=e=>{var o=k(),i=B(o);Re(i,17,()=>t.choice.requireds,$e,(e,t)=>{yr(e,{get required(){return v(t)},get scoreText(){return v(N)}})}),y(e,o)};ee(i,e=>{t.choice.showReqInAddon&&t.isFirst&&e(n)});var r=te(i,2);Re(r,17,()=>t.addon.requireds,$e,(e,t)=>{yr(e,{get required(){return v(t)},get scoreText(){return v(N)}})}),y(e,o)};ee(m,e=>{t.row.objectRequirementRemoved||e(h)});var w=te(m,2),C=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(w,e=>{t.addon.isSelectableMultiple&&v(A)&&2===v(b).multiChoiceCounterPosition&&e(C)});var x=te(w,2),F=e=>{var t=k(),o=B(t);I(o,()=>v(S),e=>{var t=nl(),o=D(t);M(o,()=>Ge.sanitize(v(S),Et)),$(()=>qe(t,v(q))),y(e,t)}),y(e,t)};ee(x,e=>{""===t.addon.text||t.row.addonTextRemoved||e(F)});var R=te(x,2),V=e=>{{let o=f(()=>!!t.isEnabled&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},get addon(){return t.addon},selectedOneMore:()=>di(t.addon,t.row,s),selectedOneLess:()=>ui(t.addon,t.row,s)})}};ee(R,e=>{t.addon.isSelectableMultiple&&v(A)&&(3===v(b).multiChoiceCounterPosition||4===v(b).multiChoiceCounterPosition)&&e(V)});var L=te(i,2),E=D(L),z=e=>{var o=k(),i=B(o),n=e=>{var o=rl();o.__contextmenu=U,P(o,(e,t)=>null==rn?void 0:rn(e,t),()=>t.addon.imageSourceTooltip),$(()=>{Le(o,"src",t.addon.image),qe(o,v(W)),Le(o,"loading",l()?"eager":"lazy")}),y(e,o)},r=e=>{var o=ll();$(()=>{Le(o,"src",t.addon.image),qe(o,v(W)),Le(o,"loading",l()?"eager":"lazy")}),y(e,o)};ee(i,e=>{t.addon.imageSourceTooltip?e(n):e(r,!1)}),y(e,o)};ee(E,e=>{t.addon.image&&!t.row.addonImageRemoved&&e(z)}),$(()=>{var e;qe(i,"max-width: ".concat(100-v(O),"%")),qe(L,"max-width: ".concat(null!=(e=v(O))?e:"","%"))}),y(e,o)};ee(i,e=>{3===t.addon.template&&e(n)},!0),y(e,o)};ee(i,e=>{2===t.addon.template?e(n):e(r,!1)}),y(e,o)};ee(E,e=>{t.addon.template>=4||1===t.addon.template||r()<=1280?e(z):e(G,!1)}),$(e=>{V(L,1,"text-center addon".concat(t.addon.isSelectable?" addon-".concat(t.addon.id):""," ").concat(null!=e?e:"")),qe(L,v(F))},[function(){let e=t.addon.addonWidth||"col-12",i=ko(e),n="col-6"===app.objectsPerRow?2:"col-4"===app.objectsPerRow?3:4;if(o()>1280)return e;if(!(o()>720))return o()>480?1===i?"col-12":"col-6":"col-12";switch(i){case 1:return"col-12";case 2:return"col-6";case 3:return n>2?"col-4":app.objectsPerRow;case 4:return n>3?"col-3":app.objectsPerRow;default:return app.objectsPerRow}}]),Ue("click",L,function(...e){var o;null==(o=t.addon.isSelectable?e=>function(e,o,i,n=!1){const r=i&&i.target?i.target:null;let l=o;if(s.isOverDlg=!1,s.isOverImg=!1,o.isResultRow||o.isGroupRow){const t=Ft.get(e.id);void 0!==t&&(l=t.row)}if(e.isSelectableMultiple){if(e.id===t.addon.id&&e.allowSelectByClick&&0===e.multipleUseVariable){if(r&&tn(r,"multi-","addon-"))return;di(e,l,s)}}else!Wo(e.requireds)||o.isInfoRow||n&&e.isNotSelectable||e.forcedActivated||(e.isActive?e.selectOnce||si(e,l,s):ci(e,l,s))}(t.addon,t.row,e,!0):void 0)||o.apply(this,e)},!0),y(e,L),C(),n()}We(["contextmenu"]);var ul=T('<div class="col-12"><!></div>'),gl=T('<img alt=""/>'),pl=T('<img alt=""/>'),ml=T('<h3 class="m-0"><!></h3>'),hl=T('<img alt=""/>'),vl=T('<img alt=""/>'),fl=T('<p class="mb-0"><!></p>'),bl=T('<img alt=""/>'),wl=T('<img alt=""/>'),Tl=T("<div></div>"),Il=T("<div></div>"),Sl=T('<div class="d-column w-100 p-0 align-items-center"><!> <!> <div class="w-100"><!> <!> <!> <!> <!> <!> <!> <!> <!> <!></div> <!> <!></div> <!>',1),yl=T('<img alt=""/>'),Cl=T('<img alt=""/>'),xl=T('<h2 class="mb-0"><!></h2>'),Ol=T('<p class="mb-0"><!></p>'),Al=T("<div></div>"),kl=T("<!> <!>",1),Bl=T("<div></div>"),Ml=T('<div class="col-12 text-center"><!> <!></div>'),Dl=T("<div></div>"),Fl=T('<div class="row g-0"><div class="col p-0 text-center"><!></div> <div class="col p-0 text-center"><!> <!> <!> <!> <!> <!> <!> <!> <!></div> <!></div> <!>',1),Rl=T('<h2 class="mb-0"><!></h2>'),jl=T('<p class="mb-0"><!></p>'),ql=T("<div></div>"),Pl=T("<!> <!>",1),$l=T('<img alt=""/>'),Vl=T('<img alt=""/>'),Wl=T("<div></div>"),Nl=T('<div class="col-12 text-center"><!> <!></div>'),Ul=T("<div></div>"),Ll=T('<div class="row g-0"><div class="col p-0 text-center"><!> <!> <!> <!> <!> <!> <!> <!> <!></div> <div class="col p-0 text-center"><!></div> <!></div> <!>',1),El=T("<div><div><div><!></div></div></div>");function zl(e,t){x(t,!0);const o=()=>Oe(io,"$winWidth",i),[i,n]=Ae(),r=R(t,"preloadImages",3,!1),l=R(t,"isSearch",3,!1),a={linkedObjects:[],mainDiv:t.mainDiv,bCreatorMode:!1,isBackpack:t.isBackpack,isOverDlg:!1,isOverImg:!1},s=f(()=>{if(t.choice.addons&&t.choice.addons.length>0){const e=t.choice.addons.filter(e=>!0!==e.isSelectable);if(e.length>0)return e}return null}),c=f(()=>{if(t.choice.addons&&t.choice.addons.length>0){const e=t.choice.addons.filter(e=>!0===e.isSelectable);if(e.length>0)return e}return null});let d=f(()=>{if(v(s))for(let e=0;e<v(s).length;e++){const o=v(s)[e];if(app.showAllAddons>0||!o.skipIndex&&(!o.hideAddon||t.choice.isActive)&&(o.showAddon||Wo(o.requireds)))return e}if(v(c))for(let e=0;e<v(c).length;e++){const o=v(c)[e];if(app.showAllAddons>0||!o.skipIndex&&(!o.hideAddon||t.choice.isActive)&&(o.showAddon||Wo(o.requireds)))return e}return-1}),u=f(()=>Ro("privateBackgroundIsOn",t.row,t.choice)),g=f(()=>Ro("privateFilterIsOn",t.row,t.choice)),p=f(()=>Ro("privateMultiChoiceIsOn",t.row,t.choice)),m=f(()=>Ro("privateObjectImageIsOn",t.row,t.choice)),h=f(()=>Ro("privateObjectIsOn",t.row,t.choice)),w=f(()=>Ro("privateTextIsOn",t.row,t.choice)),T=f(()=>void 0!==v(m).objectImageBoxWidth?v(m).objectImageBoxWidth:50),S=f(()=>Wo(t.choice.requireds)),O=f(()=>!!l()||(t.choice.isActive?!v(g).selFilterVisibleIsOn:v(S)?!v(g).unselFilterVisibleIsOn:!v(g).reqFilterVisibleIsOn)),A=f(()=>t.choice.addonJustify?" justify-".concat(t.choice.addonJustify):""),F=f(()=>t.choice.isActive),j=f(()=>v(h).objectHeight&&!l()),q=f(()=>{if(t.row.isResultRow){const e=Ft.get(t.choice.id);if(void 0!==e)return e.row}return t.row}),N=f(()=>{let e=[];return e.push("white-space: pre-line; font-family: '".concat(v(w).objectTitle,"'; font-size: ").concat(v(w).objectTitleTextSize,"%; text-align: ").concat(v(w).objectTitleAlign,";")),!v(S)&&v(g).reqCTitleColorIsOn?e.push("color: ".concat(en(v(g).reqFilterCTitleColor),";")):v(F)&&v(g).selCTitleColorIsOn?e.push("color: ".concat(en(v(g).selFilterCTitleColor),";")):e.push("color: ".concat(en(v(w).objectTitleColor),";")),v(h).titlePaddingIsOn&&e.push("padding: ".concat(v(h).objectTextPadding,"px;")),e.join(" ")}),U=f(()=>Fo(""!==v(q).title?v(q).title:v(q).debugTitle||"")),L=f(()=>Fo(t.choice.title)),E=f(()=>Fo(t.choice.text)),z=f(()=>!t.choice.hideMultipleCounter||v(S)),G=f(()=>{let e=[];return e.push("white-space: pre-wrap; font-family: '".concat(v(w).objectText,"'; text-align: ").concat(v(w).objectTextAlign,"; font-size: ").concat(v(w).objectTextTextSize,"%;")),!v(S)&&v(g).reqCTextColorIsOn?e.push("color: ".concat(en(v(g).reqFilterCTextColor),";")):v(F)&&v(g).selCTextColorIsOn?e.push("color: ".concat(en(v(g).selFilterCTextColor),";")):e.push("color: ".concat(en(v(w).objectTextColor),";")),e.push("padding: ".concat(v(h).objectTextPadding,"px;")),e.join(" ")}),H=f(()=>{const e=v(h).objectBorderRadiusIsPixels?"px":"%",t={},o={};if(v(h).objectBorderImage&&(t.borderImage="border-image: url('".concat(v(h).objectBorderImage,"') ").concat(v(h).objectBorderImageSliceTop," ").concat(v(h).objectBorderImageSliceRight," ").concat(v(h).objectBorderImageSliceBottom," ").concat(v(h).objectBorderImageSliceLeft," / ").concat(v(h).objectBorderImageWidth,"px ").concat(v(h).objectBorderImageRepeat,"; border-style: solid; padding: ").concat(v(h).objectBorderImageWidth,"px;")),v(u).objectBackgroundImage&&(t.bgImage="background-image: url('".concat(v(u).objectBackgroundImage,"'); ").concat(v(u).isObjectBackgroundRepeat?"background-repeat: repeat;":v(u).isObjectBackgroundFitIn?"background-size: 100% 100%;":"background-size: cover;")),v(u).objectBgColorIsOn&&(t.bgColor="background-color: ".concat(en(v(u).objectBgColor),";")),t.margin="margin: ".concat(v(h).objectMargin,"px;"),t.borderRadius="border-radius: ".concat(v(h).objectBorderRadiusTopLeft).concat(e," ").concat(v(h).objectBorderRadiusTopRight).concat(e," ").concat(v(h).objectBorderRadiusBottomRight).concat(e," ").concat(v(h).objectBorderRadiusBottomLeft).concat(e,";"),v(h).objectOverflowIsOn&&(t.overflow="overflow: hidden;"),v(h).objectBorderIsOn||v(F)&&v(g).selBorderColorIsOn||!v(S)&&v(g).reqBorderColorIsOn){let e=v(h).objectBorderColor;!v(S)&&v(g).reqBorderColorIsOn?e=v(g).reqFilterBorderColor:v(F)&&v(g).selBorderColorIsOn&&(e=v(g).selFilterBorderColor),t.border="border: ".concat(v(h).objectBorderWidth,"px ").concat(v(h).objectBorderStyle," ").concat(en(e),";")}return v(h).objectDropShadowIsOn&&(v(h).objectUseBoxShadowIsOn?t.boxShadow="box-shadow: ".concat(v(h).objectDropShadowH,"px ").concat(v(h).objectDropShadowV,"px ").concat(v(h).objectDropShadowBlur,"px ").concat(v(h).objectDropShadowSpread,"px ").concat(en(v(h).objectDropShadowColor),";"):v(c)?t.filter="filter: drop-shadow(".concat(v(h).objectDropShadowH,"px ").concat(v(h).objectDropShadowV,"px ").concat(v(h).objectDropShadowBlur,"px ").concat(en(v(h).objectDropShadowColor),")"):o.dropShadow=" drop-shadow(".concat(v(h).objectDropShadowH,"px ").concat(v(h).objectDropShadowV,"px ").concat(v(h).objectDropShadowBlur,"px ").concat(en(v(h).objectDropShadowColor),")")),v(c)||Z(t,o),Object.keys(o).length>0&&(t.filter="filter:".concat(Object.values(o).join(""),";")),Object.values(t).join(" ")}),_=f(()=>{const e={},t={};return Z(e,t),Object.keys(t).length>0&&(e.filter="filter:".concat(Object.values(t).join(""),";")),Object.values(e).join(" ")}),Y=f(()=>{let e=[];const o=v(m).objectImgBorderRadiusIsPixels?"px":"%";if(e.push("width: ".concat(v(m).objectImageWidth,"%; margin-top: ").concat(v(m).objectImageMarginTop,"%; margin-bottom: ").concat(v(m).objectImageMarginBottom,"%;")),v(m).objectImgObjectFillIsOn){e.push("object-fit: ".concat(v(m).objectImgObjectFillStyle,";"));const o=t.row.objectImgObjectFillHeight||v(m).objectImgObjectFillHeight;o&&e.push("height: ".concat(o,"px;"))}if(e.push("border-radius: ".concat(v(m).objectImgBorderRadiusTopLeft).concat(o," ").concat(v(m).objectImgBorderRadiusTopRight).concat(o," ").concat(v(m).objectImgBorderRadiusBottomRight).concat(o," ").concat(v(m).objectImgBorderRadiusBottomLeft).concat(o,";")),v(m).objectImgOverflowIsOn&&e.push("overflow: hidden;"),v(m).objectImgBorderIsOn){const t=v(S)?v(F)&&v(g).selImgBorderColorIsOn&&v(g).selFilterImgBorderColor||v(m).objectImgBorderColor:v(g).reqImgBorderColorIsOn&&v(g).reqFilterImgBorderColor||v(m).objectImgBorderColor;e.push("border: ".concat(v(m).objectImgBorderWidth,"px ").concat(v(m).objectImgBorderStyle," ").concat(en(t),";"))}return e.join(" ")}),J=f(()=>{let e=[];return e.push("font-family: '".concat(v(w).scoreText,"'; font-size: ").concat(v(w).scoreTextSize,"%; text-align: ").concat(v(w).scoreTextAlign,";")),!v(S)&&v(g).reqScoreTextColorIsOn?e.push("color: ".concat(en(v(g).reqFilterSTextColor))):t.choice.isActive&&v(g).selScoreTextColorIsOn?e.push("color: ".concat(en(v(g).selFilterSTextColor))):e.push("color: ".concat(en(v(w).scoreTextColor),";")),e.join(" ")});function Z(e,o){v(S)?(v(F)?(v(g).selFilterBlurIsOn&&(o.blur=" blur(".concat(v(g).selFilterBlur,"px)")),v(g).selFilterBrightIsOn&&(o.brightness=" brightness(".concat(v(g).selFilterBright,"%)")),v(g).selFilterContIsOn&&(o.contrast=" contrast(".concat(v(g).selFilterCont,"%)")),v(g).selFilterGrayIsOn&&(o.grayscale=" grayscale(".concat(v(g).selFilterGray,"%)")),v(g).selFilterHueIsOn&&(o.hueRotate=" hue-rotate(".concat(v(g).selFilterHue,"deg)")),v(g).selFilterInvertIsOn&&(o.invert=" invert(".concat(v(g).selFilterInvert,"%)")),v(g).selFilterOpacIsOn&&(o.opacity=" opacity(".concat(v(g).selFilterOpac,"%)")),v(g).selFilterSaturIsOn&&(o.saturate=" saturate(".concat(v(g).selFilterSatur,")")),v(g).selFilterSepiaIsOn&&(o.sepia=" sepia(".concat(v(g).selFilterGray,"%)")),v(g).selBgColorIsOn&&(e.bgColor="background-color: ".concat(en(v(g).selFilterBgColor),";")),v(h).objectGradientIsOn&&(e.bgImage="background-image: linear-gradient(".concat(v(h).objectGradientOnSelect,");"))):(v(g).unselFilterBlurIsOn&&(o.blur=" blur(".concat(v(g).unselFilterBlur,"px)")),v(g).unselFilterBrightIsOn&&(o.brightness=" brightness(".concat(v(g).unselFilterBright,"%)")),v(g).unselFilterContIsOn&&(o.contrast=" contrast(".concat(v(g).unselFilterCont,"%)")),v(g).unselFilterGrayIsOn&&(o.grayscale=" grayscale(".concat(v(g).unselFilterGray,"%)")),v(g).unselFilterHueIsOn&&(o.hueRotate=" hue-rotate(".concat(v(g).unselFilterHue,"deg)")),v(g).unselFilterInvertIsOn&&(o.invert=" invert(".concat(v(g).unselFilterInvert,"%)")),v(g).unselFilterOpacIsOn&&(o.opacity=" opacity(".concat(v(g).unselFilterOpac,"%)")),v(g).unselFilterSaturIsOn&&(o.saturate=" saturate(".concat(v(g).unselFilterSatur,")")),v(g).unselFilterSepiaIsOn&&(o.sepia=" sepia(".concat(v(g).unselFilterGray,"%)")),v(h).objectGradientIsOn&&(e.bgImage="background-image: linear-gradient(".concat(v(h).objectGradient,");"))),app.isPointerCursor&&!t.choice.isNotSelectable&&(!t.choice.isSelectableMultiple||t.choice.allowSelectByClick&&0===t.choice.multipleUseVariable)&&(e.cursor="cursor: pointer;")):(v(g).reqFilterBlurIsOn&&(o.blur=" blur(".concat(v(g).reqFilterBlur,"px)")),v(g).reqFilterBrightIsOn&&(o.brightness=" brightness(".concat(v(g).reqFilterBright,"%)")),v(g).reqFilterContIsOn&&(o.contrast=" contrast(".concat(v(g).reqFilterCont,"%)")),v(g).reqFilterGrayIsOn&&(o.grayscale=" grayscale(".concat(v(g).reqFilterGray,"%)")),v(g).reqFilterHueIsOn&&(o.hueRotate=" hue-rotate(".concat(v(g).reqFilterHue,"deg)")),v(g).reqFilterInvertIsOn&&(o.invert=" invert(".concat(v(g).reqFilterInvert,"%)")),v(g).reqFilterOpacIsOn&&(o.opacity=" opacity(".concat(v(g).reqFilterOpac,"%)")),v(g).reqFilterSaturIsOn&&(o.saturate=" saturate(".concat(v(g).reqFilterSatur,")")),v(g).reqFilterSepiaIsOn&&(o.sepia=" sepia(".concat(v(g).reqFilterGray,"%)")),v(g).reqBgColorIsOn&&(e.bgColor="background-color: ".concat(en(v(g).reqFilterBgColor),";")),v(h).objectGradientIsOn&&(e.bgImage="background-image: linear-gradient(".concat(v(h).objectGradientOnReq,");")))}function X(e,o,i,n=!1){const r=i&&i.target?i.target:null;let l=o;if(a.isOverDlg=!1,a.isOverImg=!1,!(r&&e.isActive&&e.addons&&e.addons.length>0&&tn(r,"addon-","addon"))){if(o.isResultRow||o.isGroupRow){const t=Ft.get(e.id);void 0!==t&&(l=t.row)}if(e.isSelectableMultiple){if(e.id===t.choice.id&&e.allowSelectByClick&&0===e.multipleUseVariable){if(r&&tn(r,"multi-","choice-"))return;di(e,l,a)}}else!Wo(e.requireds)||o.isInfoRow||n&&e.isNotSelectable||e.forcedActivated||(e.isActive?e.selectOnce||si(e,l,a):ci(e,l,a))}}function K(e){navigator.clipboard.writeText(t.choice.imageSourceTooltip).then(()=>{Zt.labelText="Tooltip copied to clipboard.",Zt.isOpen=!0}).catch(()=>{console.log(t.choice.imageSourceTooltip),Zt.labelText="Tooltip text logged to developer console.",Zt.isOpen=!0})}b(()=>{t.mainDiv&&(a.mainDiv=t.mainDiv),t.isBackpack&&(a.isBackpack=t.isBackpack)});var Q={activateObject:X,options:a},oe=k(),ie=B(oe),ne=e=>{var i=El(),n=D(i);let u;var m=D(n),h=D(m),b=e=>{var o=Sl(),i=B(o),n=D(i),l=e=>{var t=k(),o=B(t);I(o,()=>v(U),e=>{var t=ul(),o=D(t);M(o,()=>Ge.sanitize(v(U),Et)),$(()=>qe(t,v(J))),y(e,t)}),y(e,t)};ee(n,e=>{t.row.resultShowRowTitle&&e(l)});var u=te(n,2),g=e=>{var o=k(),i=B(o),n=e=>{var o=gl();o.__contextmenu=K,P(o,(e,t)=>null==rn?void 0:rn(e,t),()=>t.choice.imageSourceTooltip),$(()=>{Le(o,"src",t.choice.image),qe(o,v(Y)),Le(o,"loading",r()?"eager":"lazy")}),y(e,o)},l=e=>{var o=pl();$(()=>{Le(o,"src",t.choice.image),qe(o,v(Y)),Le(o,"loading",r()?"eager":"lazy")}),y(e,o)};ee(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),y(e,o)};ee(u,e=>{(1===t.choice.template||t.windowWidth<=1280||t.row.choicesShareTemplate)&&t.choice.image&&!t.row.objectImageRemoved&&e(g)});var m=te(u,2),h=D(m),b=e=>{var t=k(),o=B(t);I(o,()=>v(L),e=>{var t=ml(),o=D(t);M(o,()=>Ge.sanitize(v(L),Et)),$(()=>qe(t,v(N))),y(e,t)}),y(e,t)};ee(h,e=>{""===t.choice.title||t.row.objectTitleRemoved||e(b)});var w=te(h,2),T=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(w,e=>{t.choice.isSelectableMultiple&&v(z)&&0===v(p).multiChoiceCounterPosition&&e(T)});var C=te(w,2),x=e=>{var o=k(),i=B(o);Re(i,17,()=>t.choice.scores,$e,(e,o)=>{Dr(e,{get score(){return v(o)},get row(){return t.row},get choice(){return t.choice}})}),y(e,o)};ee(C,e=>{t.row.objectScoreRemoved||t.choice.showScoreInAddon||e(x)});var O=te(C,2),F=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(O,e=>{t.choice.isSelectableMultiple&&v(z)&&1===v(p).multiChoiceCounterPosition&&e(F)});var R=te(O,2),j=e=>{var o=k(),i=B(o);Re(i,17,()=>t.choice.requireds,$e,(e,t)=>{yr(e,{get required(){return v(t)},get scoreText(){return v(J)}})}),y(e,o)};ee(R,e=>{t.row.objectRequirementRemoved||t.choice.showReqInAddon||e(j)});var q=te(R,2),W=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(q,e=>{t.choice.isSelectableMultiple&&v(z)&&2===v(p).multiChoiceCounterPosition&&e(W)});var H=te(q,2),Z=e=>{var o=k(),i=B(o),n=e=>{var o=hl();o.__contextmenu=K,P(o,(e,t)=>null==rn?void 0:rn(e,t),()=>t.choice.imageSourceTooltip),$(()=>{Le(o,"src",t.choice.image),qe(o,v(Y)),Le(o,"loading",r()?"eager":"lazy")}),y(e,o)},l=e=>{var o=vl();$(()=>{Le(o,"src",t.choice.image),qe(o,v(Y)),Le(o,"loading",r()?"eager":"lazy")}),y(e,o)};ee(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),y(e,o)};ee(H,e=>{5===t.choice.template&&t.windowWidth>1280&&t.choice.image&&!t.row.objectImageRemoved&&e(Z)});var X=te(H,2),Q=e=>{var t=k(),o=B(t);I(o,()=>v(E),e=>{var t=fl(),o=D(t);M(o,()=>Ge.sanitize(v(E),Et)),$(()=>qe(t,v(G))),y(e,t)}),y(e,t)};ee(X,e=>{""===t.choice.text||t.row.objectTextRemoved||e(Q)});var oe=te(X,2),ie=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(oe,e=>{t.choice.isSelectableMultiple&&v(z)&&3===v(p).multiChoiceCounterPosition&&e(ie)});var ne=te(oe,2),re=e=>{var o=k(),i=B(o),n=e=>{var o=bl();o.__contextmenu=K,P(o,(e,t)=>null==rn?void 0:rn(e,t),()=>t.choice.imageSourceTooltip),$(()=>{Le(o,"src",t.choice.image),qe(o,v(Y)),Le(o,"loading",r()?"eager":"lazy")}),y(e,o)},l=e=>{var o=wl();$(()=>{Le(o,"src",t.choice.image),qe(o,v(Y)),Le(o,"loading",r()?"eager":"lazy")}),y(e,o)};ee(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),y(e,o)};ee(ne,e=>{4===t.choice.template&&t.windowWidth>1280&&t.choice.image&&!t.row.objectImageRemoved&&e(re)});var le=te(m,2),ae=e=>{var o=Tl();Re(o,21,()=>v(s),$e,(e,o,i)=>{var n=k(),l=B(n),a=e=>{{let n=f(()=>v(d)===i);dl(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return v(o)},get isEnabled(){return v(S)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()},get isFirst(){return v(n)},get isBackpack(){return t.isBackpack},get mainDiv(){return t.mainDiv}})}};ee(l,e=>{(app.showAllAddons>0||(!v(o).hideAddon||t.choice.isActive)&&(v(o).showAddon||Wo(v(o).requireds)))&&e(a)}),y(e,n)}),$(()=>{var e;return V(o,1,"row g-0 p-0 w-100".concat(null!=(e=v(A))?e:""))}),y(e,o)};ee(le,e=>{v(s)&&e(ae)});var se=te(le,2),ce=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(se,e=>{t.choice.isSelectableMultiple&&v(z)&&4===v(p).multiChoiceCounterPosition&&e(ce)});var de=te(i,2),ue=e=>{var o=Il();Re(o,21,()=>v(c),$e,(e,o,i)=>{var n=k(),l=B(n),a=e=>{{let n=f(()=>v(d)===i);dl(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return v(o)},get isEnabled(){return v(S)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()},get isFirst(){return v(n)},get isBackpack(){return t.isBackpack},get mainDiv(){return t.mainDiv}})}};ee(l,e=>{(app.showAllAddons>0||(!v(o).hideAddon||t.choice.isActive)&&(v(o).showAddon||Wo(v(o).requireds)))&&e(a)}),y(e,n)}),$(()=>{var e;return V(o,1,"row g-0 p-0 w-100".concat(null!=(e=v(A))?e:""))}),y(e,o)};ee(de,e=>{v(c)&&e(ue)}),$(()=>qe(i,v(c)?v(_):void 0)),y(e,o)},w=e=>{var o=k(),i=B(o),n=e=>{var o=Fl(),i=B(o),n=D(i),l=D(n),u=e=>{var o=k(),i=B(o),n=e=>{var o=yl();o.__contextmenu=K,P(o,(e,t)=>null==rn?void 0:rn(e,t),()=>t.choice.imageSourceTooltip),$(()=>{Le(o,"src",t.choice.image),qe(o,v(Y)),Le(o,"loading",r()?"eager":"lazy")}),y(e,o)},l=e=>{var o=Cl();$(()=>{Le(o,"src",t.choice.image),qe(o,v(Y)),Le(o,"loading",r()?"eager":"lazy")}),y(e,o)};ee(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),y(e,o)};ee(l,e=>{t.choice.image&&!t.row.objectImageRemoved&&e(u)});var g=te(n,2),m=D(g),h=e=>{var t=k(),o=B(t);I(o,()=>v(L),e=>{var t=xl(),o=D(t);M(o,()=>Ge.sanitize(v(L),Et)),$(()=>qe(t,v(N))),y(e,t)}),y(e,t)};ee(m,e=>{""===t.choice.title||t.row.objectTitleRemoved||e(h)});var b=te(m,2),w=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(b,e=>{t.choice.isSelectableMultiple&&v(z)&&0===v(p).multiChoiceCounterPosition&&e(w)});var C=te(b,2),x=e=>{var o=k(),i=B(o);Re(i,17,()=>t.choice.scores,$e,(e,o)=>{Dr(e,{get score(){return v(o)},get row(){return t.row},get choice(){return t.choice}})}),y(e,o)};ee(C,e=>{t.row.objectScoreRemoved||t.choice.showScoreInAddon||e(x)});var O=te(C,2),F=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(O,e=>{t.choice.isSelectableMultiple&&v(z)&&1===v(p).multiChoiceCounterPosition&&e(F)});var R=te(O,2),j=e=>{var o=k(),i=B(o);Re(i,17,()=>t.choice.requireds,$e,(e,t)=>{yr(e,{get required(){return v(t)},get scoreText(){return v(J)}})}),y(e,o)};ee(R,e=>{t.row.objectRequirementRemoved||t.choice.showReqInAddon||e(j)});var q=te(R,2),W=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(q,e=>{t.choice.isSelectableMultiple&&v(z)&&2===v(p).multiChoiceCounterPosition&&e(W)});var U=te(q,2),H=e=>{var o=k(),i=B(o);I(i,()=>v(E),e=>{var o=Ol(),i=D(o);M(i,()=>Ge.sanitize(Fo(t.choice.text),Et)),$(()=>qe(o,v(G))),y(e,o)}),y(e,o)};ee(U,e=>{""===t.choice.text||t.row.objectTextRemoved||e(H)});var Z=te(U,2),X=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(Z,e=>{t.choice.isSelectableMultiple&&v(z)&&3===v(p).multiChoiceCounterPosition&&e(X)});var Q=te(Z,2),oe=e=>{var o=kl(),i=B(o),n=e=>{var o=Al();Re(o,21,()=>v(s),$e,(e,o,i)=>{var n=k(),l=B(n),a=e=>{{let n=f(()=>v(d)===i);dl(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return v(o)},get isEnabled(){return v(S)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()},get isFirst(){return v(n)},get isBackpack(){return t.isBackpack},get mainDiv(){return t.mainDiv}})}};ee(l,e=>{(app.showAllAddons>0||(!v(o).hideAddon||t.choice.isActive)&&(v(o).showAddon||Wo(v(o).requireds)))&&e(a)}),y(e,n)}),$(()=>{var e;return V(o,1,"row g-0 p-0 col w-100".concat(null!=(e=v(A))?e:""))}),y(e,o)};ee(i,e=>{v(s)&&e(n)});var l=te(i,2),c=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(l,e=>{t.choice.isSelectableMultiple&&v(z)&&4===v(p).multiChoiceCounterPosition&&e(c)}),y(e,o)};ee(Q,e=>{t.choice.useSeperateAddon||e(oe)});var ie=te(g,2),ne=e=>{var o=Ml(),i=D(o),n=e=>{var o=Bl();Re(o,21,()=>v(s),$e,(e,o,i)=>{var n=k(),l=B(n),a=e=>{{let n=f(()=>v(d)===i);dl(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return v(o)},get isEnabled(){return v(S)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()},get isFirst(){return v(n)},get isBackpack(){return t.isBackpack},get mainDiv(){return t.mainDiv}})}};ee(l,e=>{(app.showAllAddons>0||(!v(o).hideAddon||t.choice.isActive)&&(v(o).showAddon||Wo(v(o).requireds)))&&e(a)}),y(e,n)}),$(()=>{var e;return V(o,1,"row g-0 p-0 col w-100".concat(null!=(e=v(A))?e:""))}),y(e,o)};ee(i,e=>{v(s)&&e(n)});var l=te(i,2),c=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(l,e=>{t.choice.isSelectableMultiple&&v(z)&&4===v(p).multiChoiceCounterPosition&&e(c)}),y(e,o)};ee(ie,e=>{t.choice.useSeperateAddon&&e(ne)});var re=te(i,2),le=e=>{var o=Dl();Re(o,21,()=>v(c),$e,(e,o,i)=>{var n=k(),l=B(n),a=e=>{{let n=f(()=>v(d)===i);dl(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return v(o)},get isEnabled(){return v(S)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()},get isFirst(){return v(n)},get isBackpack(){return t.isBackpack},get mainDiv(){return t.mainDiv}})}};ee(l,e=>{(app.showAllAddons>0||(!v(o).hideAddon||t.choice.isActive)&&(v(o).showAddon||Wo(v(o).requireds)))&&e(a)}),y(e,n)}),$(()=>{var e;return V(o,1,"row g-0 p-0 col w-100".concat(null!=(e=v(A))?e:""))}),y(e,o)};ee(re,e=>{v(c)&&e(le)}),$(()=>{var e;qe(i,v(c)?v(_):void 0),qe(n,"max-width: ".concat(null!=(e=v(T))?e:"","%")),qe(g,"max-width: ".concat(100-v(T),"%"))}),y(e,o)},l=e=>{var o=k(),i=B(o),n=e=>{var o=Ll(),i=B(o),n=D(i),l=D(n),u=e=>{var t=k(),o=B(t);I(o,()=>v(L),e=>{var t=Rl(),o=D(t);M(o,()=>Ge.sanitize(v(L),Et)),$(()=>qe(t,v(N))),y(e,t)}),y(e,t)};ee(l,e=>{""===t.choice.title||t.row.objectTitleRemoved||e(u)});var g=te(l,2),m=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(g,e=>{t.choice.isSelectableMultiple&&v(z)&&0===v(p).multiChoiceCounterPosition&&e(m)});var h=te(g,2),b=e=>{var o=k(),i=B(o);Re(i,17,()=>t.choice.scores,$e,(e,o)=>{Dr(e,{get score(){return v(o)},get row(){return t.row},get choice(){return t.choice}})}),y(e,o)};ee(h,e=>{t.row.objectScoreRemoved||t.choice.showScoreInAddon||e(b)});var w=te(h,2),C=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(w,e=>{t.choice.isSelectableMultiple&&v(z)&&1===v(p).multiChoiceCounterPosition&&e(C)});var x=te(w,2),O=e=>{var o=k(),i=B(o);Re(i,17,()=>t.choice.requireds,$e,(e,t)=>{yr(e,{get required(){return v(t)},get scoreText(){return v(J)}})}),y(e,o)};ee(x,e=>{t.row.objectRequirementRemoved||t.choice.showReqInAddon||e(O)});var F=te(x,2),R=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(F,e=>{t.choice.isSelectableMultiple&&v(z)&&2===v(p).multiChoiceCounterPosition&&e(R)});var j=te(F,2),q=e=>{var t=k(),o=B(t);I(o,()=>v(E),e=>{var t=jl(),o=D(t);M(o,()=>Ge.sanitize(v(E),Et)),$(()=>qe(t,v(G))),y(e,t)}),y(e,t)};ee(j,e=>{""===t.choice.text||t.row.objectTextRemoved||e(q)});var W=te(j,2),U=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(W,e=>{t.choice.isSelectableMultiple&&v(z)&&3===v(p).multiChoiceCounterPosition&&e(U)});var H=te(W,2),Z=e=>{var o=Pl(),i=B(o),n=e=>{var o=ql();Re(o,21,()=>v(s),$e,(e,o,i)=>{var n=k(),l=B(n),a=e=>{{let n=f(()=>v(d)===i);dl(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return v(o)},get isEnabled(){return v(S)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()},get isFirst(){return v(n)},get isBackpack(){return t.isBackpack},get mainDiv(){return t.mainDiv}})}};ee(l,e=>{(app.showAllAddons>0||(!v(o).hideAddon||t.choice.isActive)&&(v(o).showAddon||Wo(v(o).requireds)))&&e(a)}),y(e,n)}),$(()=>{var e;return V(o,1,"row g-0 p-0 col w-100".concat(null!=(e=v(A))?e:""))}),y(e,o)};ee(i,e=>{v(s)&&e(n)});var l=te(i,2),c=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(l,e=>{t.choice.isSelectableMultiple&&v(z)&&4===v(p).multiChoiceCounterPosition&&e(c)}),y(e,o)};ee(H,e=>{t.choice.useSeperateAddon||e(Z)});var X=te(n,2),Q=D(X),oe=e=>{var o=k(),i=B(o),n=e=>{var o=$l();o.__contextmenu=K,P(o,(e,t)=>null==rn?void 0:rn(e,t),()=>t.choice.imageSourceTooltip),$(()=>{Le(o,"src",t.choice.image),qe(o,v(Y)),Le(o,"loading",r()?"eager":"lazy")}),y(e,o)},l=e=>{var o=Vl();$(()=>{Le(o,"src",t.choice.image),qe(o,v(Y)),Le(o,"loading",r()?"eager":"lazy")}),y(e,o)};ee(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),y(e,o)};ee(Q,e=>{t.choice.image&&!t.row.objectImageRemoved&&e(oe)});var ie=te(X,2),ne=e=>{var o=Nl(),i=D(o),n=e=>{var o=Wl();Re(o,21,()=>v(s),$e,(e,o,i)=>{var n=k(),l=B(n),a=e=>{{let n=f(()=>v(d)===i);dl(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return v(o)},get isEnabled(){return v(S)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()},get isFirst(){return v(n)},get isBackpack(){return t.isBackpack},get mainDiv(){return t.mainDiv}})}};ee(l,e=>{(app.showAllAddons>0||(!v(o).hideAddon||t.choice.isActive)&&(v(o).showAddon||Wo(v(o).requireds)))&&e(a)}),y(e,n)}),$(()=>{var e;return V(o,1,"row g-0 p-0 col w-100".concat(null!=(e=v(A))?e:""))}),y(e,o)};ee(i,e=>{v(s)&&e(n)});var l=te(i,2),c=e=>{{let o=f(()=>v(S)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Pr(e,{get isEnabled(){return v(o)},get row(){return t.row},get choice(){return t.choice},selectedOneMore:()=>di(t.choice,t.row,a),selectedOneLess:()=>ui(t.choice,t.row,a)})}};ee(l,e=>{t.choice.isSelectableMultiple&&v(z)&&4===v(p).multiChoiceCounterPosition&&e(c)}),y(e,o)};ee(ie,e=>{t.choice.useSeperateAddon&&e(ne)});var re=te(i,2),le=e=>{var o=Ul();Re(o,21,()=>v(c),$e,(e,o,i)=>{var n=k(),l=B(n),a=e=>{{let n=f(()=>v(d)===i);dl(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return v(o)},get isEnabled(){return v(S)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()},get isFirst(){return v(n)},get isBackpack(){return t.isBackpack},get mainDiv(){return t.mainDiv}})}};ee(l,e=>{(app.showAllAddons>0||(!v(o).hideAddon||t.choice.isActive)&&(v(o).showAddon||Wo(v(o).requireds)))&&e(a)}),y(e,n)}),$(()=>{var e;return V(o,1,"row g-0 p-0 col w-100".concat(null!=(e=v(A))?e:""))}),y(e,o)};ee(re,e=>{v(c)&&e(le)}),$(()=>{var e;qe(i,v(c)?v(_):void 0),qe(n,"max-width: ".concat(100-v(T),"%")),qe(X,"max-width: ".concat(null!=(e=v(T))?e:"","%"))}),y(e,o)};ee(i,e=>{3===t.choice.template&&e(n)},!0),y(e,o)};ee(i,e=>{2===t.choice.template?e(n):e(l,!1)}),y(e,o)};ee(h,e=>{t.choice.template>=4||1===t.choice.template||t.windowWidth<=1280||t.row.choicesShareTemplate?e(b):e(w,!1)}),$((e,o)=>{var r,l;V(i,1,e),u=V(n,1,"d-flex",null,u,o),V(m,1,"row row-".concat(null!=(r=t.row.id)?r:""," choice-").concat(null!=(l=t.choice.id)?l:""," ").concat(v(F)?"choice-selected":"choice-unselected"," ").concat(v(S)?"choice-enabled":"choice-disabled"," ").concat(v(F)&&v(g).selOverlayOnImage||!v(S)&&v(g).reqOverlayOnImage?"bg-overlay ":"","w-100")),qe(m,v(H))},[()=>W(function(){if(l())return"col-sm-6 col-12";let e=t.choice.objectWidth||t.row.objectWidth,i=ko(e),n="col-6"===app.objectsPerRow?2:"col-4"===app.objectsPerRow?3:4;if(o()>1280)return e;if(!(o()>720))return o()>480?1===i?"col-12":"col-6":"col-12";switch(i){case 1:return"col-12";case 2:return"col-6";case 3:return n>2?"col-4":app.objectsPerRow;case 4:return n>3?"col-3":app.objectsPerRow;default:return app.objectsPerRow}}()),()=>({fullHeight:v(j)})]),Ue("click",m,e=>X(t.choice,t.row,e,!0),!0),y(e,i)};ee(ie,e=>{v(O)&&e(ne)}),y(e,oe);var re=C(Q);return n(),re}We(["contextmenu"]);var Gl=T('<div class="d-flex mb-2 justify-center"><!></div>'),Hl=T('<div class="row g-0"></div>'),_l=T("<!> <!> <!> <!>",1);var Yl=T('<img alt=""/>'),Jl=T('<img alt=""/>'),Zl=T('<h2 class="mb-0"><!></h2>'),Xl=T('<img alt=""/>'),Kl=T('<img alt=""/>'),Ql=T('<p class="mb-0"><!></p>'),ea=T('<img alt=""/>'),ta=T('<img alt=""/>'),oa=T('<div class="col-12 m-0 p-0"><!> <!> <!> <!> <!></div>'),ia=T('<h2 class="mb-0"><!></h2>'),na=T('<p class="mb-0"><!></p>'),ra=T('<img alt=""/>'),la=T('<img alt=""/>'),aa=T('<div class="col p-0 text-center"><!> <!></div> <div class="col p-0 text-center"><!></div>',1),sa=T('<img alt=""/>'),ca=T('<img alt=""/>'),da=T('<h2 class="mb-0"><!></h2>'),ua=T('<p class="mb-0"><!></p>'),ga=T('<div class="col p-0 text-center"><!></div> <div class="col p-0 text-center"><!> <!></div>',1),pa=T("<div><!></div>"),ma=T("<div><!></div>"),ha=T("<div><!> <!></div>");function va(e,t){x(t,!0);const o=R(t,"preloadImages",3,!1),i=R(t,"isBackpack",3,!1),r={linkedObjects:[]};let l=O(void 0),a=f(()=>Ro("privateBackgroundIsOn",t.row)),s=f(()=>Ro("privateRowImageIsOn",t.row)),c=f(()=>Ro("privateRowIsOn",t.row)),d=f(()=>Ro("privateTextIsOn",t.row)),u=O(0),g=f(()=>void 0!==v(s).rowImageBoxWidth?v(s).rowImageBoxWidth:50),p=f(()=>Wo(t.row.requireds)),m=f(()=>t.row.onlyIfNoChoices&&0!==t.row.currentChoices),h=f(()=>t.row.rowJustify?"justify-".concat(t.row.rowJustify):""),w=f(()=>Fo(t.row.title)),T=f(()=>Fo(t.row.titleText)),A=f(()=>{const e=[];if(void 0!==t.row.resultGroupId&&""!==t.row.resultGroupId&&t.row.resultGroupId)for(const[o]of kt){const i=Ft.get(o);if(void 0!==i){const o=i.choice,n=i.row;if(!o.isNotResult)if(t.row.resultGroupId===n.resultGroupId)e.push({choice:o,row:n});else if(void 0!==o.groups)for(let i=0;i<o.groups.length;i++)if(o.groups[i]===t.row.resultGroupId){e.push({choice:o,row:n});break}}}else for(const[t]of kt){const o=Ft.get(t);if(void 0!==o){const t=o.choice,i=o.row;t.isNotResult||e.push({choice:t,row:i})}}return e.sort((e,t)=>e.row.index!==t.row.index?e.row.index-t.row.index:e.choice.index-t.choice.index),e}),j=f(()=>{const e=[];if(void 0!==t.row.resultGroupId){const o=Rt.get(t.row.resultGroupId);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=Ft.get(o.elements[t]);void 0!==i&&e.push({choice:i.choice,row:i.row})}}return e.sort((e,t)=>e.row.index!==t.row.index?e.row.index-t.row.index:e.choice.index-t.choice.index),e}),q=f(()=>{if(void 0!==t.row.styling&&t.row.isPrivateStyling&&t.row.privateBackgroundIsOn&&t.row.styling.backgroundImage)return t.row.styling;if(void 0!==app.rowDesignGroups&&t.row.rowDesignGroups)for(let e=0;e<t.row.rowDesignGroups.length;e++){let o=$t.get(t.row.rowDesignGroups[e]);if(void 0!==o&&o.privateBackgroundIsOn&&o.styling.backgroundImage){let e=o.activatedId,t=jt.get(e);if(""===e||qo(o.activatedId))return o.styling;if(void 0!==app.globalRequirements&&void 0!==t&&Wo(t.requireds))return o.styling}}return!1}),W=f(()=>{if(void 0!==t.row.styling&&t.row.isPrivateStyling&&t.row.privateBackgroundIsOn&&t.row.styling.bgColorIsOn&&t.row.styling.backgroundColor)return t.row.styling;if(void 0!==app.rowDesignGroups&&t.row.rowDesignGroups)for(let e=0;e<t.row.rowDesignGroups.length;e++){let o=$t.get(t.row.rowDesignGroups[e]);if(void 0!==o&&o.privateBackgroundIsOn&&o.styling.bgColorIsOn&&o.styling.backgroundColor){let e=o.activatedId,t=jt.get(e);if(""===e||qo(o.activatedId))return o.styling;if(void 0!==app.globalRequirements&&void 0!==t&&Wo(t.requireds))return o.styling}}return!1}),N=f(()=>{let e=[];return e.push("margin: ".concat(v(c).rowBodyMarginTop,"px ").concat(v(c).rowBodyMarginSides,"% ").concat(v(c).rowBodyMarginBottom,"px ").concat(v(c).rowBodyMarginSides,"%;")),v(q)&&e.push("background-image: url('".concat(v(q).backgroundImage,"'); ").concat(v(q).isBackgroundRepeat?"background-repeat: repeat;":v(q).isBackgroundFitIn?"background-size: 100% 100%;":"background-size: cover;")),v(W)&&e.push("background-color: ".concat(en(v(W).backgroundColor),";")),e.join(" ")}),U=f(()=>{let e=v(c).rowBorderRadiusIsPixels?"px":"%",t=[];return v(c).rowBorderImage&&t.push("border-image: url('".concat(v(c).rowBorderImage,"') ").concat(v(c).rowBorderImageSliceTop," ").concat(v(c).rowBorderImageSliceRight," ").concat(v(c).rowBorderImageSliceBottom," ").concat(v(c).rowBorderImageSliceLeft," / ").concat(v(c).rowBorderImageWidth,"px ").concat(v(c).rowBorderImageRepeat,"; border-style: solid; padding: ").concat(v(c).rowBorderImageWidth,"px;")),v(a).rowBackgroundImage&&t.push("background-image: url('".concat(v(a).rowBackgroundImage,"'); ").concat(v(a).isRowBackgroundRepeat?"background-repeat: repeat;":v(a).isRowBackgroundFitIn?"background-size: 100% 100%;":"background-size: cover;")),v(a).rowBgColorIsOn&&t.push("background-color: ".concat(en(v(a).rowBgColor),";")),t.push("margin-left: ".concat(v(c).rowMargin,"%; margin-right: ").concat(v(c).rowMargin,"%;")),v(c).rowGradientIsOn&&t.push("background-image: linear-gradient(".concat(v(c).rowGradient,");")),t.push("border-radius: ".concat(v(c).rowBorderRadiusTopLeft).concat(e," ").concat(v(c).rowBorderRadiusTopRight).concat(e," ").concat(v(c).rowBorderRadiusBottomRight).concat(e," ").concat(v(c).rowBorderRadiusBottomLeft).concat(e,";")),v(c).rowOverflowIsOn&&t.push("overflow: hidden;"),v(c).rowBorderIsOn&&t.push("border: ".concat(v(c).rowBorderWidth,"px ").concat(v(c).rowBorderStyle," ").concat(en(v(c).rowBorderColor),";")),v(c).rowDropShadowIsOn&&(v(c).rowUseBoxShadowIsOn?t.push("box-shadow: ".concat(v(c).rowDropShadowH,"px ").concat(v(c).rowDropShadowV,"px ").concat(v(c).rowDropShadowBlur,"px ").concat(v(c).rowDropShadowSpread,"px ").concat(en(v(c).rowDropShadowColor),";")):t.push("filter: drop-shadow(".concat(v(c).rowDropShadowH,"px ").concat(v(c).rowDropShadowV,"px ").concat(v(c).rowDropShadowBlur,"px ").concat(en(v(c).rowDropShadowColor),");"))),t.join(" ")}),L=f(()=>"white-space: pre-line; font-family: '".concat(v(d).rowTitle,"'; font-size: ").concat(v(d).rowTitleTextSize,"%; text-align: ").concat(v(d).rowTitleAlign,"; color: ").concat(en(v(d).rowTitleColor))),E=f(()=>"white-space: pre-wrap; font-family: '".concat(v(d).rowText,"'; font-size: ").concat(v(d).rowTextTextSize,"%; text-align: ").concat(v(d).rowTextAlign,"; color: ").concat(en(v(d).rowTextColor),"; padding: ").concat(v(c).rowTextPaddingX,"px ").concat(v(c).rowTextPaddingY,"% ").concat(v(c).rowTextPaddingX,"px ").concat(v(c).rowTextPaddingY,"%;")),z=f(()=>{let e=v(s).rowImgBorderRadiusIsPixels?"px":"%",t=[];if(t.push("width: ".concat(v(s).rowImageWidth,"%; margin-top: ").concat(v(s).rowImageMarginTop,"%; margin-bottom: ").concat(v(s).rowImageMarginBottom,"%;")),v(s).rowImgObjectFillIsOn){t.push("object-fit: ".concat(v(s).rowImgObjectFillStyle,";"));const e=v(s).rowImgObjectFillHeight;e&&t.push("height: ".concat(e,"px;"))}return t.push("border-radius: ".concat(v(s).rowImgBorderRadiusTopLeft).concat(e," ").concat(v(s).rowImgBorderRadiusTopRight).concat(e," ").concat(v(s).rowImgBorderRadiusBottomRight).concat(e," ").concat(v(s).rowImgBorderRadiusBottomLeft).concat(e,";")),v(s).rowImgOverflowIsOn&&t.push("overflow: hidden;"),v(s).rowImgBorderIsOn&&t.push("border: ".concat(v(s).rowImgBorderWidth,"px ").concat(v(s).rowImgBorderStyle," ").concat(en(v(s).rowImgBorderColor),";")),t.join(" ")}),G=f(()=>"padding-left: ".concat(v(c).rowButtonYPadding,"px; padding-right: ").concat(v(c).rowButtonYPadding,"px; padding-top: ").concat(v(c).rowButtonXPadding,"px; padding-bottom: ").concat(v(c).rowButtonXPadding,"px;"));function H(){if(t.row.btnPointAddon&&"sumaddon"===t.row.buttonTypeRadio&&void 0!==t.row.pointTypeRandom){const e=t.row.randomMax||0,o=t.row.randomMin||0,i=Math.floor(Math.random()*(e-o)+o),l=new n,a=Mt.get(t.row.pointTypeRandom);if(void 0!==a){if(a.belowZeroNotAllowed&&a.startingSum+i<0)return;const e=kt.get(t.row.id);let o=0;a.startingSum+=i,void 0!==e&&e.pointNum&&(o=e.pointNum),Array.from(kt.entries()).forEach(([e,t])=>{const o=Ft.get(e);if(void 0!==o){const e=o.row,i=o.choice;if(!Wo(i.requireds))if(i.forcedActivated&&(delete i.forcedActivated,i.isAllowDeselect||Bt.set(i.id,{multiple:t.multiple})),0===t.multiple){if(i.isActive){const t={...r};t.isOverDlg=!0,t.isOverImg=!0,si(i,e,t)}}else if(t.multiple>0)for(let o=0;o<t.multiple;o++)if(i.isActive){const t={...r};t.isOverDlg=!0,t.isOverImg=!0,ui(i,e,t)}}}),kt.set(t.row.id,{multiple:0,isRowButton:!0,rndPoint:t.row.pointTypeRandom,pointNum:o+i}),l.set(a.id,i),li(null,l,0,void 0,void 0,r),ai(r)}return}if(t.row.buttonRandom){const e=[],o=t.row.objects.filter(e=>Wo(e.requireds)&&(!e.isNotSelectable||t.row.allowActivateUnselectable));if(t.row.isWeightedRandom){let e=0;for(let t=0;t<o.length;t++){e+=o[t].randomWeight||100}if(void 0!==t.row.buttonRandomNumber)for(let i=0;i<t.row.buttonRandomNumber;i++){const i=Math.floor(Math.random()*e);let n=0;for(let e=0;e<o.length;e++){const r=o[e];if(n+=r.randomWeight||100,i<n){r.isSelectableMultiple&&r.isMultipleUseVariable&&r.numMultipleTimesPluss?r.numMultipleTimesPluss>r.multipleUseVariable?di(r,t.row,v(l).options):ui(r,t.row,v(l).options):v(l).activateObject(r,t.row);break}}}}else if(void 0!==t.row.buttonRandomNumber)for(let i=0;i<t.row.buttonRandomNumber;i++){let i,n,r=0,a=100;do{n=Math.floor(Math.random()*o.length),i=o[n],r++}while(t.row.onlyUnselectedChoices&&(-1!==e.indexOf(n)||kt.has(i.id))&&r<a);i&&-1===e.indexOf(n)&&(e.push(n),i.isSelectableMultiple&&i.isMultipleUseVariable&&i.numMultipleTimesPluss?i.numMultipleTimesPluss>i.multipleUseVariable?di(i,t.row,v(l).options):ui(i,t.row,v(l).options):v(l).activateObject(i,t.row))}}else if(void 0!==t.row.buttonId){const e=Pt.get(t.row.buttonId);void 0!==e&&(kt.has(e.id)?t.row.buttonType&&(e.isTrue=!1,kt.delete(e.id)):(e.isTrue=!0,kt.set(e.id,{multiple:0,isVariable:!0})))}}function _(e){navigator.clipboard.writeText(t.row.imageSourceTooltip).then(()=>{Zt.labelText="Tooltip copied to clipboard.",Zt.isOpen=!0}).catch(()=>{console.log(t.row.imageSourceTooltip),Zt.labelText="Tooltip text logged to developer console.",Zt.isOpen=!0})}b(()=>{if(t.row.deselectChoices&&!v(p))for(let e=0;e<t.row.objects.length;e++){const o=t.row.objects[e];if(o.isActive)if(o.isSelectableMultiple){if(o.isMultipleUseVariable){const e=o.multipleUseVariable;if(e>0)for(let i=0;i<e;i++)ui(o,t.row,v(l).options);else if(e<0)for(let i=e;i<0;i++)di(o,t.row,v(l).options)}}else v(l).activateObject(o,t.row)}});var Y=ha(),J=D(Y),Z=e=>{var i=pa(),n=D(i),r=e=>{var i=oa(),n=D(i),r=e=>{var i=k(),n=B(i),r=e=>{{let o=f(()=>!t.row.buttonType&&void 0!==t.row.buttonId&&kt.has(t.row.buttonId)||v(m));fe(e,{class:"row-button",onclickcapture:H,get disabled(){return v(o)},get style(){return v(G)},variant:"raised",children:(e,o)=>{be(e,{children:(e,o)=>{var i=k(),n=B(i);M(n,()=>void 0!==t.row.buttonText?t.row.buttonText:"Click"),y(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})}},l=e=>{var i=k(),n=B(i),r=e=>{var i=k(),n=B(i),r=e=>{var i=Yl();i.__contextmenu=_,P(i,(e,t)=>null==rn?void 0:rn(e,t),()=>t.row.imageSourceTooltip),$(()=>{Le(i,"src",t.row.image),qe(i,v(z)),Le(i,"loading",o()?"eager":"lazy")}),y(e,i)},l=e=>{var i=Jl();$(()=>{Le(i,"src",t.row.image),qe(i,v(z)),Le(i,"loading",o()?"eager":"lazy")}),y(e,i)};ee(n,e=>{t.row.imageSourceTooltip?e(r):e(l,!1)}),y(e,i)};ee(n,e=>{t.row.image&&e(r)},!0),y(e,i)};ee(n,e=>{t.row.isButtonRow?e(r):e(l,!1)}),y(e,i)};ee(n,e=>{(1===t.row.template||t.windowWidth<=1280)&&e(r)});var l=te(n,2),a=e=>{var t=k(),o=B(t);I(o,()=>v(w),e=>{var t=Zl(),o=D(t);M(o,()=>Ge.sanitize(v(w),Et)),$(()=>qe(t,v(L))),y(e,t)}),y(e,t)};ee(l,e=>{""!==t.row.title&&e(a)});var s=te(l,2),c=e=>{var i=k(),n=B(i),r=e=>{{let o=f(()=>!t.row.buttonType&&void 0!==t.row.buttonId&&kt.has(t.row.buttonId)||v(m));fe(e,{class:"row-button",onclickcapture:H,get disabled(){return v(o)},get style(){return v(G)},variant:"raised",children:(e,o)=>{be(e,{children:(e,o)=>{var i=k(),n=B(i);M(n,()=>void 0!==t.row.buttonText?t.row.buttonText:"Click"),y(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})}},l=e=>{var i=k(),n=B(i),r=e=>{var i=k(),n=B(i),r=e=>{var i=Xl();i.__contextmenu=_,P(i,(e,t)=>null==rn?void 0:rn(e,t),()=>t.row.imageSourceTooltip),$(()=>{Le(i,"src",t.row.image),qe(i,v(z)),Le(i,"loading",o()?"eager":"lazy")}),y(e,i)},l=e=>{var i=Kl();$(()=>{Le(i,"src",t.row.image),qe(i,v(z)),Le(i,"loading",o()?"eager":"lazy")}),y(e,i)};ee(n,e=>{t.row.imageSourceTooltip?e(r):e(l,!1)}),y(e,i)};ee(n,e=>{t.row.image&&e(r)},!0),y(e,i)};ee(n,e=>{t.row.isButtonRow?e(r):e(l,!1)}),y(e,i)};ee(s,e=>{5===t.row.template&&t.windowWidth>1280&&e(c)});var d=te(s,2),u=e=>{var t=k(),o=B(t);I(o,()=>v(T),e=>{var t=Ql(),o=D(t);M(o,()=>Ge.sanitize(v(T),Et)),$(()=>qe(t,v(E))),y(e,t)}),y(e,t)};ee(d,e=>{""!==t.row.titleText&&e(u)});var g=te(d,2),p=e=>{var i=k(),n=B(i),r=e=>{{let o=f(()=>!t.row.buttonType&&void 0!==t.row.buttonId&&kt.has(t.row.buttonId)||v(m));fe(e,{class:"row-button",onclickcapture:H,get disabled(){return v(o)},get style(){return v(G)},variant:"raised",children:(e,o)=>{be(e,{children:(e,o)=>{var i=k(),n=B(i);M(n,()=>void 0!==t.row.buttonText?t.row.buttonText:"Click"),y(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})}},l=e=>{var i=k(),n=B(i),r=e=>{var i=k(),n=B(i),r=e=>{var i=ea();i.__contextmenu=_,P(i,(e,t)=>null==rn?void 0:rn(e,t),()=>t.row.imageSourceTooltip),$(()=>{Le(i,"src",t.row.image),qe(i,v(z)),Le(i,"loading",o()?"eager":"lazy")}),y(e,i)},l=e=>{var i=ta();$(()=>{Le(i,"src",t.row.image),qe(i,v(z)),Le(i,"loading",o()?"eager":"lazy")}),y(e,i)};ee(n,e=>{t.row.imageSourceTooltip?e(r):e(l,!1)}),y(e,i)};ee(n,e=>{t.row.image&&e(r)},!0),y(e,i)};ee(n,e=>{t.row.isButtonRow?e(r):e(l,!1)}),y(e,i)};ee(g,e=>{4===t.row.template&&t.windowWidth>1280&&e(p)}),y(e,i)},l=e=>{var i=k(),n=B(i),r=e=>{var i=aa(),n=B(i),r=D(n),l=e=>{var t=k(),o=B(t);I(o,()=>v(w),e=>{var t=ia(),o=D(t);M(o,()=>Ge.sanitize(v(w),Et)),$(()=>qe(t,v(L))),y(e,t)}),y(e,t)};ee(r,e=>{""!==t.row.title&&e(l)});var a=te(r,2),s=e=>{var t=k(),o=B(t);I(o,()=>v(T),e=>{var t=na(),o=D(t);M(o,()=>Ge.sanitize(v(T),Et)),$(()=>qe(t,v(E))),y(e,t)}),y(e,t)};ee(a,e=>{""!==t.row.titleText&&e(s)});var c=te(n,2),d=D(c),u=e=>{{let o=f(()=>!t.row.buttonType&&void 0!==t.row.buttonId&&kt.has(t.row.buttonId)||v(m));fe(e,{class:"row-button",onclickcapture:H,get disabled(){return v(o)},get style(){return v(G)},variant:"raised",children:(e,o)=>{be(e,{children:(e,o)=>{var i=k(),n=B(i);M(n,()=>void 0!==t.row.buttonText?t.row.buttonText:"Click"),y(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})}},p=e=>{var i=k(),n=B(i),r=e=>{var i=k(),n=B(i),r=e=>{var i=ra();i.__contextmenu=_,P(i,(e,t)=>null==rn?void 0:rn(e,t),()=>t.row.imageSourceTooltip),$(()=>{Le(i,"src",t.row.image),qe(i,v(z)),Le(i,"loading",o()?"eager":"lazy")}),y(e,i)},l=e=>{var i=la();$(()=>{Le(i,"src",t.row.image),qe(i,v(z)),Le(i,"loading",o()?"eager":"lazy")}),y(e,i)};ee(n,e=>{t.row.imageSourceTooltip?e(r):e(l,!1)}),y(e,i)};ee(n,e=>{t.row.image&&e(r)},!0),y(e,i)};ee(d,e=>{t.row.isButtonRow?e(u):e(p,!1)}),$(()=>{var e;qe(n,"max-width: ".concat(100-v(g),"%")),qe(c,"max-width: ".concat(null!=(e=v(g))?e:"","%"))}),y(e,i)},l=e=>{var i=k(),n=B(i),r=e=>{var i=ga(),n=B(i),r=D(n),l=e=>{{let o=f(()=>!t.row.buttonType&&void 0!==t.row.buttonId&&kt.has(t.row.buttonId)||v(m));fe(e,{class:"row-button",onclickcapture:H,get disabled(){return v(o)},get style(){return v(G)},variant:"raised",children:(e,o)=>{be(e,{children:(e,o)=>{var i=k(),n=B(i);M(n,()=>void 0!==t.row.buttonText?t.row.buttonText:"Click"),y(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})}},a=e=>{var i=k(),n=B(i),r=e=>{var i=k(),n=B(i),r=e=>{var i=sa();i.__contextmenu=_,P(i,(e,t)=>null==rn?void 0:rn(e,t),()=>t.row.imageSourceTooltip),$(()=>{Le(i,"src",t.row.image),qe(i,v(z)),Le(i,"loading",o()?"eager":"lazy")}),y(e,i)},l=e=>{var i=ca();$(()=>{Le(i,"src",t.row.image),qe(i,v(z)),Le(i,"loading",o()?"eager":"lazy")}),y(e,i)};ee(n,e=>{t.row.imageSourceTooltip?e(r):e(l,!1)}),y(e,i)};ee(n,e=>{t.row.image&&e(r)},!0),y(e,i)};ee(r,e=>{t.row.isButtonRow?e(l):e(a,!1)});var s=te(n,2),c=D(s),d=e=>{var t=k(),o=B(t);I(o,()=>v(w),e=>{var t=da(),o=D(t);M(o,()=>Ge.sanitize(v(w),Et)),$(()=>qe(t,v(L))),y(e,t)}),y(e,t)};ee(c,e=>{""!==t.row.title&&e(d)});var u=te(c,2),p=e=>{var t=k(),o=B(t);I(o,()=>v(T),e=>{var t=ua(),o=D(t);M(o,()=>Ge.sanitize(v(T),Et)),$(()=>qe(t,v(E))),y(e,t)}),y(e,t)};ee(u,e=>{""!==t.row.titleText&&e(p)}),$(()=>{var e;qe(n,"max-width: ".concat(null!=(e=v(g))?e:"","%")),qe(s,"max-width: ".concat(100-v(g),"%"))}),y(e,i)};ee(n,e=>{3===t.row.template&&e(r)},!0),y(e,i)};ee(n,e=>{2===t.row.template?e(r):e(l,!1)}),y(e,i)};ee(n,e=>{t.row.template>=4||1===t.row.template||t.windowWidth<=1280?e(r):e(l,!1)}),$(()=>{var e,o;V(i,1,"row gx-0 row-".concat(null!=(e=t.row.id)?e:""," row-").concat(null!=(o=t.row.id)?o:"","-header")),qe(i,""!==t.row.title?v(U):"")}),y(e,i)};ee(J,e=>{v(p)&&e(Z)});var X=te(J,2),K=e=>{var n=ma(),r=D(n),a=e=>{var i=k(),n=B(i);Re(n,17,()=>v(A),$e,(e,i,n)=>{S(zl(e,{get row(){return t.row},get choice(){return v(i).choice},index:n,get windowWidth(){return t.windowWidth},get preloadImages(){return o()}}),e=>F(l,e,!0),()=>v(l))}),y(e,i)},s=e=>{var n=k(),r=B(n),a=e=>{var n=k(),r=B(n);Re(r,17,()=>v(j),$e,(e,n,r)=>{S(zl(e,{get row(){return t.row},get choice(){return v(n).choice},index:r,get windowWidth(){return t.windowWidth},get preloadImages(){return o()},get isBackpack(){return i()},get mainDiv(){return t.mainDiv}}),e=>F(l,e,!0),()=>v(l))}),y(e,n)},s=e=>{var n=k(),r=B(n);Re(r,17,()=>t.row.objects,$e,(e,n,r)=>{S(zl(e,{get row(){return t.row},get choice(){return v(n)},index:r,get windowWidth(){return t.windowWidth},get preloadImages(){return o()},get isBackpack(){return i()},get mainDiv(){return t.mainDiv}}),e=>F(l,e,!0),()=>v(l))}),y(e,n)};ee(r,e=>{t.row.isGroupRow?e(a):e(s,!1)},!0),y(e,n)};ee(r,e=>{t.row.isResultRow?e(a):e(s,!1)}),$(()=>{var e;return V(n,1,"row gx-0 m-0 p-0 ".concat(null!=(e=v(h))?e:""))}),y(e,n)};ee(X,e=>{v(p)&&e(K)}),$(()=>{var e;V(Y,1,"row-".concat(null!=(e=t.row.id)?e:"","-bg text-center").concat(v(p)?"":" hidden")),qe(Y,v(N))}),_e(Y,"clientWidth",e=>F(u,e)),y(e,Y),C()}We(["contextmenu"]);var fa=T("<!> <!>",1),ba=T('<div class="p-0 col-12"><!></div>'),wa=T("<div><!></div>"),Ta=T('<div class="container-fluid p-0 h-100"><div class="row gx-0"></div></div>'),Ia=T("<!> <!> <!>",1);function Sa(e,t){x(t,!0);let o=R(t,"open",7),i=O(0),n=O(void 0),r=O(void 0),l=f(()=>{let e=[];return e.push("overflow-wrap: break-word;"),e.push("white-space: normal;"),app.styling.useBackpackDesign?(app.styling.backpackBgImage&&e.push("background-image: url('".concat(app.styling.backpackBgImage,"');")),e.push("background-color: ".concat(en(app.styling.backpackBgColor),";")),app.styling.isBackpackBgRepeat?e.push("background-repeat: repeat;"):app.styling.isBackpackBgFitIn?e.push("background-size: 100% 100%;"):e.push("background-size: cover;")):(app.styling.backgroundImage&&e.push("background-image: url('".concat(app.styling.backgroundImage,"');")),e.push("background-color: ".concat(en(app.styling.backgroundColor),";")),app.styling.isBackgroundRepeat?e.push("background-repeat: repeat;"):app.styling.isBackgroundFitIn?e.push("background-size: 100% 100%;"):e.push("background-size: cover;")),e.join(" ")});{let a=f(()=>"dlgBackpack"!==_t.currentDialog?"close":""),s=f(()=>"dlgBackpack"!==_t.currentDialog?"close":""),c=f(()=>void 0!==app.styling.backPackWidth?app.styling.backPackWidth:1200);ge(e,{get escapeKeyAction(){return v(a)},get scrimClickAction(){return v(s)},get surface$style(){var e;return"width: ".concat(null!=(e=v(c))?e:"","px; max-width: 100vw;")},get onSMUIDialogClosed(){return t.onclose},get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=Ia(),a=B(o);pe(a,{class:"p-0 m-0 row",tabindex:0,autofocus:!0,children:(e,t)=>{var o=ba(),i=D(o);fe(i,{onclickcapture:()=>async function(e){var t;if(e){let i=[];try{Zt.labelText="Downloading image...",Zt.isOpen=!0,Hi(e),await Gi(e);const t=(await pt.maxArea({usePromise:!0})).height,i=e.offsetHeight,n=e.offsetWidth;if(!Xt.isSingleFile&&i>t){let r=0,l=1;const a=Math.ceil(i/t);for(;r<i;){const s=Math.min(t,i-r),c=document.createElement("div");Zt.labelText="Splitting large image...(".concat(l," / ").concat(a,")"),Zt.isOpen=!0,app.styling.useBackpackDesign?(app.styling.backpackBgImage&&(c.style.backgroundImage=app.styling.backpackBgImage),app.styling.backpackBgColor&&(c.style.backgroundColor=en(app.styling.backpackBgColor)),app.styling.isBackpackBgRepeat?c.style.backgroundRepeat="repeat":app.styling.isBackpackBgFitIn?c.style.backgroundSize="100% 100%":c.style.backgroundSize="cover"):(app.styling.backgroundImage&&(c.style.backgroundImage=app.styling.backgroundImage),app.styling.backgroundColor&&(c.style.backgroundColor=en(app.styling.backgroundColor)),app.styling.isBackgroundRepeat?c.style.backgroundRepeat="repeat":app.styling.isBackgroundFitIn?c.style.backgroundSize="100% 100%":c.style.backgroundSize="cover"),e.parentElement&&e.parentElement.classList.contains("mdc-dialog__content")&&c.classList.add("backpack-wrapper"),c.style.width="".concat(n,"px"),c.style.height="".concat(s,"px"),c.style.overflow="hidden",c.style.position="absolute",c.style.display="block",c.style.top="0",c.style.left="0",c.style.zIndex="-9999",c.style.pointerEvents="none";const d=e.cloneNode(!0);Hi(d),d.style.position="relative",d.style.top="-".concat(r,"px"),c.appendChild(d),document.body.appendChild(c),await Gi(c),await _i(c),await Yi(5);try{const e=await h(c,{filter:e=>{var t,o;return!(null==(t=e.classList)?void 0:t.contains("mdc-top-app-bar"))&&!(null==(o=e.classList)?void 0:o.contains("hidden"))&&e.nodeType!==Node.COMMENT_NODE}});if(!e)throw new Error("blob creation failed");const t=URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download="Build_".concat(vo(),"_part").concat(l++,".png"),o.target="_blank",o.click(),setTimeout(()=>{URL.revokeObjectURL(t)},1e3)}catch(o){Zt.labelText="Download failed: Restricted content detected.",Zt.isOpen=!0,console.error(o)}finally{document.body.removeChild(c)}r+=t}Zt.labelText="Image downloads complete.",Zt.isOpen=!0}else{const t=await h(e,{filter:e=>{var t,o;return!(null==(t=e.classList)?void 0:t.contains("mdc-top-app-bar"))&&!(null==(o=e.classList)?void 0:o.contains("hidden"))&&e.nodeType!==Node.COMMENT_NODE}});if(!t)throw new Error("blob creation failed");const o=URL.createObjectURL(t),i=document.createElement("a");i.href=o,i.download="Build_".concat(vo(),".png"),i.target="_blank",i.click(),setTimeout(()=>{URL.revokeObjectURL(o)},1e3),Zt.labelText="Image download complete.",Zt.isOpen=!0}}catch(o){Zt.labelText="Download failed: Restricted content detected.",Zt.isOpen=!0,console.error(o)}finally{for(let e=0;e<i.length;e++){const o=i[e];o.style.removeProperty("height"),""===(null==(t=o.getAttribute("style"))?void 0:t.trim())&&o.removeAttribute("style")}}}else Zt.labelText="Download failed: Cannot find window.",Zt.isOpen=!0}(v(n)),class:"h-100",children:(e,t)=>{var o=fa(),i=B(o);Ye(i,{class:"mdi mdi-file-image"});var n=te(i,2);be(n,{children:(e,t)=>{var o=se("Download Image");y(e,o)},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}});var s=te(a,2);me(s,{id:"backpackDialog",class:"p-0",children:(e,t)=>{var o=Ta(),a=D(o);Re(a,21,()=>app.backpack,$e,(e,t)=>{var o=wa();va(D(o),{get row(){return v(t)},get windowWidth(){return v(i)},get preloadImages(){return app.preloadImages},isBackpack:!0}),$(()=>V(o,1,W(v(t).width?"col-6":"col-12"))),y(e,o)}),S(a,e=>F(r,e),()=>v(r)),S(o,e=>F(n,e),()=>v(n)),$(()=>qe(o,v(l))),_e(o,"clientWidth",e=>F(i,e)),y(e,o)},$$slots:{default:!0}});var c=te(s,2);we(c,{class:"p-0",style:"min-height: 36px",children:(e,t)=>{fe(e,{action:"close",children:(e,t)=>{be(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=se("Close");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}})}C()}var ya=T("<div><!></div>"),Ca=(e,t)=>{e.preventDefault(),t()},xa=T('<span class="picture-inner-text"><!></span>'),Oa=T('<span class="picture-inner-text"><!></span>'),Aa=T('<div class="picture-inner"><!></div>'),ka=T('<div class="preview-container"><canvas tabindex="0"></canvas> <!></div> <!> <!> <!>',1),Ba=T("<div><!></div> <!> <!>",1),Ma=T("<div><!></div>"),Da=T('<div id="picture-input" class="picture-input"><!> <input type="file"/></div>');function Fa(e,o){x(o,!0);let n,r,l=R(o,"width",19,()=>Number.MAX_SAFE_INTEGER),a=R(o,"height",19,()=>Number.MAX_SAFE_INTEGER),s=R(o,"margin",3,0),c=R(o,"accept",3,"image/*, image/avif"),d=R(o,"capture",3,null),u=R(o,"size",19,()=>Number.MAX_SAFE_INTEGER),g=R(o,"name",3,null),m=R(o,"id",3,null),h=R(o,"buttonClass",3,""),T=R(o,"removeButtonClass",3,""),I=R(o,"aspectButtonClass",3,""),A=R(o,"prefill",11,""),j=R(o,"prefillOptions",19,()=>({})),q=R(o,"crop",3,!0),P=R(o,"radius",3,0),W=R(o,"removable",3,!1),N=R(o,"hideChangeButton",3,!1),U=R(o,"autoToggleAspectRatio",3,!1),L=R(o,"toggleAspectRatio",3,!1),z=R(o,"changeOnClick",3,!0),G=R(o,"plain",3,!1),H=R(o,"zIndex",3,1e4),_=R(o,"alertOnError",3,!0),Y=R(o,"customStrings",19,()=>({})),J=O(!1),Z=O(0),X=O(0),K=O(!1),Q=O(0),oe=O(0),ie=O(1),ne=O(0),re=O(""),le=O(null),ae=O(null),de=O(""),ue=O(0),ge=O(0),pe=O(""),me=O(!1),he=O(0),ve=O(0),we=O(0),Te=O(null),Ie=O(i([])),Se={upload:"<p>Your device does not support file uploading.</p>",drag:"Drag an image or <br>click here to select a file",tap:"Tap here to select a photo <br>from your gallery",change:"Change Photo",aspect:"Landscape/Portrait",remove:"Remove Photo",select:"Select a Photo",selected:"<p>Photo successfully selected!</p>",fileSize:"The file size exceeds the limit",fileType:"This file type is not supported."},ye=O(void 0);const Ce=f(()=>{if(navigator.userAgent.match(/(Android (1\.0|1\.1|1\.5|1\.6|2\.0|2\.1))|(Windows Phone (OS 7|8\.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1\.0|2\.0|2\.5|3\.0))/))return!1;const e=document.createElement("input");return e.type="file",!e.disabled}),xe=f(()=>!(!window.FileReader||!window.CanvasRenderingContext2D)),Oe=f(()=>{const e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&!("ontouchstart"in window||navigator.maxTouchPoints)}),Ae=f(()=>v(K)?"dragging-over":""),ke=f(()=>"".concat(Math.min(.04*v(X),21),"px"));function Be(){v(J)&&!z()||Pe(),o.onclick&&o.onclick()}function Me(){We()&&v(le)&&je(v(le))}function De(){v(Oe)&&F(K,!1)}function Fe(e,t=!1){var i;const n=e.target,r="drop"===e.type?null==(i=e.dataTransfer)?void 0:i.files:n.files;if(r&&0!==r.length){if(r[0].size<=0||r[0].size>1024*Number(u())*1024)return o.onerror&&o.onerror({type:"fileSize",fileSize:r[0].size,fileType:r[0].type,fileName:r[0].name,message:"".concat(Se.fileSize," (").concat(u(),"MB)")}),void(_()&&alert("".concat(Se.fileSize," (").concat(u(),"MB)")));if(r[0].name!==v(de)||r[0].size!==v(ue)||v(ge)!==r[0].lastModified){if(F(ae,r[0],!0),F(de,r[0].name,!0),F(ue,r[0].size,!0),F(ge,r[0].lastModified,!0),F(pe,r[0].type.split(";")[0],!0),"image/*, image/avif"===c()){if(!v(pe).startsWith("image/"))return}else if(-1===v(Ie).indexOf(v(pe)))return o.onerror&&o.onerror({type:"fileType",fileSize:v(ue),fileType:v(pe),fileName:v(de),message:Se.fileType}),void(_()&&alert(Se.fileType));F(J,!0),F(re,""),v(xe)&&v(ae)?Re(v(ae),t):t?o.onprefill&&o.onprefill():o.onchange&&o.onchange(v(re))}}}function Re(e,t){!function(e,t){const o=new FileReader;o.onload=e=>{const o=new DataView(e.target.result);if(65496!==o.getUint16(0,!1))return t(-2);const i=o.byteLength;let n=2;for(;n<i;){const e=o.getUint16(n,!1);if(n+=2,65505===e){if(1165519206!==o.getUint32(n+=2,!1))return t(-1);const e=18761===o.getUint16(n+=6,!1);n+=o.getUint32(n+4,e);const i=o.getUint16(n,e);n+=2;for(let r=0;r<i;r++)if(274===o.getUint16(n+12*r,e))return t(o.getUint16(n+12*r+8,e))}else{if(65280&~e)break;n+=o.getUint16(n,!1)}}return t(-1)},o.readAsArrayBuffer(e.slice(0,65536))}(e,i=>{!function(e){F(me,!1),8===e?F(me,-Math.PI/2):6===e?F(me,Math.PI/2):3===e&&F(me,-Math.PI)}(i);const n=new FileReader;n.onload=e=>{F(re,e.target.result,!0),F(le,new Image,!0),v(le).onload=()=>{if(U()){Ne(v(Q),v(oe))!==Ne(v(le).width,v(le).height)&&Ee()}je(v(le))},v(le).src=v(re),!t&&o.onchange&&o.onchange(v(re))},n.readAsDataURL(e)})}function je(e){F(he,e.width,!0),F(ve,e.height,!0),F(we,e.width/e.height);let t=0,o=0,i=v(X),n=v(Z);const r=v(X)/v(Z);q()?v(we)>=r?(i=n*v(we),t=(v(X)-i)/2):(n=i/v(we),o=(v(Z)-n)/2):v(we)>=r?(n=i/v(we),o=(v(Z)-n)/2):(i=n*v(we),t=(v(X)-i)/2),v(ye)&&(v(ye).style.background="none",v(ye).width=v(X)*v(ie),v(ye).height=v(Z)*v(ie),v(Te)&&(v(Te).setTransform(1,0,0,1,0,0),v(Te).clearRect(0,0,v(ye).width,v(ye).height),v(me)&&void 0===e.style.imageOrientation&&(v(Te).translate(t*v(ie),o*v(ie)),v(Te).translate(i/2*v(ie),n/2*v(ie)),v(Te).rotate(v(me)),t=-i/2,o=-n/2),v(Te).drawImage(e,t*v(ie),o*v(ie),i*v(ie),n*v(ie))))}function Pe(){r.click()}function $e(){r.value="",r.type="",r.type="file",F(de,""),F(pe,""),F(ue,0),F(ge,0),F(J,!1),F(re,""),F(ae,null),F(le,null),v(ye)&&(v(ye).style.backgroundColor="rgba(200,200,200,.25)",v(ye).width=v(X)*v(ie)),o.onremove&&o.onremove()}function Ve(){Ee(),v(le)&&je(v(le));const e=Ne(v(Q),v(oe));o.onaspectratiochange&&o.onaspectratiochange(e)}function We(){const e=v(Q)/v(oe),t=n.clientWidth;return!!t&&(!(!L()&&!U()&&t===v(ne))&&(F(ne,t,!0),F(X,Math.min(v(ne)-2*Number(s()),v(Q)),!0),F(Z,v(X)/e),!0))}function Ne(e,t){return e>t?"landscape":e<t?"portrait":"square"}function Ee(){!function(){const e=v(Q);F(Q,v(oe),!0),F(oe,e,!0)}(),We()}function ze(e,i){let n=window.File;try{new n([],"")}catch(l){n=class extends Blob{constructor(e,o,i={}){super(e,i),t(this,"lastModifiedDate",new Date),t(this,"lastModified",+this.lastModifiedDate),t(this,"name"),this.name=o}}}if(i=Object.assign({},i),"object"==typeof e)return F(J,!0),F(re,""),void(v(xe)?Re(e,!0):o.onprefill&&o.onprefill());-1===e.indexOf("data:")&&(e+=-1!==e.indexOf("?")?"&_="+(new Date).getTime():"?_="+(new Date).getTime());const r=new Headers;r.append("Accept","image/*, image/avif"),fetch(e,{method:"GET",mode:"cors",headers:r}).then(e=>e.blob()).then(t=>{const o={target:{files:[]}},r=i.fileName||e.split("/").slice(-1)[0];let l=i.mediaType||t.type||"image/"+(i.fileType||r.split("?")[0].split(".").slice(-1)[0]);l=l.replace("jpg","jpeg").replace("image/svg","image/svg+xml"),"image/svg"===l&&(l="image/svg+xml"),o.target.files[0]=new n([t],r,{type:l}),Fe(o,!0)}).catch(e=>{o.onerror&&o.onerror({type:"failedPrefill",message:"Failed loading prefill image: "+e}),_()&&alert("Failed loading prefill image: "+e)})}b(()=>{A()&&ze(A(),j())}),E(async()=>{await p(),function(){if(Y())for(const e in Y())e in Se&&"string"==typeof Y()[e]&&(Se[e]=Y()[e])}(),A()&&ze(A(),j()),window.addEventListener("resize",Me),Me(),v(xe)&&v(ye)&&(F(ie,Math.round(window.devicePixelRatio||1),!0),v(ye).getContext&&(F(Te,v(ye).getContext("2d"),!0),v(Te)&&v(Te).scale(v(ie),v(ie)))),"image/*, image/avif"!==c()&&F(Ie,c().split(",").map(e=>e.trim()),!0),F(Q,l()!=Number.MAX_SAFE_INTEGER?Number(l()):n.clientWidth,!0),F(oe,a()!=Number.MAX_SAFE_INTEGER?Number(a()):v(Q),!0),F(X,v(Q),!0),F(Z,v(oe),!0)}),w(()=>{window.removeEventListener("resize",Me)});var Ge=Da(),He=D(Ge),_e=e=>{var t=ya(),o=D(t);M(o,()=>Se.upload),y(e,t)},Ye=e=>{var t=k(),o=B(t),i=e=>{var t=ka(),o=B(t),i=D(o);i.__click=[Ca,Be],S(i,e=>F(ye,e),()=>v(ye));var n=te(i,2),r=e=>{var t=Aa(),o=D(t),i=e=>{var t=xa(),o=D(t);M(o,()=>Se.drag),y(e,t)},n=e=>{var t=Oa(),o=D(t);M(o,()=>Se.tap),y(e,t)};ee(o,e=>{v(Oe)?e(i):e(n,!1)}),$(e=>{var o,i,n,r;return qe(t,"top: -".concat(null!=(o=v(Z))?o:"","px; margin-bottom: -").concat(null!=(i=v(Z))?i:"","px; font-size: ").concat(null!=(n=v(ke))?n:"","; border-radius: ").concat(null!=(r=P())?r:"","%; z-index: ").concat(null!=e?e:"",";"))},[()=>parseInt(H()+"")+2]),y(e,t)};ee(n,e=>{v(J)||G()||e(r)});var s=te(o,2),c=e=>{fe(e,{variant:"raised",onclick:Pe,get class(){return h()},children:(e,t)=>{be(e,{children:(e,t)=>{var o=se();$(()=>ce(o,Se.change)),y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};ee(s,e=>{v(J)&&!N()&&e(c)});var d=te(s,2),u=e=>{fe(e,{variant:"raised",onclick:$e,get class(){return T()},children:(e,t)=>{be(e,{children:(e,t)=>{var o=se();$(()=>ce(o,Se.remove)),y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};ee(d,e=>{v(J)&&W()&&e(u)});var g=te(d,2),p=e=>{fe(e,{variant:"raised",onclick:Ve,get class(){return I()},children:(e,t)=>{be(e,{children:(e,t)=>{var o=se();$(()=>ce(o,Se.aspect)),y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};ee(g,e=>{v(J)&&L()&&l()!==a()&&e(p)}),$(e=>{var t,n,r,l,a;qe(o,"max-width: ".concat(null!=(t=v(X))?t:"","px; height: ").concat(null!=(n=v(Z))?n:"","px; border-radius: ").concat(null!=(r=P())?r:"","%;")),V(i,1,"picture-preview ".concat(null!=(l=v(Ae))?l:"")),qe(i,"height: ".concat(null!=(a=v(Z))?a:"","px; z-index: ").concat(null!=e?e:"",";"))},[()=>parseInt(H()+"")+1]),Ue("drag",i,e=>{e.stopPropagation(),e.preventDefault()}),Ue("dragover",i,e=>{e.stopPropagation(),e.preventDefault()}),Ue("dragstart",i,e=>{e.stopPropagation(),e.preventDefault()}),Ue("dragend",i,e=>{e.stopPropagation(),e.preventDefault()}),Ue("dragenter",i,e=>{e.stopPropagation(),e.preventDefault(),v(Oe)&&F(K,!0)}),Ue("dragleave",i,e=>{e.stopPropagation(),e.preventDefault(),De()}),Ue("drop",i,e=>{e.stopPropagation(),e.preventDefault(),function(e){De(),Fe(e)}(e)}),y(e,t)},n=e=>{var t=Ma(),o=D(t),i=e=>{fe(e,{variant:"raised",onclick:Pe,get class(){return h()},children:(e,t)=>{be(e,{children:(e,t)=>{var o=se();$(()=>ce(o,Se.select)),y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},n=e=>{var t=Ba(),o=B(t),i=D(o);M(i,()=>Se.selected);var n=te(o,2),r=e=>{fe(e,{variant:"raised",onclick:Pe,get class(){return h()},children:(e,t)=>{be(e,{children:(e,t)=>{var o=se();$(()=>ce(o,Se.change)),y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};ee(n,e=>{N()||e(r)});var l=te(n,2),a=e=>{fe(e,{variant:"raised",onclick:$e,get class(){return T()},children:(e,t)=>{be(e,{children:(e,t)=>{var o=se();$(()=>ce(o,Se.remove)),y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};ee(l,e=>{W()&&e(a)}),y(e,t)};ee(o,e=>{v(J)?e(n,!1):e(i)}),y(e,t)};ee(o,e=>{v(xe)?e(i):e(n,!1)},!0),y(e,t)};ee(He,e=>{v(Ce)?e(Ye,!1):e(_e)});var Je=te(He,2);Je.__change=Fe,S(Je,e=>r=e,()=>r),S(Ge,e=>n=e,()=>n),$(()=>{Le(Je,"name",g()),Le(Je,"id",m()),Le(Je,"accept",c()),Le(Je,"capture",d())}),y(e,Ge),C()}We(["click","change"]);var Ra=T('<div class="mb-4 text-left"><!></div>'),ja=T('<img class="d-block w-100" alt="Converted" loading="lazy"/> <!> <!>',1),qa=T('<div class="col col-lg-4"><!> <!></div> <div class="col col-lg-8"><!></div>',1),Pa=T('<div><img alt="Cropper" loading="lazy" class="cropper-image"/></div>'),$a=T('<div class="row justify-center"><div class="col"><!></div> <div class="col"><!></div> <div class="col"><!></div></div> <div class="mt-2"><!></div> <!>',1),Va=T('<div class="pt-3 col col-12"><img class="d-block w-100" alt="Compress" loading="lazy"/></div>'),Wa=T('<div class="row justify-center"><div class="col"><!></div> <div class="col"><!></div> <div class="col"><!></div> <!></div>'),Na=T('<div class="col col-lg-4"><div><!></div> <div><b>Before:</b> <b>After:</b> </div> <!></div> <div class="col-lg-8"><!> <!> <!></div>',1),Ua=T('<div class="container"><!> <div class="row"><!></div></div>'),La=T('<div class="col-sm-6 col-12"><!></div> <div class="col-sm-6 col-12"><!></div>',1),Ea=T("<!> <!> <!>",1);function za(e,t){x(t,!0);let o,i=R(t,"open",7),n=R(t,"imgObject",7),r=R(t,"canHaveURL",3,!0),l=R(t,"isDeselect",3,!1),a=R(t,"closeHandler",3,e=>{}),s=O("Cropper"),c=O(100),d=O(90),u=!1,g=O(1),p=O(1),m=O(void 0),h=O(void 0),w=O(void 0),T=O(!1),I=[],A=!1,M=f(()=>{if(v(h)){const e=function(e){const t=e.match(/^data:.+;base64,(.+)$/);return t?t[1]:e}(v(h)).length*(3/4)-2;return Math.round(e/1024)}return 0}),j=f(()=>{if(v(w)){const e=v(w).split(",")[1].length*(3/4)-2;return Math.round(e/1024)}return 0});function P(e,t){const o=e.getImageData(),i=e.getData();let n=0,r=0;switch(t){case 0:n=0,r=0;break;case 1:n=(o.naturalWidth-i.width)/2,r=0;break;case 2:n=o.naturalWidth-i.width,r=0;break;case 3:n=0,r=(o.naturalHeight-i.height)/2;break;case 4:n=(o.naturalWidth-i.width)/2,r=(o.naturalHeight-i.height)/2;break;case 5:n=o.naturalWidth-i.width,r=(o.naturalHeight-i.height)/2;break;case 6:n=0,r=o.naturalHeight-i.height;break;case 7:n=(o.naturalWidth-i.width)/2,r=o.naturalHeight-i.height;break;case 8:n=o.naturalWidth-i.width,r=o.naturalHeight-i.height}e.setData({x:n,y:r})}function W(){const e=_(n(),t.imgProp);e&&z(e)}function N(){v(w)&&H(n(),t.imgProp,v(w))}function U(){o&&(o.setAspectRatio(v(p)/v(g)),P(o,app.cropperPosition))}function L(){if(o&&v(m)){const e=o.getCroppedCanvas().toDataURL("image/webp");v(m).src=e,H(n(),t.imgProp,e)}}function z(e){I.push(e),A||G()}function G(){const e=I.shift();if(e){A=!0;const t=document.createElement("canvas"),o=t.getContext("2d"),i=new Image;i.crossOrigin="anonymous",i.onload=()=>{const e=v(c)/100,n=i.width*e,r=i.height*e;t.setAttribute("width",n.toString()),t.setAttribute("height",r.toString()),null==o||o.drawImage(i,0,0,n,r),F(w,t.toDataURL("image/webp",v(d)/100),!0),u&&(u=!1,N()),G()},i.src=e}else A=!1}function H(e,t,i){e&&(e[t]=i,F(h,i,!0),o&&o.replace(i),z(i))}function _(e,t){return e&&e[t]?e[t]:""}function Y(){if(n().parentId){const e=Ft.get(n().parentId);if(void 0!==e)return void(e.row.defaultAspectWidth=v(p))}if(n().id){const e=Dt.get(n().id);if(void 0!==e)return void(e.defaultAspectWidth=v(p));const t=Ft.get(n().id);if(void 0!==t)return void(t.row.defaultAspectWidth=v(p))}}function J(){if(n().parentId){const e=Ft.get(n().parentId);if(void 0!==e)return void(e.row.defaultAspectHeight=v(g))}if(n().id){const e=Dt.get(n().id);if(void 0!==e)return void(e.defaultAspectHeight=v(g));const t=Ft.get(n().id);if(void 0!==t)return void(t.row.defaultAspectHeight=v(g))}}b(()=>(v(m)&&(o=new Je(v(m),{viewMode:3,dragMode:"move",ready(){P(o,app.cropperPosition)}})),()=>{o&&o.destroy()})),E(()=>{!function(){if(n().parentId){const e=Ft.get(n().parentId);return void(void 0!==e&&(void 0!==e.row.defaultAspectHeight&&F(g,e.row.defaultAspectHeight,!0),void 0!==e.row.defaultAspectWidth&&F(p,e.row.defaultAspectWidth,!0)))}if(n().id){const e=Dt.get(n().id);if(void 0!==e)return void 0!==e.defaultAspectHeight&&F(g,e.defaultAspectHeight,!0),void(void 0!==e.defaultAspectWidth&&F(p,e.defaultAspectWidth,!0));const t=Ft.get(n().id);if(void 0!==t)void 0!==t.row.defaultAspectHeight&&F(g,t.row.defaultAspectHeight,!0),void 0!==t.row.defaultAspectWidth&&F(p,t.row.defaultAspectWidth,!0)}}();const e=_(n(),t.imgProp);if(e){F(h,e,!0);const t=document.createElement("canvas"),o=t.getContext("2d"),i=new Image;i.crossOrigin="anonymous",i.onload=()=>{const e=v(c)/100,n=i.width*e,r=i.height*e;t.setAttribute("width",n.toString()),t.setAttribute("height",r.toString()),null==o||o.drawImage(i,0,0,n,r),F(w,t.toDataURL("image/webp",v(d)/100),!0)},i.src=v(h)}}),ge(e,{surface$style:"width: 1200px; max-width: calc(100vw - 32px);",style:"text-align: center",onSMUIDialogClosed:function(e){a()(e),t.onclose()},get open(){return i()},set open(e){i(e)},children:(e,o)=>{var a=Ea(),h=B(a);pe(h,{tabindex:0,autofocus:!0,children:(e,t)=>{var o=se("Image");y(e,o)},$$slots:{default:!0}});var b=te(h,2);me(b,{children:(e,o)=>{var l=Ua(),a=D(l),h=e=>{var t=Ra(),o=D(t);he(o,{label:e=>{var t=se("Uploaded Image or External URL.");y(e,t)},children:(e,t)=>{ve(e,{color:"secondary",class:"switch-scale",get checked(){return v(T)},set checked(e){F(T,e,!0)}})},$$slots:{label:!0,default:!0}});y(e,t)};ee(a,e=>{r()&&e(h)});var b=te(a,2),w=D(b),I=e=>{var o=qa(),i=B(o),r=D(i);Tn(r,{get value(){return(null==(e=n())?void 0:e.imageLink)||"";var e},set value(e){var t;t=e,n().imageLink=t},label:"External Image URL",variant:"filled"});var l=te(r,2);fe(l,{onclick:()=>{H(n(),t.imgProp,n().imageLink)},variant:"raised",children:(e,t)=>{be(e,{children:(e,t)=>{var o=se("Convert URL to Image");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var a=te(i,2),s=D(a),c=e=>{var o=ja(),i=B(o),r=te(i,2);fe(r,{onclick:()=>{H(n(),t.imgProp,""),delete n().imageLink},variant:"raised",class:"my-3",children:(e,t)=>{be(e,{children:(e,t)=>{var o=se("Remove Photo");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var l=te(r,2);Tn(l,{get value(){return(null==(e=n())?void 0:e.imageSourceTooltip)||"";var e},set value(e){var t;t=e,n().imageSourceTooltip=t},label:"Tooltip That Shows When Hovering over it",variant:"filled"}),$(e=>Le(i,"src",e),[()=>_(n(),t.imgProp)]),y(e,o)};ee(s,e=>{void 0!==_(n(),t.imgProp)&&""!==_(n(),t.imgProp)&&e(c)}),y(e,o)},C=e=>{var o=Na(),r=B(o),l=D(r),a=D(l),h=e=>{{let o=f(()=>bi(_(n(),t.imgProp))?_(n(),t.imgProp):"");Fa(e,{hideChangeButton:!0,removable:!0,crop:!1,get prefill(){return v(o)},onchange:e=>{H(n(),t.imgProp,e)},onclick:()=>u=app.compressImageAuto,onremove:()=>H(n(),t.imgProp,"")})}};ee(a,e=>{i()&&e(h)});var b=te(l,2);let w;var T=te(D(b)),I=te(T,2),C=te(b,2);Tn(C,{get value(){return(null==(e=n())?void 0:e.imageSourceTooltip)||"";var e},set value(e){var t;t=e,n().imageSourceTooltip=t},label:"Tooltip That Shows When Hovering over it",variant:"filled"});var x=te(r,2),O=D(x);{const e=(e,t=q)=>{Me(e,{get tab(){return t()},children:(e,o)=>{be(e,{children:(e,o)=>{var i=se();$(()=>ce(i,t())),y(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})};Be(O,{tabs:["Cropper","Compress"],get active(){return v(s)},set active(e){F(s,e,!0)},tab:e,$$slots:{tab:!0}})}var A=te(O,2);{let e=f(()=>"Cropper"!==v(s)?"display: none;":"");De(A,{role:"tabpanel",variant:"unelevated",get style(){return v(e)},children:(e,o)=>{Fe(e,{children:(e,o)=>{var i=$a(),r=B(i),l=D(r);Tn(D(l),{onchange:Y,label:"Width Aspect",type:"number",variant:"filled",get value(){return v(p)},set value(e){F(p,e,!0)}});var a=te(l,2);Tn(D(a),{onchange:J,label:"Height Aspect",type:"number",variant:"filled",get value(){return v(g)},set value(e){F(g,e,!0)}});var s=te(a,2),c=D(s);fe(c,{onclick:U,variant:"raised",style:"height: 100%;",children:(e,t)=>{be(e,{children:(e,t)=>{var o=se("Change Aspect");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var d=te(r,2),u=D(d);fe(u,{onclick:L,variant:"raised",children:(e,t)=>{be(e,{children:(e,t)=>{var o=se("Crop Image");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var h=te(d,2),f=e=>{var o=Pa(),i=D(o);S(i,e=>F(m,e),()=>v(m)),$(e=>Le(i,"src",e),[()=>_(n(),t.imgProp)]),y(e,o)};ee(h,e=>{bi(_(n(),t.imgProp))&&e(f)}),y(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})}var k=te(A,2);{let e=f(()=>"Compress"!==v(s)?"display: none;":"");De(k,{role:"tabpanel",variant:"unelevated",get style(){return v(e)},children:(e,o)=>{Fe(e,{children:(e,o)=>{var i=Wa(),r=D(i);Tn(D(r),{onchange:W,label:"Image Scale",type:"number",variant:"filled",get value(){return v(c)},set value(e){F(c,e,!0)}});var l=te(r,2);Tn(D(l),{onchange:W,label:"Image Quality",type:"number",variant:"filled",get value(){return v(d)},set value(e){F(d,e,!0)}});var a=te(l,2),s=D(a);fe(s,{onclick:N,variant:"raised",style:"height: 100%;",children:(e,t)=>{be(e,{children:(e,t)=>{var o=se("Compress Image");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var u=te(a,2),g=e=>{var o=Va(),i=D(o);$(e=>Le(i,"src",e),[()=>_(n(),t.imgProp)]),y(e,o)};ee(u,e=>{bi(_(n(),t.imgProp))&&e(g)}),y(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})}$(e=>{var t,o;w=V(b,1,"p-2",null,w,e),ce(T,"".concat(null!=(t=v(M))?t:""," kB|")),ce(I,"".concat(null!=(o=v(j))?o:""," kB"))},[()=>({hidden:!_(n(),t.imgProp)})]),y(e,o)};ee(w,e=>{v(T)?e(I):e(C,!1)}),y(e,l)},$$slots:{default:!0}});var w=te(b,2);we(w,{children:(e,t)=>{var o=k(),i=B(o),n=e=>{var t=La(),o=B(t),i=D(o);fe(i,{action:"deselect",children:(e,t)=>{be(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=se("Deselect Choice");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var n=te(o,2),r=D(n);fe(r,{action:"close",children:(e,t)=>{be(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=se("Close");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),y(e,t)},r=e=>{fe(e,{action:"close",children:(e,t)=>{be(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=se("Close");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};ee(i,e=>{l()?e(n):e(r,!1)}),y(e,o)},$$slots:{default:!0}}),y(e,a)},$$slots:{default:!0}}),C()}var Ga=T('<div class="row pt-4"><div class="col-12"><!></div></div>'),Ha=T('<div class="container-fluid"><div class="row"><div class="col-6"><!></div> <div class="col-6"><!></div></div></div>'),_a=T("<!> <!> <!>",1);function Ya(e,t){x(t,!0);let o=R(t,"changeNum",7),i=R(t,"minVal",3,0),n=R(t,"maxVal",3,0);ge(e,{get open(){return t.open},set open(e){!e&&t.onclose()},surface$style:"width: 400px; max-width: calc(100vw - 32px);",children:(e,r)=>{var l=_a(),a=B(l);pe(a,{class:"px-3 pb-0 toolbar toolbar__dialog",children:(e,t)=>{var o=se("Counter");y(e,o)},$$slots:{default:!0}});var s=te(a,2);me(s,{children:(e,t)=>{var r=Ga(),l=D(r);Tn(D(l),{label:"Number of Count",variant:"filled",type:"number",onchange:()=>{o(Math.min(Math.max(o(),i()),n()))},get input$min(){return i()},get input$max(){return n()},get value(){return o()},set value(e){o(e)}}),y(e,r)},$$slots:{default:!0}});var c=te(s,2);we(c,{children:(e,r)=>{var l=Ha(),a=D(l),s=D(a),c=D(s);fe(c,{children:(e,t)=>{be(e,{children:(e,t)=>{var o=se("Cancel");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var d=te(s,2),u=D(d);fe(u,{defaultAction:!0,onclickcapture:()=>t.submit(Math.min(Math.max(o(),i()),n())),children:(e,t)=>{be(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=se("OK");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),y(e,l)},$$slots:{default:!0}}),y(e,l)},$$slots:{default:!0}}),C()}var Ja=T("<!> <!>",1),Za=T("<!> <!>",1),Xa=T("<!> <!>",1),Ka=T("<!> <!>",1),Qa=T("<!> <!>",1),es=T("<!> <!>",1),ts=T("<!> <!>",1),os=T("<!> <!>",1),is=T("<!> <!>",1),ns=T("<!> <!> <!> <!> <!> <!> <!> <!>",1),rs=T("<i></i>"),ls=T('<i class="mdi mdi-stop"></i>'),as=T("<i></i>"),ss=T('<!> <!> <!> <div class="px-1 music-player--volume" style="max-width: 104px; width: 100%"><!></div> <div class="ps-1" style="max-width:150px; overflow: hidden;"><span class="scrolling-text"> </span></div> <div class="px-1 col music-player--progress-bar"><!></div> <div class="text-center" style="width: 180px"> </div>',1),cs=T('<i class="mdi mdi-format-list-checks"></i>'),ds=T('<i class="mdi mdi-format-list-checks"></i>'),us=T('<div class="py-0 justify-center"><!></div>'),gs=T('<i class="mdi mdi-checkbox-marked-circle-outline"></i>'),ps=T("<!> <!> <!>",1),ms=T("<div><!></div>"),hs=T('<div class="ab-0"><div class="fadeOverlay"></div> <!> <!> <div class="s-main"><!> <!> <div class="container-fluid p-0"><div class="row gx-0"></div></div></div></div> <!> <!> <!> <!> <!>',1);function vs(e,t){x(t,!0);const o={action:()=>{},title:"Warning",context:""};let i=O(!1),n=O(!1),r=O("none"),l=f(()=>v(n)?app.showMusicPlayer?"top: 32px;":"top: 0;":"bottom: 0;"),a=f(()=>"opacity: ".concat(app.fadeTransitionIsOn?1:0,"; transition: opacity ").concat(app.fadeTransitionTime,"s ease-out; background-color: ").concat(en(app.fadeTransitionColor),"; pointer-events: ").concat(app.fadeTransitionIsOn?"auto":"none","; cursor: ").concat(app.fadeTransitionIsOn?"none":"auto",";")),s=O(0),c=O(void 0),d=f(()=>app.pointTypes.length>0||app.backpack.length>0||app.importedChoicesIsOpen),g=f(()=>"background-color: ".concat(en(app.styling.barBackgroundColor),"; margin:").concat(app.styling.barMargin,"px; padding:").concat(app.styling.barPadding,"px; ").concat(v(l))),p=f(()=>"color: ".concat(en(app.styling.barTextColor),"; margin: ").concat(app.styling.barTextMargin,"px; padding: ").concat(app.styling.barTextPadding,"px; font-family: '").concat(app.styling.barTextFont,"'; font-size: ").concat(app.styling.barTextSize,"px;")),m=f(()=>"color: ".concat(en(app.styling.barIconColor),";")),h=f(()=>{let e=[];return app.styling.backgroundImage&&e.push("background-image: url('".concat(app.styling.backgroundImage,"');")),e.push("background-color: ".concat(en(app.styling.backgroundColor),";")),app.styling.isBackgroundRepeat?e.push("background-repeat: repeat;"):app.styling.isBackgroundFitIn?e.push("background-size: 100% 100%;"):e.push("background-size: cover;"),v(d)&&e.push("padding-bottom: 56px;"),app.useVW&&e.push("font-size: 0.835vw;"),e.join(" ")}),T=f(()=>{let e=[];return app.showMusicPlayer&&e.push("padding-top: 32px;"),e.join(" ")}),j=f(()=>"".concat(L(Ht.curBgmTime)," | ").concat(L(Ht.curBgmLength))),q=O(0),P=O(100),N=O(!1);function U(e){const t=e.currentTarget;e.preventDefault(),t.blur(),F(r,"appBuildForm")}function L(e){const t=Math.floor(e/3600),o=Math.floor(e%3600/60),i=Math.floor(e%60),n=String(o).padStart(2,"0"),r=String(i).padStart(2,"0");return t>0?"".concat(t,":").concat(n,":").concat(r):"".concat(n,":").concat(r)}function E(){const e=localStorage.getItem("theme");Lt.value="dark"===e?"light":"dark";let t=document.head.querySelector("#theme-dark"),o=document.head.querySelector("#theme-light");"dark"===Lt.value?(t&&(t.media="screen and (prefers-color-scheme: light)"),o&&(o.media="screen and (prefers-color-scheme: dark)")):(t&&(t.media="screen and (prefers-color-scheme: dark)"),o&&(o.media="screen and (prefers-color-scheme: light)")),localStorage.setItem("theme",Lt.value)}function z(){const e=u(zt);if(e)if(Ht.bgmIsPlaying)e.pause(),Ht.bgmIsPlaying=!1,0!==Ht.bgmPlayInterval&&(clearInterval(Ht.bgmPlayInterval),Ht.bgmPlayInterval=0);else{let t=0,o=0;0!==Ht.bgmPlayInterval&&(clearInterval(Ht.bgmPlayInterval),Ht.bgmPlayInterval=0),e.play(),Ht.bgmIsPlaying=!0,Ht.bgmPlayInterval=window.setInterval(()=>{if(!Ht.isSeeking&&e.isPlaying()){const i=Math.floor(e.getCurrentTime());i!==Ht.curBgmTime?t!==i?Ht.curBgmTime=i:(o++,o>Ht.curBgmLength&&(o=1),Ht.curBgmTime=o):(t=i,o=i+1,Ht.curBgmTime=o)}},1e3)}}function G(){const e=u(zt);e&&Ht.bgmIsPlaying&&(e.stop(),Ht.bgmIsPlaying=!1,Ht.curBgmTime=0,0!==Ht.bgmPlayInterval&&(clearInterval(Ht.bgmPlayInterval),Ht.bgmPlayInterval=0))}function H(){const e=u(zt);app.isMute=!app.isMute,e&&(app.isMute?e.mute():e.unMute())}function _(){u(zt)&&Ht.bgmIsPlaying&&(Ht.isSeeking=!0)}function Y(){var e,t;if(Ht.bgmIsPlaying){const t=u(zt);t&&(null==(e=t.seekTo)?void 0:e.call(t,v(q)))&&(Ht.curBgmTime=v(q)),Ht.isSeeking=!1}null==(t=document.activeElement)||t.blur()}function J(){F(N,!0)}function Z(){var e;const t=u(zt);app.curVolume=v(P),t&&t.setVolume(v(P)),F(N,!1),null==(e=document.activeElement)||e.blur()}b(()=>{Ht.isSeeking||F(q,Ht.curBgmTime,!0)}),b(()=>{v(N)||F(P,app.curVolume,!0)});var X=hs(),K=B(X),Q=D(K),oe=te(Q,2);Ze(oe,{style:"top: 0;",variant:"modal",get open(){return v(i)},set open(e){F(i,e,!0)},children:(e,t)=>{Ke(e,{class:"navigation-drawer",children:(e,t)=>{Ce(e,{children:(e,t)=>{var l=ns(),a=B(l);ke(a,{onSMUIAction:()=>F(i,!1),class:"my-0",children:(e,t)=>{var o=Ja(),i=B(o);Qe(i,{class:"mdi mdi-chevron-left"});var n=te(i,2);Ne(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=se("Close Menu");y(e,o)},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}});var s=te(a,2);et(s,{class:"my-3"});var c=te(s,2);ke(c,{onSMUIAction:E,class:"my-0",children:(e,t)=>{var o=Za(),i=B(o);Qe(i,{class:"mdi mdi-theme-light-dark"});var n=te(i,2);Ne(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=se("Toogle Dark/Light Theme");y(e,o)},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}});var d=te(c,2);ke(d,{onSMUIAction:()=>F(n,!v(n)),class:"my-0",children:(e,t)=>{var o=Xa(),i=B(o);Qe(i,{class:"mdi mdi-swap-vertical"});var n=te(i,2);Ne(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=se("Top/Bottom Point Bar");y(e,o)},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}});var u=te(d,2);ke(u,{onSMUIAction:()=>{o.action=()=>ei(),o.context="Are you sure you want to clear selected choices?<br>This action cannot be undone.",F(r,"dlgCommon"),F(i,!1)},class:"my-0",children:(e,t)=>{var o=Ka(),i=B(o);Qe(i,{class:"mdi mdi-select-off"});var n=te(i,2);Ne(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=se("Clear Selected Choices");y(e,o)},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}});var g=te(u,2),p=e=>{ke(e,{onSMUIAction:()=>{F(r,"appSearchForm"),F(i,!1)},class:"my-0",children:(e,t)=>{var o=Qa(),i=B(o);Qe(i,{class:"mdi mdi-magnify"});var n=te(i,2);Ne(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=se("Search Choice");y(e,o)},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}})};ee(g,e=>{app.enableSearch&&e(p)});var m=te(g,2),h=e=>{var t=os(),o=B(t);ke(o,{onSMUIAction:()=>{F(r,"appBuildForm"),F(i,!1)},class:"my-0",children:(e,t)=>{var o=es(),i=B(o);Qe(i,{class:"mdi mdi-format-list-checks"});var n=te(i,2);Ne(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=se("Open Build Form");y(e,o)},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}});var n=te(o,2);ke(n,{onSMUIAction:()=>{F(r,"appSaveLoad"),F(i,!1)},class:"my-0",children:(e,t)=>{var o=ts(),i=B(o);Qe(i,{class:"mdi mdi-content-save"});var n=te(i,2);Ne(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=se("Save/Load Build");y(e,o)},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}}),y(e,t)};ee(m,e=>{app.importedChoicesIsOpen&&e(h)});var f=te(m,2);ke(f,{onSMUIAction:()=>{F(r,"appGlobalSettings"),F(i,!1)},class:"my-0",children:(e,t)=>{var o=is(),i=B(o);Qe(i,{class:"mdi mdi-cog"});var n=te(i,2);Ne(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=se("Settings");y(e,o)},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}}),y(e,l)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}});var ie=te(oe,2);Xe(ie,{});var ne=te(ie,2),re=D(ne),le=e=>{tt(e,{class:"music-player",variant:"fixed",children:(e,t)=>{ot(e,{class:"music-player--row",children:(e,t)=>{it(e,{class:"px-2 justify-left",children:(e,t)=>{var o=ss(),i=B(o);Pe(i,{class:"music-player--button",onclickcapture:z,size:"button","aria-label":"Play",children:(e,t)=>{var o=rs();$(()=>V(o,1,W(Ht.bgmIsPlaying?"mdi mdi-pause":"mdi mdi-play"))),y(e,o)},$$slots:{default:!0}});var n=te(i,2);Pe(n,{class:"music-player--button",onclickcapture:G,size:"button","aria-label":"Stop",children:(e,t)=>{var o=ls();y(e,o)},$$slots:{default:!0}});var r=te(n,2);Pe(r,{class:"music-player--button",onclickcapture:H,size:"button","aria-label":"Mute",children:(e,t)=>{var o=as();$(()=>V(o,1,W(app.isMute?"mdi mdi-volume-off":"mdi mdi-volume-high"))),y(e,o)},$$slots:{default:!0}});var l=te(r,2),a=D(l);He(a,{min:0,max:100,step:1,class:"mx-2",onpointerdown:J,onpointerup:Z,get disabled(){return app.isMute},get value(){return v(P)},set value(e){F(P,e,!0)}});var s=te(l,2),c=D(s),d=D(c),u=te(s,2),g=D(u);{let e=f(()=>Ht.curBgmLength||1);He(g,{min:0,get max(){return v(e)},step:1,class:"mx-2",onpointerdown:_,onpointerup:Y,get value(){return v(q)},set value(e){F(q,e,!0)}})}var p=te(u,2),m=D(p);$(()=>{ce(d,Ht.bgmTitle),ce(m,v(j))}),y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})};ee(re,e=>{app.showMusicPlayer&&e(le)});var ae=te(re,2),de=e=>{tt(e,{class:"pointBar",get style(){return v(g)},variant:"fixed",color:"secondary",children:(e,t)=>{ot(e,{class:"justify-space-around",children:(e,t)=>{var o=ps(),n=B(o);it(n,{class:"py-0 justify-center",children:(e,t)=>{var o=k(),n=B(o),r=e=>{sn(e,{text:"L-Click: Open Side Menu<br>R-Click: Open Build Form",children:(e,t)=>{Pe(e,{class:"pointbar-icons",onclickcapture:()=>F(i,!0),oncontextmenu:U,"aria-label":"Open Import Window",get style(){return v(m)},children:(e,t)=>{var o=cs();y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},l=e=>{Pe(e,{class:"pointbar-icons",onclickcapture:()=>F(i,!0),"aria-label":"Open Import Window",get style(){return v(m)},children:(e,t)=>{var o=ds();y(e,o)},$$slots:{default:!0}})};ee(n,e=>{app.importedChoicesIsOpen?e(r):e(l,!1)}),y(e,o)},$$slots:{default:!0}});var l=te(n,2);it(l,{class:"pointbar-center--viewer",children:(e,t)=>{var o=k(),i=B(o);Re(i,17,()=>app.pointTypes,$e,(e,t)=>{var o=k(),i=B(o),n=e=>{var o=us();!function(e,t){x(t,!0);let o=f(()=>"color: ".concat(en(app.styling.barTextColor),"; margin: ").concat(app.styling.barTextMargin,"px; padding: ").concat(app.styling.barTextPadding,"px; font-family: '").concat(app.styling.barTextFont,"'; font-size: ").concat(app.styling.barTextSize,"px;")),i=f(()=>{if(t.point.startingSum>=0){if(void 0!==app.styling.barPointPos)return"color: ".concat(en(app.styling.barPointPos),";")}else if(void 0!==app.styling.barPointNeg)return"color: ".concat(en(app.styling.barPointNeg),";");return""});function n(e,t){const o=t?e.negativeImage:e.image,i=t?e.negativeIconWidth:e.iconWidth,n=t?e.negativeIconHeight:e.iconHeight;return o?'<img src="'.concat(o,'" class="mx-1" style="width: ').concat(i,"px; height: ").concat(n,'px;" alt="">'):""}var r=Nn(),l=D(r),a=D(l),s=e=>{var o=k(),i=B(o),r=e=>{var o=k(),i=B(o),r=e=>{var o=k(),i=B(o);M(i,()=>n(t.point,!0)),y(e,o)};ee(i,e=>{t.point.negativeImageOnSide||t.point.negativeImageSidePlacement||e(r)}),y(e,o)},l=e=>{var o=k(),i=B(o),r=e=>{var o=k(),i=B(o);M(i,()=>n(t.point,!1)),y(e,o)};ee(i,e=>{t.point.imageOnSide||t.point.imageSidePlacement||e(r)}),y(e,o)};ee(i,e=>{t.point.negativeIconIsOn&&t.point.startingSum<0?e(r):e(l,!1)}),y(e,o)};ee(a,e=>{t.point.iconIsOn&&e(s)});var c=te(a),d=te(c),u=e=>{var o=k(),i=B(o),r=e=>{var o=k(),i=B(o),r=e=>{var o=k(),i=B(o);M(i,()=>n(t.point,!0)),y(e,o)};ee(i,e=>{t.point.negativeImageOnSide&&!t.point.negativeImageSidePlacement&&e(r)}),y(e,o)},l=e=>{var o=k(),i=B(o),r=e=>{var o=k(),i=B(o);M(i,()=>n(t.point,!1)),y(e,o)};ee(i,e=>{t.point.imageOnSide&&!t.point.imageSidePlacement&&e(r)}),y(e,o)};ee(i,e=>{t.point.negativeIconIsOn&&t.point.startingSum<0?e(r):e(l,!1)}),y(e,o)};ee(d,e=>{t.point.iconIsOn&&e(u)});var g=te(d,2),p=D(g),m=te(g,2),h=e=>{var o=k(),i=B(o),r=e=>{var o=k(),i=B(o),r=e=>{var o=k(),i=B(o);M(i,()=>n(t.point,!0)),y(e,o)};ee(i,e=>{!t.point.negativeImageOnSide&&t.point.negativeImageSidePlacement&&e(r)}),y(e,o)},l=e=>{var o=k(),i=B(o),r=e=>{var o=k(),i=B(o);M(i,()=>n(t.point,!1)),y(e,o)};ee(i,e=>{!t.point.imageOnSide&&t.point.imageSidePlacement&&e(r)}),y(e,o)};ee(i,e=>{t.point.negativeIconIsOn&&t.point.startingSum<0?e(r):e(l,!1)}),y(e,o)};ee(m,e=>{t.point.iconIsOn&&e(h)});var b=te(m),w=te(b),T=e=>{var o=k(),i=B(o),r=e=>{var o=k(),i=B(o),r=e=>{var o=k(),i=B(o);M(i,()=>n(t.point,!0)),y(e,o)};ee(i,e=>{t.point.negativeImageOnSide&&t.point.negativeImageSidePlacement&&e(r)}),y(e,o)},l=e=>{var o=k(),i=B(o),r=e=>{var o=k(),i=B(o);M(i,()=>n(t.point,!1)),y(e,o)};ee(i,e=>{t.point.imageOnSide&&t.point.imageSidePlacement&&e(r)}),y(e,o)};ee(i,e=>{t.point.negativeIconIsOn&&t.point.startingSum<0?e(r):e(l,!1)}),y(e,o)};ee(w,e=>{t.point.iconIsOn&&e(T)}),$((e,n)=>{var a,s;qe(r,v(o)),qe(l,e),ce(c," ".concat(null!=(a=t.point.beforeText)?a:""," ")),qe(g,v(i)),ce(p,n),ce(b," ".concat(null!=(s=t.point.afterText)?s:""," "))},[()=>t.point.pointPrivateColorIsOn?"color: ".concat(t.point.startingSum>=0?en(t.point.privateColor):en(t.point.privateNegativeColor)):"",()=>t.point.startingSum%1==0?t.point.startingSum:parseFloat(t.point.startingSum.toFixed(void 0!==t.point.decimalPlaces?t.point.decimalPlaces:2))]),y(e,r),C()}(D(o),{get point(){return v(t)}}),$(()=>qe(o,v(p))),y(e,o)};ee(i,e=>{(function(e){if(e.isNotShownPointBar){if(void 0!==e.activatedId&&""!==e.activatedId){const t=jt.get(e.activatedId),o=Pt.get(e.activatedId);return void 0!==t?Wo(t.requireds):void 0!==o?o.isTrue:qo(e.activatedId)}return!1}return!0})(v(t))&&e(n)}),y(e,o)}),y(e,o)},$$slots:{default:!0}});var a=te(l,2);it(a,{class:"py-0 justify-center",children:(e,t)=>{var o=k(),i=B(o),n=e=>{Pe(e,{class:"pointbar-icons",onclickcapture:()=>F(r,"dlgBackpack"),"aria-label":"Open Backpack Window",get style(){return v(m)},children:(e,t)=>{var o=gs();y(e,o)},$$slots:{default:!0}})};ee(i,e=>{app.backpack.length>0&&(void 0===app.hideBackpackBtn||0===app.hideBackpackBtn||app.hideBackpackBtn>0&&app.hideBackpackBtn===app.btnBackpackIsOn)&&e(n)}),y(e,o)},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};ee(ae,e=>{v(d)&&e(de)});var ue=te(ae,2),he=D(ue);Re(he,21,()=>app.rows,$e,(e,t)=>{var o=ms();va(D(o),{get row(){return v(t)},get windowWidth(){return v(s)},get mainDiv(){return v(c)}}),$(()=>V(o,1,W(v(t).width?"col-6":"col-12"))),y(e,o)}),S(he,e=>F(c,e),()=>v(c));var ve=te(K,2),Te=e=>{{let t=f(()=>"appSaveLoad"===v(r));dr(e,{get open(){return v(t)},onclose:()=>F(r,"none")})}},Ie=e=>{var t=k(),i=B(t),n=e=>{{let t=f(()=>"dlgBackpack"===v(r));Sa(e,{get open(){return v(t)},onclose:()=>F(r,"none")})}},l=e=>{var t=k(),i=B(t),n=e=>{{let t=f(()=>"appGlobalSettings"===v(r));Wn(e,{get open(){return v(t)},onclose:()=>F(r,"none")})}},l=e=>{var t=k(),i=B(t),n=e=>{{let t=f(()=>"appBuildForm"===v(r));yn(e,{get open(){return v(t)},onclose:()=>F(r,"none")})}},l=e=>{var t=k(),i=B(t),n=e=>{{let t=f(()=>"dlgCommon"===v(r));Hn(e,{get open(){return v(t)},onclose:()=>F(r,"none"),get title(){return o.title},get context(){return o.context},closeHandler:e=>{"accept"===e.detail.action&&o.action()}})}},l=e=>{var t=k(),o=B(t),i=e=>{{let t=f(()=>"appSearchForm"===v(r));!function(e,t){x(t,!0);let o=R(t,"open",7),i=O(""),n=O(void 0),r=O(0),l=f(()=>{const e=[];if(v(n)&&v(n).sResult)for(let t=0;t<v(n).sResult.length;t++){const o=Ft.get(v(n).sResult[t]);if(void 0!==o){const t=o.choice;if(void 0!==t.parentId){const o=Ft.get(t.parentId);void 0!==o&&e.push(o)}else e.push(o)}}else{const t=Ft.get(v(i));if(void 0!==t){const o=t.choice;if(void 0!==o.parentId){const t=Ft.get(o.parentId);void 0!==t&&e.push(t)}else e.push(t)}}return e}),a=f(()=>{let e=[];return e.push("min-height: 451px;"),app.styling.backgroundImage&&e.push("background-image: url('".concat(app.styling.backgroundImage,"');")),e.push("background-color: ".concat(en(app.styling.backgroundColor),";")),app.styling.isBackgroundRepeat?e.push("background-repeat: repeat;"):app.styling.isBackgroundFitIn?e.push("background-size: 100% 100%;"):e.push("background-size: cover;"),app.useVW&&e.push("font-size: 0.835vw;"),e.join(" ")});function s(e){const t=Ft.get(e);if(void 0!==t){const e=t.choice,o=document.createElement("div");return o.innerHTML=e.title,o.textContent}return""}ge(e,{surface$style:"width: 800px; max-width: calc(100vw - 32px); min-height: 600px;",get onSMUIDialogClosed(){return t.onclose},get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=_l(),c=B(o);pe(c,{class:"px-3 pb-0 toolbar toolbar__dialog",tabindex:0,autofocus:!0,children:(e,t)=>{var o=se("Search");y(e,o)},$$slots:{default:!0}});var d=te(c,2);{let e=f(ro);S(Tr(d,{get options(){return v(e)},getOptionLabel:s,showMenuWithNoInput:!1,textfield$variant:"outlined",class:"w-100 p-0",isSearch:!0,selectOnExactMatch:!1,get value(){return v(i)},set value(e){F(i,e,!0)}}),e=>F(n,e,!0),()=>v(n))}var u=te(d,2);me(u,{class:"p-0",children:(e,t)=>{var o=Hl();Re(o,21,()=>v(l),$e,(e,t,o)=>{var i=Gl();zl(D(i),{get row(){return v(t).row},get choice(){return v(t).choice},index:o,get windowWidth(){return v(r)},isSearch:!0}),y(e,i)}),$(()=>qe(o,v(a))),_e(o,"clientWidth",e=>F(r,e)),y(e,o)},$$slots:{default:!0}});var g=te(u,2);we(g,{children:(e,t)=>{fe(e,{action:"close",children:(e,t)=>{be(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=se("Cancel");y(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),y(e,o)},$$slots:{default:!0}}),C()}(e,{get open(){return v(t)},onclose:()=>F(r,"none")})}};ee(o,e=>{"appSearchForm"===v(r)&&e(i)},!0),y(e,t)};ee(i,e=>{"dlgCommon"===v(r)?e(n):e(l,!1)},!0),y(e,t)};ee(i,e=>{"appBuildForm"===v(r)?e(n):e(l,!1)},!0),y(e,t)};ee(i,e=>{"appGlobalSettings"===v(r)?e(n):e(l,!1)},!0),y(e,t)};ee(i,e=>{"dlgBackpack"===v(r)?e(n):e(l,!1)},!0),y(e,t)};ee(ve,e=>{"appSaveLoad"===v(r)?e(Te):e(Ie,!1)});var Se=te(ve,2),ye=e=>{{let t=f(()=>"dlgCommon"===Yt.currentDialog);Hn(e,{get open(){return v(t)},onclose:()=>Yt.currentDialog="none",get closeHandler(){return Yt.cFunc},get title(){return Yt.title},get context(){return Yt.context},get isWord(){return Yt.isWord},get prevText(){return Yt.prevText},get isDeselect(){return Yt.isDeselect},get isForced(){return Yt.isForced}})}};ee(Se,e=>{"dlgCommon"===Yt.currentDialog&&void 0!==Yt.cFunc&&void 0!==Yt.context&&e(ye)});var xe=te(Se,2),Oe=e=>{{let t=f(()=>"appImageUpload"===Jt.currentDialog);za(e,{get open(){return v(t)},onclose:()=>Jt.currentDialog="none",get imgObject(){return Jt.data},get imgProp(){return Jt.imgProp},get isDeselect(){return _t.isDeselect},get closeHandler(){return Jt.cFunc}})}};ee(xe,e=>{"appImageUpload"===Jt.currentDialog&&void 0!==Jt.data&&void 0!==Jt.imgProp&&e(Oe)});var Ae=te(xe,2),Be=e=>{{let t=f(()=>"dlgCommon"===_t.currentDialog);Hn(e,{get open(){return v(t)},onclose:()=>_t.currentDialog="none",get closeHandler(){return _t.cFunc},get title(){return _t.title},get context(){return _t.context},get isWord(){return _t.isWord}})}},Me=e=>{var t=k(),o=B(t),i=e=>{{let t=f(()=>"selectDialog"===_t.currentDialog);Ya(e,{get open(){return v(t)},onclose:()=>_t.currentDialog="none",get submit(){return _t.func},get changeNum(){return _t.choice.multipleUseVariable},get minVal(){return _t.choice.numMultipleTimesMinus},get maxVal(){return _t.choice.numMultipleTimesPluss}})}};ee(o,e=>{"selectDialog"===_t.currentDialog&&void 0!==_t.choice&&void 0!==_t.func&&e(i)},!0),y(e,t)};ee(Ae,e=>{"dlgCommon"===_t.currentDialog&&void 0!==_t.cFunc&&void 0!==_t.context?e(Be):e(Me,!1)}),function(e,t){x(t,!0);let o=O(void 0),i=null;b(()=>{v(o)&&""!==on.text&&(on.isVisible&&on.anchor&&on.anchor.isConnected?(null==i||i.destroy(),i=A(on.anchor,v(o),{placement:"top",modifiers:[{name:"offset",options:{offset:[0,6]}},{name:"preventOverflow",options:{boundary:"viewport"}},{name:"flip",options:{fallbackPlacements:["top","bottom"]}}]}),v(o).classList.add("mdc-tooltip--shown")):i&&(i.destroy(),i=null,v(o).classList.remove("mdc-tooltip--shown")))}),w(()=>{null==i||i.destroy()});var n=ln(),r=D(n),l=D(r);I(l,()=>on.text,e=>{var t=k(),o=B(t);M(o,()=>on.text),y(e,t)}),S(n,e=>F(o,e),()=>v(o)),y(e,n),C()}(te(Ae,2),{}),$(()=>{qe(K,v(h)),qe(Q,v(a)),qe(ne,v(T))}),_e(K,"clientWidth",e=>F(s,e)),y(e,X),C()}var fs=T('<div id="bgm-player" style="display:none"></div> <!> <!>',1);void 0===window.ResizeObserver&&(window.ResizeObserver=rt);const bs=e=>{e.preventDefault(),e.returnValue=""};window.addEventListener?window.addEventListener("beforeunload",bs):window.onbeforeunload=bs,lt(function(e,t){let o,i,n;x(t,!0);let r,l="<div>Loading</div>";function a(){let e=localStorage.getItem("theme"),t=document.head.querySelector("#theme-dark"),o=document.head.querySelector("#theme-light"),i=function(){if(!window.matchMedia)return!1;try{return"not all"!==window.matchMedia("(prefers-color-scheme: dark)").media}catch(e){return!1}}();"dark"===e?i?(t&&(t.media="screen and (prefers-color-scheme: light)"),o&&(o.media="screen and (prefers-color-scheme: dark)"),Lt.value="dark"):(t&&(t.media="all"),o&&(o.media="not all")):i||(o&&(o.media="all"),t&&(t.media="not all"))}async function s(e){const t=Array.from(e);for(let n=0;n<t.length;n++){const e=t[n];try{await new Promise((t,o)=>{const i=new Image;i.onload=t,i.onerror=o,i.src=e})}catch(o){console.error(o)}finally{i&&(i.innerHTML="<div>Images</div><div>".concat(n," / ").concat(t.length,"</div>"))}}}async function c(){if(oo.value){const t="Your browser does not support the .avif format.\n Avif images may not be displayed.";try{await new Promise((e,t)=>{const o=new Image;o.onload=e,o.onerror=t,o.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="})}catch(e){console.error(e),Zt.labelText=t,Zt.isOpen=!0}}}b(()=>{Zt.isOpen&&(r.close(),r.open(),Zt.isOpen=!1)}),E(()=>{window.debugApp=app,a(),async function(){const e=(await co()).transaction("buildStore","readonly").objectStore("buildStore"),t=location.pathname.replace(/\/index\.html$/,"/");await new Promise((o,i)=>{const n=e.openCursor();n.onsuccess=e=>{const i=e.target.result;if(!i)return void o();const n=i.key,r=i.value;if("string"==typeof n&&n.startsWith(t)){const e=n.slice(t.length);if("autoSave"===e)Kt.stored=!0,Kt.time=r.time;else{const t=e.match(/^slot-(\d+)$/),o=Number(null==t?void 0:t[1]);Qt[o].stored=!0,Qt[o].name=void 0!==r.name?r.name:"Slot ".concat(o+1),Qt[o].time=r.time}}i.continue()},n.onerror=i})}(),async function(){o=document.getElementById("lm"),n=document.getElementById("projectSize"),i=document.getElementById("indicator");const e=n?parseInt(n.innerHTML):0,t=i?i.className:"";if(i&&(l=i.innerHTML),o&&(o.style.pointerEvents="none",o.style.overflow="hidden"),"function"==typeof window.fetch)try{const r=await fetch("project.json");if(r&&r.body){const a=r.body.getReader(),d=new TextDecoder;let u=0,g="";for(;;){const{done:o,value:n}=await a.read();if(o)break;u+=n.length,g+=d.decode(n,{stream:!0}),i&&(i.innerHTML="ind2"===t&&e>0?"".concat(l,"<div>").concat((u/e*100).toFixed(1)," %</div>"):"ind3"===t&&e>0?"".concat(l,"<div>").concat((u/1e6).toFixed(1),"/").concat((e/1e6).toFixed(1)," MB</div>"):"".concat(l,"<div>").concat((u/1e6).toFixed(1)," MB</div>"))}o&&(o.style.height="0");const p=Ui(JSON.parse(g)),m=Wi.safeParse(p);m.success?(zi(m.data),app.preloadExternalImages&&to.size>0&&await s(to),setTimeout(()=>{const e=document.createElement("style");document.head.appendChild(e),setTimeout(()=>{o&&(o.style.height="",o.style.opacity="1",o.style.overflow="",o.style.pointerEvents=""),i&&i.remove(),n&&n.remove(),e.sheet&&e.sheet.insertRule("body::before{opacity:0;transition:opacity 2s}",0)},1e3)},1e3),await c()):(Zt.labelText="Failed to load data.",Zt.isOpen=!0,console.error(m.error))}}catch(r){console.error(r),o&&(o.style.height="0"),zi(JSON.parse(JSON.stringify(app))),app.preloadExternalImages&&to.size>0&&await s(to),setTimeout(()=>{const e=document.createElement("style");document.head.appendChild(e),setTimeout(()=>{o&&(o.style.height="",o.style.opacity="1",o.style.overflow="",o.style.pointerEvents=""),i&&i.remove(),n&&n.remove(),e.sheet&&e.sheet.insertRule("body::before{opacity:0;transition:opacity 2s}",0)},1e3)},1e3),await c()}else{const r=new XMLHttpRequest;r.open("GET","project.json",!0),r.onprogress=o=>{i&&(i.innerHTML="ind2"===t&&e>0?"".concat(l,"<div>").concat((o.loaded/e*100).toFixed(1)," %</div>"):"ind3"===t&&e>0?"".concat(l,"<div>").concat((o.loaded/1e6).toFixed(1),"/").concat((e/1e6).toFixed(1)," MB</div>"):"".concat(l,"<div>").concat((o.loaded/1e6).toFixed(1)," MB</div>"))},r.onload=async()=>{o&&(o.style.height="0"),200===r.status?(zi(JSON.parse(r.responseText)),app.preloadExternalImages&&app.externalImages.size>0&&await s(app.externalImages)):zi(JSON.parse(JSON.stringify(app))),setTimeout(()=>{const e=document.createElement("style");document.head.appendChild(e),setTimeout(()=>{o&&(o.style.height="",o.style.opacity="1",o.style.overflow="",o.style.pointerEvents=""),i&&i.remove(),n&&n.remove(),e.sheet&&e.sheet.insertRule("body::before{opacity:0;transition:opacity 2s}",0)},1e3)},1e3),await c()},r.send()}}(),w(()=>{Gt.update(e=>(null==e||e.destroy(),null))})});var d=fs(),u=te(B(d),2);vs(u,{});var g=te(u,2);S(nt(g,{get labelText(){return Zt.labelText},get timeoutMs(){return Zt.timeoutMs},children:(e,t)=>{be(e,{class:"text-center"})},$$slots:{default:!0}}),e=>r=e,()=>r),y(e,d),C()},{target:document.getElementById("app")});export{o as __vite_legacy_guard};
