var e=Object.defineProperty,t=(t,o,i)=>((t,o,i)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[o]=i)(t,"symbol"!=typeof o?o+"":o,i);import{p as o,a as i,u as n,o as l,f as r,h as a,b as s,c as d,d as c,g as u,s as g,e as h,i as m,j as p,k as v,l as f,m as b,n as w,t as T,q as I,S as y,r as S,v as C,w as x,x as B,y as $,z as A,A as O,B as k,C as M,D as F,E as R,F as j,G as D,H as P,I as q,J as V,K as L,L as N,M as W,N as E,O as U,P as z,Q as G,R as H,T as _,U as Y,V as J,W as X,X as Z,Y as K,Z as Q,_ as ee,$ as te,a0 as oe,a1 as ie,a2 as ne,a3 as le,a4 as re,a5 as ae,a6 as se,a7 as de,a8 as ce,a9 as ue,aa as ge,ab as he,ac as me,ad as pe,ae as ve,af as fe,ag as be,ah as we,ai as Te,aj as Ie,ak as ye,al as Se,am as Ce,an as xe,ao as Be,ap as $e,aq as Ae,ar as Oe,as as ke,at as Me,au as Fe,av as Re,aw as je,ax as De,ay as Pe,az as qe,aA as Ve,aB as Le,aC as Ne,aD as We,aE as Ee,aF as Ue,aG as ze,aH as Ge,aI as He,aJ as _e,aK as Ye,aL as Je,aM as Xe,aN as Ze,aO as Ke}from"./chunk-vendors.59af3576.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Qe=o({anchor:null,text:"",isVisible:!0});var et=r('<div class="mdc-tooltip" role="tooltip" style="z-index: 9999;"><div class="mdc-tooltip__surface"><!></div></div>');var tt=r("<div><!></div>");const ot=function(e,t){i(t,!0);let o,n=v(t,"text",3,""),l=v(t,"innerClass",3,"");function r(){Qe.anchor=o,Qe.text=n(),Qe.isVisible=!0}function a(){Qe.isVisible=!1}f(()=>(o.addEventListener("mouseenter",r),o.addEventListener("mouseleave",a),o.addEventListener("focusin",r),o.addEventListener("focusout",a),()=>{o.removeEventListener("mouseenter",r),o.removeEventListener("mouseleave",a),o.removeEventListener("focusin",r),o.removeEventListener("focusout",a)}));var u=tt(),g=p(u);b(g,()=>t.children??w),s(u,e=>o=e,()=>o),T(()=>I(u,1,`p-0 m-0 ${l()??""}`)),d(e,u),c()};
/*!
 * canvas-size
 * v2.0.0
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2024 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function it(e){const t=e.sizes.shift(),o=Math.max(Math.ceil(t[0]),1),i=Math.max(Math.ceil(t[1]),1),n=[o-1,i-1,1,1],l=performance.now(),r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;let a,s;r?(a=new OffscreenCanvas(1,1),s=new OffscreenCanvas(o,i)):(a=document.createElement("canvas"),a.width=1,a.height=1,s=document.createElement("canvas"),s.width=o,s.height=i);const d=a.getContext("2d"),c=s.getContext("2d");c&&(c.fillRect.apply(c,n),d.drawImage(s,o-1,i-1,1,1,0,0,1,1));const u=d&&0!==d.getImageData(0,0,1,1).data[3],g=parseInt(performance.now()-l);return[a,s].forEach(e=>{e.height=0,e.width=0}),r?(postMessage({width:o,height:i,testTime:g,isTestPass:u}),!u&&e.sizes.length&&setTimeout(()=>{it(e)},0)):u?e.onSuccess({width:o,height:i,testTime:g}):(e.onError({width:o,height:i,testTime:g}),e.sizes.length&&setTimeout(()=>{it(e)},0)),u}const nt={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},lt={max:null,min:1,sizes:[],step:1024,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},rt={};function at(e){const t=e.width===e.height,o=1===e.height,i=1===e.width,n=[];if(e.width&&e.height){const l=e.min||lt.min,r=e.step||lt.step;let a=Math.max(e.width,e.height);for(;a>=l;){const e=t||o?a:1,l=t||i?a:1;n.push([e,l]),a-=r}}else e.sizes.forEach(e=>{const l=t||o?e:1,r=t||i?e:1;n.push([l,r])});return n}function st(e){const t="undefined"!=typeof window,o=t&&"Promise"in window,i=t&&"HTMLCanvasElement"in window,n=t&&"OffscreenCanvas"in window,l=URL.createObjectURL(new Blob([])).slice(-36),r=performance.now(),{onError:a,onSuccess:s,...d}=e,c=()=>parseInt(performance.now()-r);let u=null;if(!i)return!1;if(e.useWorker&&n){const e=`\n            var canvasTest = ${it.toString()};\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        `,t=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(t);u=new Worker(o),URL.revokeObjectURL(o),u.onmessage=function(e){const{width:t,height:o,testTime:i,isTestPass:n}=e.data,r={width:t,height:o,testTime:i,totalTime:c()};n?(rt[l].onSuccess(r),delete rt[l]):rt[l].onError(r)}}return o?new Promise(t=>{const o={...e,onError(o){let{width:i,height:n,testTime:l}=o;const r={width:i,height:n,testTime:l,totalTime:c()};let s;if(0===e.sizes.length)s=!0;else{const[[t,o]]=e.sizes.slice(-1);s=i===t&&n===o}a(r),s&&t({...r,success:!1})},onSuccess(e){let{width:o,height:i,testTime:n}=e;const l={width:o,height:i,testTime:n,totalTime:c()};s(l),t({...l,success:!0})}};if(u){const{onError:e,onSuccess:t}=o;rt[l]={onError:e,onSuccess:t},u.postMessage(d)}else it(o)}):u?(rt[l]={onError:a,onSuccess:s},void u.postMessage(d)):it(e)}const dt={maxArea(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=at({width:e.max,height:e.max,min:e.min,step:e.step,sizes:[...nt.area]});return st({...lt,...e,sizes:t})},maxHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=at({width:1,height:e.max,min:e.min,step:e.step,sizes:[...nt.height]});return st({...lt,...e,sizes:t})},maxWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=at({width:e.max,height:1,min:e.min,step:e.step,sizes:[...nt.width]});return st({...lt,...e,sizes:t})},test(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={...lt,...e};return t.sizes=[...t.sizes],t.width&&t.height&&(t.sizes=[[t.width,t.height]]),st(t)}},ct="2.0.3",ut={selFilterBlurIsOn:!1,selFilterBlur:0,selFilterBrightIsOn:!1,selFilterBright:100,selFilterContIsOn:!1,selFilterCont:100,selFilterGrayIsOn:!1,selFilterGray:0,selFilterHueIsOn:!1,selFilterHue:0,selFilterInvertIsOn:!1,selFilterInvert:0,selFilterOpacIsOn:!1,selFilterOpac:100,selFilterSaturIsOn:!1,selFilterSatur:1,selFilterSepiaIsOn:!1,selFilterSepia:0,selBgColorIsOn:!0,selOverlayOnImage:!1,selFilterBgColor:"#70FF7EFF",selBorderColorIsOn:!1,selFilterBorderColor:"#000000FF",selCTitleColorIsOn:!1,selFilterCTitleColor:"#000000FF",selCTextColorIsOn:!1,selFilterCTextColor:"#000000FF",selATitleColorIsOn:!1,selFilterATitleColor:"#000000FF",selATextColorIsOn:!1,selFilterATextColor:"#000000FF",selScoreTextColorIsOn:!1,selFilterSTextColor:"#000000FF",reqFilterBlurIsOn:!1,reqFilterBlur:0,reqFilterBrightIsOn:!1,reqFilterBright:100,reqFilterContIsOn:!1,reqFilterCont:100,reqFilterGrayIsOn:!1,reqFilterGray:0,reqFilterHueIsOn:!1,reqFilterHue:0,reqFilterInvertIsOn:!1,reqFilterInvert:0,reqFilterOpacIsOn:!0,reqFilterOpac:50,reqFilterSaturIsOn:!1,reqFilterSatur:1,reqFilterSepiaIsOn:!1,reqFilterSepia:0,reqBgColorIsOn:!1,reqOverlayOnImage:!1,reqFilterBgColor:"#FFFFFFFF",reqBorderColorIsOn:!1,reqFilterBorderColor:"#000000FF",reqCTitleColorIsOn:!1,reqFilterCTitleColor:"#000000FF",reqCTextColorIsOn:!1,reqFilterCTextColor:"#000000FF",reqATitleColorIsOn:!1,reqFilterATitleColor:"#000000FF",reqATextColorIsOn:!1,reqFilterATextColor:"#000000FF",reqScoreTextColorIsOn:!1,reqFilterSTextColor:"#000000FF",reqFilterVisibleIsOn:!1,unselFilterBlurIsOn:!1,unselFilterBlur:0,unselFilterBrightIsOn:!1,unselFilterBright:100,unselFilterContIsOn:!1,unselFilterCont:100,unselFilterGrayIsOn:!1,unselFilterGray:0,unselFilterHueIsOn:!1,unselFilterHue:0,unselFilterInvertIsOn:!1,unselFilterInvert:0,unselFilterOpacIsOn:!1,unselFilterOpac:100,unselFilterSaturIsOn:!1,unselFilterSatur:1,unselFilterSepiaIsOn:!1,unselFilterSepia:0},gt={customRowTitle:!1,rowTitle:"Times New Roman",customRowText:!1,rowText:"Times New Roman",customObjectTitle:!1,objectTitle:"Times New Roman",customObjectText:!1,objectText:"Times New Roman",customAddonTitle:!1,addonTitle:"Times New Roman",customAddonText:!1,addonText:"Times New Roman",customScoreText:!1,scoreText:"Times New Roman",rowTitleTextSize:200,rowTextTextSize:100,objectTitleTextSize:200,objectTextTextSize:100,addonTitleTextSize:200,addonTextTextSize:100,scoreTextSize:75,rowTitleColor:"#000000",rowTextColor:"#000000",objectTitleColor:"#000000",objectTextColor:"#000000",addonTitleColor:"#000000",addonTextColor:"#000000",scoreTextColor:"#000000",rowTitleAlign:"center",rowTextAlign:"center",objectTitleAlign:"center",objectTextAlign:"center",addonTitleAlign:"center",addonTextAlign:"center",scoreTextAlign:"center"},ht={objectImgBorderStyle:"solid",objectImgBorderWidth:2,objectImageWidth:100,objectImageMarginTop:0,objectImageMarginBottom:0,objectImgBorderRadiusTopLeft:0,objectImgBorderRadiusTopRight:0,objectImgBorderRadiusBottomRight:0,objectImgBorderRadiusBottomLeft:0,objectImgBorderRadiusIsPixels:!0,objectImgBorderIsOn:!1,objectImgOverflowIsOn:!1,objectImgBorderColor:"red",objectImgObjectFillStyle:"",objectImgObjectFillIsOn:!1,objectImageBoxWidth:50},mt={rowImgBorderStyle:"solid",rowImgBorderWidth:2,rowImageWidth:100,rowImageMarginTop:0,rowImageMarginBottom:0,rowImgBorderRadiusTopLeft:0,rowImgBorderRadiusTopRight:0,rowImgBorderRadiusBottomRight:0,rowImgBorderRadiusBottomLeft:0,rowImgBorderRadiusIsPixels:!0,rowImgBorderIsOn:!1,rowImgOverflowIsOn:!1,rowImgBorderColor:"red",rowImageBoxWidth:50},pt={useAddonImage:!1,addonImgBorderStyle:"solid",addonImgBorderWidth:2,addonImageWidth:100,addonImageMarginTop:0,addonImageMarginBottom:0,addonImgBorderRadiusTopLeft:0,addonImgBorderRadiusTopRight:0,addonImgBorderRadiusBottomRight:0,addonImgBorderRadiusBottomLeft:0,addonImgBorderRadiusIsPixels:!0,addonImgBorderIsOn:!1,addonImgOverflowIsOn:!1,addonImgBorderColor:"red",addonImgObjectFillStyle:"",addonImgObjectFillIsOn:!1,addonImageBoxWidth:50},vt={bgColorIsOn:!1,backgroundColor:"#FFFFFFFF",rowBgColorIsOn:!1,rowBgColor:"#FFFFFFFF",objectBgColorIsOn:!1,objectBgColor:"#FFFFFFFF",isBackgroundRepeat:!1,isBackgroundFitIn:!1,backgroundImage:"",isRowBackgroundRepeat:!1,isRowBackgroundFitIn:!1,rowBackgroundImage:"",isObjectBackgroundRepeat:!1,isObjectBackgroundFitIn:!1,objectBackgroundImage:""},ft={objectHeight:!0,objectDesignIsAdvanced:!1,objectMargin:10,objectTextPadding:10,objectBorderStyle:"solid",objectBorderWidth:2,objectBorderIsOn:!1,objectDropShadowH:0,objectDropShadowV:0,objectDropShadowBlur:0,objectDropShadowSpread:0,objectDropShadowIsOn:!1,objectUseBoxShadowIsOn:!1,objectBorderRadiusTopLeft:0,objectBorderRadiusTopRight:0,objectBorderRadiusBottomRight:0,objectBorderRadiusBottomLeft:0,objectBorderRadiusIsPixels:!0,objectOverflowIsOn:!0,objectDropShadowColor:"grey",objectGradientIsOn:!1,objectGradient:"",objectGradientOnSelect:"",objectGradientOnReq:"",objectBorderColor:"red",objectBorderImage:"",objectBorderImageRepeat:"stretch",objectBorderImageWidth:5,objectBorderImageSliceTop:5,objectBorderImageSliceBottom:5,objectBorderImageSliceLeft:5,objectBorderImageSliceRight:5,removeSpaceAddonIsOn:!1,titlePaddingIsOn:!1},bt={rowDesignIsAdvanced:!1,rowMargin:10,rowBodyMarginSides:1,rowBodyMarginTop:25,rowBodyMarginBottom:25,rowTextPaddingY:5,rowTextPaddingX:10,rowOverflowIsOn:!0,rowDropShadowH:0,rowDropShadowV:0,rowDropShadowBlur:0,rowDropShadowSpread:0,rowDropShadowColor:"grey",rowButtonXPadding:0,rowButtonYPadding:0,rowDropShadowIsOn:!1,rowUseBoxShadowIsOn:!1,rowBorderRadiusTopLeft:0,rowBorderRadiusTopRight:0,rowBorderRadiusBottomRight:0,rowBorderRadiusBottomLeft:0,rowBorderRadiusIsPixels:!0,rowBorderStyle:"solid",rowBorderWidth:2,rowBorderIsOn:!1,rowBorderColor:"red",rowGradientIsOn:!1,rowGradient:"",rowBorderImage:"",rowBorderImageRepeat:"stretch",rowBorderImageWidth:5,rowBorderImageSliceTop:5,rowBorderImageSliceBottom:5,rowBorderImageSliceLeft:5,rowBorderImageSliceRight:5},wt={useAddonDesign:!1,addonDesignIsAdvanced:!1,addonMargin:10,addonTextPadding:10,addonBorderStyle:"solid",addonBorderWidth:2,addonBorderIsOn:!1,addonDropShadowH:0,addonDropShadowV:0,addonDropShadowBlur:0,addonDropShadowSpread:0,addonDropShadowIsOn:!1,addonUseBoxShadowIsOn:!1,addonBorderRadiusTopLeft:0,addonBorderRadiusTopRight:0,addonBorderRadiusBottomRight:0,addonBorderRadiusBottomLeft:0,addonBorderRadiusIsPixels:!0,addonOverflowIsOn:!0,addonDropShadowColor:"grey",addonGradientIsOn:!1,addonGradient:"",addonGradientOnSelect:"",addonGradientOnReq:"",addonBorderColor:"red",addonBorderImage:"",addonBorderImageRepeat:"stretch",addonBorderImageWidth:5,addonBorderImageSliceTop:5,addonBorderImageSliceBottom:5,addonBorderImageSliceLeft:5,addonBorderImageSliceRight:5,removeSpaceAddonIsOn:!1,useAddonBackgroundImage:!1,addonBackgroundImage:"",isAddonBackgroundFitIn:!1,isAddonBackgroundRepeat:!1,addonBgColorIsOn:!1,addonBgColor:"#FFFFFFFF",addonTitlePaddingIsOn:!1},Tt={customMultiTextFont:!1,multiChoiceCounterPosition:0,multiChoiceCounterSize:170,multiChoiceTextFont:"Times New Roman",multiChoiceTextSize:100},It={barTextPadding:17,barTextMargin:0,customBarTextFont:!1,barTextFont:"Times New Roman",barPadding:0,barMargin:0,barTextSize:15,barTextColor:"#000000",barPointPos:"#FF0000FF",barPointNeg:"#FF0000FF",barIconColor:"#0000008A",barBackgroundColor:"#FFFFFFFF"},yt={useBackpackDesign:!1,backpackBgColor:"#FFFFFF",isBackpackBgRepeat:!1,isBackpackBgFitIn:!1,backpackBgImage:"",backPackWidth:1200},app=o({version:ct,isEditModeOnAll:!0,isStyleOpen:!1,isPointsOpen:!1,isChoicesOpen:!1,isDesignOpen:!1,isFadingOut:!1,isPointerCursor:!1,importedChoicesIsOpen:!0,curBgmTime:0,curBgmLength:0,curVolume:100,isSeeking:!1,isMute:!1,lastFadeTime:0,showMusicPlayer:!1,fadeTransitionColor:"#000000FF",fadeTransitionTime:.25,fadeTransitionIsOn:!1,hideBackpackBtn:0,btnBackpackIsOn:0,showAllAddons:0,tmpRequired:[],rowIdLength:4,objectIdLength:4,words:[],wordChangeComplete:!1,groups:[],rowDesignGroups:[],objectDesignGroups:[],objectsPerRow:"col-6",globalRequirements:[],googleFonts:[],customFonts:[],compressImageAuto:!1,hideScoresUpdated:!1,hideChoiceDT:!1,hideImages:!1,preloadImages:!1,preloadExternalImages:!1,useVW:!1,activated:[],rows:[],pointTypes:[],variables:[],mdObjects:[],printThis:!1,autoSaveIsOn:!1,autoSaveInterval:10,buildAutoSaveIsOn:!1,buildAutoSaveInterval:10,checkDeleteRow:!0,checkDeleteObject:!1,defaultRowTitle:"Row",defaultRowText:"This is a row, and inside of it, you can place choices. On both rows and choices Requirements can be placed, which will block a row from being viewed, or make the player unable to select a choice, depending on either Point-types or the Ids of other choices. Point-types can be made in Features then Manage Points. Hovering over buttons will explain what they do. The Design of the project can be changed in 'Modify Design' at the side navigation bar, and private styling for each row can be turned on in the rows Settings. Default text like this can be turned off in Features -> Manage Defaults.",defaultChoiceTitle:"Choice",defaultChoiceText:"This is a Choice, and inside of it, you can place images and text. Scores can be added to it, and have Point-types attached. Addons can be added underneath the image and text. In the Functions at the bottom of the choice, there is an array of different things that can be done. Default text like this can be turned off in Features then Manage Defaults.",defaultBeforePoint:"Cost:",defaultAfterPoint:"points",defaultBeforeReq:"Required:",defaultAfterReq:"choice",defaultAddonTitle:"Addon",defaultAddonText:"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.",enableShortcut:!0,orderOrReqText:"0",defaultOrReq:"of",orderSelReqText:"0",defaultSelReq:"choice from",backpack:[{index:0,id:"default_backpack_row",isBackpack:!0,title:"Result",debugTitle:"",titleText:"",objectWidth:"col-md-3",image:"",template:1,isButtonRow:!1,buttonType:!0,buttonId:"",buttonText:"Click",buttonRandom:!1,buttonRandomNumber:1,isResultRow:!0,resultGroupId:"",isInfoRow:!0,defaultAspectWidth:1,defaultAspectHeight:1,allowedChoices:0,currentChoices:0,requireds:[],isEditModeOn:!1,isRequirementOpen:!1,objects:[],rowDesignGroups:[]}],styling:{...ut,...gt,...ht,...mt,...pt,...vt,...ft,...bt,...wt,...Tt,...It,...yt}}),St={version:ct,isEditModeOnAll:!0,isStyleOpen:!1,isPointsOpen:!1,isChoicesOpen:!1,isDesignOpen:!1,isFadingOut:!1,isPointerCursor:!1,importedChoicesIsOpen:!0,curBgmTime:0,curBgmLength:0,curVolume:100,isSeeking:!1,isMute:!1,lastFadeTime:0,showMusicPlayer:!1,fadeTransitionColor:"#000000FF",fadeTransitionTime:.25,fadeTransitionIsOn:!1,hideBackpackBtn:0,btnBackpackIsOn:0,showAllAddons:0,tmpRequired:[],rowIdLength:4,objectIdLength:4,words:[],wordChangeComplete:!1,groups:[],rowDesignGroups:[],objectDesignGroups:[],objectsPerRow:"col-6",globalRequirements:[],googleFonts:[],customFonts:[],compressImageAuto:!1,hideScoresUpdated:!1,hideChoiceDT:!1,hideImages:!1,preloadImages:!1,preloadExternalImages:!1,useVW:!1,activated:[],rows:[],pointTypes:[],variables:[],mdObjects:[],printThis:!1,autoSaveIsOn:!1,autoSaveInterval:10,buildAutoSaveIsOn:!1,buildAutoSaveInterval:10,checkDeleteRow:!0,checkDeleteObject:!1,defaultRowTitle:"Row",defaultRowText:"This is a row, and inside of it, you can place choices. On both rows and choices Requirements can be placed, which will block a row from being viewed, or make the player unable to select a choice, depending on either Point-types or the Ids of other choices. Point-types can be made in Features then Manage Points. Hovering over buttons will explain what they do. The Design of the project can be changed in 'Modify Design' at the side navigation bar, and private styling for each row can be turned on in the rows Settings. Default text like this can be turned off in Features -> Manage Defaults.",defaultChoiceTitle:"Choice",defaultChoiceText:"This is a Choice, and inside of it, you can place images and text. Scores can be added to it, and have Point-types attached. Addons can be added underneath the image and text. In the Functions at the bottom of the choice, there is an array of different things that can be done. Default text like this can be turned off in Features then Manage Defaults.",defaultBeforePoint:"Cost:",defaultAfterPoint:"points",defaultBeforeReq:"Required:",defaultAfterReq:"choice",defaultAddonTitle:"Addon",defaultAddonText:"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.",enableShortcut:!0,orderOrReqText:"0",defaultOrReq:"of",orderSelReqText:"0",defaultSelReq:"choice from",backpack:[{index:0,id:"default_backpack_row",isBackpack:!0,title:"Result",debugTitle:"",titleText:"",objectWidth:"col-md-3",image:"",template:1,isButtonRow:!1,buttonType:!0,buttonId:"",buttonText:"Click",buttonRandom:!1,buttonRandomNumber:1,isResultRow:!0,resultGroupId:"",isInfoRow:!0,defaultAspectWidth:1,defaultAspectHeight:1,allowedChoices:0,currentChoices:0,requireds:[],isEditModeOn:!1,isRequirementOpen:!1,objects:[],rowDesignGroups:[]}],styling:{...ut,...gt,...ht,...mt,...pt,...vt,...ft,...bt,...wt,...Tt,...It,...yt}},Ct=o(new y),xt=o(new y),Bt=o(new y),$t=o(new y),At=o(new y),Ot=o(new y),kt=o(new y),Mt=o(new y),Ft=o(new y),Rt=o(new y),jt=o(new y),Dt=o(new S),Pt=o([]),qt=o({value:"light"}),Vt={ALLOWED_TAGS:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr","font","iframe","img"],ALLOWED_ATTR:["href","target","style"]},Lt=$(null),Nt=o({isBgmInit:!1,bgmIsPlaying:!1,bgmPlayInterval:0,bgmTitleInterval:0,bgmFadeInterval:0,bgmFadeTimer:0,bgmTitle:"No Audio Title",curBgmTime:0,curBgmLength:0,isSeeking:!1,lastFadeTime:0,isFadingOut:!1,bgmObjectId:""}),Wt=o({currentDialog:"none"}),Et=o({labelText:"",timeoutMs:4e3,isOpen:!1}),Ut=o({allowDeselect:!1}),zt=o({stored:!1,name:"Auto Save",time:"",app:""}),Gt=o(Array.from({length:99},(e,t)=>({stored:!1,name:`Slot ${t+1}`,time:"",app:""}))),Ht=o(Array.from({length:99},(e,t)=>({stored:!1,name:`Slot ${t+1}`,time:"",app:""})));o({backgroundColor:"",backgroundImage:"",barBgColor:""});const _t=new Set,Yt={value:!1},Jt=O(window.innerWidth,e=>{const t=()=>e(window.innerWidth);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)});let Xt=null;function Zt(){return new Promise((e,t)=>{const o=indexedDB.open("cyoaPlusDB");o.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("cyoaStore")||t.createObjectStore("cyoaStore"),t.objectStoreNames.contains("buildStore")||t.createObjectStore("buildStore")},o.onsuccess=t=>{const o=t.target.result;e(o)},o.onerror=t})}function Kt(){return new Promise((e,t)=>{if(Xt)return e(Xt);const o=indexedDB.open("cyoaDB");let i=!1,n=[],l=[],r=[];o.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("buildStore")||t.createObjectStore("buildStore",{keyPath:"title"}),i=!0},o.onsuccess=o=>{const a=o.target.result;if(1===a.version)if(i)Zt().then(t=>{Xt=t,e(Xt)}).catch(t).finally(()=>{a.close()});else if(a.objectStoreNames.contains("buildStore")){const o=a.transaction(["buildStore"],"readonly").objectStore("buildStore").getAll();o.onsuccess=()=>{const i=o.result;for(let e=0;e<i.length;e++){const t=o.result[e];Ht[e].stored=!0,Ht[e].name=t.title,Ht[e].time="Unknown",Ht[e].app=Array.isArray(t.value)?t.value.join(","):t.value}Zt().then(t=>{Xt=t,e(Xt)}).catch(t).finally(()=>{a.close()})},o.onerror=o=>{console.error(o),Zt().then(t=>{Xt=t,e(Xt)}).catch(t).finally(()=>{a.close()})}}else Zt().then(t=>{Xt=t,e(Xt)}).catch(t).finally(()=>{a.close()});else{const o=[new Promise((e,t)=>{if(a.objectStoreNames.contains("cyoaStore")){const o=a.transaction("cyoaStore","readonly").objectStore("cyoaStore").openCursor();o.onsuccess=t=>{const o=t.target.result;o?(n.push({key:o.key,value:o.value}),o.continue()):e()},o.onerror=t}else e()}),new Promise((e,t)=>{if(a.objectStoreNames.contains("buildStore")){const o=a.transaction("buildStore","readonly").objectStore("buildStore").openCursor();o.onsuccess=t=>{const o=t.target.result;o?(l.push({key:o.key,value:o.value}),o.continue()):e()},o.onerror=t}else e()})];Promise.all(o).then(()=>(a.close(),new Promise((e,t)=>{const o=indexedDB.deleteDatabase("cyoaDB");o.onsuccess=()=>{const o=indexedDB.open("cyoaDB",1);o.onupgradeneeded=e=>{e.target.result.createObjectStore("buildStore",{keyPath:"title"});const t=e.target.transaction;if(t){const e=t.objectStore("buildStore");let o=0;for(let t=0;t<l.length;t++){const i=l[t];void 0!==i.value.title?(e.put(i.value),Ht[o].stored=!0,Ht[o].name=i.title,Ht[o].time="Unknown",Ht[o].app=Array.isArray(i.value)?i.value.join(","):i.value,o+=1):r.push(i)}}},o.onsuccess=t=>{t.target.result.close(),e()},o.onerror=e=>{console.error(e,"L872"),t(e)}},o.onerror=e=>{console.error(e,"L877"),t(e)}}))).catch(e=>{console.error(e),a.close()}).finally(()=>{const o=indexedDB.open("cyoaPlusDB");o.onupgradeneeded=e=>{const t=e.target.result;!t.objectStoreNames.contains("cyoaStore")&&n.length>0&&t.createObjectStore("cyoaStore"),t.objectStoreNames.contains("buildStore")||t.createObjectStore("buildStore");const o=e.target.transaction;if(o){if(n.length>0){const e=o.objectStore("cyoaStore");for(let t=0;t<n.length;t++){const o=n[t];e.put(o.value,o.key)}}if(r.length>0){const e=o.objectStore("buildStore");for(let t=0;t<r.length;t++){const o=r[t];e.put(o.value,o.key)}}}},o.onsuccess=t=>{const o=t.target.result;Xt=o,e(Xt)},o.onerror=e=>{t(e)}})}},o.onerror=e=>{t(e)}})}let Qt=null;function eo(e,t){return new Promise((o,i)=>{const n=setTimeout(()=>o(),e);t&&t.addEventListener("abort",()=>{clearTimeout(n),i(new DOMException("Aborted","AbortError"))})})}async function to(){const e=new AbortController;Qt=e;const t=`${location.pathname.replace(/\/index\.html$/,"/")}autoSave`;for(;app.buildAutoSaveIsOn;){try{await eo(1e3*app.buildAutoSaveInterval*60,e.signal)}catch(o){break}if(!app.buildAutoSaveIsOn)break;const i=(await Kt()).transaction("buildStore","readwrite").objectStore("buildStore"),n=navigator.language,l=new Date,r=new Intl.DateTimeFormat(n,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(l),a={stored:!0,name:"Auto Save",time:r,app:oo()};try{await new Promise((e,o)=>{const n=i.put(a,t);n.onsuccess=()=>e(),n.onerror=()=>o(n.error)}),zt.stored=!0,zt.time=r,zt.app=a.app,Et.labelText="Auto-save completed successfully.",Et.isOpen=!0}catch(o){console.error(o)}}}function oo(){let e=[];return Array.from(Ct.entries()).forEach(([t,o])=>{let i=At.get(t);if(void 0!==i){const n=i.choice;let l=t;0===o.multiple?(n.isActivateRandom&&n.activatedRandom&&(l+=`/RND#${n.activatedRandom.join("/AND#").replaceAll("/ON#","/RON#")}`),n.textfieldIsOn&&n.customTextfieldIsOn&&void 0!==n.wordChangeSelect&&(l+=`/WORD#${n.wordChangeSelect.replaceAll(",","/CHAR#")}`),n.isImageUpload&&n.image!==n.defaultImage&&(l+=`/IMG#${n.image.replaceAll(",","/CHAR#")}`),e.push(l)):(l+=`/ON#${o.multiple}`,n.isActivateRandom&&n.activatedRandomMul&&(l+=`/RND#${n.activatedRandomMul.flat(2).join("/AND#").replaceAll("/ON#","/RON#")}`),e.push(l))}}),e.join(",")}function io(){const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}_${String(e.getHours()).padStart(2,"0")}-${String(e.getMinutes()).padStart(2,"0")}-${String(e.getSeconds()).padStart(2,"0")}`}function no(e){if(e.customTextIsOn)return void 0!==e.customText?e.customText:"";switch(e.type){case"id":{let t=e.reqId.split("/ON#"),o=At.get(t[0]);if(void 0!==o){let i=o.choice;return`${e.beforeText} ${t.length>1?`${t[1]} `:""} ${i.title} ${e.afterText}`}break}case"point":{let t=Bt.get(e.reqId);if(void 0!==t)return`${e.beforeText} ${e.reqPoints} ${t.name} ${e.afterText}`;break}case"or":{let t=[];for(let o=0;o<e.orRequired.length;o++){let i=e.orRequired[o].req;if(void 0!==i){let e=i.split("/ON#"),o=At.get(e[0]),n="";if(void 0!==o){let i=o.choice;n=e.length>1?`${e[1]} `:"",t.push(`${n}${i.title}`)}}}return"1"===app.orderOrReqText?`${e.beforeText} ${t.join(", ")} ${void 0!==e.orNum?`${app.defaultOrReq} ${e.orNum}`:`${app.defaultOrReq} 1`} ${e.afterText}`:`${e.beforeText} ${void 0!==e.orNum?`${e.orNum} ${app.defaultOrReq}`:`1 ${app.defaultOrReq}`} ${t.join(", ")} ${e.afterText}`}case"selFromGroups":if(void 0!==e.selGroups){let t=[];for(let o=0;o<e.selGroups.length;o++){let i=e.selGroups[o],n=Ot.get(i);void 0!==n&&t.push(n.name)}return"1"===app.orderSelReqText?`${e.beforeText} ${t.join(", ")} ${app.defaultOrReq} ${e.selNum} ${e.afterText}`:`${e.beforeText} ${e.selNum} ${app.defaultOrReq} ${t.join(", ")} ${e.afterText}`}case"selFromRows":if(void 0!==e.selRows){let t=[];for(let o=0;o<e.selRows.length;o++){let i=e.selRows[o],n=$t.get(i);void 0!==n&&t.push(n.title)}return"1"===app.orderSelReqText?`${e.beforeText} ${t.join(", ")} ${app.defaultOrReq} ${e.selNum} ${e.afterText}`:`${e.beforeText} ${e.selNum} ${app.defaultOrReq} ${t.join(", ")} ${e.afterText}`}case"selFromWhole":return"1"===app.orderSelReqText?`${e.beforeText} ${app.defaultOrReq} ${e.selNum} ${e.afterText}`:`${e.beforeText} ${e.selNum} ${app.defaultOrReq} ${e.afterText}`}return`${e.beforeText} ${e.afterText}`}function lo(e,t){let o="row-",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return $t.has(o)?e>2?lo(0,++t):lo(++e,t):o}function ro(e,t){let o="word-",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return Mt.has(o)?e>2?ro(0,++t):ro(++e,t):o}function ao(e,t){let o="choice-",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return At.has(o)?e>2?ao(0,++t):ao(++e,t):o}function so(e,t,o){let i="design-",n="abcdefghijklmnopqrstuvwxyz0123456789";for(var l=0;l<t;l++)i+=n.charAt(Math.floor(36*Math.random()));return(o?Rt.has(i):jt.has(i))?e>2?so(0,++t,o):so(++e,t,o):i}function co(e,t){let o="group-",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return Ot.has(o)?e>2?co(0,++t):co(++e,t):o}function uo(e,t){let o="point-",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return Bt.has(o)?e>2?uo(0,++t):uo(++e,t):o}function go(e,t){let o="variable-",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return Ft.has(o)?e>2?go(0,++t):go(++e,t):o}function ho(e,t){let o="s-",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return Dt.has(o)?e>2?ho(0,++t):ho(++e,t):o}function mo(e){let t=e;if(app.words){const e=new RegExp(app.words.map(e=>e.id.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")).join("|"),"g");t=t.replace(e,e=>{const t=Bt.get(e);if(void 0!==t){return(t.startingSum%1==0?t.startingSum:parseFloat(t.startingSum.toFixed(t.decimalPlaces??2))).toString()}{const t=At.get(e);if(void 0!==t){const e=t.choice;if(e.isSelectableMultiple&&e.isMultipleUseVariable)return e.multipleUseVariable.toString()}else{const t=Mt.get(e);if(void 0!==t)return t.replaceText}}return e})}return t}function po(e,t,o){if(void 0!==o){if(void 0!==o.styling&&o.isPrivateStyling&&o[e])return o.styling;if(void 0!==app.objectDesignGroups&&o.objectDesignGroups)for(let t=0;t<o.objectDesignGroups.length;t++){let i=jt.get(o.objectDesignGroups[t]);if(void 0!==i&&i[e]){let e=i.activatedId,t=kt.get(e);if(""===e||fo(i.activatedId))return i.styling;if(void 0!==app.globalRequirements&&void 0!==t&&wo(t.requireds))return i.styling}}}if(void 0!==t){if(void 0!==t.styling&&t.isPrivateStyling&&t[e])return t.styling;if(void 0!==app.rowDesignGroups&&t.rowDesignGroups)for(let o=0;o<t.rowDesignGroups.length;o++){let i=Rt.get(t.rowDesignGroups[o]);if(void 0!==i&&i[e]){let e=i.activatedId,t=kt.get(e);if(""===e||fo(i.activatedId))return i.styling;if(void 0!==app.globalRequirements&&void 0!==t&&wo(t.requireds))return i.styling}}}return app.styling}function vo(e,t){if(t.has(e)){return vo(`${e}_dup`,t)}return e}function fo(e,t=Ct){var o;const[i,n="0"]=e.split("/ON#"),l=parseInt(n);if(l>0){return((null==(o=t.get(i))?void 0:o.multiple)??0)>=l}return t.has(i)}function bo(e,t=Ct){if(e.required)switch(e.type){case"id":return fo(e.reqId,t);case"points":const o=Bt.get(e.reqId);if(void 0!==o){if(void 0===e.operator)return o.startingSum>e.reqPoints;switch(e.operator){case"1":return o.startingSum>e.reqPoints;case"2":return o.startingSum>=e.reqPoints;case"3":return o.startingSum==e.reqPoints;case"4":return o.startingSum<=e.reqPoints;case"5":return o.startingSum<e.reqPoints}}return!1;case"or":let i=void 0===e.orNum?1:e.orNum,n=0;for(let u=0;u<e.orRequired.length;u++){let o=e.orRequired[u].req;void 0!==o&&fo(o,t)&&n++}return n>=i;case"pointCompare":const l=Bt.get(e.reqId),r=Bt.get(e.reqId1);if(void 0!==l&&void 0!==r){let t=r.startingSum;if(e.more)for(let o=0;o<e.more.length;o++){let i=0,n=e.more[o].id,l=e.more[o].points;if(void 0!==n){let e=Bt.get(n);void 0!==e&&(i=e.startingSum)}else void 0!==l&&(i=l);switch(e.more[o].operator){case"1":t+=i;break;case"2":t-=i;break;case"3":t*=i;break;case"4":t/=i;break;case"5":t%=i}}switch(e.operator){case"1":return l.startingSum>t;case"2":return l.startingSum>=t;case"3":return l.startingSum==t;case"4":return l.startingSum<=t;case"5":return l.startingSum<t;default:return!1}}return!1;case"selFromGroups":if(e.selGroups){let t=0,o=void 0===e.selFromOperators?"1":e.selFromOperators,i=void 0===e.selNum?1:e.selNum;for(let n=0;n<e.selGroups.length;n++){const o=Ot.get(e.selGroups[n]);if(void 0!==o){const e=o.elements;for(let o=0;o<e.length;o++)Ct.has(e[o])&&t++}}switch(o){case"1":return!(i>t||0===i&&t>0);case"2":return i===t;case"3":return!(i<t||0===i&&t>0);default:return!1}}case"selFromRows":if(e.selRows){let t=0,o=void 0===e.selFromOperators?"1":e.selFromOperators,i=void 0===e.selNum?1:e.selNum;for(let n=0;n<e.selRows.length;n++){const o=$t.get(e.selRows[n]);void 0!==o&&(t+=o.currentChoices)}switch(o){case"1":return!(i>t||0===i&&t>0);case"2":return i===t;case"3":return!(i<t||0===i&&t>0);default:return!1}}case"selFromWhole":let a=0,s=void 0===e.selFromOperators?"1":e.selFromOperators,d=void 0===e.selNum?1:e.selNum;for(let e=0;e<app.rows.length;e++)a+=app.rows[e].currentChoices;switch(s){case"1":return!(d>a||0===d&&a>0);case"2":return d===a;case"3":return!(d<a||0===d&&a>0);default:return!1}case"gid":const c=kt.get(e.reqId);return void 0!==c&&void 0!==app.globalRequirements&&wo(c.requireds,t)}else switch(e.type){case"id":return!fo(e.reqId,t);case"or":let o=void 0===e.orNum?1:e.orNum,i=0;for(let l=0;l<e.orRequired.length;l++){let o=e.orRequired[l].req;void 0!==o&&fo(o,t)&&i++}return o>i;case"gid":const n=kt.get(e.reqId);return void 0!==n&&void 0!==app.globalRequirements&&!wo(n.requireds,t)}return!1}function wo(e,t=Ct){let o=!0;if(void 0!==e)for(let i=0;i<e.length;i++){const n=e[i];let l=!0;if(void 0!==n.requireds)for(let e=0;e<n.requireds.length;e++)l=l&&bo(n.requireds[e],t);l&&(o=o&&bo(e[i],t))}return o}function To(e,t,o,i){function n(){let n=0,l=0,r=0;if(o&&(i.loadVideoById(t),e.bgmNoLoop?i.setLoop(!1):(i.loadPlaylist(t),i.setLoop(!0))),e.bgmFadeIn&&void 0!==e.bgmFadeInSec&&e.bgmFadeInSec>0){const t=e.bgmFadeInSec/20;Nt.lastFadeTime=e.bgmFadeInSec,i.setVolume(0),i.playVideo(),0!==Nt.bgmFadeInterval&&(window.clearInterval(Nt.bgmFadeInterval),Nt.bgmFadeInterval=0),0!==Nt.bgmPlayInterval&&(window.clearInterval(Nt.bgmPlayInterval),Nt.bgmPlayInterval=0),Nt.isFadingOut&&(Nt.isFadingOut=!1),Nt.bgmFadeInterval=window.setInterval(()=>{1===i.getPlayerState()&&(n<app.curVolume?(n+=5,i.setVolume(n),Nt.lastFadeTime=Nt.lastFadeTime-t):(i.setVolume(app.curVolume),window.clearInterval(Nt.bgmFadeInterval),Nt.bgmFadeInterval=0,Nt.lastFadeTime=0))},t)}else Nt.isFadingOut&&(Nt.isFadingOut=!1,window.clearInterval(Nt.bgmFadeInterval),Nt.bgmFadeInterval=0),i.playVideo(),i.setVolume(app.curVolume);Nt.bgmObjectId=e.id,app.showMusicPlayer&&(0!==Nt.bgmTitleInterval&&(window.clearInterval(Nt.bgmTitleInterval),Nt.bgmTitleInterval=0),Nt.bgmTitleInterval=window.setInterval(()=>{if(void 0!==i.playerInfo.videoData){let e=i.playerInfo.videoData;e.video_id===t&&void 0!==e.title&&""!==e.title&&(Nt.bgmTitle=e.title,Nt.curBgmLength=i.getDuration(),window.clearInterval(Nt.bgmTitleInterval),Nt.bgmTitleInterval=0)}},1e3),0!==Nt.bgmPlayInterval&&(window.clearInterval(Nt.bgmPlayInterval),Nt.bgmPlayInterval=0),Nt.bgmPlayInterval=window.setInterval(()=>{if(void 0!==i.playerInfo.videoData&&!Nt.isSeeking&&1===i.getPlayerState()){const e=Math.floor(i.getCurrentTime());e!==Nt.curBgmTime?l!==e?Nt.curBgmTime=e:(r++,r>Nt.curBgmLength&&(r=1),Nt.curBgmTime=r):(l=e,r=e+1,Nt.curBgmTime=r)}},1e3))}if(Nt.isFadingOut){const e=Nt.lastFadeTime;0!==Nt.bgmFadeTimer&&(window.clearTimeout(Nt.bgmFadeTimer),Nt.bgmFadeTimer=0),Nt.bgmFadeTimer=window.setTimeout(()=>{n()},e)}else n()}function Io(e,t){const o=app.curVolume/5;if(e.bgmFadeOut&&void 0!==e.bgmFadeOutSec&&e.bgmFadeOutSec>0&&o>0){const i=e.bgmFadeOutSec/o;let n=app.curVolume;Nt.lastFadeTime=e.bgmFadeOutSec,Nt.isFadingOut=!0,0!==Nt.bgmFadeInterval&&(window.clearInterval(Nt.bgmFadeInterval),Nt.bgmFadeInterval=0),Nt.bgmFadeInterval=window.setInterval(()=>{void 0!==t.setVolume&&(n>0?(n-=5,t.setVolume(n),Nt.lastFadeTime-=i):Nt.isFadingOut&&(t.pauseVideo(),t.setVolume(app.curVolume),window.clearInterval(Nt.bgmFadeInterval),Nt.bgmFadeInterval=0,Nt.lastFadeTime=0,Nt.isFadingOut=!1,0!==Nt.bgmTitleInterval&&(window.clearInterval(Nt.bgmTitleInterval),Nt.bgmTitleInterval=0),0!==Nt.bgmPlayInterval&&(window.clearInterval(Nt.bgmPlayInterval),Nt.bgmPlayInterval=0),Nt.bgmTitle="No Audio Title",Nt.curBgmTime=0,Nt.curBgmLength=0))},i)}else t.pauseVideo(),0!==Nt.bgmTitleInterval&&(window.clearInterval(Nt.bgmTitleInterval),Nt.bgmTitleInterval=0),0!==Nt.bgmPlayInterval&&(window.clearInterval(Nt.bgmPlayInterval),Nt.bgmPlayInterval=0),Nt.bgmTitle="No Audio Title",Nt.curBgmTime=0,Nt.curBgmLength=0}function yo(e,t,o){const i=A(Lt);if(i&&void 0!==i.playerInfo.videoData){const o=Nt.bgmIsPlaying,n=i.playerInfo.videoData.video_id,l=i.getPlayerState();n===t?Nt.bgmObjectId===e.id?o?(2===l||i.stopVideo(),To(e,t,!1,i)):Io(e,i):o?(i.stopVideo(),To(e,t,!1,i)):Io(e,i):o&&To(e,t,!0,i)}else o<10?window.setTimeout(()=>{yo(e,t,++o)},200):console.log("Failed to play bgm")}async function So(e){const t=new((await new Promise(e=>{if(window.YT&&window.YT.Player)e(window.YT);else{const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api",document.head.appendChild(t),window.onYouTubeIframeAPIReady=()=>e(window.YT)}})).Player)("bgm-player",{width:0,height:0,events:{onReady:()=>{Lt.set(t),yo(e,e.bgmId??"",0),app.isMute&&!t.isMuted()&&t.mute()}}})}function Co(e,t){if(void 0!==e){if(t){const t=["addonBorderRadiusTopLeft","addonBorderRadiusTopRight","addonBorderRadiusBottomLeft","addonBorderRadiusBottomRight","addonImgBorderRadiusTopLeft","addonImgBorderRadiusTopRight","addonImgBorderRadiusBottomLeft","addonImgBorderRadiusBottomRight","objectBorderRadiusTopLeft","objectBorderRadiusTopRight","objectBorderRadiusBottomLeft","objectBorderRadiusBottomRight","objectImgBorderRadiusTopLeft","objectImgBorderRadiusTopRight","objectImgBorderRadiusBottomLeft","objectImgBorderRadiusBottomRight","rowBorderRadiusTopLeft","rowBorderRadiusTopRight","rowBorderRadiusBottomLeft","rowBorderRadiusBottomRight","rowImgBorderRadiusTopLeft","rowImgBorderRadiusTopRight","rowImgBorderRadiusBottomLeft","rowImgBorderRadiusBottomRight"];for(let o=0;o<t.length;o++){const i=t[o];void 0!==e[i]&&(e[i]=10*e[i])}}const o=["selFilterBgColor","selFilterBorderColor","selFilterCTitleColor","selFilterCTextColor","selFilterATitleColor","selFilterATextColor","selFilterSTextColor","reqFilterBgColor","reqFilterBorderColor","reqFilterCTitleColor","reqFilterCTextColor","reqFilterATitleColor","reqFilterATextColor","reqFilterSTextColor","rowTitleColor","rowTextColor","objectTitleColor","objectTextColor","addonTitleColor","addonTextColor","scoreTextColor","objectImgBorderColor","rowImgBorderColor","addonImgBorderColor","backgroundColor","rowBgColor","objectBgColor","objectDropShadowColor","objectBorderColor","rowDropShadowColor","rowBorderColor","addonDropShadowColor","addonBorderColor","addonBgColor","barTextColor","barIconColor","barBackgroundColor","backpackBgColor","barPointNeg","barPointPos"];for(let t=0;t<o.length;t++){const i=o[t];"object"==typeof e[i]&&(e[i]=e[i].hexa)}}}function xo(e,t,o){switch(t){case"1":return e-o;case"2":return e+o;case"3":return e*o;case"4":return e/o;default:return e}}function Bo(e){delete e.tmpDiscount,delete e.discountTextA,delete e.discountTextB,delete e.dupTextA,delete e.dupTextB,delete e.discountedFrom,delete e.discountIsOn,delete e.discountScore,delete e.discountScoreCal,delete e.notStackableDiscount}function $o(e,t){var o,i,n,l,r,a,s,d;const c=Bt.get(t.id);if(void 0!==c&&void 0!==e.discountOperator&&void 0!==e.discountValue){let u=c.allowFloat?t.value:Math.floor(t.value),g=t.discountIsOn&&void 0!==t.discountScore?t.discountScore:t.value;g=c.allowFloat?g:Math.floor(g);let h=0,m=0,p=[],v=!1,f=0;if(e.stackableDiscount){if(t.notStackableDiscount){if(void 0!==t.tmpDiscount){for(let e=0;e<t.tmpDiscount.length;e++)t.tmpDiscount[e].isStackable&&(p=t.tmpDiscount[e].discountedFrom,u=t.tmpDiscount[e].discountedValue,f=e);t.tmpDiscount.splice(f,1)}}else if(void 0!==t.discountedFrom){let r=t.discountedFrom.indexOf(e.id);if(t.discountedFrom.splice(r,1),void 0!==t.discountedFrom&&t.discountedFrom.length>0){for(let e=0;e<t.discountedFrom.length;e++){const o=At.get(t.discountedFrom[e]);if(void 0!==o){const e=o.choice;void 0!==e.discountOperator&&void 0!==e.discountValue&&(h=xo(u,e.discountOperator,e.discountValue),h=c.allowFloat?h:Math.floor(h),m=h,e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(h=Math.max(h,e.discountLowLimit)))}}if(e.discountShow){let r=(null==(o=t.discountTextA)?void 0:o.indexOf(e.discountAfterText??""))??-1,a=(null==(i=t.discountTextB)?void 0:i.indexOf(e.discountBeforeText??""))??-1;e.discountTextDuplicated?(-1!==r&&void 0!==t.dupTextA&&void 0!==e.discountAfterText&&(t.dupTextA[e.discountAfterText]-=1,0===t.dupTextA[e.discountAfterText]&&(null==(n=t.discountTextA)||n.splice(r,1),delete t.dupTextA[e.discountAfterText])),-1!==a&&void 0!==t.dupTextB&&void 0!==e.discountBeforeText&&(t.dupTextB[e.discountBeforeText]-=1,0===t.dupTextB[e.discountBeforeText]&&(null==(l=t.discountTextB)||l.splice(r,1),delete t.dupTextB[e.discountBeforeText]))):(-1!==r&&void 0!==t.discountTextA&&(t.discountTextA.splice(r,1),t.discountAfterText=t.discountTextA.join("")),-1!==a&&void 0!==t.discountTextB&&(t.discountTextB.splice(a,1),t.discountBeforeText=t.discountTextB.join("")))}t.discountScore=h,t.discountScoreCal=m}else{if(void 0!==t.tmpDiscount)for(let e=0;e<t.tmpDiscount.length;e++)t.tmpDiscount[e].isStackable||h>t.tmpDiscount[e].discountedValue&&(p=t.tmpDiscount[e].discountedFrom,m=t.tmpDiscount[e].calcValue,h=t.tmpDiscount[e].discountedValue,f=e,v=!0);v&&void 0!==t.tmpDiscount?0===p.length?t.tmpDiscount.splice(f,1):(t.discountedFrom=p,t.tmpDiscount[f].showDiscount&&(t.discountBeforeText=t.tmpDiscount[f].beforeText,t.discountAfterText=t.tmpDiscount[f].afterText),t.tmpDiscount.splice(f,1),t.notStackableDiscount=!0):Bo(t)}}}else if(t.notStackableDiscount)if(void 0!==t.discountedFrom&&t.discountedFrom.length>0&&void 0!==t.tmpDiscount){if(-1!==t.discountedFrom.indexOf(e.id)){if(t.tmpDiscount.length>0){u=t.tmpDiscount[0].discountedValue,v=!0;for(let e=1;e<t.tmpDiscount.length;e++)u>t.tmpDiscount[e].discountedValue&&(u=t.tmpDiscount[e].discountedValue,f=e)}v?(t.discountScore=u,t.discountScoreCal=t.tmpDiscount[f].calcValue,t.discountedFrom=t.tmpDiscount[f].discountedFrom,t.notStackableDiscount=!t.tmpDiscount[f].isStackable,t.discountShow=t.tmpDiscount[f].showDiscount,t.tmpDiscount[f].isStackable&&t.tmpDiscount[f].showDiscount?(t.discountBeforeText=null==(r=t.discountTextB)?void 0:r.join(""),t.discountAfterText=null==(a=t.discountTextA)?void 0:a.join("")):t.tmpDiscount[f].showDiscount?(t.discountBeforeText=t.tmpDiscount[f].beforeText,t.discountAfterText=t.tmpDiscount[f].afterText):(t.discountBeforeText="",t.discountAfterText=""),t.tmpDiscount.splice(f,1)):Bo(t)}else for(let o=0;o<t.tmpDiscount.length;o++)if(-1!==t.tmpDiscount[o].discountedFrom.indexOf(e.id)){t.tmpDiscount.splice(o,1);break}}else Bo(t);else if(void 0!==t.tmpDiscount){if(t.tmpDiscount=t.tmpDiscount.filter(t=>-1!==t.discountedFrom.indexOf(e.id)),t.tmpDiscount.length>0){u=t.tmpDiscount[0].discountedValue,v=!0;for(let e=1;e<t.tmpDiscount.length;e++)u>t.tmpDiscount[e].discountedValue&&(u=t.tmpDiscount[e].discountedValue,f=e)}v?(t.discountScore=u,t.discountScoreCal=t.tmpDiscount[f].calcValue,t.discountedFrom=t.tmpDiscount[f].discountedFrom,t.notStackableDiscount=!t.tmpDiscount[f].isStackable,t.notStackableDiscount?t.tmpDiscount[f].showDiscount?(t.discountBeforeText=t.tmpDiscount[f].beforeText,t.discountAfterText=t.tmpDiscount[f].afterText):(t.discountBeforeText="",t.discountAfterText=""):(t.discountBeforeText=null==(s=t.discountTextB)?void 0:s.join(""),t.discountAfterText=null==(d=t.discountTextA)?void 0:d.join("")),t.tmpDiscount.splice(f,1)):Bo(t)}else Bo(t);let b=t.discountScore??c.allowFloat?t.value:Math.floor(t.value);b!==g?(t.tmpDisScore=g-b,t.isChangeDiscount=!0):delete t.isChangeDiscount}}function Ao(e,t){const o=Bt.get(t.id);if(void 0!==o&&void 0!==e.discountOperator&&void 0!==e.discountValue){let i,n=o.allowFloat?t.value:Math.floor(t.value),l=t.discountIsOn&&void 0!==t.discountScore?t.discountScore:n,r=0,a=0,s=[],d=!1,c=0;if(t.discountedFrom??(t.discountedFrom=[]),e.stackableDiscount)if(t.notStackableDiscount){if(void 0!==t.tmpDiscount){for(let o=0;o<t.tmpDiscount.length;o++)t.tmpDiscount[o].isStackable&&(s=t.tmpDiscount[o].discountedFrom,s.push(e.id),n=t.tmpDiscount[o].discountedValue,d=!0,c=o);r=xo(n,e.discountOperator,e.discountValue),r=o.allowFloat?r:Math.floor(r),a=r,e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(r=Math.max(r,e.discountLowLimit)),void 0!==t.discountScore&&t.discountScore>r?(t.tmpDisScore=t.discountScore-r,t.isChangeDiscount=!0,i={isStackable:!1,discountedFrom:t.discountedFrom,calcValue:t.discountScoreCal??t.discountScore,discountedValue:t.discountScore,showDiscount:!1},t.discountShow&&(i.showDiscount=!0,i.beforeText=e.discountBeforeText,i.afterText=e.discountAfterText),t.discountScore=r,t.discountScoreCal=a,e.discountShow&&(t.discountShow=!0,Oo(e,t)),void 0!==t.discountTextA&&(t.discountAfterText=t.discountTextA.join("")),void 0!==t.discountTextB&&(t.discountBeforeText=t.discountTextB.join("")),t.discountedFrom.push(...s),d&&t.tmpDiscount.splice(c,1),t.tmpDiscount.push(i),t.notStackableDiscount=!1):(t.isChangeDiscount=!1,s.push(e.id),e.discountShow&&Oo(e,t),d?(t.tmpDiscount[c].discountedFrom=s,t.tmpDiscount[c].calcValue=a,t.tmpDiscount[c].discountedValue=r):(i={isStackable:e.stackableDiscount??!1,discountedFrom:s,calcValue:a,discountedValue:r,showDiscount:e.discountShow??!1},t.tmpDiscount.push(i)))}}else n=t.discountIsOn?t.discountScoreCal??t.value:t.value,n=o.allowFloat?n:Math.floor(n),l=t.discountIsOn&&void 0!==t.discountScore?t.discountScore:t.value,l=o.allowFloat?l:Math.floor(l),r=xo(n,e.discountOperator,e.discountValue),r=o.allowFloat?r:Math.floor(r),a=r,e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(r=Math.max(r,e.discountLowLimit)),Array.isArray(t.discountedFrom)||(t.discountedFrom=[]),t.discountScore=r,t.discountScoreCal=a,t.discountedFrom.push(e.id),t.discountScore!==l?(t.tmpDisScore=l-t.discountScore,t.isChangeDiscount=!0):t.isChangeDiscount=!1,t.discountIsOn||(t.discountIsOn=!0),e.discountShow&&(t.discountShow=!0,Oo(e,t)),void 0!==t.discountTextA&&(t.discountAfterText=t.discountTextA.join("")),void 0!==t.discountTextB&&(t.discountBeforeText=t.discountTextB.join(""));else t.tmpDiscount??(t.tmpDiscount=[]),r=xo(n,e.discountOperator,e.discountValue),r=o.allowFloat?r:Math.floor(r),a=r,e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(r=Math.max(r,e.discountLowLimit)),t.discountIsOn?void 0!==t.discountScore&&(t.discountScore>r?(i={isStackable:!t.notStackableDiscount,discountedFrom:t.discountedFrom,calcValue:t.discountScoreCal??t.discountScore,discountedValue:t.discountScore,showDiscount:t.discountShow??!1},t.discountShow&&(i.showDiscount=!0,i.beforeText=t.discountBeforeText,i.afterText=t.discountAfterText),t.discountScore=r,t.discountScoreCal=a,t.discountShow=e.discountShow,t.discountBeforeText=e.discountBeforeText,t.discountAfterText=e.discountAfterText,t.discountedFrom=[e.id],t.notStackableDiscount=!0):(i={isStackable:e.stackableDiscount??!1,discountedFrom:[e.id],calcValue:a,discountedValue:r,showDiscount:e.discountShow??!1},e.discountShow&&(i.showDiscount=!0,i.beforeText=e.discountBeforeText,i.afterText=e.discountAfterText)),t.tmpDiscount.push(i)):(t.discountScore=r,t.discountScoreCal=a,e.discountShow&&(t.discountShow=e.discountShow,t.discountBeforeText=e.discountBeforeText,t.discountAfterText=e.discountAfterText),Array.isArray(t.discountedFrom)||(t.discountedFrom=[]),t.discountIsOn=!0,t.discountedFrom.push(e.id),t.notStackableDiscount=!0),void 0!==t.discountScore&&t.discountScore!==l?(t.tmpDisScore=l-t.discountScore,t.isChangeDiscount=!0):t.isChangeDiscount=!1}}function Oo(e,t){t.discountTextA??(t.discountTextA=[]),t.discountTextB??(t.discountTextB=[]),t.dupTextA??(t.dupTextA={}),t.dupTextB??(t.dupTextB={}),e.discountTextDuplicated?(void 0!==e.discountAfterText&&(-1!==t.discountTextA.indexOf(e.discountAfterText)?t.dupTextA[e.discountAfterText]=(t.dupTextA[e.discountAfterText]??0)+1:(t.dupTextA[e.discountAfterText]=1,t.discountTextA.push(e.discountAfterText))),void 0!==e.discountBeforeText&&(-1!==t.discountTextB.indexOf(e.discountBeforeText)?t.dupTextB[e.discountBeforeText]=(t.dupTextB[e.discountBeforeText]??0)+1:(t.dupTextB[e.discountBeforeText]=1,t.discountTextB.push(e.discountBeforeText)))):(void 0!==e.discountAfterText&&t.discountTextA.push(e.discountAfterText),void 0!==e.discountBeforeText&&t.discountTextB.push(e.discountBeforeText))}function ko(e,t){let o=!0,i=new Map;for(let n=0;n<e.scores.length;n++){let l=e.scores[n],r=l.discountIsOn&&void 0!==l.discountScore?l.discountScore:l.value;if(l.multiplyByTimes&&(r*=Math.abs(e.multipleUseVariable)+1),wo(l.requireds)&&!l.isActive){let e=Bt.get(l.id);if(void 0!==e&&e.belowZeroNotAllowed){let n=i.get(l.id);void 0!==n?(o=o&&(t?n-r>=0:n+r>=0),i.set(l.id,n-l.value)):(o=o&&(t?e.startingSum-r>=0:e.startingSum+r>=0),i.set(l.id,e.startingSum-r))}}}return o}function Mo(){var e,t,o,i,n,l,r,a;const s=new Set;function d(e){if(e.activateOtherChoice&&void 0!==e.activateThisChoice)if(e.activatedRandom){if(e.isSelectableMultiple){for(let o=0;o<e.multipleUseVariable;o++)if(void 0!==e.activatedRandomMul)for(var t=0;t<e.activatedRandomMul[t].length;t++){const i=e.activatedRandomMul[o][t].split("/ON#"),n=At.get(i[0]);if(void 0!==n){const t=n.choice;if(Ct.has(t.id))e.isAllowDeselect||(s.add(t.id),i.length>1&&t.isSelectableMultiple&&(void 0===t.tempMultipleValue?t.tempMultipleValue=parseInt(i[1]):t.tempMultipleValue+=parseInt(i[1])),d(t));else{const e=xt.get(t.id);void 0!==e?i.length>1&&(e.multiple+=parseInt(i[1])):xt.set(t.id,{multiple:i.length>1?parseInt(i[1]):0,isAllowDeselect:t.isAllowDeselect??!1})}}}}else if(void 0!==e.activatedRandom)for(let o=0;o<e.activatedRandom.length;o++){const t=e.activatedRandom[o].split("/ON#"),i=At.get(t[0]);if(void 0!==i){const o=i.choice;if(Ct.has(o.id))e.isAllowDeselect||(s.add(o.id),t.length>1&&o.isSelectableMultiple&&(void 0===o.tempMultipleValue?o.tempMultipleValue=parseInt(t[1]):o.tempMultipleValue+=parseInt(t[1])),d(o));else{const e=xt.get(o.id);void 0!==e?t.length>1&&(e.multiple+=parseInt(t[1])):xt.set(o.id,{multiple:t.length>1?parseInt(t[1]):0,isAllowDeselect:o.isAllowDeselect??!1})}}}}else{const t=e.activateThisChoice.split(",");for(let o=0;o<t.length;o++){const i=t[o].split("/ON#"),n=At.get(i[0]);if(void 0!==n){const t=n.choice;if(Ct.has(t.id))e.isAllowDeselect||(s.add(t.id),i.length>1&&t.isSelectableMultiple&&(void 0===t.tempMultipleValue?t.tempMultipleValue=parseInt(i[1]):t.tempMultipleValue+=parseInt(i[1])),d(t));else{const e=xt.get(t.id);void 0!==e?i.length>1&&(e.multiple+=parseInt(i[1])):xt.set(t.id,{multiple:i.length>1?parseInt(i[1]):0,isAllowDeselect:t.isAllowDeselect??!1})}}}}}xt.clear(),Array.from(Ct.entries()).forEach(([e])=>{const t=At.get(e);if(void 0!==t){const e=t.choice;e.notDeselectedByClean&&(s.add(e.id),d(e))}else Ct.delete(e)});let c=[...Ct.keys()],u=Array.from(At.entries()).filter(([e,t])=>!0===t.choice.isActive).map(([e])=>e),g=Array.from(new Set([...c,...u]));for(let h=g.length-1;h>=0;h--){const e=At.get(g[h]);if(void 0!==e){const t=e.choice;if(!s.has(t.id)){if(delete t.multiplyPointtypeIsOnCheck,delete t.startingSumAtMultiply,delete t.multiplyPointtypeIsOnCheck,delete t.startingSumAtDivide,delete t.activatedRandom,delete t.activatedRandomMul,t.addToAllowChoice&&void 0!==t.idOfAllowChoice&&void 0!==t.numbAddToAllowChoice)for(let e=0;e<t.idOfAllowChoice.length;e++){const o=$t.get(t.idOfAllowChoice[e]);void 0!==o&&(o.allowedChoices-=t.numbAddToAllowChoice)}if(t.isChangeVariables&&void 0!==t.changedVariables)for(let e=0;e<t.changedVariables.length;e++){const o=Ft.get(t.changedVariables[e]);void 0!==o&&("1"===t.changeType?o.isTrue=!0:"2"===t.changeType?o.isTrue=!1:"3"===t.changeType&&(o.isTrue=!o.isTrue))}if(t.textfieldIsOn&&void 0!==t.idOfTheTextfieldWord&&void 0!==t.wordChangeSelect){const e=Mt.get(t.idOfTheTextfieldWord);void 0!==e&&(e.replaceText=void 0===t.wordChangeDeselect?"":t.wordChangeDeselect)}if(t.isImageUpload&&void 0!==t.defaultImage&&(t.image=t.defaultImage),t.setBgmIsOn&&Lt&&t.bgmId){const e=A(Lt);if(e&&void 0!==e.playerInfo.videoData){const o=e.playerInfo.videoData.video_id;t.bgmId===o&&(e.stopVideo(),Nt.bgmIsPlaying=!1,0!==Nt.bgmFadeInterval&&(window.clearInterval(Nt.bgmFadeInterval),Nt.bgmFadeInterval=0),0!==Nt.bgmTitleInterval&&(window.clearInterval(Nt.bgmTitleInterval),Nt.bgmTitleInterval=0),0!==Nt.bgmPlayInterval&&(window.clearInterval(Nt.bgmPlayInterval),Nt.bgmPlayInterval=0),Nt.lastFadeTime=0,Nt.isFadingOut=!1,Nt.bgmTitle="No Audio Title",Nt.curBgmTime=0,Nt.curBgmLength=0)}}if(t.isContentHidden&&void 0!==t.hiddenContentsRow&&void 0!==t.hiddenContentsType)for(let e=0;e<t.hiddenContentsRow.length;e++){const o=$t.get(t.hiddenContentsRow[e]);if(void 0!==o)for(let e=0;e<t.hiddenContentsType.length;e++)switch(t.hiddenContentsType[e]){case"1":delete o.objectTitleRemoved;break;case"2":delete o.objectImageRemoved;break;case"3":delete o.objectTextRemoved;break;case"4":delete o.objectScoreRemoved;break;case"5":delete o.objectRequirementRemoved;break;case"6":delete o.addonTitleRemoved;break;case"7":delete o.addonImageRemoved;break;case"8":delete o.addonTextRemoved}}t.multipleUseVariable=0,t.isActive=!1,Ct.delete(t.id)}}else Ct.delete(g[h])}for(let h=0;h<app.pointTypes.length;h++){const e=app.pointTypes[h];e.startingSum=e.initValue}for(let h=0;h<app.rows.length;h++){const e=app.rows[h];e.isEditModeOn=!1,e.currentChoices=0,e.index=h;for(let t=0;t<e.objects.length;t++){const o=e.objects[t];o.index=t,void 0!==o.defaultTemplate&&(o.template=o.defaultTemplate),void 0!==o.defaultWidth&&(o.width=o.defaultWidth),delete o.templateStack,delete o.widthStack;for(let e=0;e<o.scores.length;e++){const t=o.scores[e];o.isSelectableMultiple?(delete t.isActiveMul,delete t.isActiveMulMinus):delete t.isActive,Bo(t)}}}for(let h=0;h<app.backpack.length;h++){const e=app.backpack[h];e.isEditModeOn=!1,e.currentChoices=0,e.index=h;for(let t=0;t<e.objects.length;t++){const o=e.objects[t];o.index=t,void 0!==o.defaultTemplate&&(o.template=o.defaultTemplate),void 0!==o.defaultWidth&&(o.width=o.defaultWidth),delete o.templateStack,delete o.widthStack;for(let e=0;e<o.scores.length;e++){const t=o.scores[e];o.isSelectableMultiple?(delete t.isActiveMul,delete t.isActiveMulMinus):delete t.isActive,Bo(t)}}}if(void 0!==app.defaultBgColor&&(app.styling.backgroundColor=app.defaultBgColor,delete app.defaultBgColor),void 0!==app.defaultBgImage&&(app.styling.backgroundImage=app.defaultBgImage,delete app.defaultBgImage),void 0!==app.defaultBarBgColor&&(app.styling.barBackgroundColor=app.defaultBarBgColor,delete app.defaultBarBgColor),void 0!==app.defaultBarIconColor&&(app.styling.barIconColor=app.defaultBarIconColor,delete app.defaultBarIconColor),void 0!==app.defaultBarTextColor&&(app.styling.barTextColor=app.defaultBarTextColor,delete app.defaultBarTextColor),delete app.bgColorStack,delete app.bgImageStack,delete app.barBgColorStack,delete app.barIconColorStack,delete app.barTextColorStack,app.btnBackpackIsOn=0,app.showAllAddons=0,app.isMute=!1,app.curVolume=100,Lt){const e=A(Lt);e&&"function"==typeof e.unMute&&e.unMute()}Pt.splice(0),g=[...Ct.keys()];for(let h=0;h<g.length;h++){const n=At.get(g[h]);if(void 0!==n){const l=n.choice;if(wo(l.requireds)&&ko(l,!0)){if(l.discountOther&&void 0!==l.discountOperator&&void 0!==l.discountValue)if(l.isDisChoices){if(void 0!==l.discountChoices)for(let o=0;o<l.discountChoices.length;o++){const i=At.get(l.discountChoices[o]);if(void 0!==i)for(let o=0;o<i.choice.scores.length;o++){const n=i.choice.scores[o];n.isNotDiscountable||0!==(null==(e=l.discountPointTypes)?void 0:e.length)&&-1===(null==(t=l.discountPointTypes)?void 0:t.indexOf(n.id))||Ao(l,n)}}}else if(void 0!==l.discountGroups)for(let e=0;e<l.discountGroups.length;e++){const t=Ot.get(l.discountGroups[e]);if(void 0!==t)for(let e=0;e<t.elements.length;e++){const n=At.get(t.elements[e]);if(void 0!==n)for(let e=0;e<n.choice.scores.length;e++){const t=n.choice.scores[e];t.isNotDiscountable||0!==(null==(o=l.discountPointTypes)?void 0:o.length)&&-1===(null==(i=l.discountPointTypes)?void 0:i.indexOf(t.id))||Ao(l,t)}}}if(l.addToAllowChoice&&void 0!==l.idOfAllowChoice&&void 0!==l.numbAddToAllowChoice)for(let e=0;e<l.idOfAllowChoice.length;e++){const t=$t.get(l.idOfAllowChoice[e]);void 0!==t&&(t.allowedChoices+=l.numbAddToAllowChoice)}}}}for(let h=0;h<g.length;h++){const e=At.get(g[h]);if(void 0!==e){const t=e.choice,o=e.row;if(wo(t.requireds)&&ko(t,!0)){for(let e=0;e<t.scores.length;e++){const o=t.scores[e],i=Bt.get(o.id);if(void 0!==i)if(t.isSelectableMultiple&&t.isMultipleUseVariableultiple)for(let e=0;e<t.multipleUseVariable;e++)wo(o.requireds)&&(void 0===o.isActiveMul&&(o.isActiveMul=[]),o.isActiveMul[e]||(o.multiplyByTimes?i.startingSum-=o.discountIsOn&&void 0!==o.discountScore?o.discountScore*(e+1):o.value*(e+1):i.startingSum-=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value,o.isActiveMul[e]=!0));else t.isSelectableMultiple||wo(o.requireds)&&!o.isActive&&(i.startingSum-=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value,o.isActive=!0)}if(t.multiplyPointtypeIsOn&&void 0!==t.pointTypeToMultiply&&void 0!==t.multiplyWithThis){let e=0;t.multiplyPointtypeIsOnCheck=!0,"object"!=typeof t.startingSumAtMultiply&&(t.startingSumAtMultiply=[]);for(let o=0;o<t.pointTypeToMultiply.length;o++){let i=Bt.get(t.pointTypeToMultiply[o]);if(void 0!==i)if(t.multiplyPointtypeIsId&&"string"==typeof t.multiplyWithThis){let n=Bt.get(t.multiplyWithThis);void 0!==n?(t.startingSumAtMultiply[o]={value:i.startingSum,calcVal:n.startingSum},i.startingSum*=n.startingSum):e++}else"number"==typeof t.multiplyWithThis&&(t.startingSumAtMultiply[o]={value:i.startingSum,calcVal:t.multiplyWithThis},i.startingSum*=t.multiplyWithThis);else e++}e===t.pointTypeToMultiply.length&&delete t.multiplyPointtypeIsOnCheck,t.multiplyPointtypeIsOnCheck&&Pt.push(t)}if(t.dividePointtypeIsOn&&void 0!==t.pointTypeToDivide&&void 0!==t.divideWithThis){let e=0;t.dividePointtypeIsOnCheck=!0,"object"!=typeof t.startingSumAtDivide&&(t.startingSumAtDivide=[]);for(let o=0;o<t.pointTypeToDivide.length;o++){let i=Bt.get(t.pointTypeToDivide[o]);if(void 0!==i)if(t.dividePointtypeIsId&&"string"==typeof t.divideWithThis){let n=Bt.get(t.divideWithThis);void 0!==n?0===n.startingSum?e++:(t.startingSumAtDivide[o]={value:i.startingSum,calcVal:n.startingSum},i.startingSum/=n.startingSum):e++}else"number"==typeof t.divideWithThis&&(0===t.dividedWithThis?e++:(t.startingSumAtDivide[o]={value:i.startingSum,calcVal:t.divideWithThis},i.startingSum/=t.divideWithThis));else e++}e===t.pointTypeToDivide.length&&delete t.dividePointtypeIsOnCheck,!t.multiplyPointtypeIsOnCheck&&t.dividePointtypeIsOnCheck&&Pt.push(t)}if(t.changeBackground&&(t.changeBgImage?void 0!==t.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage??""),app.bgImageStack.push({id:t.id,data:t.bgImage}),app.styling.backgroundImage=t.bgImage):void 0!==t.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor??""),app.bgColorStack.push({id:t.id,data:t.changedBgColorCode}),app.styling.backgroundColor=t.changedBgColorCode)),t.changePointBar&&(t.changeBarBgColorIsOn&&void 0!==t.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor??"#FFFFFFFF"),app.barBgColorStack.push({id:t.id,data:t.changedBarBgColor}),app.styling.barBackgroundColor=t.changedBarBgColor),t.changeBarIconColorIsOn&&void 0!==t.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor??"#0000008A"),app.barIconColorStack.push({id:t.id,data:t.changedBarIconColor}),app.styling.barIconColor=t.changedBarIconColor),t.changeBarTextColorIsOn&&void 0!==t.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor??"#000000"),app.barTextColorStack.push({id:t.id,data:t.changedBarTextColor}),app.styling.barTextColor=t.changedBarTextColor)),t.changeTemplates&&t.changeTemplatesList&&t.changeToThisTemplate){const e=t.changeTemplatesList.split(",");for(let o=0;o<e.length;o++){const i=e[o],n=At.get(i);if(void 0!==n){const e=n.choice;if(vi(e,t.id,t.changeToThisTemplate),t.changeAddonTemplate)for(let o=0;o<e.addons.length;o++){vi(e.addons[o],t.id,t.changeToThisTemplate)}continue}const l=$t.get(i);if(void 0!==l){vi(l,t.id,t.changeToThisTemplate);continue}const r=Ot.get(i[0]);if(void 0!==r){const e=r.rowElements;for(let i=0;i<e.length;i++){const o=$t.get(e[i]);void 0!==o&&vi(o,t.id,t.changeToThisTemplate)}const o=r.elements;for(let i=0;i<o.length;i++){const e=At.get(o[i]);if(void 0!==e){vi(e.choice,t.id,t.changeToThisTemplate)}}continue}}}if(t.changeWidth&&t.changeWidthList&&t.changeToThisWidth){const e=t.changeWidthList.split(",");for(let o=0;o<e.length;o++){const i=e[o],n=At.get(i);if(void 0!==n){bi(n.choice,t.id,t.changeToThisWidth);continue}const l=$t.get(i);if(void 0!==l){bi(l,t.id,t.changeToThisWidth);continue}const r=Ot.get(i[0]);if(void 0!==r){const e=r.rowElements;for(let i=0;i<e.length;i++){const o=$t.get(e[i]);void 0!==o&&bi(o,t.id,t.changeToThisWidth)}const o=r.elements;for(let i=0;i<o.length;i++){const e=At.get(o[i]);if(void 0!==e){bi(e.choice,t.id,t.changeToThisWidth)}}continue}}}if(t.muteBgm&&Lt){const e=A(Lt);app.isMute=!0,e&&"function"==typeof e.mute&&e.mute()}t.backpackBtnRequirement&&(app.btnBackpackIsOn+=1),t.showAllAddons&&(app.showAllAddons+=1),o.currentChoices+=1}else{if(t.discountOther&&void 0!==t.discountOperator&&void 0!==t.discountValue)if(t.isDisChoices){if(void 0!==t.discountChoices)for(let e=0;e<t.discountChoices.length;e++){const o=At.get(t.discountChoices[e]);if(void 0!==o)for(let e=0;e<o.choice.scores.length;e++){const i=o.choice.scores[e];i.isNotDiscountable||0!==(null==(n=t.discountPointTypes)?void 0:n.length)&&-1===(null==(l=t.discountPointTypes)?void 0:l.indexOf(i.id))||$o(t,i)}}}else if(void 0!==t.discountGroups)for(let e=0;e<t.discountGroups.length;e++){const o=Ot.get(t.discountGroups[e]);if(void 0!==o)for(let e=0;e<o.elements.length;e++){const i=At.get(o.elements[e]);if(void 0!==i)for(let e=0;e<i.choice.scores.length;e++){const o=i.choice.scores[e];o.isNotDiscountable||0!==(null==(r=t.discountPointTypes)?void 0:r.length)&&-1===(null==(a=t.discountPointTypes)?void 0:a.indexOf(o.id))||$o(t,o)}}}if(t.addToAllowChoice&&void 0!==t.idOfAllowChoice&&void 0!==t.numbAddToAllowChoice)for(let e=0;e<t.idOfAllowChoice.length;e++){const o=$t.get(t.idOfAllowChoice[e]);void 0!==o&&(o.allowedChoices-=t.numbAddToAllowChoice)}Ct.delete(t.id),t.forcedActivated&&xt.set(t.id,{multiple:t.multipleUseVariable})}}else Ct.delete(g[h])}}function Fo(e,t,o){Array.from(Ct.entries()).forEach(([o,i])=>{const n=At.get(o);if(void 0!==n){const o=n.row,i=n.choice,l=new y;let r=!1;for(let n=0;n<i.scores.length;n++){const a=i.scores[n];if(!a.isNotRecalculatable){const n=Bt.get(a.id);if(void 0!==n){if(e.discountOther&&a.isChangeDiscount&&void 0!==a.tmpDisScore){const e=i.multipleUseVariable;if(i.isSelectableMultiple&&i.isMultipleUseVariable&&void 0!==i.numMultipleTimesMinus){for(let t=e-1;t>=0;t--)i.isActive&&(n.startingSum+=a.tmpDisScore);i.isActive&&(l.set(a.id,a.tmpDisScore),delete a.isChangeDiscount,delete a.tmpDisScore)}else i.isSelectableMultiple||(n.startingSum+=a.tmpDisScore,l.set(a.id,a.tmpDisScore),delete a.isChangeDiscount,delete a.tmpDisScore)}const s=t.get(a.id)??0;if(i.isActive){const t=wo(a.requireds),d=new y(JSON.parse(JSON.stringify([...Ct])));d.delete(e.id),o.currentChoices-=1,n.startingSum+=s;const c=wo(a.requireds,d);if(o.currentChoices+=1,n.startingSum-=s,c!==t){let e=a.discountIsOn&&void 0!==a.discountScore?a.discountScore:a.value;if(c)if(i.isSelectableMultiple&&i.isMultipleUseVariable&&void 0!==i.numMultipleTimesMinus){for(let t=i.multipleUseVariable-1;t>=0;t--)void 0!==a.isActiveMul&&a.isActiveMul[t]&&(n.startingSum+=e,l.set(a.id,e),a.isActiveMul[t]=!1)}else i.isSelectableMultiple||a.isActive&&(r=!0,n.startingSum+=e,l.set(a.id,e),delete a.isActive);else a.isActive||(r=!0,n.startingSum-=e,l.set(a.id,e),a.isActive=!0)}}}}}r&&Fo(i,l)}})}function Ro(e,t){var o,i,n,l,r,a;let s=e.split("/IMG#");const d=s.length>1?s[1]:"";s=s[0].split("/WORD#");const c=s.length>1?s[1].replaceAll("/CHAR#",","):"";s=s[0].split("/RND#");const u=s.length>1?s[1].split("/AND#"):"",g=s[0],h=At.get(g);if(void 0!==h){const e=h.row,s=h.choice;for(let t=0;t<s.scores.length;t++){const e=s.scores[t],o=Bt.get(e.id);void 0!==o&&e.isRandom&&!e.setValue&&void 0!==e.maxValue&&void 0!==e.minValue&&(e.value=Math.floor(Math.random()*(e.maxValue-e.minValue+1))+e.minValue,e.value=o.allowFloat?e.value:Math.floor(e.value),e.setValue=!0)}const g=new y;if(s.isActive=!0,Ct.set(s.id,{multiple:0}),e.currentChoices+=1,s.discountOther&&void 0!==s.discountOperator&&void 0!==s.discountValue)if(s.isDisChoices){const e=new Set;if(void 0!==s.discountRows)for(let t=0;t<s.discountRows.length;t++){const n=$t.get(s.discountRows[t]);if(void 0!==n)for(let t=0;t<n.objects.length;t++){const l=n.objects[t];for(let e=0;e<l.scores.length;e++){const t=l.scores[e];t.isNotDiscountable||0!==(null==(o=s.discountPointTypes)?void 0:o.length)&&-1===(null==(i=s.discountPointTypes)?void 0:i.indexOf(t.id))||Ao(s,t)}e.add(l.id)}}if(void 0!==s.discountChoices)for(let t=0;t<s.discountChoices.length;t++)if(!e.has(s.discountChoices[t])){const e=At.get(s.discountChoices[t]);if(void 0!==e){const t=e.choice;for(let e=0;e<t.scores.length;e++){const o=t.scores[e];o.isNotDiscountable||0!==(null==(n=s.discountPointTypes)?void 0:n.length)&&-1===(null==(l=s.discountPointTypes)?void 0:l.indexOf(o.id))||Ao(s,o)}}}}else if(void 0!==s.discountGroups)for(let t=0;t<s.discountGroups.length;t++){const e=Ot.get(s.discountGroups[t]);if(void 0!==e)for(let t=0;t<e.elements.length;t++){const o=At.get(e.elements[t]);if(void 0!==o)for(let e=0;e<o.choice.scores.length;e++){const t=o.choice.scores[e];t.isNotDiscountable||0!==(null==(r=s.discountPointTypes)?void 0:r.length)&&-1===(null==(a=s.discountPointTypes)?void 0:a.indexOf(t.id))||Ao(s,t)}}}for(let t=0;t<s.scores.length;t++){const e=s.scores[t];if(wo(e.requireds)&&!e.isActive){const t=Bt.get(e.id);if(void 0!==t){let o=e.discountIsOn&&void 0!==e.discountScore?e.discountScore:e.value;o=t.allowFloat?o:Math.floor(o),t.startingSum-=o,e.isActive=!0;let i=g.get(e.id);void 0!==i?g.set(e.id,o+i):g.set(e.id,o)}}}if(s.duplicateRow&&void 0!==s.duplicateRowId&&void 0!==s.duplicateRowPlace&&qo(s),s.activateOtherChoice&&void 0!==s.activateThisChoice){const e=new Set(t.map(e=>e.split("/ON#")[0]));if(s.isActivateRandom&&void 0!==s.numActivateRandom)if(""===u){let t=s.activateThisChoice.split(",").filter(t=>e.has(t.split("/ON#")[0]));const o=s.numActivateRandom>t.length?t.length:s.numActivateRandom;let i=new Set;for(let e=0;e<t.length;e++){const o=At.get(t[e]);if(void 0!==o){if(!wo(o.choice.requireds)){const o=t[e];t.splice(e,1),t.push(o)}}}for(let e=t.length-1;e>=0;e--)i.add(t[e]);t=[...i].reverse(),s.activatedRandom=t.slice(0,o);for(let e=0;e<o;e++){const t=s.activatedRandom[e].split("/ON#"),o=At.get(t[0]);if(void 0!==o){const e=o.choice;if(!s.isAllowDeselect){if(e.isSelectableMultiple&&e.isMultipleUseVariable){const o=parseInt(t[1]);for(let t=0;t<Math.abs(o);t++)o>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:o<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--}e.forcedActivated=!0}}}}else{let t=u.filter(t=>e.has(t.split("/RON#")[0]));s.activatedRandom=t;for(let e=0;e<t.length;e++){const t=s.activatedRandom[e].split("/RON#"),o=At.get(t[0]);if(void 0!==o){const e=o.choice;if(!s.isAllowDeselect){if(e.isSelectableMultiple&&e.isMultipleUseVariable){const o=parseInt(t[1]);for(let t=0;t<Math.abs(o);t++)o>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:o<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--}e.forcedActivated=!0}}}}else{const t=s.activateThisChoice.split(",").filter(t=>e.has(t.split("/ON#")[0]));for(let e=0;e<t.length;e++){const o=t[e].split("/ON#"),i=o.length>1?parseInt(o[1]):0,n=At.get(o[0]);if(void 0!==n){const e=n.choice;if(!s.isAllowDeselect){if(e.isSelectableMultiple&&e.isMultipleUseVariable)if(s.isSelectableMultiple&&s.isMultipleUseVariable)for(let t=0;t<Math.abs(s.multipleUseVariable);t++)for(let o=0;o<Math.abs(i);o++)i>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:i<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--;else for(let t=0;t<Math.abs(i);t++)i>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:i<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--;e.forcedActivated=!0}}else{const e=Ot.get(o[0]);if(void 0!==e){const t=e.elements;for(let e=0;e<t.length;e++){const o=At.get(t[e]);if(void 0!==o){const e=o.choice;if(!s.isAllowDeselect){if(e.isSelectableMultiple&&e.isMultipleUseVariable)if(s.isSelectableMultiple&&s.isMultipleUseVariable)for(let t=0;t<Math.abs(s.multipleUseVariable);t++)for(let o=0;o<Math.abs(i);o++)i>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:i<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--;else for(let t=0;t<Math.abs(i);t++)i>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:i<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--;e.forcedActivated=!0}}}}}}}}if(s.multiplyPointtypeIsOn&&void 0!==s.pointTypeToMultiply&&void 0!==s.multiplyWithThis){let e=0;s.multiplyPointtypeIsOnCheck=!0,"object"!=typeof s.startingSumAtMultiply&&(s.startingSumAtMultiply=[]);for(let t=0;t<s.pointTypeToMultiply.length;t++){let o=Bt.get(s.pointTypeToMultiply[t]);if(void 0!==o)if(s.multiplyPointtypeIsId&&"string"==typeof s.multiplyWithThis){let i=Bt.get(s.multiplyWithThis);void 0!==i?(s.startingSumAtMultiply[t]={value:o.startingSum,calcVal:i.startingSum},o.startingSum*=i.startingSum,o.startingSum=o.allowFloat?o.startingSum:Math.floor(o.startingSum)):e++}else"number"==typeof s.multiplyWithThis&&(s.startingSumAtMultiply[t]={value:o.startingSum,calcVal:s.multiplyWithThis},o.startingSum*=s.multiplyWithThis,o.startingSum=o.allowFloat?o.startingSum:Math.floor(o.startingSum));else e++}e===s.pointTypeToMultiply.length&&delete s.multiplyPointtypeIsOnCheck,s.multiplyPointtypeIsOnCheck&&Pt.push(s)}if(s.dividePointtypeIsOn&&void 0!==s.pointTypeToDivide&&void 0!==s.divideWithThis){let e=0;s.dividePointtypeIsOnCheck=!0,"object"!=typeof s.startingSumAtDivide&&(s.startingSumAtDivide=[]);for(let t=0;t<s.pointTypeToDivide.length;t++){let o=Bt.get(s.pointTypeToDivide[t]);if(void 0!==o)if(s.dividePointtypeIsId&&"string"==typeof s.divideWithThis){let i=Bt.get(s.divideWithThis);void 0!==i?0===i.startingSum?e++:(s.startingSumAtDivide[t]={value:o.startingSum,calcVal:i.startingSum},o.startingSum/=i.startingSum,o.startingSum=o.allowFloat?o.startingSum:Math.floor(o.startingSum)):e++}else"number"==typeof s.divideWithThis&&(0===s.dividedWithThis?e++:(s.startingSumAtDivide[t]={value:o.startingSum,calcVal:s.divideWithThis},o.startingSum/=s.divideWithThis,o.startingSum=o.allowFloat?o.startingSum:Math.floor(o.startingSum)));else e++}e===s.pointTypeToDivide.length&&delete s.dividePointtypeIsOnCheck,!s.multiplyPointtypeIsOnCheck&&s.dividePointtypeIsOnCheck&&Pt.push(s)}if(s.isChangeVariables&&void 0!==s.changedVariables)for(let t=0;t<s.changedVariables.length;t++){const e=Ft.get(s.changedVariables[t]);void 0!==e&&("1"===s.changeType?e.isTrue=!0:"2"===s.changeType?e.isTrue=!1:"3"===s.changeType&&(e.isTrue=!e.isTrue))}if(s.addToAllowChoice&&void 0!==s.idOfAllowChoice&&void 0!==s.numbAddToAllowChoice)for(let t=0;t<s.idOfAllowChoice.length;t++){const e=$t.get(s.idOfAllowChoice[t]);void 0!==e&&(e.allowedChoices+=s.numbAddToAllowChoice)}if(s.textfieldIsOn&&void 0!==s.idOfTheTextfieldWord&&void 0!==s.wordChangeSelect){const e=Mt.get(s.idOfTheTextfieldWord);void 0!==e&&(s.customTextfieldIsOn?e.replaceText=c:e.replaceText=s.wordChangeSelect)}if(s.isImageUpload&&(s.defaultImage=s.image,s.image=d),s.backpackBtnRequirement&&(app.btnBackpackIsOn??(app.btnBackpackIsOn=0),app.btnBackpackIsOn+=1),s.showAllAddons&&(app.showAllAddons??(app.showAllAddons=0),app.showAllAddons+=1),s.changeBackground&&(s.changeBgImage?void 0!==s.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage??""),app.bgImageStack.push({id:s.id,data:s.bgImage}),app.styling.backgroundImage=s.bgImage):void 0!==s.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor??""),app.bgColorStack.push({id:s.id,data:s.bgColor}),app.styling.backgroundColor=s.bgColor)),s.changePointBar&&(s.changeBarBgColorIsOn&&void 0!==s.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor??"#FFFFFFFF"),app.barBgColorStack.push({id:s.id,data:s.changedBarBgColor}),app.styling.barBackgroundColor=s.changedBarBgColor),s.changeBarIconColorIsOn&&void 0!==s.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor??"#0000008A"),app.barIconColorStack.push({id:s.id,data:s.changedBarIconColor}),app.styling.barIconColor=s.changedBarIconColor),s.changeBarTextColorIsOn&&void 0!==s.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor??"#000000"),app.barTextColorStack.push({id:s.id,data:s.changedBarTextColor}),app.styling.barTextColor=s.changedBarTextColor)),s.changeTemplates&&s.changeTemplatesList&&s.changeToThisTemplate){const e=s.changeTemplatesList.split(",");for(let t=0;t<e.length;t++){const o=e[t],i=At.get(o);if(void 0!==i){const e=i.choice;if(vi(e,s.id,s.changeToThisTemplate),s.changeAddonTemplate)for(let t=0;t<e.addons.length;t++){vi(e.addons[t],s.id,s.changeToThisTemplate)}continue}const n=$t.get(o);if(void 0!==n){vi(n,s.id,s.changeToThisTemplate);continue}const l=Ot.get(o[0]);if(void 0!==l){const e=l.rowElements;for(let o=0;o<e.length;o++){const t=$t.get(e[o]);void 0!==t&&vi(t,s.id,s.changeToThisTemplate)}const t=l.elements;for(let o=0;o<t.length;o++){const e=At.get(t[o]);if(void 0!==e){vi(e.choice,s.id,s.changeToThisTemplate)}}continue}}}if(s.changeWidth&&s.changeWidthList&&s.changeToThisWidth){const e=s.changeWidthList.split(",");for(let t=0;t<e.length;t++){const o=e[t],i=At.get(o);if(void 0!==i){bi(i.choice,s.id,s.changeToThisWidth);continue}const n=$t.get(o);if(void 0!==n){bi(n,s.id,s.changeToThisWidth);continue}const l=Ot.get(o[0]);if(void 0!==l){const e=l.rowElements;for(let o=0;o<e.length;o++){const t=$t.get(e[o]);void 0!==t&&bi(t,s.id,s.changeToThisWidth)}const t=l.elements;for(let o=0;o<t.length;o++){const e=At.get(t[o]);if(void 0!==e){bi(e.choice,s.id,s.changeToThisWidth)}}continue}}}if(s.setBgmIsOn&&s.bgmId&&(Nt.bgmIsPlaying=!0,Nt.isBgmInit?yo(s,s.bgmId,0):(So(s),Nt.isBgmInit=!0)),s.muteBgm&&Lt){const e=A(Lt);e&&"function"==typeof e.mute&&(app.isMute=!0,e.mute())}if(s.isContentHidden&&void 0!==s.hiddenContentsRow&&void 0!==s.hiddenContentsType)for(let t=0;t<s.hiddenContentsRow.length;t++){const e=$t.get(s.hiddenContentsRow[t]);if(void 0!==e){e.textIsRemoved||(e.textIsRemoved=!0);for(let t=0;t<s.hiddenContentsType.length;t++)switch(s.hiddenContentsType[t]){case"1":e.objectTitleRemoved=!0;break;case"2":e.objectImageRemoved=!0;break;case"3":e.objectTextRemoved=!0;break;case"4":e.objectScoreRemoved=!0;break;case"5":e.objectRequirementRemoved=!0;break;case"6":e.addonTitleRemoved=!0;break;case"7":e.addonImageRemoved=!0;break;case"8":e.addonTextRemoved=!0}}}Fo(s,g)}}function jo(e,t){var o,i,n,l,r,a;const s=e.length>1?e[1].split("/AND#"):"",d=e[0].split("/ON#"),c=At.get(d[0]);if(void 0!==c){const e=c.choice,d=c.row;for(let t=0;t<e.scores.length;t++){const o=e.scores[t],i=Bt.get(o.id);void 0!==i&&o.isRandom&&!o.setValue&&void 0!==o.maxValue&&void 0!==o.minValue&&(o.value=Math.floor(Math.random()*(o.maxValue-o.minValue+1))+o.minValue,o.value=i.allowFloat?o.value:Math.floor(o.value),o.setValue=!0)}const u=new y,g=e.isActive,h=e.multipleUseVariable>=0,m=Math.abs(e.multipleUseVariable);if(e.isActive||(e.isActive=!0,d.currentChoices+=1),e.multipleUseVariable+=1,Ct.set(e.id,{multiple:e.multipleUseVariable}),h&&e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue)if(e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let n=0;n<e.discountRows.length;n++){const l=$t.get(e.discountRows[n]);if(void 0!==l)for(let n=0;n<l.objects.length;n++){const r=l.objects[n];for(let t=0;t<r.scores.length;t++){const n=r.scores[t];n.isNotDiscountable||0!==(null==(o=e.discountPointTypes)?void 0:o.length)&&-1===(null==(i=e.discountPointTypes)?void 0:i.indexOf(n.id))||Ao(e,n)}t.add(r.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++){const i=At.get(e.discountChoices[o]);if(void 0!==i){const o=i.choice;if(!t.has(o.id))for(let t=0;t<o.scores.length;t++){const i=o.scores[t];i.isNotDiscountable||0!==(null==(n=e.discountPointTypes)?void 0:n.length)&&-1===(null==(l=e.discountPointTypes)?void 0:l.indexOf(i.id))||Ao(e,i)}}}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Ot.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=At.get(o.elements[t]);if(void 0!==i)for(let t=0;t<i.choice.scores.length;t++){const o=i.choice.scores[t];o.isNotDiscountable||0!==(null==(r=e.discountPointTypes)?void 0:r.length)&&-1===(null==(a=e.discountPointTypes)?void 0:a.indexOf(o.id))||Ao(e,o)}}}for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(void 0===o.isActiveMul&&(o.isActiveMul=[]),wo(o.requireds)&&!o.isActiveMul[m]){const e=Bt.get(o.id);if(void 0!==e){let t=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value;t=e.allowFloat?t:Math.floor(t),o.multiplyByTimes&&(t*=m+1),e.startingSum-=t,o.isActiveMul[m]=!0;let i=u.get(o.id);void 0!==i?u.set(o.id,t+i):u.set(o.id,t)}}}if(h&&(e.duplicateRow&&void 0!==e.duplicateRowId&&void 0!==e.duplicateRowPlace&&qo(e),e.activateOtherChoice&&void 0!==e.activateThisChoice)){const o=new Set(t.map(e=>e.split("/ON#")[0]));if(e.isActivateRandom&&void 0!==e.numActivateRandom)if(void 0===e.activatedRandomMul&&(e.activatedRandomMul=[]),""===s){if(1===e.multipleUseVariable){let t=e.activateThisChoice.split(",").filter(e=>o.has(e.split("/ON#")[0]));e.numActivateRandom>t.length?t.length:e.numActivateRandom;let i=new Set;for(let e=0;e<t.length;e++){const o=At.get(t[e]);if(void 0!==o){if(!wo(o.choice.requireds)){const o=t[e];t.splice(e,1),t.push(o)}}}for(let e=t.length-1;e>=0;e--)i.add(t[e]);t=[...i].reverse();let n=0,l=[];for(let o=0;o<e.numActivateRandom;o++){l[o]=t.length/(e.numActivateRandom*(o+1))<1?t.length%(e.numActivateRandom*(o+1)):e.numActivateRandom,e.activatedRandomMul.push(t.slice(n,l[o]+n));for(let t=0;t<l[o]-n;t++){const i=e.activatedRandomMul[o][t].split("/ON#"),n=i.length>1?parseInt(i[1]):0,l=At.get(i[0]);if(void 0!==l){const t=l.choice;if(!e.isAllowDeselect){if(t.isSelectableMultiple&&t.isMultipleUseVariable)for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;t.forcedActivated=!0}}}n+=l[o]}}}else{const t=(e.multipleUseVariable-1)*e.numActivateRandom,i=s.splice(t,t+e.numActivateRandom);e.activatedRandomMul.push(i);for(let n=0;n<e.activatedRandomMul[e.multipleUseVariable-1].length;n++){const t=e.activatedRandomMul[e.multipleUseVariable-1][n].split("/RON#"),i=t.length>1?parseInt(t[1]):0,l=At.get(t[0]);if(void 0!==l){const t=l.choice;if(!e.isAllowDeselect&&o.has(t.id)){if(t.isSelectableMultiple&&t.isMultipleUseVariable)for(let e=0;e<Math.abs(i);e++)i>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:i<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;t.forcedActivated=!0}}}}else{const t=e.activateThisChoice.split(",").filter(e=>o.has(e.split("/ON#")[0]));for(let o=0;o<t.length;o++){const i=t[o].split("/ON#"),n=i.length>1?parseInt(i[1]):0,l=At.get(i[0]);if(void 0!==l){const t=l.choice;if(!e.isAllowDeselect){if(t.isSelectableMultiple&&t.isMultipleUseVariable)if(e.isSelectableMultiple&&e.isMultipleUseVariable)for(let o=0;o<Math.abs(e.multipleUseVariable);o++)for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;else for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;t.forcedActivated=!0}}else{const t=Ot.get(i[0]);if(void 0!==t){const o=t.elements;for(let t=0;t<o.length;t++){const i=At.get(o[t]);if(void 0!==i){const t=i.choice;if(!e.isAllowDeselect){if(t.isSelectableMultiple&&t.isMultipleUseVariable)if(e.isSelectableMultiple&&e.isMultipleUseVariable)for(let o=0;o<Math.abs(e.multipleUseVariable);o++)for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;else for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;t.forcedActivated=!0}}}}}}}}if(e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const o=$t.get(e.idOfAllowChoice[t]);void 0!==o&&(o.allowedChoices+=e.numbAddToAllowChoice)}if(!g){if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Ft.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!0:"2"===e.changeType?o.isTrue=!1:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.backpackBtnRequirement&&(app.btnBackpackIsOn+=1),e.showAllAddons&&(app.showAllAddons+=1),e.changeBackground&&(e.changeBgImage?void 0!==e.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage??""),app.bgImageStack.push({id:e.id,data:e.bgImage}),app.styling.backgroundImage=e.bgImage):void 0!==e.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor??""),app.bgColorStack.push({id:e.id,data:e.changedBgColorCode}),app.styling.backgroundColor=e.changedBgColorCode)),e.changePointBar&&(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor??"#FFFFFFFF"),app.barBgColorStack.push({id:e.id,data:e.changedBarBgColor}),app.styling.barBackgroundColor=e.changedBarBgColor),e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor??"#0000008A"),app.barIconColorStack.push({id:e.id,data:e.changedBarIconColor}),app.styling.barIconColor=e.changedBarIconColor),e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor??"#000000"),app.barTextColorStack.push({id:e.id,data:e.changedBarTextColor}),app.styling.barTextColor=e.changedBarTextColor)),e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){const t=n.choice;if(vi(t,e.id,e.changeToThisTemplate),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){vi(t.addons[o],e.id,e.changeToThisTemplate)}continue}const l=$t.get(i);if(void 0!==l){vi(l,e.id,e.changeToThisTemplate);continue}const r=Ot.get(i[0]);if(void 0!==r){const t=r.rowElements;for(let i=0;i<t.length;i++){const o=$t.get(t[i]);void 0!==o&&vi(o,e.id,e.changeToThisTemplate)}const o=r.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){vi(t.choice,e.id,e.changeToThisTemplate)}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){bi(n.choice,e.id,e.changeToThisWidth);continue}const l=$t.get(i);if(void 0!==l){bi(l,e.id,e.changeToThisWidth);continue}const r=Ot.get(i[0]);if(void 0!==r){const t=r.rowElements;for(let i=0;i<t.length;i++){const o=$t.get(t[i]);void 0!==o&&bi(o,e.id,e.changeToThisWidth)}const o=r.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){bi(t.choice,e.id,e.changeToThisWidth)}}continue}}}if(e.setBgmIsOn&&e.bgmId&&(Nt.bgmIsPlaying=!0,Nt.isBgmInit?yo(e,e.bgmId,0):(So(e),Nt.isBgmInit=!0)),e.muteBgm&&Lt){const e=A(Lt);e&&"function"==typeof e.mute&&(app.isMute=!0,e.mute())}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=$t.get(e.hiddenContentsRow[t]);if(void 0!==o){o.textIsRemoved||(o.textIsRemoved=!0);for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":o.objectTitleRemoved=!0;break;case"2":o.objectImageRemoved=!0;break;case"3":o.objectTextRemoved=!0;break;case"4":o.objectScoreRemoved=!0;break;case"5":o.objectRequirementRemoved=!0;break;case"6":o.addonTitleRemoved=!0;break;case"7":o.addonImageRemoved=!0;break;case"8":o.addonTextRemoved=!0}}}}Fo(e,u)}}function Do(e,t){const o=new y,i=Math.abs(e.multipleUseVariable-1);for(let n=0;n<e.scores.length;n++){const t=e.scores[n];if(void 0===t.isActiveMulMinus&&(t.isActiveMulMinus=[]),wo(t.requireds)&&!t.isActiveMulMinus[i]){const e=Bt.get(t.id);if(void 0!==e){let n=t.discountIsOn&&void 0!==t.discountScore?t.discountScore:t.value;n=e.allowFloat?n:Math.floor(n),t.multiplyByTimes&&(n*=Math.abs(i)),e.startingSum+=n;let l=o.get(t.id);void 0!==l?o.set(t.id,-n+l):o.set(t.id,-n),t.isActiveMulMinus[i]=!0}}}if(e.multipleUseVariable-=1,0===e.multipleUseVariable?(e.isActive=!1,t.currentChoices-=1,Ct.delete(e.id)):(-1===e.multipleUseVariable&&(e.isActive=!0,t.currentChoices+=1),Ct.set(e.id,{multiple:e.multipleUseVariable})),e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let n=0;n<e.idOfAllowChoice.length;n++){const t=$t.get(e.idOfAllowChoice[n]);void 0!==t&&(t.allowedChoices-=e.numbAddToAllowChoice)}Fo(e,o)}function Po(e){Mo();const t=e.split(",");for(let o=0;o<t.length;o++){const e=t[o].split(/\/(IMG|WORD|RND)#/)[0].split("/ON#"),i=e.length>1?parseInt(e[1]):0,n=At.get(e[0]);if(void 0!==n){const e=n.choice;if(e.isSelectableMultiple&&e.isMultipleUseVariable)for(let l=0;l<Math.abs(i);l++){const l=t[o].split("/RND#");i>0?jo(l,t):Do(e,n.row)}else Ro(t[o],t)}}}function qo(e,t){if(void 0!==e.duplicateRowId&&void 0!==e.duplicateRowPlace){const t=e.duplicateRowId;let o=0;Array.from($t.entries()).forEach(([e])=>{e.split("/D#")[0]===t.split("/D#")[0]&&o++});const i=$t.get(e.duplicateRowId),n=$t.get(e.duplicateRowPlace),l=`/D#${o}`;if(void 0!==i&&void 0!==n){const t=JSON.parse(JSON.stringify(i));if(t.id=`${t.id.split("/D#")[0]}${l}`,n.isBackpack){app.backpack.splice(n.index+1,0,t);for(let e=n.index+1;e<app.backpack.length;e++)app.backpack[e].index=e}else{app.rows.splice(n.index+1,0,t);for(let e=n.index+1;e<app.rows.length;e++)app.rows[e].index=e}$t.set(t.id,t);for(let o=0;o<t.objects.length;o++){const i=t.objects[o];i.id=`${i.id.split("/D#")[0]}${l}`,i.isActive=!1,delete i.forcedActivated;for(let e=0;e<i.scores.length;e++){const t=i.scores[e];t.idx=ho(0,5),Dt.add(t.idx),delete t.isActive,delete t.setValue,delete t.discountIsOn,delete t.discountShow,delete t.discountBeforeText,delete t.discountAfterText,delete t.discountScore,delete t.discountScoreCal,delete t.isChangeDiscount,delete t.tmpDisScore,delete t.tmpDiscount,delete t.discountedFrom,delete t.dupTextA,delete t.dupTextB,delete t.discountTextA,delete t.discountTextB,delete t.notStackableDiscount}for(let e=0;e<i.addons.length;e++){i.addons[e].parentId=i.id}if(!e.dRowAddSufReq){for(let e=0;e<i.requireds.length;e++){const t=i.requireds[e];if("id"===t.type){const e=t.reqId.split("/ON#"),o=`${e[0].split("/D#")[0]}${l}`;e.length>1?t.reqId=`${o}/ON#${e[1]}`:t.reqId=o}else if("or"===t.type)for(let e=0;e<t.orRequired.length;e++){const o=t.orRequired[e];if(void 0!==o.req){const e=o.req.split("/ON#"),t=`${e[0].split("/D#")[0]}${l}`;e.length>1?o.req=`${t}/ON#${e[1]}`:o.req=t}}if(void 0!==t.requireds)for(let o=0;o<t.requireds.length;o++){const t=i.requireds[e];if("id"===t.type){const e=t.reqId.split("/ON#"),o=`${e[0].split("/D#")[0]}${l}`;e.length>1?t.reqId=`${o}/ON#${e[1]}`:t.reqId=o}else if("or"===t.type)for(let e=0;e<t.orRequired.length;e++){const o=t.orRequired[e];if(void 0!==o.req){const e=o.req.split("/ON#"),t=`${e[0].split("/D#")[0]}${l}`;e.length>1?o.req=`${t}/ON#${e[1]}`:o.req=t}}}}for(let e=0;e<i.scores.length;e++){const t=i.scores[e];if(void 0!==t.requireds)for(let e=0;e<t.requireds.length;e++){const o=t.requireds[e];if("id"===o.type){const e=o.reqId.split("/ON#"),t=`${e[0].split("/D#")[0]}${l}`;e.length>1?o.reqId=`${t}/ON#${e[1]}`:o.reqId=t}else if("or"===o.type)for(let e=0;e<o.orRequired.length;e++){const t=o.orRequired[e];if(void 0!==t.req){const e=t.req.split("/ON#"),o=`${e[0].split("/D#")[0]}${l}`;e.length>1?t.req=`${o}/ON#${e[1]}`:t.req=o}}}}for(let e=0;e<i.addons.length;e++){const t=i.addons[e];if(void 0!==t.requireds)for(let e=0;e<t.requireds.length;e++){const o=t.requireds[e];if("id"===o.type){const e=o.reqId.split("/ON#"),t=`${e[0].split("/D#")[0]}${l}`;e.length>1?o.reqId=`${t}/ON#${e[1]}`:o.reqId=t}else if("or"===o.type)for(let e=0;e<o.orRequired.length;e++){const t=o.orRequired[e];if(void 0!==t.req){const e=t.req.split("/ON#"),o=`${e[0].split("/D#")[0]}${l}`;e.length>1?t.req=`${o}/ON#${e[1]}`:t.req=o}}}}}if(!e.dRowAddSufFunc){if(i.activateOtherChoice&&void 0!==i.activateThisChoice){const e=i.activateThisChoice.split(",");let t="";for(let o=0;o<e.length;o++){const i=e[o].split("/ON#"),n=`${i[0].split("/D#")[0]}${l}`;i.length>1?t+=`${n}/ON#${i[1]},`:t+=`${n},`}i.activateThisChoice=t}if(i.deactivateOtherChoice&&void 0!==i.deactivateThisChoice){const e=i.deactivateThisChoice.split(",");let t="";for(let o=0;o<e.length;o++){const i=e[o].split("/ON#"),n=`${i[0].split("/D#")[0]}${l}`;i.length>1?t+=`${n}/ON#${i[1]},`:t+=`${n},`}i.deactivateThisChoice=t}if(i.duplicateRow&&void 0!==i.duplicateRowId&&void 0!==i.duplicateRowPlace){const e=i.duplicateRowId,t=i.duplicateRowPlace;i.duplicateRowId=`${e.split("/D")[0]}${l}`,i.duplicateRowPlace=`${t.split("/D")[0]}${l}`}}if(i.backpackBtnRequirement&&(void 0!==app.hideBackpackBtn?app.hideBackpackBtn+=1:delete i.backpackBtnRequirement),At.set(i.id,{choice:i,row:t}),i.groups)for(let e=0;e<i.groups.length;e++){let t=Ot.get(i.groups[e]);if(void 0!==t){-1===t.elements.indexOf(i.id)&&t.elements.push(i.id)}}if(i.objectDesignGroups)for(let e=0;e<i.objectDesignGroups.length;e++){let t=jt.get(i.objectDesignGroups[e]);if(void 0!==t){-1===t.elements.indexOf(i.id)&&t.elements.push(i.id)}}}}}}function Vo(e){return/^data:[a-zA-Z]+\/[a-zA-Z]+;base64,/.test(e)}function Lo(e){const t=e.match(/^data:(image\/[a-zA-Z0-9.+-]+);base64,/);if(!t)return!1;return"image/avif"===t[1].toLowerCase()}const No=C({selFilterBlur:x.number().optional(),selFilterBright:x.number().optional(),selFilterCont:x.number().optional(),selFilterGray:x.number().optional(),selFilterHue:x.number().optional(),selFilterInvert:x.number().optional(),selFilterOpac:x.number().optional(),selFilterSatur:x.number().optional(),selFilterSepia:x.number().optional(),reqFilterBlur:x.number().optional(),reqFilterBright:x.number().optional(),reqFilterCont:x.number().optional(),reqFilterGray:x.number().optional(),reqFilterHue:x.number().optional(),reqFilterInvert:x.number().optional(),reqFilterOpac:x.number().optional(),reqFilterSatur:x.number().optional(),reqFilterSepia:x.number().optional(),unselFilterBlur:x.number().optional(),unselFilterBright:x.number().optional(),unselFilterCont:x.number().optional(),unselFilterGray:x.number().optional(),unselFilterHue:x.number().optional(),unselFilterInvert:x.number().optional(),unselFilterOpac:x.number().optional(),unselFilterSatur:x.number().optional(),unselFilterSepia:x.number().optional()}).passthrough(),Wo=C({rowTitleTextSize:x.number().optional(),rowTextTextSize:x.number().optional(),objectTitleTextSize:x.number().optional(),objectTextTextSize:x.number().optional(),addonTitleTextSize:x.number().optional(),addonTextTextSize:x.number().optional(),scoreTextSize:x.number().optional()}).passthrough(),Eo=C({objectImgBorderWidth:x.number().optional(),objectImageWidth:x.number().optional(),objectImageMarginTop:x.number().optional(),objectImageMarginBottom:x.number().optional(),objectImgBorderRadiusTopLeft:x.number().optional(),objectImgBorderRadiusTopRight:x.number().optional(),objectImgBorderRadiusBottomRight:x.number().optional(),objectImgBorderRadiusBottomLeft:x.number().optional(),objectImageBoxWidth:x.number().optional()}).passthrough(),Uo=C({rowImgBorderWidth:x.number().optional(),rowImageWidth:x.number().optional(),rowImageMarginTop:x.number().optional(),rowImageMarginBottom:x.number().optional(),rowImgBorderRadiusTopLeft:x.number().optional(),rowImgBorderRadiusTopRight:x.number().optional(),rowImgBorderRadiusBottomRight:x.number().optional(),rowImgBorderRadiusBottomLeft:x.number().optional(),rowImageBoxWidth:x.number().optional()}).passthrough(),zo=C({addonImgBorderWidth:x.number().optional(),addonImageWidth:x.number().optional(),addonImageMarginTop:x.number().optional(),addonImageMarginBottom:x.number().optional(),addonImgBorderRadiusTopLeft:x.number().optional(),addonImgBorderRadiusTopRight:x.number().optional(),addonImgBorderRadiusBottomRight:x.number().optional(),addonImgBorderRadiusBottomLeft:x.number().optional(),addonImageBoxWidth:x.number().optional()}).passthrough(),Go=C({objectMargin:x.number().optional(),objectTextPadding:x.number().optional(),objectBorderWidth:x.number().optional(),objectDropShadowH:x.number().optional(),objectDropShadowV:x.number().optional(),objectDropShadowBlur:x.number().optional(),objectDropShadowSpread:x.number().optional(),objectBorderRadiusTopLeft:x.number().optional(),objectBorderRadiusTopRight:x.number().optional(),objectBorderRadiusBottomRight:x.number().optional(),objectBorderRadiusBottomLeft:x.number().optional(),objectBorderImageWidth:x.number().optional(),objectBorderImageSliceTop:x.number().optional(),objectBorderImageSliceBottom:x.number().optional(),objectBorderImageSliceLeft:x.number().optional(),objectBorderImageSliceRight:x.number().optional()}).passthrough(),Ho=C({rowMargin:x.number().optional(),rowBodyMarginSides:x.number().optional(),rowBodyMarginTop:x.number().optional(),rowBodyMarginBottom:x.number().optional(),rowTextPaddingY:x.number().optional(),rowTextPaddingX:x.number().optional(),rowDropShadowH:x.number().optional(),rowDropShadowV:x.number().optional(),rowDropShadowBlur:x.number().optional(),rowDropShadowSpread:x.number().optional(),rowButtonXPadding:x.number().optional(),rowButtonYPadding:x.number().optional(),rowBorderRadiusTopLeft:x.number().optional(),rowBorderRadiusTopRight:x.number().optional(),rowBorderRadiusBottomRight:x.number().optional(),rowBorderRadiusBottomLeft:x.number().optional(),rowBorderWidth:x.number().optional(),rowBorderImageWidth:x.number().optional(),rowBorderImageSliceTop:x.number().optional(),rowBorderImageSliceBottom:x.number().optional(),rowBorderImageSliceLeft:x.number().optional(),rowBorderImageSliceRight:x.number().optional()}).passthrough(),_o=C({addonMargin:x.number().optional(),addonTextPadding:x.number().optional(),addonBorderWidth:x.number().optional(),addonDropShadowH:x.number().optional(),addonDropShadowV:x.number().optional(),addonDropShadowBlur:x.number().optional(),addonDropShadowSpread:x.number().optional(),addonBorderRadiusTopLeft:x.number().optional(),addonBorderRadiusTopRight:x.number().optional(),addonBorderRadiusBottomRight:x.number().optional(),addonBorderRadiusBottomLeft:x.number().optional(),addonBorderImageWidth:x.number().optional(),addonBorderImageSliceTop:x.number().optional(),addonBorderImageSliceBottom:x.number().optional(),addonBorderImageSliceLeft:x.number().optional(),addonBorderImageSliceRight:x.number().optional()}).passthrough(),Yo=C({multiChoiceCounterPosition:x.number().optional(),multiChoiceCounterSize:x.number().optional(),multiChoiceTextSize:x.number().optional()}).passthrough(),Jo=C({barTextPadding:x.number().optional(),barTextMargin:x.number().optional(),barPadding:x.number().optional(),barMargin:x.number().optional(),barTextSize:x.number().optional()}).passthrough(),Xo=C({backPackWidth:x.number().optional()}).passthrough(),Zo=No.merge(Wo).merge(Eo).merge(Uo).merge(zo).merge(Go).merge(Ho).merge(_o).merge(Yo).merge(Jo).merge(Xo).passthrough(),Ko=C({template:x.number().optional()}).passthrough(),Qo=C({value:x.number().optional(),minValue:x.number().optional(),maxValue:x.number().optional(),discountScore:x.number().optional(),discountScoreCal:x.number().optional(),tmpDisScore:x.number().optional()}).passthrough(),ei=C({index:x.number().optional(),template:x.number().optional(),multipleUseVariable:x.number().optional(),initMultipleTimesMinus:x.number().optional(),selectedThisManyTimesProp:x.number().optional(),defaultAspectWidth:x.number().optional(),defaultAspectHeight:x.number().optional(),addons:B(Ko).optional(),scores:B(Qo).optional(),styling:Zo.optional().optional(),numMultipleTimesMinus:x.number().optional(),numMultipleTimesPluss:x.number().optional(),numActivateRandom:x.number().optional(),discountLowLimit:x.number().optional(),discountValue:x.number().optional(),numbAddToAllowChoice:x.number().optional(),bgmFadeInSec:x.number().optional(),bgmFadeOutSec:x.number().optional(),fadeTransitionTime:x.number().optional(),divideWithThis:x.number().optional(),activatedFrom:x.number().optional()}).passthrough(),ti=C({index:x.number().optional(),template:x.number().optional(),buttonRandomNumber:x.number().optional(),defaultAspectWidth:x.number().optional(),defaultAspectHeight:x.number().optional(),allowedChoices:x.number().optional(),currentChoices:x.number().optional(),objects:B(ei).optional(),styling:Zo.optional(),objectImgObjectFillHeight:x.number().optional(),randomMin:x.number().optional(),randomMax:x.number().optional()}).passthrough(),oi=C({startingSum:x.number().optional(),initValue:x.number().optional(),iconWidth:x.number().optional(),iconHeight:x.number().optional(),negativeIconWidth:x.number().optional(),negativeIconHeight:x.number().optional()}).passthrough(),ii=C({styling:Zo.optional()}).passthrough(),ni=C({styling:Zo.optional()}).passthrough(),li=C({curVolume:x.number().optional(),fadeTransitionTime:x.number().optional(),hideBackpackBtn:x.number().optional(),btnBackpackIsOn:x.number().optional(),rowIdLength:x.number().optional(),objectIdLength:x.number().optional(),rowDesignGroups:B(ii).optional(),objectDesignGroups:B(ni).optional(),rows:B(ti).optional(),pointTypes:B(oi).optional(),backpack:B(ti).optional(),styling:Zo.optional()}).passthrough(),ri=["autoSaveInterval","bgmFadeInterval","bgmFadeTimer","bgmIsPlaying","bgmObjectId","bgmPlayInterval","bgmTitle","bgmTitleInterval","cancelForcedActivated","comp","compG","compODG","compR","compRDG","curBgmTime","curBgmLength","isSeeking","isFadingOut","lastFadeTime","objectMap","pointTypeMap","wordMap"];function ai(e){if(Array.isArray(e))return e.map(ai).filter(e=>null!==e&&!("object"==typeof e&&0===Object.keys(e).length));if(e&&"object"==typeof e){const t={},o=Object.keys(e);for(let i=0;i<o.length;i++){const n=o[i],l=ai(e[n]);null!==l&&(t[n]=l)}return Object.keys(t).length>0?t:null}return e}function si(e){e.isPrivateStyling&&e.privateFilterIsOn&&void 0!==e.styling&&(void 0===e.styling.unselFilterBlurIsOn&&(e.styling.unselFilterBlurIsOn=!1),void 0===e.styling.unselFilterBlur&&(e.styling.unselFilterBlur=0),void 0===e.styling.unselFilterBrightIsOn&&(e.styling.unselFilterBrightIsOn=!1),void 0===e.styling.unselFilterBright&&(e.styling.unselFilterBright=100),void 0===e.styling.unselFilterCont&&(e.styling.unselFilterCont=100),void 0===e.styling.unselFilterGrayIsOn&&(e.styling.unselFilterGrayIsOn=!1),void 0===e.styling.unselFilterGray&&(e.styling.unselFilterGray=0),void 0===e.styling.unselFilterHueIsOn&&(e.styling.unselFilterHueIsOn=!1),void 0===e.styling.unselFilterHue&&(e.styling.unselFilterHue=0),void 0===e.styling.unselFilterInvertIsOn&&(e.styling.unselFilterInvertIsOn=!1),void 0===e.styling.unselFilterInvert&&(e.styling.unselFilterInvert=0),void 0===e.styling.unselFilterOpacIsOn&&(e.styling.unselFilterOpacIsOn=!1),void 0===e.styling.unselFilterOpac&&(e.styling.unselFilterOpac=100),void 0===e.styling.unselFilterSaturIsOn&&(e.styling.unselFilterSaturIsOn=!1),void 0===e.styling.unselFilterSatur&&(e.styling.unselFilterSatur=0),void 0===e.styling.unselFilterSepiaIsOn&&(e.styling.unselFilterSepiaIsOn=!1),void 0===e.styling.unselFilterSepia&&(e.styling.unselFilterSepia=0))}function di(e,t){e.isPrivateStyling&&void 0===e.privateFilterIsOn&&void 0!==e.styling&&Object.keys(ut).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateFilterIsOn=!0:e.privateFilterIsOn=!1}),e.isPrivateStyling&&void 0===e.privateTextIsOn&&void 0!==e.styling&&Object.keys(gt).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateTextIsOn=!0:e.privateTextIsOn=!1}),e.isPrivateStyling&&void 0===e.privateObjectImageIsOn&&void 0!==e.styling&&Object.keys(ht).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateObjectImageIsOn=!0:e.privateObjectImageIsOn=!1}),e.isPrivateStyling&&void 0===e.privateObjectIsOn&&void 0!==e.styling&&Object.keys(ft).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateObjectIsOn=!0:e.privateObjectIsOn=!1}),e.isPrivateStyling&&void 0===e.privateAddonImageIsOn&&void 0!==e.styling&&Object.keys(pt).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateAddonImageIsOn=!0:e.privateAddonImageIsOn=!1}),e.isPrivateStyling&&void 0===e.privateAddonIsOn&&void 0!==e.styling&&Object.keys(wt).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateAddonIsOn=!0:e.privateAddonIsOn=!1}),e.isPrivateStyling&&void 0===e.privateBackgroundIsOn&&void 0!==e.styling&&Object.keys(vt).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateBackgroundIsOn=!0:e.privateBackgroundIsOn=!1}),t&&(e.isPrivateStyling&&void 0===e.privateRowImageIsOn&&void 0!==e.styling&&Object.keys(mt).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateRowImageIsOn=!0:e.privateRowImageIsOn=!1}),e.isPrivateStyling&&void 0===e.privateRowIsOn&&void 0!==e.styling&&Object.keys(bt).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateRowIsOn=!0:e.privateRowIsOn=!1})),si(e),e.isPrivateStyling||void 0===e.styling||(void 0!==e.styling.objectImgObjectFillHeight&&(e.objectImgObjectFillHeight=e.styling.objectImgObjectFillHeight),delete e.styling)}function ci(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const o=t[n];if(-1!==ri.indexOf(o))delete e[o];else if(Array.isArray(e[o])){if("rows"===o||"backpack"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];if(i.index=t,"backpack"===o&&(i.isBackpack=!0),di(i,!0),void 0!==i.styling&&Co(i.styling,void 0===e.version||"2.0.0-beta"===e.version),void 0!==i.rowDesignGroups)for(let e=0;e<i.rowDesignGroups.length;e++)"object"==typeof i.rowDesignGroups[e]&&(i.rowDesignGroups[e]=i.rowDesignGroups[e].id);if(i.image,Vo(i.image)?Yt.value||(Yt.value=Lo(i.image)):_t.add(i.image),void 0!==i.objects)for(let t=0;t<i.objects.length;t++){const o=i.objects[t];if(o.index=t,di(o,!1),void 0!==o.styling&&Co(o.styling,void 0===e.version||"2.0.0-beta"===e.version),o.multiplyPointtypeIsOn&&("string"==typeof o.pointTypeToMultiply&&(o.pointTypeToMultiply=[o.pointTypeToMultiply]),"number"==typeof o.startingSumAtMultiply&&(o.startingSumAtMultiply=[o.startingSumAtMultiply])),o.dividePointtypeIsOn&&("string"==typeof o.pointTypeToDivide&&(o.pointTypeToDivide=[o.pointTypeToDivide]),"number"==typeof o.startingSumAtDivide&&(o.startingSumAtDivide=[o.startingSumAtDivide])),o.fadeTransitionIsOn&&void 0!==o.fadeTransitionTime&&(o.fadeInTransitionTime=o.fadeTransitionTime,o.fadeOutTransitionTime=o.fadeTransitionTime,delete o.fadeTransitionTime),void 0!==o.groups)for(let e=0;e<o.groups.length;e++)"object"==typeof o.groups[e]&&(o.groups[e]=o.groups[e].id);if(void 0!==o.objectDesignGroups)for(let e=0;e<o.objectDesignGroups.length;e++)"object"==typeof o.objectDesignGroups[e]&&(o.objectDesignGroups[e]=o.objectDesignGroups[e].id);o.image,Vo(o.image)?Yt.value||(Yt.value=Lo(o.image)):_t.add(o.image);for(let e=0;e<o.addons.length;e++){const t=o.addons[e];void 0!==t.template&&0!==t.template||(t.template=1),t.parentId=o.id,t.image,Vo(t.image)?Yt.value||(Yt.value=Lo(t.image)):_t.add(t.image)}}}else if("objectDesignGroups"===o||"rowDesignGroups"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];void 0===i.activatedId&&(i.activatedId=""),void 0===i.elements&&(i.elements=[]),void 0===i.backpackElements&&(i.backpackElements=[]);for(let e=0;e<i.elements.length;e++)"object"==typeof i.elements[e]&&(i.elements[e]=i.elements[e].id);for(let e=0;e<i.backpackElements.length;e++)"object"==typeof i.backpackElements[e]&&(i.backpackElements[e]=i.backpackElements[e].id);si(i),Co(i.styling,void 0===e.version||"2.0.0-beta"===e.version)}else if("pointTypes"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];void 0===i.initValue&&(i.initValue=i.startingSum),"object"==typeof i.positiveColor&&i.positiveColor.hexa&&(i.positiveColor=i.positiveColor.hexa),"object"==typeof i.negativeColor&&i.negativeColor.hexa&&(i.negativeColor=i.negativeColor.hexa),"object"==typeof i.privateColor&&i.privateColor.hexa&&(i.privateColor=i.privateColor.hexa),"object"==typeof i.privateNegativeColor&&i.privateNegativeColor.hexa&&(i.privateNegativeColor=i.privateNegativeColor.hexa)}else if("groups"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];void 0===i.elements&&(i.elements=[]),void 0===i.rowElements&&(i.rowElements=[]);for(let e=0;e<i.elements.length;e++)"object"==typeof i.elements[e]&&(i.elements[e]=i.elements[e].id);for(let e=0;e<i.rowElements.length;e++)"object"==typeof i.rowElements[e]&&(i.rowElements[e]=i.rowElements[e].id)}}else"object"==typeof e[o]&&"styling"===o&&Co(e[o],void 0===e.version||"2.0.0-beta"===e.version)}Ct.clear(),Bt.clear(),$t.clear(),At.clear(),Ot.clear(),kt.clear(),Mt.clear(),Ft.clear(),Rt.clear(),jt.clear(),Pt.splice(0);const o=Object.keys(St);for(let n=0;n<o.length;n++){const e=o[n];St.hasOwnProperty(e)?app[e]=St[e]:delete app[e]}const i=Object.keys(e);for(let n=0;n<i.length;n++){const t=i[n];app[t]=e[t]}for(let n=0;n<app.googleFonts.length;n++){const e=app.googleFonts[n].replaceAll(" ","+"),t=`https://fonts.googleapis.com/css2?family=${e}&display=swap`,o=document.createElement("link");o.id=e,o.rel="stylesheet",o.href=t,o.crossOrigin="anonymous",document.head.appendChild(o)}for(let n=0;n<app.customFonts.length;n++){const e=app.customFonts[n],t=document.createElement("link");t.id=e,t.rel="stylesheet",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}for(let n=0;n<app.pointTypes.length;n++){const e=app.pointTypes[n];void 0!==e.id&&""!==e.id||(e.id=uo(0,4)),e.id=vo(e.id,Bt),void 0===e.initValue&&(e.initValue=e.startingSum),void 0===e.isNotShownObjects&&""!==e.activatedId&&(e.isNotShownObjects=!0),void 0===e.isNotShownPointBar&&""!==e.activatedId&&(e.isNotShownPointBar=!0),Bt.set(e.id,e)}for(let n=0;n<app.rows.length;n++){const e=app.rows[n];void 0!==e.id&&""!==e.id||(e.id=lo(0,4)),e.id=vo(e.id,$t),$t.set(e.id,e);for(let t=0;t<e.objects.length;t++){const o=e.objects[t];void 0!==o.id&&""!==o.id||(o.id=ao(0,4)),o.id=vo(o.id,At),At.set(o.id,{choice:o,row:e});for(let e=0;e<o.scores.length;e++){const t=o.scores[e];void 0!==t.idx&&""!==t.idx||(t.idx=ho(0,5)),t.idx=vo(t.idx,Dt),Dt.add(t.idx)}}}for(let n=0;n<app.backpack.length;n++){const e=app.backpack[n];void 0!==e.id&&""!==e.id||(e.id=lo(0,4)),e.id=vo(e.id,$t),$t.set(e.id,e);for(let t=0;t<e.objects.length;t++){const o=e.objects[t];void 0!==o.id&&""!==o.id||(o.id=ao(0,4)),o.id=vo(o.id,At),At.set(o.id,{choice:o,row:e});for(let e=0;e<o.scores.length;e++){const t=o.scores[e];void 0!==t.idx&&""!==t.idx||(t.idx=ho(0,5)),t.idx=vo(t.idx,Dt),Dt.add(t.idx)}}}for(let n=0;n<app.groups.length;n++){const e=app.groups[n];void 0!==e.id&&""!==e.id||(e.id=co(0,4)),e.id=vo(e.id,Ot),Ot.set(e.id,app.groups[n])}for(let n=0;n<app.words.length;n++){const e=app.words[n];void 0!==e.id&&""!==e.id||(e.id=ro(0,4)),e.id=vo(e.id,Mt),Mt.set(e.id,app.words[n])}for(let n=0;n<app.variables.length;n++){const e=app.variables[n];void 0!==e.id&&""!==e.id||(e.id=go(0,4)),e.id=vo(e.id,Ft),Ft.set(e.id,app.variables[n])}if(void 0!==app.rowDesignGroups)for(let n=0;n<app.rowDesignGroups.length;n++){const e=app.rowDesignGroups[n];void 0!==e.id&&""!==e.id||(e.id=so(0,4,!0)),e.id=vo(e.id,Rt),Rt.set(e.id,e)}if(void 0!==app.objectDesignGroups)for(let n=0;n<app.objectDesignGroups.length;n++){const e=app.objectDesignGroups[n];void 0!==e.id&&""!==e.id||(e.id=so(0,4,!1)),e.id=vo(e.id,jt),jt.set(app.objectDesignGroups[n].id,app.objectDesignGroups[n])}if(void 0!==app.globalRequirements)for(let n=0;n<app.globalRequirements.length;n++){const e=app.globalRequirements[n];kt.set(e.id,e)}app.activated.length>0&&Po(app.activated.join(",")),void 0!==app.customCSS&&function(e){let t=document.getElementById("customCSS");t?""===e?(t.remove(),delete app.customCSS):(t.textContent=e,app.customCSS=e):(t=document.createElement("style"),t.id="customCSS",t.textContent=e,app.customCSS=e,document.head.appendChild(t))}(app.customCSS),app.buildAutoSaveIsOn&&(Qt&&Qt.abort(),to()),"boolean"!=typeof app.isMute&&(app.curVolume=100,app.isMute=!1)}async function ui(e){const t=e.querySelectorAll("img"),o=Array.from(t).map(e=>e.complete?Promise.resolve():new Promise(t=>{e.onload=t,e.onerror=t}));return Promise.all(o).then(()=>{})}function gi(e){e.querySelectorAll("img").forEach(e=>{"lazy"===e.loading&&(e.loading="eager")})}function hi(e,t){!function(e,t){const o=window.getComputedStyle(e);for(const n of o)try{t.style.setProperty(n,o.getPropertyValue(n),o.getPropertyPriority(n))}catch(i){console.error(i)}}(e,t);const o=e.children,i=t.children;for(let n=0;n<o.length;n++)hi(o[n],i[n])}async function mi(e){const t=e.querySelectorAll("*"),o=[];t.forEach(e=>{const t=getComputedStyle(e).borderImageSource.match(/url\(["']?(.*?)["']?\)/);t&&t[1]&&o.push(t[1])});const i=o.map(e=>new Promise(t=>{const o=new Image;o.src=e,o.onload=t,o.onerror=t}));await Promise.all(i)}function pi(e=2){return new Promise(t=>{let o=0;requestAnimationFrame(function i(){if(++o>=e)return t();requestAnimationFrame(i)})})}function vi(e,t,o){void 0===e.templateStack&&(e.templateStack=[],e.defaultTemplate=e.template??1),e.templateStack.push({id:t,data:o}),e.template=o}function fi(e,t){if(void 0!==e.templateStack){const o=e.templateStack.findIndex(e=>e.id===t);-1!==o&&e.templateStack.splice(o,1);const i=e.templateStack.length;i>0?e.template=e.templateStack[i-1].data:(e.template=e.defaultTemplate??1,delete e.templateStack)}}function bi(e,t,o){void 0===e.widthStack&&(e.widthStack=[],e.defaultWidth=e.width??"col-md-3"),e.widthStack.push({id:t,data:o}),e.width=o}function wi(e,t){if(void 0!==e.widthStack){const o=e.widthStack.findIndex(e=>e.id===t);-1!==o&&e.widthStack.splice(o,1);const i=e.widthStack.length;i>0?e.width=e.widthStack[i-1].data:(e.width=e.defaultWidth??"col-md-3",delete e.widthStack)}}var Ti=r("<input/>");function Ii(e,t){i(t,!0);let l,r=v(t,"use",19,()=>[]),a=v(t,"class",3,""),u=v(t,"type",3,"text"),g=v(t,"placeholder",3," "),h=v(t,"value",15),m=v(t,"files",15,null),p=v(t,"dirty",15,!1),b=v(t,"invalid",15,!1),w=v(t,"updateInvalid",3,!0),T=v(t,"initialInvalid",3,!1),I=v(t,"emptyValueNull",19,()=>null===h()),y=v(t,"emptyValueUndefined",19,()=>void 0===h()),S=D(t,["$$slots","$$events","$$legacy","use","class","type","placeholder","value","files","dirty","invalid","updateInvalid","initialInvalid","emptyValueNull","emptyValueUndefined"]),C=o({}),x=o({});function B(e){return""===e?Number.NaN:+e}function $(e){if("file"!==u())if(""===e.currentTarget.value&&I())h(null);else if(""===e.currentTarget.value&&y())h(void 0);else switch(u()){case"number":h(B(e.currentTarget.value)),""!==e.currentTarget.value&&"0"!==e.currentTarget.value||("-"===e.data?(h("-0"),e.target.value="-0"):"deleteContentBackward"===e.inputType||"insertFromPaste"!==e.inputType||isNaN(parseInt(e.data))?(h("0"),e.target.value="0"):(h(parseInt(e.data)),e.target.value=parseInt(e.data)));break;case"range":h(B(e.currentTarget.value));break;default:h(e.currentTarget.value)}else m(e.currentTarget.files)}function A(){return l}n(()=>{"file"===u()?delete x.value:x.value=null==h()?"":h()}),f(()=>{w()&&T()&&b(A().matches(":invalid"))});var O=Ti(),k=e=>{var o;"file"!==u()&&$(e),null==(o=t.oninput)||o.call(t,e)},M=e=>{var o;!function(e){"file"!==u()&&"range"!==u()||$(e),p(!0),w()&&b(A().matches(":invalid"))}(e),null==(o=t.onchange)||o.call(t,e)};return P(O,e=>({class:e,type:u(),placeholder:g(),...x,...C,...S,oninput:k,onchange:M}),[()=>q({[a()]:!0,"mdc-text-field__input":!0})]),s(O,e=>l=e,()=>l),V(O,(e,t)=>{var o;return null==(o=L)?void 0:o(e,t)},r),d(e,O),c({getAttr:function(e){return e in C?C[e]??null:A().getAttribute(e)},addAttr:function(e,t){C[e]!==t&&(C[e]=t)},removeAttr:function(e){e in C&&null==C[e]||(C[e]=void 0)},focus:function(){A().focus()},blur:function(){A().blur()},getElement:A})}var yi=r("<textarea></textarea>");function Si(e,t){i(t,!0);let n,l=v(t,"use",19,()=>[]),r=v(t,"class",3,""),a=v(t,"style",3,""),u=v(t,"value",15,""),g=v(t,"dirty",15,!1),h=v(t,"invalid",15,!1),m=v(t,"updateInvalid",3,!0),p=v(t,"initialInvalid",3,!1),b=v(t,"resizable",3,!0),w=D(t,["$$slots","$$events","$$legacy","use","class","style","value","dirty","invalid","updateInvalid","initialInvalid","resizable"]),T=o({});function I(){return n}f(()=>{m()&&p()&&h(I().matches(":invalid"))});var y=yi(),S=e=>{var o;g(!0),m()&&h(I().matches(":invalid")),null==(o=t.onchange)||o.call(t,e)};return P(y,e=>({class:e,style:`${b()?"":"resize: none; "}${a()}`,...T,...w,onchange:S}),[()=>q({[r()]:!0,"mdc-text-field__input":!0})]),s(y,e=>n=e,()=>n),V(y,(e,t)=>{var o;return null==(o=L)?void 0:o(e,t)},l),N(()=>W(y,u)),d(e,y),c({getAttr:function(e){return e in T?T[e]??null:I().getAttribute(e)},addAttr:function(e,t){T[e]!==t&&(T[e]=t)},removeAttr:function(e){e in T&&null==T[e]||(T[e]=void 0)},focus:function(){I().focus()},blur:function(){I().blur()},getElement:I})}var Ci=r('<span class="mdc-text-field__ripple"></span>'),xi=r("<!> <!>",1),Bi=r("<span><!> <!></span>"),$i=r("<!> <!> <!>",1),Ai=r("<label><!> <!> <!> <!> <!> <!> <!></label>"),Oi=r("<div><!> <!> <!> <!> <!></div>"),ki=r("<!> <!>",1);function Mi(e,t){i(t,!0);const{applyPassive:r}=H;let a=()=>{};function h(e){return e===a}let y=v(t,"use",19,()=>[]),S=v(t,"class",3,""),C=v(t,"style",3,""),x=v(t,"ripple",3,!0),B=v(t,"disabled",3,!1),$=v(t,"required",3,!1),A=v(t,"textarea",3,!1),O=v(t,"variant",19,()=>A()?"outlined":"standard"),k=v(t,"noLabel",3,!1),N=v(t,"type",3,"text"),W=v(t,"value",15),se=v(t,"files",15,a),de=v(t,"invalid",15,a),ce=v(t,"updateInvalid",19,()=>h(de())),ue=v(t,"initialInvalid",3,!1),ge=v(t,"dirty",15,!1),he=v(t,"validateOnValueChange",19,ce),me=v(t,"useNativeValidation",19,ce),pe=v(t,"withLeadingIcon",3,a),ve=v(t,"withTrailingIcon",3,a),fe=v(t,"input",7),be=v(t,"floatingLabel",7),we=v(t,"lineRipple",7),Te=v(t,"notchedOutline",7),Ie=v(t,"alwaysFloat",3,!1),ye=D(t,["$$slots","$$events","$$legacy","use","class","style","ripple","disabled","required","textarea","variant","noLabel","label","type","value","files","invalid","updateInvalid","initialInvalid","dirty","prefix","suffix","validateOnValueChange","useNativeValidation","withLeadingIcon","withTrailingIcon","input","floatingLabel","lineRipple","notchedOutline","children","leadingIcon","trailingIcon","internalCounter","line","helper","alwaysFloat"]);const Se=void 0!==W()||void 0===W()&&t.input$emptyValueUndefined||!h(se());h(se())&&se(null),h(de())&&de(!1);let Ce,xe,Be,$e,Ae,Oe,ke=g(o(document.createElement("div"))),Me=g(void 0),Fe=new G,Re=o({}),je=o({}),De=g(void 0),Pe=g(!1),qe=g(o(ue())),Ve=E("SMUI:addLayoutListener"),Le=new Promise(e=>xe=e);const Ne=K(()=>fe()&&fe().getElement());n(()=>{(ge()||u(qe)||!ce())&&u(Me)&&u(Me).isValid()!==!de()&&(ce()?de(!u(Me).isValid()):u(Me).setValid(!de()))}),n(()=>{u(Me)&&u(Me).getValidateOnValueChange()!==he()&&u(Me).setValidateOnValueChange(!h(he())&&he())}),n(()=>{u(Me)&&u(Me).setUseNativeValidation(!!h(me())||me())}),n(()=>{u(Me)&&u(Me).setDisabled(B())});let We=W();function Ee(e){return e in Re?Re[e]??null:_e().classList.contains(e)}function Ue(e){Re[e]||(Re[e]=!0)}function ze(e){e in Re&&!Re[e]||(Re[e]=!1)}function Ge(e,t){je[e]!=t&&(""===t||null==t?delete je[e]:je[e]=t)}function He(){if(u(Me)){const e=u(Me).shouldFloat;u(Me).notchOutline(e)}}function _e(){return u(ke)}n(()=>{if(u(Me)&&Se&&We!==W()){We=W();const e=`${null==W()?"":W()}`;u(Me).getValue()!==e&&u(Me).setValue(e)}}),Ve&&(Ce=Ve(He)),U("SMUI:textfield:leading-icon:mount",e=>{Be=e}),U("SMUI:textfield:leading-icon:unmount",()=>{Be=void 0}),U("SMUI:textfield:trailing-icon:mount",e=>{$e=e}),U("SMUI:textfield:trailing-icon:unmount",()=>{$e=void 0}),U("SMUI:textfield:helper-text:id",e=>{m(De,e,!0)}),U("SMUI:textfield:helper-text:mount",e=>{Ae=e}),U("SMUI:textfield:helper-text:unmount",()=>{m(De,void 0),Ae=void 0}),U("SMUI:textfield:character-counter:mount",e=>{Oe=e}),U("SMUI:textfield:character-counter:unmount",()=>{Oe=void 0}),f(()=>{var e;if(m(Me,new z({addClass:Ue,removeClass:ze,hasClass:Ee,registerTextFieldInteractionHandler:(e,t)=>Fe.on(_e(),e,t),deregisterTextFieldInteractionHandler:(e,t)=>Fe.off(_e(),e,t),registerValidationAttributeChangeHandler:e=>{const t=new MutationObserver(t=>{me()&&e((e=>e.map(e=>e.attributeName).filter(e=>e))(t))}),o={attributes:!0};return fe()&&t.observe(fe().getElement(),o),t},deregisterValidationAttributeChangeHandler:e=>{e.disconnect()},getNativeInput:()=>{var e;return(null==(e=fe())?void 0:e.getElement())??null},setInputAttr:(e,t)=>{var o;null==(o=fe())||o.addAttr(e,t)},removeInputAttr:e=>{var t;null==(t=fe())||t.removeAttr(e)},isFocused:()=>{var e;return document.activeElement===(null==(e=fe())?void 0:e.getElement())},registerInputInteractionHandler:(e,t)=>{var o;const i=null==(o=fe())?void 0:o.getElement();if(i){const o=r();Fe.on(i,e,t,"boolean"==typeof o?{capture:o}:o)}},deregisterInputInteractionHandler:(e,t)=>{var o;const i=null==(o=fe())?void 0:o.getElement();i&&Fe.off(i,e,t)},floatLabel:e=>be()&&be().float(e||Ie()),getLabelWidth:()=>be()?be().getWidth():0,hasLabel:()=>!!be(),shakeLabel:e=>be()&&be().shake(e),setLabelRequired:e=>be()&&be().setRequired(e),activateLineRipple:()=>we()&&we().activate(),deactivateLineRipple:()=>we()&&we().deactivate(),setLineRippleTransformOrigin:e=>we()&&we().setRippleCenter(e),closeOutline:()=>Te()&&Te().closeNotch(),hasOutline:()=>!!Te(),notchOutline:e=>Te()&&Te().notch(e)},{get helperText(){return Ae},get characterCounter(){return Oe},get leadingIcon(){return Be},get trailingIcon(){return $e}}),!0),Se){if(null==fe())throw new Error("SMUI Textfield must be initialized with either a non-undefined initial value or an Input component.");null==(e=u(Me))||e.init()}else _().then(()=>{var e;if(null==fe())throw new Error("SMUI Textfield must be initialized with either a non-undefined initial value or an Input component.");null==(e=u(Me))||e.init()});return xe(),()=>{var e;null==(e=u(Me))||e.destroy(),Fe.clear()}}),l(()=>{Ce&&Ce()});var Ye=ki(),Je=j(Ye),Xe=e=>{var o=Ai();P(o,(e,t,o)=>({class:e,style:t,for:void 0,...o}),[()=>q({[S()]:!0,"mdc-text-field":!0,"mdc-text-field--disabled":B(),"mdc-text-field--textarea":A(),"mdc-text-field--filled":"filled"===O(),"mdc-text-field--outlined":"outlined"===O(),"smui-text-field--standard":"standard"===O()&&!A(),"mdc-text-field--no-label":k()||null==t.label,"mdc-text-field--label-floating":u(Pe)||null!=W()&&""!==W(),"mdc-text-field--with-leading-icon":h(pe())?t.leadingIcon:pe(),"mdc-text-field--with-trailing-icon":h(ve())?t.trailingIcon:ve(),"mdc-text-field--with-internal-counter":A()&&t.internalCounter,"mdc-text-field--invalid":de(),...Re}),()=>Object.entries(je).map(([e,t])=>`${e}: ${t};`).concat([C()]).join(" "),()=>X(ye,["input$","label$","ripple$","outline$","helperLine$"])]);var n=p(o),l=e=>{var o=xi(),i=j(o),n=e=>{var t=Ci();d(e,t)};Y(i,e=>{"filled"===O()&&e(n)});var l=J(i,2),r=e=>{const o=K(()=>u(Pe)||Ie()||null!=W()&&""!==W()&&("number"!=typeof W()||!isNaN(W())));var i=K(()=>ee(ye,"label$"));s(oe(e,F({get floatAbove(){return u(o)},get required(){return $()},wrapped:!0},()=>u(i),{children:(e,o)=>{var i=R(),n=j(i),l=e=>{},r=(e,o)=>{var i=e=>{var o=ie();T(()=>ne(o,t.label)),d(e,o)},n=e=>{var o=R(),i=j(o);b(i,()=>t.label),d(e,o)};Y(e,e=>{"string"==typeof t.label?e(i):e(n,!1)},o)};Y(n,e=>{null==t.label?e(l):e(r,!1)}),d(e,i)},$$slots:{default:!0}})),e=>be(e),()=>be())};Y(l,e=>{k()||null==t.label||e(r)}),d(e,o)};Y(n,e=>{"outlined"!==O()&&e(l)});var r=J(n,2),a=e=>{const o=K(()=>k()||null==t.label);var i=K(()=>ee(ye,"outline$"));s(te(e,F({get noLabel(){return u(o)}},()=>u(i),{children:(e,o)=>{var i=R(),n=j(i),l=e=>{const o=K(()=>u(Pe)||Ie()||null!=W()&&""!==W()&&("number"!=typeof W()||!isNaN(W())));var i=K(()=>ee(ye,"label$"));s(oe(e,F({get floatAbove(){return u(o)},get required(){return $()},wrapped:!0},()=>u(i),{children:(e,o)=>{var i=R(),n=j(i),l=e=>{},r=(e,o)=>{var i=e=>{var o=ie();T(()=>ne(o,t.label)),d(e,o)},n=e=>{var o=R(),i=j(o);b(i,()=>t.label),d(e,o)};Y(e,e=>{"string"==typeof t.label?e(i):e(n,!1)},o)};Y(n,e=>{null==t.label?e(l):e(r,!1)}),d(e,i)},$$slots:{default:!0}})),e=>be(e),()=>be())};Y(n,e=>{k()||null==t.label||e(l)}),d(e,i)},$$slots:{default:!0}})),e=>Te(e),()=>Te())};Y(r,e=>{"outlined"===O()&&e(a)});var g=J(r,2);Z(g,{key:"SMUI:textfield:icon:leading",value:!0,children:(e,o)=>{var i=R(),n=j(i);b(n,()=>t.leadingIcon??w),d(e,i)},$$slots:{default:!0}});var v=J(g,2);b(v,()=>t.children??w);var f=J(v,2),E=e=>{var o=Bi(),i=p(o),n=K(()=>ee(ye,"input$"));s(Si(i,F({get disabled(){return B()},get required(){return $()},get updateInvalid(){return ce()},get initialInvalid(){return u(qe)},get"aria-controls"(){return u(De)},get"aria-describedby"(){return u(De)}},()=>u(n),{onblur:e=>{var o;m(Pe,!1),m(qe,!0),le(_e(),"blur",e),null==(o=t.input$onblur)||o.call(t,e)},onfocus:e=>{var o;m(Pe,!0),le(_e(),"focus",e),null==(o=t.input$onfocus)||o.call(t,e)},get value(){return W()},set value(e){W(e)},get dirty(){return ge()},set dirty(e){ge(e)},get invalid(){return de()},set invalid(e){de(e)}})),e=>fe(e),()=>fe());var l=J(i,2);b(l,()=>t.internalCounter??w),T(e=>I(o,1,e),[()=>re(q({"mdc-text-field__resizer":!("input$resizable"in ye)||t.input$resizable}))]),d(e,o)},U=e=>{var o=$i(),n=j(o),l=e=>{var o=R(),n=j(o),l=e=>{!function(e,t){i(t,!0);let o,n=D(t,["$$slots","$$events","$$legacy","children"]);s(M(e,F({_smuiClass:"mdc-text-field__affix mdc-text-field__affix--prefix",tag:"span"},()=>n,{children:(e,o)=>{var i=R(),n=j(i);b(n,()=>t.children??w),d(e,i)},$$slots:{default:!0}})),e=>o=e,()=>o),c({getElement:function(){return o.getElement()}})}(e,{children:(e,o)=>{var i=ie();T(()=>ne(i,t.prefix)),d(e,i)},$$slots:{default:!0}})},r=e=>{var o=R(),i=j(o);b(i,()=>t.prefix??w),d(e,o)};Y(n,e=>{"string"==typeof t.prefix?e(l):e(r,!1)}),d(e,o)};Y(n,e=>{null!=t.prefix&&e(l)});var r=J(n,2),a=K(()=>ee(ye,"input$"));s(Ii(r,F({get type(){return N()},get disabled(){return B()},get required(){return $()},get updateInvalid(){return ce()},get initialInvalid(){return u(qe)},get"aria-controls"(){return u(De)},get"aria-describedby"(){return u(De)}},()=>k()&&null!=t.label&&"string"==typeof t.label?{placeholder:t.label}:{},()=>u(a),{onblur:e=>{var o;m(Pe,!1),m(qe,!0),le(_e(),"blur",e),null==(o=t.input$onblur)||o.call(t,e)},onfocus:e=>{var o;m(Pe,!0),le(_e(),"focus",e),null==(o=t.input$onfocus)||o.call(t,e)},get value(){return W()},set value(e){W(e)},get files(){return se()},set files(e){se(e)},get dirty(){return ge()},set dirty(e){ge(e)},get invalid(){return de()},set invalid(e){de(e)}})),e=>fe(e),()=>fe());var g=J(r,2),h=e=>{var o=R(),n=j(o),l=e=>{!function(e,t){i(t,!0);let o,n=D(t,["$$slots","$$events","$$legacy","children"]);s(M(e,F({_smuiClass:"mdc-text-field__affix mdc-text-field__affix--suffix",tag:"span"},()=>n,{children:(e,o)=>{var i=R(),n=j(i);b(n,()=>t.children??w),d(e,i)},$$slots:{default:!0}})),e=>o=e,()=>o),c({getElement:function(){return o.getElement()}})}(e,{children:(e,o)=>{var i=ie();T(()=>ne(i,t.suffix)),d(e,i)},$$slots:{default:!0}})},r=e=>{var o=R(),i=j(o);b(i,()=>t.suffix??w),d(e,o)};Y(n,e=>{"string"==typeof t.suffix?e(l):e(r,!1)}),d(e,o)};Y(g,e=>{null!=t.suffix&&e(h)}),d(e,o)};Y(f,e=>{A()&&"string"==typeof W()?e(E):e(U,!1)});var z=J(f,2);Z(z,{key:"SMUI:textfield:icon:leading",value:!1,children:(e,o)=>{var i=R(),n=j(i);b(n,()=>t.trailingIcon??w),d(e,i)},$$slots:{default:!0}});var G=J(z,2),H=e=>{var t=K(()=>ee(ye,"ripple$"));s(ae(e,F(()=>u(t))),e=>we(e),()=>we())};Y(G,e=>{"outlined"!==O()&&x()&&e(H)}),s(o,e=>m(ke,e),()=>u(ke)),V(o,(e,t)=>{var o;return null==(o=Q)?void 0:o(e,t)},()=>({ripple:"filled"===O(),unbounded:!1,addClass:Ue,removeClass:ze,addStyle:Ge,eventTarget:u(Ne),activeTarget:u(Ne),initPromise:Le})),V(o,(e,t)=>{var o;return null==(o=L)?void 0:o(e,t)},y),d(e,o)},Ze=e=>{var o=Oi();P(o,(e,t,o)=>({class:e,style:t,...o}),[()=>q({[S()]:!0,"mdc-text-field":!0,"mdc-text-field--disabled":B(),"mdc-text-field--textarea":A(),"mdc-text-field--filled":"filled"===O(),"mdc-text-field--outlined":"outlined"===O(),"smui-text-field--standard":"standard"===O()&&!A(),"mdc-text-field--no-label":k()||null==t.label,"mdc-text-field--with-leading-icon":t.leadingIcon,"mdc-text-field--with-trailing-icon":t.trailingIcon,"mdc-text-field--invalid":de(),...Re}),()=>Object.entries(je).map(([e,t])=>`${e}: ${t};`).concat([C()]).join(" "),()=>X(ye,["input$","label$","ripple$","outline$","helperLine$"])]);var i=p(o),n=e=>{var o=R(),i=j(o);b(i,()=>t.label??w),d(e,o)};Y(i,e=>{"string"!=typeof t.label&&e(n)});var l=J(i,2);Z(l,{key:"SMUI:textfield:icon:leading",value:!0,children:(e,o)=>{var i=R(),n=j(i);b(n,()=>t.leadingIcon??w),d(e,i)},$$slots:{default:!0}});var r=J(l,2);b(r,()=>t.children??w);var a=J(r,2);Z(a,{key:"SMUI:textfield:icon:leading",value:!1,children:(e,o)=>{var i=R(),n=j(i);b(n,()=>t.trailingIcon??w),d(e,i)},$$slots:{default:!0}});var c=J(a,2);b(c,()=>t.line??w),s(o,e=>m(ke,e),()=>u(ke)),V(o,(e,t)=>{var o;return null==(o=Q)?void 0:o(e,t)},()=>({ripple:x(),unbounded:!1,addClass:Ue,removeClass:ze,addStyle:Ge})),V(o,(e,t)=>{var o;return null==(o=L)?void 0:o(e,t)},y),d(e,o)};Y(Je,e=>{Se?e(Xe):e(Ze,!1)});var Ke=J(Je,2),Qe=e=>{var o=K(()=>ee(ye,"helperLine$"));!function(e,t){i(t,!0);let o,n=D(t,["$$slots","$$events","$$legacy","children"]);s(M(e,F({_smuiClass:"mdc-text-field-helper-line",tag:"div"},()=>n,{children:(e,o)=>{var i=R(),n=j(i);b(n,()=>t.children??w),d(e,i)},$$slots:{default:!0}})),e=>o=e,()=>o),c({getElement:function(){return o.getElement()}})}(e,F(()=>u(o),{children:(e,o)=>{var i=R(),n=j(i);b(n,()=>t.helper??w),d(e,i)},$$slots:{default:!0}}))};return Y(Ke,e=>{t.helper&&e(Qe)}),d(e,Ye),c({focus:function(){var e;null==(e=fe())||e.focus()},blur:function(){var e;null==(e=fe())||e.blur()},layout:He,getElement:_e})}var Fi=r('<div class="col-12"><!></div>'),Ri=r('<div class="row pt-4"><div class="col-12"><!></div> <!></div>'),ji=r('<div class="container-fluid"><div class="row"><div class="col-6"><!></div> <div class="col-6"><!></div></div></div>'),Di=r("<!> <!> <!>",1);function Pi(e,t){i(t,!0);let n=v(t,"open",7),l=g(o(t.isWord&&t.prevText?t.prevText:""));se(e,{surface$style:"width: 400px; max-width: calc(100vw - 32px);",onSMUIDialogClosed:function(e){t.isWord?t.closeHandler(e,u(l)):t.closeHandler(e),t.onclose()},get open(){return n()},set open(e){n(e)},children:(e,o)=>{var i=Di(),n=j(i);de(n,{class:"px-3 pb-0 toolbar toolbar__dialog",children:(e,o)=>{var i=R(),n=j(i);a(n,()=>t.title),d(e,i)},$$slots:{default:!0}});var r=J(n,2);ce(r,{children:(e,o)=>{var i=Ri(),n=p(i),r=p(n);a(r,()=>t.context);var s=J(n,2),c=e=>{var t=Fi();Mi(p(t),{textarea:!0,label:"",variant:"filled",input$rows:5,get value(){return u(l)},set value(e){m(l,e,!0)}}),d(e,t)};Y(s,e=>{t.isWord&&e(c)}),d(e,i)},$$slots:{default:!0}});var s=J(r,2);ue(s,{children:(e,t)=>{var o=ji(),i=p(o),n=p(i),l=p(n);ge(l,{action:"close",children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie("Cancel");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var r=J(n,2),a=p(r);ge(a,{action:"accept",children:(e,t)=>{he(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=ie("OK");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),d(e,o)},$$slots:{default:!0}}),d(e,i)},$$slots:{default:!0}}),c()}var qi=r('<div class="row gy-4"><div class="col-sm-6 col-12"><!></div> <div class="col-sm-6 col-12"><!></div> <div class="col-12"><!> <!></div></div>'),Vi=r("<!> <!> <!>",1);var Li=r('<i class="mdi mdi-play"></i>'),Ni=r('<i class="mdi mdi-clipboard-outline"></i>'),Wi=r('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div> <div class="col-sm-10 col-8"><div class="col-12 pt-1"><div> </div> <div> </div></div></div> <div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div></div>'),Ei=r('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-12" style="height: 48px">Empty</div></div>'),Ui=r('<i class="mdi mdi-alpha-a-box-outline"></i>'),zi=r('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div> <div class="col-sm-11 col-10"><div class="col-12 pt-1"><div> </div> <div> </div></div></div></div>'),Gi=r('<i class="mdi mdi-play"></i>'),Hi=r('<i class="mdi mdi-trash-can"></i>'),_i=r('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div> <div class="col-sm-10 col-8"><div class="col-12 pt-1"><div> </div> <div> </div></div></div> <div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div></div>'),Yi=r('<i class="mdi mdi-content-save"></i>'),Ji=r('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div> <div class="col-sm-11 col-10"><div class="col-12"><!></div></div></div>'),Xi=r("<!> <!>",1),Zi=r('<i class="mdi mdi-menu-left"></i>'),Ki=r('<i class="mdi mdi-menu-right"></i>'),Qi=r('<div class="container-fluid pb-2 mb-2" style="border: 1px solid"><!></div> <div class="row gy-2"><div class="col pb-2"><!></div> <div class="col pb-2"><div class="d-row align-items-center justify-end"><!> <span class="list-text px-2"> </span> <!></div></div></div> <div class="row gy-2"><div class="col-12"><!></div></div>',1),en=r("<!> <!> <!>",1),tn=r("<!> <!>",1);function on(e,t){i(t,!0);let o=v(t,"open",7);const n={action:()=>{},title:"Warning",context:""};let l=g("none"),r=g(1),a=K(()=>9*(u(r)-1)),h=K(()=>Math.min(u(a)+9-1,99)),f=K(()=>Array.from({length:u(h)-u(a)+1},(e,t)=>Gt[u(a)+t])),b=K(()=>Array.from({length:u(h)-u(a)+1},(e,t)=>Ht[u(a)+t])),w=g(!1);function I(e){const t=`${location.pathname.replace(/\/index\.html$/,"/")}slot-${e}`,o=navigator.language,i=new Date,n=new Intl.DateTimeFormat(o,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(i);!async function(e,t,o,i,n){const l=(await Kt()).transaction(i,"readwrite").objectStore(i);try{await new Promise((o,i)=>{const n=l.put(e,t);n.onsuccess=()=>o(),n.onerror=()=>i(n.error)}),n&&(Gt[o].stored=!0,Gt[o].time=e.time,Gt[o].name=e.name,Gt[o].app=e.app)}catch(r){console.error(r)}}({stored:!0,name:Gt[e].name,time:n,app:oo()},t,e,"buildStore",!0)}function y(e){!async function(e,t,o,i){const n=(await Kt()).transaction(o,"readwrite").objectStore(o);try{await new Promise((t,o)=>{const i=n.delete(e);i.onsuccess=()=>t(),i.onerror=()=>o(i.error)}),i&&(Gt[t].stored=!1,Gt[t].name=`Slot ${t+1}`,Gt[t].time="",Gt[t].app="")}catch(l){console.error(l)}}(`${location.pathname.replace(/\/index\.html$/,"/")}slot-${e}`,e,"buildStore",!0)}var S=tn(),C=j(S);se(C,{surface$style:"width: 700px; max-width: calc(100vw - 32px);",get onSMUIDialogClosed(){return t.onclose},id:"dialog",get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=en(),i=j(o);de(i,{class:"text-left dialog-title",tabindex:0,autofocus:!0,children:(e,t)=>{var o=ie("Save/Load Project");d(e,o)},$$slots:{default:!0}});var a=J(i,2);ce(a,{class:"pt-3",children:(e,t)=>{var o=Qi(),i=j(o),a=p(i),s=e=>{var t=R(),o=j(t);fe(o,17,()=>u(b),be,(e,t,o)=>{var i=R(),r=j(i),a=e=>{var i=Wi(),r=p(i),a=p(r);ve(a,{onclick:()=>{n.action=()=>{return e=o,void Po(u(b)[e].app);var e},n.context="Are you sure you want to load this project?<br>Any unsaved changes will be lost.",m(l,"dlgCommon")},children:(e,t)=>{var o=Li();d(e,o)},$$slots:{default:!0}});var s=J(r,2),c=p(s),g=p(c),h=p(g),v=J(g,2),f=p(v),w=J(s,2),I=p(w);ve(I,{onclick:()=>function(e){const t=u(b)[e].app;navigator.clipboard.writeText(t).then(()=>{Et.labelText="Build code copied to clipboard.",Et.isOpen=!0}).catch(e=>{Et.labelText="Failed to copy build code to clipboard.",Et.isOpen=!0,console.error(e)})}(o),children:(e,t)=>{var o=Ni();d(e,o)},$$slots:{default:!0}}),T(()=>{ne(h,u(t).name),ne(f,u(t).time)}),d(e,i)},s=e=>{var t=Ei();d(e,t)};Y(r,e=>{u(t).stored?e(a):e(s,!1)}),d(e,i)}),d(e,t)},c=e=>{var t=Xi(),o=j(t),i=e=>{var t=zi(),o=p(t),i=p(o);ve(i,{onclick:()=>{n.action=()=>{Po(zt.app)},n.context="Are you sure you want to load this project?<br>Any unsaved changes will be lost.",m(l,"dlgCommon")},children:(e,t)=>{var o=Ui();d(e,o)},$$slots:{default:!0}});var r=J(o,2),a=p(r),s=p(a),c=p(s),u=J(s,2),g=p(u);T(()=>{ne(c,zt.name),ne(g,zt.time)}),d(e,t)};Y(o,e=>{zt.stored&&e(i)});var r=J(o,2);fe(r,17,()=>u(f),be,(e,t,o)=>{var i=R(),r=j(i),a=e=>{var i=_i(),r=p(i),a=p(r);ve(a,{onclick:()=>{n.action=()=>{Po(Gt[o].app)},n.context="Are you sure you want to load this project?<br>Any unsaved changes will be lost.",m(l,"dlgCommon")},children:(e,t)=>{var o=Gi();d(e,o)},$$slots:{default:!0}});var s=J(r,2),c=p(s),g=p(c),h=p(g),v=J(g,2),f=p(v),b=J(s,2),w=p(b);ve(w,{onclick:()=>{n.action=()=>y(o),n.context="Are you sure you want to delete this project?<br>This action cannot be undone.",m(l,"dlgCommon")},children:(e,t)=>{var o=Hi();d(e,o)},$$slots:{default:!0}}),T(()=>{ne(h,u(t).name),ne(f,u(t).time)}),d(e,i)},s=e=>{var i=Ji(),n=p(i),l=p(n);ve(l,{onclick:()=>I(o),children:(e,t)=>{var o=Yi();d(e,o)},$$slots:{default:!0}});var r=J(n,2),a=p(r);Mi(p(a),{onclick:()=>u(t).name="",onblur:()=>{""===u(t).name&&(u(t).name=`Slot ${o+1}`)},input$onkeydown:e=>{"Enter"===e.key&&I(o)},class:"textbox-mini",variant:"standard",get value(){return u(t).name},set value(e){u(t).name=e}}),d(e,i)};Y(r,e=>{u(t).stored?e(a):e(s,!1)}),d(e,i)}),d(e,t)};Y(a,e=>{u(w)?e(s):e(c,!1)});var g=J(i,2),h=p(g),v=p(h);me(v,{style:"height: 48px",label:e=>{var t=ie("Load from Legacy Version");d(e,t)},children:(e,t)=>{pe(e,{onSMUISwitchChange:()=>m(r,1),color:"secondary",class:"switch-scale",get checked(){return u(w)},set checked(e){m(w,e,!0)}})},$$slots:{label:!0,default:!0}});var S=J(h,2),C=p(S),x=p(C);ve(x,{onclick:()=>u(r)>1?m(r,u(r)-1):m(r,11),children:(e,t)=>{var o=Zi();d(e,o)},$$slots:{default:!0}});var B=J(x,2),$=p(B),A=J(B,2);ve(A,{onclick:()=>u(r)<11?m(r,u(r)+1):m(r,1),children:(e,t)=>{var o=Ki();d(e,o)},$$slots:{default:!0}});var O=J(g,2),k=p(O),M=p(k);ge(M,{onclick:()=>m(l,"appBuildForm"),variant:"raised",children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie("Open Build Form");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),T(()=>ne($,`Page ${u(r)??""}`)),d(e,o)},$$slots:{default:!0}});var s=J(a,2);ue(s,{children:(e,t)=>{ge(e,{action:"close",children:(e,t)=>{he(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=ie("Close");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),d(e,o)},$$slots:{default:!0}});var x=J(C,2),B=e=>{const t=K(()=>"dlgCommon"===u(l));Pi(e,{get open(){return u(t)},onclose:()=>m(l,"none"),get title(){return n.title},get context(){return n.context},closeHandler:e=>{"accept"===e.detail.action&&n.action()}})},$=(e,t)=>{var o=e=>{const t=K(()=>"appBuildForm"===u(l));!function(e,t){i(t,!0);let o=v(t,"open",7),n=g(void 0),l=g(void 0),r=g("");function a(){let e=[],t=Array.from(Ct.keys());t.sort((e,t)=>{let o=At.get(e),i=At.get(t);return void 0!==o&&void 0!==i?o.row.index!==i.row.index?o.row.index-i.row.index:o.choice.index-i.choice.index:0});for(let o=0;o<t.length;o++){let i=At.get(t[o]);void 0!==i&&e.push(i.choice.title)}return e.join(", ")}se(e,{surface$style:"width: 1920px; max-width: calc(100vw - 32px);",get onSMUIDialogClosed(){return t.onclose},get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=Vi(),i=j(o);de(i,{class:"px-3 pb-0 toolbar toolbar__dialog",tabindex:0,autofocus:!0,children:(e,t)=>{var o=ie("Build Form");d(e,o)},$$slots:{default:!0}});var c=J(i,2);ce(c,{children:(e,t)=>{var o=qi(),i=p(o),c=p(i);const g=K(a);s(Mi(c,{textarea:!0,get value(){return u(g)},label:"Current Activated Choices Titles",variant:"filled",input$rows:5}),e=>m(n,e,!0),()=>u(n));var h=J(i,2),v=p(h);const f=K(oo);s(Mi(v,{textarea:!0,get value(){return u(f)},label:"Current Activated Choices ID's",variant:"filled",input$rows:5}),e=>m(l,e,!0),()=>u(l));var b=J(h,2),w=p(b);Mi(w,{textarea:!0,label:"Area To Import Activated Choices With Lists Of Id's",variant:"filled",input$rows:5,get value(){return u(r)},set value(e){m(r,e,!0)}});var T=J(w,2);ge(T,{onclick:()=>Po(u(r)),variant:"raised",children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie("Import Choices/Clean if empty");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),d(e,o)},$$slots:{default:!0}});var g=J(c,2);ue(g,{children:(e,t)=>{ge(e,{action:"close",children:(e,t)=>{he(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=ie("Cancel");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),d(e,o)},$$slots:{default:!0}}),c()}(e,{get open(){return u(t)},onclose:()=>m(l,"none")})};Y(e,e=>{"appBuildForm"===u(l)&&e(o)},t)};Y(x,e=>{"dlgCommon"===u(l)?e(B):e($,!1)}),d(e,S),c()}var nn=r('<div class="col"><!></div>'),ln=r('<div class="col"><!></div>');function rn(e,t){i(t,!0);let o=K(()=>{let e=kt.get(t.required.reqId);return void 0!==e&&void 0!==app.globalRequirements?e.requireds:[]}),n=K(()=>!!t.required.showRequired&&(!t.required.hideRequired||(t.required.requireds.length>0?wo(t.required.requireds)&&!bo(t.required):!bo(t.required))));var l=R(),r=j(l),s=e=>{var i=R(),n=j(i),l=e=>{var i=R(),n=j(i);fe(n,17,()=>u(o),be,(e,o)=>{var i=R(),n=j(i),l=e=>{var i=nn(),n=p(i);a(n,()=>we.sanitize(mo(no(u(o))),Vt)),T(()=>Te(i,t.scoreText)),d(e,i)};Y(n,e=>{u(o).showRequired&&e(l)}),d(e,i)}),d(e,i)},r=e=>{var o=ln(),i=p(o);a(i,()=>we.sanitize(mo(no(t.required)),Vt)),T(()=>Te(o,t.scoreText)),d(e,o)};Y(n,e=>{"gid"===t.required.type?e(l):e(r,!1)}),d(e,i)};Y(r,e=>{u(n)&&e(s)}),d(e,l),c()}var an=r('<img alt=""/>'),sn=r('<img alt=""/>'),dn=r('<h3 class="m-0"><!></h3>'),cn=r('<img alt=""/>'),un=r('<img alt=""/>'),gn=r("<p><!></p>"),hn=r('<img alt=""/>'),mn=r('<img alt=""/>'),pn=r('<span class="m-0"><!> <!> <!> <!> <!> <!></span>'),vn=r('<img alt=""/>'),fn=r('<img alt=""/>'),bn=r('<h2 class="mb-0"><!></h2>'),wn=r("<p><!></p>"),Tn=r('<div class="col p-0 text-center"><!></div> <div class="col p-0 text-center"><!> <!> <!></div>',1),In=r('<h2 class="mb-0"><!></h2>'),yn=r("<p><!></p>"),Sn=r('<img alt=""/>'),Cn=r('<img alt=""/>'),xn=r('<div class="col p-0 text-center"><!> <!> <!></div> <div class="col p-0 text-center"><!></div>',1),Bn=r('<div class="row m-0 p-0 w-100"><!></div>'),$n=r('<div class="text-center"><!></div>');function An(e,t){i(t,!0);let o=v(t,"windowWidth",3,0),n=v(t,"preloadImages",3,!1),l=K(()=>po("privateAddonImageIsOn",t.row,t.choice)),r=K(()=>po("privateAddonIsOn",t.row,t.choice)),s=K(()=>po("privateFilterIsOn",t.row,t.choice)),g=K(()=>po("privateObjectImageIsOn",t.row,t.choice)),h=K(()=>po("privateObjectIsOn",t.row,t.choice)),m=K(()=>po("privateTextIsOn",t.row,t.choice)),f=K(()=>wo(t.addon.requireds)),b=K(()=>u(l).addonImageBoxWidth??50),w=K(()=>{let e=u(r).useAddonDesign,o=(e?u(r).addonBorderRadiusIsPixels:u(h).objectBorderRadiusIsPixels)?"px":"%",i=0,n=0,l=0,a=[];if(e){if(u(r).addonBorderImage&&a.push(`border-image: url('${u(r).addonBorderImage}') ${u(r).addonBorderImageSliceTop} ${u(r).addonBorderImageSliceRight} ${u(r).addonBorderImageSliceBottom} ${u(r).addonBorderImageSliceLeft} / ${u(r).addonBorderImageWidth}px ${u(r).addonBorderImageRepeat}; border-style: solid; padding: ${u(r).addonBorderImageWidth}px;`),u(r).useAddonBackgroundImage&&u(r).addonBackgroundImage&&(a.push(`background-image: url('${u(r).addonBackgroundImage}'); ${u(r).isObjectBackgroundRepeat?"background-repeat: repeat;":u(r).isObjectBackgroundFitIn?"background-size: 100% 100%;":"background-size: cover;"}`),i=a.length),u(r).addonBgColorIsOn&&(a.push(`background-color: ${u(r).addonBgColor};`),n=a.length),a.push(`margin: ${u(r).addonMargin}px;`),a.push(`border-radius: ${u(r).addonBorderRadiusTopLeft}${o} ${u(r).addonBorderRadiusTopRight}${o} ${u(r).addonBorderRadiusBottomRight}${o} ${u(r).addonBorderRadiusBottomLeft}${o};`),u(r).addonOverflowIsOn&&a.push("overflow: hidden;"),u(r).addonBorderIsOn||t.isActive&&u(s).selBorderColorIsOn||!t.isEnabled&&u(s).reqBorderColorIsOn){let e=u(r).addonBorderColor;!t.isEnabled&&u(s).reqBorderColorIsOn?e=u(s).reqFilterBorderColor:t.isActive&&u(s).selBorderColorIsOn&&(e=u(s).selFilterBorderColor),a.push(`border: ${u(r).addonBorderWidth}px ${u(r).addonBorderStyle} ${e};`)}u(r).addonDropShadowIsOn&&(u(r).addonUseBoxShadowIsOn?a.push(`box-shadow: ${u(r).addonDropShadowH}px ${u(r).addonDropShadowV}px ${u(r).addonDropShadowBlur}px ${u(r).addonDropShadowColor};`):(l=a.length,a.push(`filter: drop-shadow(${u(r).addonDropShadowH}px ${u(r).addonDropShadowV}px ${u(r).addonDropShadowBlur}px ${u(r).addonDropShadowColor})`))),0===l&&(a.push("filter:"),l=a.length),t.isEnabled&&u(f)&&(t.isActive?(u(s).selFilterBlurIsOn&&a.push(` blur(${u(s).selFilterBlur}px)`),u(s).selFilterBrightIsOn&&a.push(` brightness(${u(s).selFilterBright}%)`),u(s).selFilterContIsOn&&a.push(` contrast(${u(s).selFilterCont}%)`),u(s).selFilterGrayIsOn&&a.push(` grayscale(${u(s).selFilterGray}%)`),u(s).selFilterHueIsOn&&a.push(` hue-rotate(${u(s).selFilterHue}deg)`),u(s).selFilterInvertIsOn&&a.push(` invert(${u(s).selFilterInvert}%)`),u(s).selFilterOpacIsOn&&a.push(` opacity(${u(s).selFilterOpac}%)`),u(s).selFilterSaturIsOn&&a.push(` saturate(${u(s).selFilterSatur})`),u(s).selFilterSepiaIsOn&&a.push(` sepia(${u(s).selFilterGray}%)`)):(u(s).unselFilterBlurIsOn&&a.push(` blur(${u(s).unselFilterBlur}px)`),u(s).unselFilterBrightIsOn&&a.push(` brightness(${u(s).unselFilterBright}%)`),u(s).unselFilterContIsOn&&a.push(` contrast(${u(s).unselFilterCont}%)`),u(s).unselFilterGrayIsOn&&a.push(` grayscale(${u(s).unselFilterGray}%)`),u(s).unselFilterHueIsOn&&a.push(` hue-rotate(${u(s).unselFilterHue}deg)`),u(s).unselFilterInvertIsOn&&a.push(` invert(${u(s).unselFilterInvert}%)`),u(s).unselFilterOpacIsOn&&a.push(` opacity(${u(s).unselFilterOpac}%)`),u(s).unselFilterSaturIsOn&&a.push(` saturate(${u(s).unselFilterSatur})`),u(s).unselFilterSepiaIsOn&&a.push(` sepia(${u(s).unselFilterGray}%)`)),a.length===l?a.splice(l-1,1):a.push(";")),u(r).addonGradientIsOn&&a.push(`background-image: linear-gradient('${u(r).addonGradient}');`)}return(app.showAllAddons>0||t.addon.showAddon)&&t.isEnabled&&!u(f)&&(0===l&&(a.push("filter:"),l=a.length),u(s).reqFilterBlurIsOn&&a.push(` blur(${u(s).reqFilterBlur}px)`),u(s).reqFilterBrightIsOn&&a.push(` brightness(${u(s).reqFilterBright}%)`),u(s).reqFilterContIsOn&&a.push(` contrast(${u(s).reqFilterCont}%)`),u(s).reqFilterGrayIsOn&&a.push(` grayscale(${u(s).reqFilterGray}%)`),u(s).reqFilterHueIsOn&&a.push(` hue-rotate(${u(s).reqFilterHue}deg)`),u(s).reqFilterInvertIsOn&&a.push(` invert(${u(s).reqFilterInvert}%)`),u(s).reqFilterOpacIsOn&&a.push(` opacity(${u(s).reqFilterOpac}%)`),u(s).reqFilterSaturIsOn&&a.push(` saturate(${u(s).reqFilterSatur})`),u(s).reqFilterSepiaIsOn&&a.push(` sepia(${u(s).reqFilterGray}%)`),a.length===l?a.splice(l-1,1):a.push(";"),u(s).reqBgColorIsOn&&(u(s).reqOverlayOnImage||(0!==n&&a.splice(n-1,1),0!==i&&a.splice(i-1,1)),a.push(`background-color: ${u(s).reqFilterBgColor};`)),u(r).addonGradientIsOn&&a.push(`background-image: linear-gradient('${u(r).addonGradientOnReq}');`)),a.join(" ")}),I=K(()=>{let e=[];return e.push(`font-family: ${u(m).addonTitle};font-size: ${u(m).addonTitleTextSize}%;text-align: ${u(m).addonTitleAlign};`),!t.isEnabled&&u(s).reqATitleColorIsOn?e.push(`color: ${u(s).reqFilterATitleColor};`):t.isActive&&u(s).selATitleColorIsOn?e.push(`color: ${u(s).selFilterATitleColor};`):e.push(`color: ${u(m).addonTitleColor};`),u(r).useAddonDesign?u(r).titlePaddingIsOn&&e.push(`padding: ${u(r).addonTextPadding}px;`):u(h).titlePaddingIsOn&&e.push(`padding: ${u(h).objectTextPadding}px;`),e.join(" ")}),y=K(()=>{let e=[];return e.push(`font-family: ${u(m).addonText};text-align: ${u(m).addonTextAlign};font-size: ${u(m).addonTextTextSize}%;white-space: pre-line;`),!t.isEnabled&&u(s).reqATextColorIsOn?e.push(`color: ${u(s).reqFilterATextColor};`):t.isActive&&u(s).selATextColorIsOn?e.push(`color: ${u(s).selFilterATextColor};`):e.push(`color: ${u(m).addonTextColor};`),u(r).useAddonDesign?e.push(`padding: ${u(r).addonTextPadding}px;`):e.push(`padding: ${u(h).objectTextPadding}px;`),e.join(" ")}),S=K(()=>{var e,o;let i=[],n=u(l).useAddonImage,r=(n?u(l).addonImgBorderRadiusIsPixels:u(g).objectImgBorderRadiusIsPixels)?"px":"%";return n?(i.push(`width: ${u(l).addonImageWidth}%; margin-top: ${u(l).addonImageMarginTop}%; margin-bottom: ${u(l).addonImageMarginBottom}%;`),u(l).addonImgObjectFillIsOn&&i.push(`object-fit: ${u(l).addonImgObjectFillStyle}; height: ${(null==(e=t.choice)?void 0:e.addonImgObjectFillHeight)??200}px;`),i.push(`border-radius: ${u(l).addonImgBorderRadiusTopLeft}${r} ${u(l).addonImgBorderRadiusTopRight}${r} ${u(l).addonImgBorderRadiusBottomRight}${r} ${u(l).addonImgBorderRadiusBottomLeft}${r};`),u(l).addonImgOverflowIsOn&&i.push("overflow: hidden;"),u(l).addonImgBorderIsOn&&i.push(`border: ${u(l).addonImgBorderWidth}px ${u(l).addonImgBorderStyle} ${u(l).addonImgBorderColor};`)):(i.push(`width: ${u(g).objectImageWidth}%; margin-top: ${u(g).objectImageMarginTop}%; margin-bottom: ${u(g).objectImageMarginBottom}%;`),u(g).objectImgObjectFillIsOn&&i.push(`object-fit: ${u(g).objectImgObjectFillStyle}; height: ${(null==(o=t.row)?void 0:o.objectImgObjectFillHeight)??200}px;`),i.push(`border-radius: ${u(g).objectImgBorderRadiusTopLeft}${r} ${u(g).objectImgBorderRadiusTopRight}${r} ${u(g).objectImgBorderRadiusBottomRight}${r} ${u(g).objectImgBorderRadiusBottomLeft}${r};`),u(g).objectImgOverflowIsOn&&i.push("overflow: hidden;"),u(g).objectImgBorderIsOn&&i.push(`border: ${u(g).objectImgBorderWidth}px ${u(g).objectImgBorderStyle} ${u(g).objectImgBorderColor};`)),i.join(" ")}),C=K(()=>`font-family: ${u(m).scoreText}; font-size: ${u(m).scoreTextSize}%; text-align: ${u(m).scoreTextAlign}; color: ${u(m).scoreTextColor};`);var x=R(),B=j(x),$=e=>{var i=$n(),l=p(i),r=e=>{var i=pn(),l=p(i),r=e=>{var o=R(),i=j(o),l=e=>{ot(e,{get text(){return t.addon.imageSourceTooltip},children:(e,o)=>{var i=an();T(()=>{Ie(i,"src",t.addon.image),Te(i,u(S)),Ie(i,"loading",n()?"eager":"lazy")}),d(e,i)},$$slots:{default:!0}})},r=e=>{var o=sn();T(()=>{Ie(o,"src",t.addon.image),Te(o,u(S)),Ie(o,"loading",n()?"eager":"lazy")}),d(e,o)};Y(i,e=>{t.addon.imageSourceTooltip?e(l):e(r,!1)}),d(e,o)};Y(l,e=>{var i;(1===t.addon.template||o()<=960)&&t.addon.image&&!(null==(i=t.row)?void 0:i.addonImageRemoved)&&e(r)});var s=J(l,2),c=e=>{var o=dn(),i=p(o);a(i,()=>we.sanitize(mo(t.addon.title),Vt)),T(()=>Te(o,u(I))),d(e,o)};Y(s,e=>{var o;""===t.addon.title||(null==(o=t.row)?void 0:o.addonTitleRemoved)||e(c)});var g=J(s,2),h=e=>{var o=R(),i=j(o);fe(i,17,()=>t.addon.requireds,be,(e,t)=>{rn(e,{get required(){return u(t)},get scoreText(){return u(C)}})}),d(e,o)};Y(g,e=>{var o;(null==(o=t.row)?void 0:o.objectRequirementRemoved)||e(h)});var m=J(g,2),v=e=>{var o=R(),i=j(o),l=e=>{ot(e,{get text(){return t.addon.imageSourceTooltip},children:(e,o)=>{var i=cn();T(()=>{Ie(i,"src",t.addon.image),Te(i,u(S)),Ie(i,"loading",n()?"eager":"lazy")}),d(e,i)},$$slots:{default:!0}})},r=e=>{var o=un();T(()=>{Ie(o,"src",t.addon.image),Te(o,u(S)),Ie(o,"loading",n()?"eager":"lazy")}),d(e,o)};Y(i,e=>{t.addon.imageSourceTooltip?e(l):e(r,!1)}),d(e,o)};Y(m,e=>{var o;5===t.addon.template&&t.addon.image&&!(null==(o=t.row)?void 0:o.addonImageRemoved)&&e(v)});var f=J(m,2),b=e=>{var o=gn(),i=p(o);a(i,()=>we.sanitize(mo(t.addon.text),Vt)),T(()=>Te(o,u(y))),d(e,o)};Y(f,e=>{var o;""===t.addon.text||(null==(o=t.row)?void 0:o.addonTextRemoved)||e(b)});var w=J(f,2),x=e=>{var o=R(),i=j(o),l=e=>{ot(e,{get text(){return t.addon.imageSourceTooltip},children:(e,o)=>{var i=hn();T(()=>{Ie(i,"src",t.addon.image),Te(i,u(S)),Ie(i,"loading",n()?"eager":"lazy")}),d(e,i)},$$slots:{default:!0}})},r=e=>{var o=mn();T(()=>{Ie(o,"src",t.addon.image),Te(o,u(S)),Ie(o,"loading",n()?"eager":"lazy")}),d(e,o)};Y(i,e=>{t.addon.imageSourceTooltip?e(l):e(r,!1)}),d(e,o)};Y(w,e=>{var o;4===t.addon.template&&t.addon.image&&!(null==(o=t.row)?void 0:o.addonImageRemoved)&&e(x)}),d(e,i)},s=e=>{var o=Bn(),i=p(o),l=e=>{var o=Tn(),i=j(o),l=p(i),r=e=>{var o=R(),i=j(o),l=e=>{ot(e,{get text(){return t.addon.imageSourceTooltip},children:(e,o)=>{var i=vn();T(()=>{Ie(i,"src",t.addon.image),Te(i,u(S)),Ie(i,"loading",n()?"eager":"lazy")}),d(e,i)},$$slots:{default:!0}})},r=e=>{var o=fn();T(()=>{Ie(o,"src",t.addon.image),Te(o,u(S)),Ie(o,"loading",n()?"eager":"lazy")}),d(e,o)};Y(i,e=>{t.addon.imageSourceTooltip?e(l):e(r,!1)}),d(e,o)};Y(l,e=>{var o;t.addon.image&&!(null==(o=t.row)?void 0:o.addonImageRemoved)&&e(r)});var s=J(i,2),c=p(s),g=e=>{var o=bn(),i=p(o);a(i,()=>we.sanitize(mo(t.addon.title),Vt)),T(()=>Te(o,u(I))),d(e,o)};Y(c,e=>{var o;""===t.addon.title||(null==(o=t.row)?void 0:o.addonTitleRemoved)||e(g)});var h=J(c,2),m=e=>{var o=R(),i=j(o);fe(i,17,()=>t.addon.requireds,be,(e,t)=>{rn(e,{get required(){return u(t)},get scoreText(){return u(C)}})}),d(e,o)};Y(h,e=>{var o;(null==(o=t.row)?void 0:o.objectRequirementRemoved)||e(m)});var v=J(h,2),f=e=>{var o=wn(),i=p(o);a(i,()=>we.sanitize(mo(t.addon.text),Vt)),T(()=>Te(o,u(y))),d(e,o)};Y(v,e=>{var o;""===t.addon.text||(null==(o=t.row)?void 0:o.addonTextRemoved)||e(f)}),T(()=>{Te(i,`max-width: ${u(b)??""}%`),Te(s,`max-width: ${100-u(b)}%`)}),d(e,o)},r=(e,o)=>{var i=e=>{var o=xn(),i=j(o),l=p(i),r=e=>{var o=In(),i=p(o);a(i,()=>we.sanitize(mo(t.addon.title),Vt)),T(()=>Te(o,u(I))),d(e,o)};Y(l,e=>{var o;""===t.addon.title||(null==(o=t.row)?void 0:o.addonTitleRemoved)||e(r)});var s=J(l,2),c=e=>{var o=R(),i=j(o);fe(i,17,()=>t.addon.requireds,be,(e,t)=>{rn(e,{get required(){return u(t)},get scoreText(){return u(C)}})}),d(e,o)};Y(s,e=>{var o;(null==(o=t.row)?void 0:o.objectRequirementRemoved)||e(c)});var g=J(s,2),h=e=>{var o=yn(),i=p(o);a(i,()=>we.sanitize(mo(t.addon.text),Vt)),T(()=>Te(o,u(y))),d(e,o)};Y(g,e=>{var o;""===t.addon.text||(null==(o=t.row)?void 0:o.addonTextRemoved)||e(h)});var m=J(i,2),v=p(m),f=e=>{var o=R(),i=j(o),l=e=>{ot(e,{get text(){return t.addon.imageSourceTooltip},children:(e,o)=>{var i=Sn();T(()=>{Ie(i,"src",t.addon.image),Te(i,u(S)),Ie(i,"loading",n()?"eager":"lazy")}),d(e,i)},$$slots:{default:!0}})},r=e=>{var o=Cn();T(()=>{Ie(o,"src",t.addon.image),Te(o,u(S)),Ie(o,"loading",n()?"eager":"lazy")}),d(e,o)};Y(i,e=>{t.addon.imageSourceTooltip?e(l):e(r,!1)}),d(e,o)};Y(v,e=>{var o;t.addon.image&&!(null==(o=t.row)?void 0:o.addonImageRemoved)&&e(f)}),T(()=>{Te(i,`max-width: ${100-u(b)}%`),Te(m,`max-width: ${u(b)??""}%`)}),d(e,o)};Y(e,e=>{3===t.addon.template&&e(i)},o)};Y(i,e=>{2===t.addon.template?e(l):e(r,!1)}),d(e,o)};Y(l,e=>{t.addon.template>=4||1===t.addon.template||o()<=960?e(r):e(s,!1)}),T(()=>Te(i,u(w))),d(e,i)};Y(B,e=>{(app.showAllAddons>0||t.addon.showAddon||wo(t.addon.requireds))&&e($)}),d(e,x),c()}var On=r('<i class="mdi mdi-minus"></i>'),kn=r('<i class="mdi mdi-plus"></i>'),Mn=r('<div class="px-5 w-100"><!></div>'),Fn=r('<div class="d-row justify-space-around w-100"><!> <div translate="no"> </div> <!></div> <!>',1);function Rn(e,t){i(t,!0);let o=g(0),l=K(()=>{if(t.choice.isMultipleUseVariable)return t.choice.multipleUseVariable;if(void 0!==t.choice.multipleScoreId){let e=Bt.get(t.choice.multipleScoreId);if(void 0!==e)return e.startingSum}return 0});function r(e){e.stopPropagation(),t.selectedOneMore()}function a(e){e.stopPropagation(),t.selectedOneLess()}function s(){var e;const i=u(o)-u(l);for(let o=0;o<Math.abs(i);o++)i>0?t.selectedOneMore():t.selectedOneLess();null==(e=document.activeElement)||e.blur()}n(()=>{t.choice.useSlider&&m(o,u(l),!0)});var h=R(),v=j(h),f=e=>{var i=Fn(),n=j(i),c=p(n);const g=K(()=>!t.isEnabled);ve(c,{class:"counter-icons",get disabled(){return u(g)},onclick:a,children:(e,o)=>{var i=On();T(()=>Te(i,t.multiChoiceButton)),d(e,i)},$$slots:{default:!0}});var h=J(c,2),v=p(h),f=J(h,2);const b=K(()=>!t.isEnabled);ve(f,{class:"counter-icons",get disabled(){return u(b)},onclick:r,children:(e,o)=>{var i=kn();T(()=>Te(i,t.multiChoiceButton)),d(e,i)},$$slots:{default:!0}});var w=J(n,2),I=e=>{var i=Mn(),n=p(i);const l=K(()=>!t.isEnabled);ye(n,{get min(){return t.choice.numMultipleTimesMinus},get max(){return t.choice.numMultipleTimesPluss},step:1,class:"mx-2",onpointerup:s,get disabled(){return u(l)},discrete:!0,get value(){return u(o)},set value(e){m(o,e,!0)}}),d(e,i)};Y(w,e=>{t.choice.useSlider&&e(I)}),T(()=>{Te(h,t.multiChoiceText),ne(v,u(l))}),d(e,i)};Y(v,e=>{t.choice.hideCounterUntilSelect&&0===t.choice.multipleUseVariable||e(f)}),d(e,h),c()}var jn=r('<img class="me-1" alt=""/>'),Dn=r('<img class="mx-1" alt=""/>'),Pn=r('<img class="mx-1" alt=""/>'),qn=r('<img class="ms-1" alt=""/>'),Vn=r("<!> <!> <!> <!> <!> <!> <!>",1),Ln=r('<div class="row m-0"><div class="col-12 p-0 m-0 d-flex align-items-center justify-center"><p class="m-0 d-flex align-items-center"><!></p></div></div>');function Nn(e,t){i(t,!0);let o=K(()=>po("privateTextIsOn",t.row,t.choice)),n=K(()=>po("privateFilterIsOn",t.row,t.choice)),l=K(()=>Bt.get(t.score.id)),r=K(()=>wo(t.choice.requireds)),s=K(()=>{let e=[];return e.push(`${t.score.afterText}`),t.score.discountIsOn&&t.score.discountShow&&void 0!==t.score.discountAfterText&&e.push(`${t.score.discountAfterText}`),e.join(" ")}),g=K(()=>{let e=[];return e.push(`${t.score.beforeText}`),t.score.discountIsOn&&t.score.discountShow&&void 0!==t.score.discountBeforeText&&e.push(`${t.score.discountBeforeText}`),e.join(" ")}),h=K(()=>t.score.hideValue?"":t.score.isRandom&&!t.score.setValue&&void 0!==t.score.maxValue?t.score.maxValue<0?`${u(v)} ~ ${u(f)}`:`${u(f)} ~ ${u(v)}`:`${u(m)}`),m=K(()=>{var e,o;let i=t.score.discountShow?t.score.discountScore??t.score.value:t.score.value;if(i=Math.abs(i),i=(null==(e=u(l))?void 0:e.allowFloat)?i%1==0?i:parseFloat(i.toFixed(u(l).decimalPlaces??2)):Math.floor(i),null==(o=u(l))?void 0:o.plussOrMinusAdded){return`${u(l).plussOrMinusInverted?u(b)?"-":"+":u(b)?"+":"-"}${i}`}return`${i}`}),v=K(()=>{var e,o;if(void 0!==t.score.maxValue){let i=t.score.maxValue<0,n=Math.abs(t.score.maxValue);if(n=(null==(e=u(l))?void 0:e.allowFloat)?n%1==0?n:parseFloat(n.toFixed(u(l).decimalPlaces??2)):Math.floor(n),null==(o=u(l))?void 0:o.plussOrMinusAdded){return`${u(l).plussOrMinusInverted?i?"-":"+":i?"+":"-"}${n}`}return`${n}`}return""}),f=K(()=>{var e,o;if(void 0!==t.score.minValue){let i=t.score.minValue<0,n=Math.abs(t.score.minValue);if(n=(null==(e=u(l))?void 0:e.allowFloat)?n%1==0?n:parseFloat(n.toFixed(u(l).decimalPlaces??2)):Math.floor(n),null==(o=u(l))?void 0:o.plussOrMinusAdded){return`${u(l).plussOrMinusInverted?i?"-":"+":i?"+":"-"}${n}`}return`${n}`}return""}),b=K(()=>t.score.discountShow?(t.score.discountScore??t.score.value)<0:t.score.value<0),w=K(()=>{var e;let i=[];return i.push(`font-family: ${u(o).scoreText}; font-size: ${u(o).scoreTextSize}%; text-align: ${u(o).scoreTextAlign};`),(null==(e=u(l))?void 0:e.pointColorsIsOn)?u(b)?i.push(`color: ${u(l).positiveColor};`):i.push(`color: ${u(l).negativeColor};`):i.push(`color: ${u(o).scoreTextColor};`),u(r)?t.choice.isActive&&u(n).selScoreTextColorIsOn&&i.push(`color: ${u(n).selFilterSTextColor}`):u(n).reqScoreTextColorIsOn&&i.push(`color: ${u(n).reqFilterSTextColor}`),i.join(" ")}),I=K(()=>{var e;return(null==(e=u(l))?void 0:e.negativeIconIsOn)&&u(b)}),y=K(()=>{var e,t;return u(I)?null==(e=u(l))?void 0:e.negativeImageSidePlacement:null==(t=u(l))?void 0:t.imageSidePlacement}),S=K(()=>{var e,t;return u(I)?null==(e=u(l))?void 0:e.negativeImageOnSide:null==(t=u(l))?void 0:t.imageOnSide}),C=K(()=>{var e,t;return(u(I)?null==(e=u(l))?void 0:e.negativeImage:null==(t=u(l))?void 0:t.image)??""}),x=K(()=>{var e,t;return(u(I)?null==(e=u(l))?void 0:e.negativeIconWidth:null==(t=u(l))?void 0:t.iconWidth)??0}),B=K(()=>{var e,t;return(u(I)?null==(e=u(l))?void 0:e.negativeIconHeight:null==(t=u(l))?void 0:t.iconHeight)??0}),$=K(()=>!u(y)&&!u(S)),A=K(()=>!u(y)&&u(S)),O=K(()=>u(y)&&!u(S)),k=K(()=>u(y)&&u(S));var M=R(),F=j(M),D=e=>{var t=Ln(),o=p(t),i=p(o),n=p(i),r=e=>{var t=Vn(),o=j(t),i=e=>{var t=jn();T(()=>{Ie(t,"src",u(C)),Te(t,`width: ${u(x)??""}px; height: ${u(B)??""}px;`)}),d(e,t)};Y(o,e=>{u($)&&e(i)});var n=J(o,2);a(n,()=>we.sanitize(u(g),Vt));var l=J(n,2),r=e=>{var t=Dn();T(()=>{Ie(t,"src",u(C)),Te(t,`width: ${u(x)??""}px; height: ${u(B)??""}px;`)}),d(e,t)};Y(l,e=>{u(A)&&e(r)});var c=J(l,2);a(c,()=>we.sanitize(u(h),Vt));var m=J(c,2),p=e=>{var t=Pn();T(()=>{Ie(t,"src",u(C)),Te(t,`width: ${u(x)??""}px; height: ${u(B)??""}px;`)}),d(e,t)};Y(m,e=>{u(O)&&e(p)});var v=J(m,2);a(v,()=>we.sanitize(u(s),Vt));var f=J(v,2),b=e=>{var t=qn();T(()=>{Ie(t,"src",u(C)),Te(t,`width: ${u(x)??""}px; height: ${u(B)??""}px;`)}),d(e,t)};Y(f,e=>{u(k)&&e(b)}),d(e,t)},c=e=>{var t=R(),o=j(t);a(o,()=>we.sanitize(`${u(g)} ${u(h)} ${u(s)}`,Vt)),d(e,t)};Y(n,e=>{var t;(null==(t=u(l))?void 0:t.iconIsOn)?e(r):e(c,!1)}),T(()=>Te(o,u(w))),d(e,t)};Y(F,e=>{(function(){if(t.score.showScore){if(void 0!==u(l)&&u(l).isNotShownObjects){if(void 0!==u(l).activatedId&&""!==u(l).activatedId){let e=kt.get(u(l).activatedId),t=Ft.get(u(l).activatedId);return void 0!==e?wo(e.requireds):void 0!==t?t.isTrue:fo(u(l).activatedId)}return!1}return!0}return!1})()&&wo(t.score.requireds)&&e(D)}),d(e,M),c()}var Wn=r('<div class="col"><!></div>'),En=r('<img alt=""/>'),Un=r('<img alt=""/>'),zn=r('<h3 class="m-0"><!></h3>'),Gn=r('<img alt=""/>'),Hn=r('<img alt=""/>'),_n=r("<p><!></p>"),Yn=r('<img alt=""/>'),Jn=r('<img alt=""/>'),Xn=r('<span class="d-column w-100 p-0 align-items-center"><!> <!> <span class="w-100"><!> <!> <!> <!> <!> <!> <!> <!> <!> <!></span> <div></div> <!></span>'),Zn=r('<img alt=""/>'),Kn=r('<img alt=""/>'),Qn=r('<h2 class="mb-0"><!></h2>'),el=r("<p><!></p>"),tl=r("<div></div> <!>",1),ol=r('<div class="col-12 text-center"><div></div> <!></div>'),il=r('<div class="col p-0 text-center"><!></div> <div class="col p-0 text-center"><!> <!> <!> <!> <!> <!> <!> <!> <!></div> <!>',1),nl=r('<h2 class="mb-0"><!></h2>'),ll=r("<p><!></p>"),rl=r("<div></div> <!>",1),al=r('<img alt=""/>'),sl=r('<img alt=""/>'),dl=r('<div class="col-12 text-center"><div></div> <!></div>'),cl=r('<div class="col p-0 text-center"><!> <!> <!> <!> <!> <!> <!> <!> <!></div> <div class="col p-0 text-center"><!></div> <!>',1),ul=r("<div><span><span><!></span></span></div>"),gl=r("<!> <!>",1);function hl(e,t){i(t,!0);const[o,n]=Ce(),l=()=>xe(Jt,"$winWidth",o),r=v(t,"preloadImages",3,!1),s=[],h={choice:null,row:null,context:"",prevText:""};let f=K(()=>po("privateBackgroundIsOn",t.row,t.choice)),b=K(()=>po("privateFilterIsOn",t.row,t.choice)),w=K(()=>po("privateMultiChoiceIsOn",t.row,t.choice)),S=K(()=>po("privateObjectImageIsOn",t.row,t.choice)),C=K(()=>po("privateObjectIsOn",t.row,t.choice)),x=K(()=>po("privateTextIsOn",t.row,t.choice)),B=K(()=>u(S).objectImageBoxWidth??50),$=g("none"),O=!1,k=K(()=>wo(t.choice.requireds)),M=K(()=>t.choice.isActive),F=K(()=>u(C).objectHeight),D=K(()=>{if(t.row.isResultRow){const e=At.get(t.choice.id);if(void 0!==e)return e.row}return t.row}),P=K(()=>{let e=[];return e.push(`font-family: ${u(x).objectTitle};font-size: ${u(x).objectTitleTextSize}%;text-align: ${u(x).objectTitleAlign};`),!u(k)&&u(b).reqCTitleColorIsOn?e.push(`color: ${u(b).reqFilterCTitleColor};`):u(M)&&u(b).selCTitleColorIsOn?e.push(`color: ${u(b).selFilterCTitleColor};`):e.push(`color: ${u(x).objectTitleColor};`),u(C).titlePaddingIsOn&&e.push(`padding: ${u(C).objectTextPadding}px;`),e.join(" ")}),q=K(()=>`font-family: ${u(w).multiChoiceTextFont}; color: ${u(x).scoreTextColor}; font-size: ${u(w).multiChoiceTextSize}%; align-content: center;`),V=K(()=>`font-size: ${u(w).multiChoiceCounterSize}%; color: ${u(x).scoreTextColor};`),L=K(()=>!t.choice.hideMultipleCounter||u(k)),N=K(()=>{let e=[];return e.push(`font-family: ${u(x).objectText};text-align: ${u(x).objectTextAlign};font-size: ${u(x).objectTextTextSize}%;white-space: pre-line;`),!u(k)&&u(b).reqCTextColorIsOn?e.push(`color: ${u(b).reqFilterCTextColor};`):u(M)&&u(b).selCTextColorIsOn?e.push(`color: ${u(b).selFilterCTextColor};`):e.push(`color: ${u(x).objectTextColor};`),e.push(`padding: ${u(C).objectTextPadding}px;`),e.join(" ")}),W=K(()=>{const e=u(C).objectBorderRadiusIsPixels?"px":"%";let o=0,i=0,n=0,l=[];if(u(C).objectBorderImage&&l.push(`border-image: url('${u(C).objectBorderImage}') ${u(C).objectBorderImageSliceTop} ${u(C).objectBorderImageSliceRight} ${u(C).objectBorderImageSliceBottom} ${u(C).objectBorderImageSliceLeft} / ${u(C).objectBorderImageWidth}px ${u(C).objectBorderImageRepeat}; border-style: solid; padding: ${u(C).objectBorderImageWidth}px;`),u(f).objectBackgroundImage&&(l.push(`background-image: url('${u(f).objectBackgroundImage}'); ${u(f).isObjectBackgroundRepeat?"background-repeat: repeat;":u(f).isObjectBackgroundFitIn?"background-size: 100% 100%;":"background-size: cover;"}`),o=l.length),u(f).objectBgColorIsOn&&(l.push(`background-color: ${u(f).objectBgColor};`),i=l.length),l.push(`margin: ${u(C).objectMargin}px;`),l.push(`border-radius: ${u(C).objectBorderRadiusTopLeft}${e} ${u(C).objectBorderRadiusTopRight}${e} ${u(C).objectBorderRadiusBottomRight}${e} ${u(C).objectBorderRadiusBottomLeft}${e};`),u(C).objectOverflowIsOn&&l.push("overflow: hidden;"),u(C).objectBorderIsOn||u(M)&&u(b).selBorderColorIsOn||!u(k)&&u(b).reqBorderColorIsOn){let e=u(C).objectBorderColor;!u(k)&&u(b).reqBorderColorIsOn?e=u(b).reqFilterBorderColor:u(M)&&u(b).selBorderColorIsOn&&(e=u(b).selFilterBorderColor),l.push(`border: ${u(C).objectBorderWidth}px ${u(C).objectBorderStyle} ${e};`)}return u(C).objectDropShadowIsOn&&(u(C).objectUseBoxShadowIsOn?l.push(`box-shadow: ${u(C).objectDropShadowH}px ${u(C).objectDropShadowV}px ${u(C).objectDropShadowBlur}px ${u(C).objectDropShadowColor};`):(n=l.length,l.push(`filter: drop-shadow(${u(C).objectDropShadowH}px ${u(C).objectDropShadowV}px ${u(C).objectDropShadowBlur}px ${u(C).objectDropShadowColor})`))),0===n&&(l.push("filter:"),n=l.length),u(k)?(u(M)?(u(b).selFilterBlurIsOn&&l.push(` blur(${u(b).selFilterBlur}px)`),u(b).selFilterBrightIsOn&&l.push(` brightness(${u(b).selFilterBright}%)`),u(b).selFilterContIsOn&&l.push(` contrast(${u(b).selFilterCont}%)`),u(b).selFilterGrayIsOn&&l.push(` grayscale(${u(b).selFilterGray}%)`),u(b).selFilterHueIsOn&&l.push(` hue-rotate(${u(b).selFilterHue}deg)`),u(b).selFilterInvertIsOn&&l.push(` invert(${u(b).selFilterInvert}%)`),u(b).selFilterOpacIsOn&&l.push(` opacity(${u(b).selFilterOpac}%)`),u(b).selFilterSaturIsOn&&l.push(` saturate(${u(b).selFilterSatur})`),u(b).selFilterSepiaIsOn&&l.push(` sepia(${u(b).selFilterGray}%)`),l.length===n?l.splice(n-1,1):l.push(";"),u(b).selBgColorIsOn&&(0!==i&&l.splice(i-1,1),u(b).selOverlayOnImage||0!==o&&l.splice(o-1,1),l.push(`background-color: ${u(b).selFilterBgColor};`)),u(C).objectGradientIsOn&&l.push(`background-image: linear-gradient('${u(C).objectGradientOnSelect}');`)):(u(b).unselFilterBlurIsOn&&l.push(` blur(${u(b).unselFilterBlur}px)`),u(b).unselFilterBrightIsOn&&l.push(` brightness(${u(b).unselFilterBright}%)`),u(b).unselFilterContIsOn&&l.push(` contrast(${u(b).unselFilterCont}%)`),u(b).unselFilterGrayIsOn&&l.push(` grayscale(${u(b).unselFilterGray}%)`),u(b).unselFilterHueIsOn&&l.push(` hue-rotate(${u(b).unselFilterHue}deg)`),u(b).unselFilterInvertIsOn&&l.push(` invert(${u(b).unselFilterInvert}%)`),u(b).unselFilterOpacIsOn&&l.push(` opacity(${u(b).unselFilterOpac}%)`),u(b).unselFilterSaturIsOn&&l.push(` saturate(${u(b).unselFilterSatur})`),u(b).unselFilterSepiaIsOn&&l.push(` sepia(${u(b).unselFilterGray}%)`),l.length===n?l.splice(n-1,1):l.push(";"),u(C).objectGradientIsOn&&l.push(`background-image: linear-gradient('${u(C).objectGradient}');`)),app.isPointerCursor&&!t.choice.isNotSelectable&&(!t.choice.isSelectableMultiple||t.choice.allowSelectByClick&&0===t.choice.multipleUseVariable)&&l.push("cursor: pointer;")):(u(b).reqFilterBlurIsOn&&l.push(` blur(${u(b).reqFilterBlur}px)`),u(b).reqFilterBrightIsOn&&l.push(` brightness(${u(b).reqFilterBright}%)`),u(b).reqFilterContIsOn&&l.push(` contrast(${u(b).reqFilterCont}%)`),u(b).reqFilterGrayIsOn&&l.push(` grayscale(${u(b).reqFilterGray}%)`),u(b).reqFilterHueIsOn&&l.push(` hue-rotate(${u(b).reqFilterHue}deg)`),u(b).reqFilterInvertIsOn&&l.push(` invert(${u(b).reqFilterInvert}%)`),u(b).reqFilterOpacIsOn&&l.push(` opacity(${u(b).reqFilterOpac}%)`),u(b).reqFilterSaturIsOn&&l.push(` saturate(${u(b).reqFilterSatur})`),u(b).reqFilterSepiaIsOn&&l.push(` sepia(${u(b).reqFilterGray}%)`),l.length===n?l.splice(n-1,1):l.push(";"),u(b).reqBgColorIsOn&&(0!==i&&l.splice(i-1,1),u(b).reqOverlayOnImage||0!==o&&l.splice(o-1,1),l.push(`background-color: ${u(b).reqFilterBgColor};`)),u(C).objectGradientIsOn&&l.push(`background-image: linear-gradient('${u(C).objectGradientOnReq}');`)),l.join(" ")}),E=K(()=>{let e=[];const o=u(S).objectImgBorderRadiusIsPixels?"px":"%";return e.push(`width: ${u(S).objectImageWidth}%; margin-top: ${u(S).objectImageMarginTop}%; margin-bottom: ${u(S).objectImageMarginBottom}%;`),u(S).objectImgObjectFillIsOn&&e.push(`object-fit: ${u(S).objectImgObjectFillStyle}; height: ${t.row.objectImgObjectFillHeight}px;`),e.push(`border-radius: ${u(S).objectImgBorderRadiusTopLeft}${o} ${u(S).objectImgBorderRadiusTopRight}${o} ${u(S).objectImgBorderRadiusBottomRight}${o} ${u(S).objectImgBorderRadiusBottomLeft}${o};`),u(S).objectImgOverflowIsOn&&e.push("overflow: hidden;"),u(S).objectImgBorderIsOn&&e.push(`border: ${u(S).objectImgBorderWidth}px ${u(S).objectImgBorderStyle} ${u(S).objectImgBorderColor};`),e.join(" ")}),U=K(()=>{let e=[];return e.push(`font-family: ${u(x).scoreText}; font-size: ${u(x).scoreTextSize}%; text-align: ${u(x).scoreTextAlign};`),e.push(`color: ${u(x).scoreTextColor};`),u(k)?t.choice.isActive&&u(b).selScoreTextColorIsOn&&e.push(`color: ${u(b).selFilterSTextColor}`):u(b).reqScoreTextColorIsOn&&e.push(`color: ${u(b).reqFilterSTextColor}`),e.join(" ")}),z=[];function G(e,t,o,i){let n=!1;if(t.activateOtherChoice&&void 0!==t.activateThisChoice&&-1===s.indexOf(e.id)&&t.activateThisChoice.split(",").some(t=>t.split("/ON#")[0]===e.id)&&(s.push(e.id),n=!0),t.isSelectableMultiple){if(t.isMultipleUseVariable&&void 0!==t.numMultipleTimesMinus&&void 0!==t.numMultipleTimesPluss){let n=t.multipleUseVariable;if(i>0)for(let l=0;l<i;l++)ne(t,o),n++,e.isAllowDeselect||(t.numMultipleTimesMinus+=1);else if(i<0)for(let l=0;l>-1*i;l++)le(t,o),n--,e.isAllowDeselect||(t.numMultipleTimesPluss-=1);if(t.multipleUseVariable!==n){const o=Math.abs(t.numMultipleTimesMinus-t.numMultipleTimesPluss);if(t.numMultipleTimesMinus>t.numMultipleTimePluss){const n=xt.get(t.id);i>0?(t.numMultipleTimesMinus-=o,void 0!==n?n.multiple+=o:xt.set(t.id,{multiple:o,isAllowDeselect:e.isAllowDeselect??!1})):i<0&&(void 0!==n?n.multiple-=o:xt.set(t.id,{multiple:-o,isAllowDeselect:e.isAllowDeselect??!1}))}}}}else t.isActive||te(t,o),e.isAllowDeselect||(t.forcedActivated=!0),t.activatedFrom??(t.activatedFrom=0),n||t.activatedFrom++;t.isActive||(delete t.forcedActivated,xt.set(t.id,{multiple:i,isAllowDeselect:e.isAllowDeselect??!1}))}function H(e,t,o,i){if(t.activateOtherChoice&&void 0!==t.activateThisChoice&&-1===s.indexOf(e.id)&&t.activateThisChoice.split(",").some(t=>t.split("/ON#")[0]===e.id)&&s.push(e.id),t.isSelectableMultiple){if(t.isMultipleUseVariable&&void 0!==t.numMultipleTimesMinus&&void 0!==t.numMultipleTimesPluss)if(t.isActive){if(i>0)for(let n=0;n<i;n++)e.isAllowDeselect||(t.numMultipleTimesMinus-=1),e.isNotDeactivate||le(t,o);else if(i<0)for(let n=0;n>-1*i;n++)e.isAllowDeselect||(t.numMultipleTimesPluss+=1),e.isNotDeactivate||ne(t,o)}else{const o=xt.get(t.id);let n=0;void 0!==o?(n=o.multiple-i,0===n?xt.delete(t.id):xt.set(t.id,{multiple:n,isAllowDeselect:e.isAllowDeselect??!1})):xt.delete(t.id)}}else void 0!==t.activatedFrom?(t.activatedFrom--,t.activatedFrom<=0&&(t.isActive?(delete t.activatedFrom,delete t.forcedActivated,e.isNotDeactivate||oe(t,o)):xt.delete(t.id))):(delete t.forcedActivated,!e.isNotDeactivate&&t.isActive&&oe(t,o))}function X(e){if(void 0!==e.activateThisChoice){let t=e.activateThisChoice.split(","),o=new Map;for(let e=0;e<t.length;e++){let[i,n="0"]=t[e].split("/ON#"),l=parseInt(n),r=Ot.get(i);if(void 0!==r)for(let e=0;e<r.elements.length;e++)Ct.has(r.elements[e])||o.set(r.elements[e],l);else Ct.has(i)||o.set(i,l)}let i=[...o.keys()],n=Math.min(i.length,e.numActivateRandom??0),l=n;for(let e=i.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[i[e],i[t]]=[i[t],i[e]]}let r=[];for(let a=0;a<n;){let t=i[a],s=At.get(t);if(void 0!==s){let d=s.row,c=s.choice;if(G(e,c,d,o.get(t)??0),!c.isActive){if(r.length<n&&i.length>l){i[a]=i[l++],void 0!==c.activatedFrom&&(c.activatedFrom--,0===c.activatedFrom&&xt.delete(c.id));continue}break}r.push(t)}a++}e.isSelectableMultiple?(void 0===e.activatedRandomMul&&(e.activatedRandomMul=[]),e.activatedRandomMul[e.multipleUseVariable-1]=[...r]):e.activatedRandom=[...r]}}function Z(e,t,o,i=new Set){Array.from(Ct.entries()).forEach(([n])=>{const l=At.get(n);if(void 0!==l){const n=l.row,r=l.choice,a=new y;let s=!1;for(let o=0;o<r.scores.length;o++){const l=r.scores[o];if(!l.isNotRecalculatable){const o=Bt.get(l.id);if(void 0!==o){if(e.discountOther&&l.isChangeDiscount&&void 0!==l.tmpDisScore){if(o.belowZeroNotAllowed&&o.startingSum+l.tmpDisScore<0)if(r.forcedActivated&&(delete r.forcedActivated,r.isAllowDeselect||xt.set(r.id,{multiple:r.multipleUseVariable})),r.isSelectableMultiple&&r.isMultipleUseVariable)for(let e=0;e<r.multipleUseVariable;e++)r.isActive&&le(r,n);else r.isActive&&oe(r,n);else o.startingSum+=l.tmpDisScore,a.set(l.id,l.tmpDisScore),delete l.isChangeDiscount,delete l.tmpDisScore;0===z.length?z.push(`Scores Updated On: ${r.title}`):z.push(`, ${r.title}`),s=e.id!==r.id}if(!i.has(l.idx)){const i=t.get(l.id)??0;if(r.isActive){const t=wo(l.requireds),d=new y(JSON.parse(JSON.stringify([...Ct])));d.delete(e.id),n.currentChoices-=1,o.startingSum+=i;const c=wo(l.requireds,d);if(n.currentChoices+=1,o.startingSum-=i,c!==t){let t=l.discountIsOn&&void 0!==l.discountScore?l.discountScore:l.value;if(t=o.allowFloat?t:Math.floor(t),c)if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus){for(let e=r.multipleUseVariable-1;e>=0;e--)void 0!==l.isActiveMul&&l.isActiveMul[e]&&(o.belowZeroNotAllowed&&o.startingSum+t<0?r.forcedActivated&&r.isActive?(r.forcedActivated=!1,r.numMultipleTimesMinus--,le(r,n),r.forcedActivated=!0):le(r,n):(o.startingSum+=t,a.set(l.id,t),l.isActiveMul[e]=!1))}else r.isSelectableMultiple||l.isActive&&(o.belowZeroNotAllowed&&o.startingSum+t<0?(r.forcedActivated&&delete r.forcedActivated,oe(r,n)):(o.startingSum+=t,a.set(l.id,t),delete l.isActive));else l.isActive||(o.belowZeroNotAllowed&&o.startingSum-t<0?(r.forcedActivated&&delete r.forcedActivated,oe(r,n)):(o.startingSum-=t,a.set(l.id,t),l.isActive=!0));0===z.length?z.push(`Scores Updated On: ${r.title}`):z.push(`, ${r.title}`),s=e.id!==r.id}}}}}}s&&Z(r,a,++o,i)}}),z.length>0&&!app.hideScoresUpdated&&(Et.labelText=z.join(""),Et.isOpen=!0),z.splice(0)}function Q(e,t,o,i=new Set){Array.from(Ct.entries()).forEach(([n])=>{const l=At.get(n);if(void 0!==l){const n=l.row,r=l.choice,a=new y;let s=!1;for(let o=0;o<r.scores.length;o++){const l=r.scores[o];if(!l.isNotRecalculatable){const o=Bt.get(l.id);if(void 0!==o){if(e.discountOther&&l.isChangeDiscount&&void 0!==l.tmpDisScore&&r.id!==e.id){const e=r.multipleUseVariable;if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus){for(let t=e-1;t>=0;t--)r.isActive&&(o.belowZeroNotAllowed&&o.startingSum+l.tmpDisScore<0?r.forcedActivated&&r.isActive?(r.forcedActivated=!1,r.numMultipleTimesMinus--,le(r,n),r.forcedActivated=!0):le(r,n):o.startingSum+=l.tmpDisScore);r.isActive&&(a.set(l.id,l.tmpDisScore),delete l.isChangeDiscount,delete l.tmpDisScore)}else r.isSelectableMultiple||(o.belowZeroNotAllowed&&o.startingSum+l.tmpDisScore<0?(r.forcedActivated&&delete r.forcedActivated,oe(r,n)):(o.startingSum+=l.tmpDisScore,a.set(l.id,l.tmpDisScore),delete l.isChangeDiscount,delete l.tmpDisScore));0===z.length?z.push(`Scores Updated On: ${r.title}`):z.push(`, ${r.title}`),s=!0}if(!i.has(l.idx)){const d=t.get(l.id)??0;if(r.isActive&&!l.isChanged){const t=wo(l.requireds),c=new y(JSON.parse(JSON.stringify([...Ct])));c.delete(e.id),n.currentChoices-=1,o.startingSum+=d;const u=wo(l.requireds,c);if(n.currentChoices+=1,o.startingSum-=d,u!==t){let e=l.discountIsOn&&void 0!==l.discountScore?l.discountScore:l.value;if(e=o.allowFloat?e:Math.floor(e),u)if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus){for(let t=r.multipleUseVariable-1;t>=0;t--)void 0!==l.isActiveMul&&l.isActiveMul[t]&&(o.belowZeroNotAllowed&&o.startingSum+e<0?r.forcedActivated&&r.isActive?(r.forcedActivated=!1,r.numMultipleTimesMinus--,le(r,n),r.forcedActivated=!0):le(r,n):(o.startingSum+=e,a.set(l.id,e),l.isActiveMul[t]=!1))}else r.isSelectableMultiple||l.isActive&&(o.belowZeroNotAllowed&&o.startingSum+e<0?(r.forcedActivated&&delete r.forcedActivated,oe(r,n)):(o.startingSum+=e,a.set(l.id,e),delete l.isActive));else l.isActive||(o.belowZeroNotAllowed&&o.startingSum-e<0?(r.forcedActivated&&delete r.forcedActivated,oe(r,n)):(o.startingSum-=e,a.set(l.id,e),l.isActive=!0));0===z.length?z.push(`Scores Updated On: ${r.title}`):z.push(`, ${r.title}`),s=!0,i.add(l.idx)}}}}}}s&&Q(r,a,++o,i)}}),z.length>0&&!app.hideScoresUpdated&&(Et.labelText=z.join(""),Et.isOpen=!0),z.splice(0)}function ee(){let e=!1;Array.from(xt.entries()).forEach(([t,o])=>{const i=At.get(t);if(void 0!==i){const n=i.row,l=i.choice;l.isActive||(te(l,n),l.isActive&&(xt.delete(t),e=!0,o.isAllowDeselect||(l.forcedActivated=!0)))}}),e&&ee()}function te(e,o){let i=o;if(o.isResultRow){const t=At.get(e.id);void 0!==t&&(i=t.row)}e.isSelectableMultiple?e.id===t.choice.id&&e.allowSelectByClick&&0===e.multipleUseVariable&&ne(e,i):!wo(e.requireds)||o.isInfoRow||e.isNotSelectable||e.forcedActivated||(e.isActive?e.selectOnce||oe(e,i):ie(e,i))}function oe(e,t){if(ko(e,!1)){const o=()=>{var o,i,n,l,r,a;const s=new y;for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(wo(o.requireds)&&o.isActive||o.isActive){const e=Bt.get(o.id);if(void 0!==e){let t=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value;t=e.allowFloat?t:Math.floor(t),e.startingSum+=t;let i=s.get(o.id);void 0!==i?s.set(o.id,-t+i):s.set(o.id,-t),delete o.isActive,delete o.setValue}}}if(e.activateOtherChoice&&void 0!==e.activateThisChoice)if(e.isActivateRandom&&void 0!==e.activatedRandom){for(let t=0;t<e.activatedRandom.length;t++){const o=At.get(e.activatedRandom[t]);if(void 0!==o){const t=o.row,i=o.choice;H(e,i,t,0)}}delete e.activatedRandom}else{const t=e.activateThisChoice.split(",");for(let o=0;o<t.length;o++){const i=t[o].split("/ON#"),n=i.length>1?parseInt(i[1]):0,l=At.get(i[0]);if(void 0!==l){const t=l.row,o=l.choice;H(e,o,t,n)}else{const t=Ot.get(i[0]);if(void 0!==t){const o=t.elements;for(let t=0;t<o.length;t++){const i=At.get(o[t]);if(void 0!==i){const t=i.row,o=i.choice;H(e,o,t,n)}}}}}}if(e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue)if(e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let n=0;n<e.discountRows.length;n++){const l=$t.get(e.discountRows[n]);if(void 0!==l)for(let n=0;n<l.objects.length;n++){const r=l.objects[n];for(let t=0;t<r.scores.length;t++){const n=r.scores[t];n.isNotDiscountable||0!==(null==(o=e.discountPointTypes)?void 0:o.length)&&-1===((null==(i=e.discountPointTypes)?void 0:i.indexOf(n.id))??-1)||$o(e,n)}t.add(r.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const i=At.get(e.discountChoices[o]);if(void 0!==i){const o=i.choice;for(let r=0;r<o.scores.length;r++){const o=i.choice.scores[r];o.isNotDiscountable||0!==(null==(n=e.discountPointTypes)?void 0:n.length)&&-1===((null==(l=e.discountPointTypes)?void 0:l.indexOf(o.id))??-1)||t.has(o.idx)||$o(e,o)}}}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Ot.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=At.get(o.elements[t]);if(void 0!==i)for(let t=0;t<i.choice.scores.length;t++){const o=i.choice.scores[t];o.isNotDiscountable||0!==(null==(r=e.discountPointTypes)?void 0:r.length)&&-1===((null==(a=e.discountPointTypes)?void 0:a.indexOf(o.id))??-1)||$o(e,o)}}}if(e.isActive=!1,t.currentChoices-=1,Ct.delete(e.id),Array.from(Ct.entries()).forEach(([t,o])=>{const i=At.get(t);if(void 0!==i){const t=i.row,n=i.choice;if(n.id!==e.id&&!wo(n.requireds))if(n.forcedActivated&&(delete n.forcedActivated,n.isAllowDeselect||xt.set(n.id,{multiple:o.multiple})),0===o.multiple)n.isActive&&oe(n,t);else if(o.multiple>0)for(let e=0;e<o.multiple;e++)n.isActive&&le(n,t)}}),e.multiplyPointtypeIsOnCheck&&void 0!==e.pointTypeToMultiply){let t=0;for(let o=0;o<e.pointTypeToMultiply.length;o++){let i=Bt.get(e.pointTypeToMultiply[o]);if(void 0!==i){for(let n=Pt.length-1;n>=0;n--){let l=Pt[n];if(l.multiplyPointtypeIsOnCheck&&void 0!==l.startingSumAtMultiply){let e=l.startingSumAtMultiply[o].value*l.startingSumAtMultiply[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=l.startingSumAtMultiply[o].value}if(l.dividePointtypeIsOnCheck&&void 0!==l.startingSumAtDivide){let e=l.startingSumAtDivide[o].value/l.startingSumAtDivide[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=l.startingSumAtDivide[o].value}if(l.id===e.id){t=n;break}}for(let e=t+1;e<Pt.length;e++){let t=Pt[e];t.multiplyPointtypeIsOnCheck&&void 0!==t.startingSumAtMultiply&&(t.startingSumAtMultiply[o].value=i.startingSum,i.startingSum*=t.startingSumAtMultiply[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)),t.dividePointtypeIsOnCheck&&void 0!==t.startingSumAtDivide&&(t.startingSumAtDivide[o].value=i.startingSum,i.startingSum/=t.startingSumAtDivide[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum))}}}delete e.multiplyPointtypeIsOnCheck,delete e.startingSumAtMultiply,e.dividePointtypeIsOnCheck||Pt.splice(t,1)}if(e.dividePointtypeIsOnCheck&&void 0!==e.pointTypeToDivide){let t=0;for(let o=0;o<e.pointTypeToDivide.length;o++){let i=Bt.get(e.pointTypeToDivide[o]);if(void 0!==i){for(let n=Pt.length-1;n>=0;n--){let l=Pt[n];if(l.multiplyPointtypeIsOnCheck&&void 0!==l.startingSumAtMultiply){let e=l.startingSumAtMultiply[o].value*l.startingSumAtMultiply[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=l.startingSumAtMultiply[o].value}if(l.dividePointtypeIsOnCheck&&void 0!==l.startingSumAtDivide){let e=l.startingSumAtDivide[o].value/l.startingSumAtDivide[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=l.startingSumAtDivide[o].value}if(l.id===e.id){t=n;break}}for(let e=t+1;e<Pt.length;e++){let t=Pt[e];t.multiplyPointtypeIsOnCheck&&void 0!==t.startingSumAtMultiply&&(t.startingSumAtMultiply[o].value=i.startingSum,i.startingSum*=t.startingSumAtMultiply[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)),t.dividePointtypeIsOnCheck&&void 0!==t.startingSumAtDivide&&(t.startingSumAtDivide[o].value=i.startingSum,i.startingSum/=t.startingSumAtDivide[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum))}}}delete e.dividePointtypeIsOnCheck,delete e.startingSumAtDivide,Pt.splice(t,1)}if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Ft.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!1:"2"===e.changeType?o.isTrue=!0:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const o=$t.get(e.idOfAllowChoice[t]);if(void 0!==o&&(o.allowedChoices-=e.numbAddToAllowChoice,o.allowedChoices>0&&o.currentChoices>=o.allowedChoices))for(let e=0;e<o.objects.length;e++){const t=o.objects[e];if(t.isActive&&!t.forcedActivated)if(t.isSelectableMultiple){let e=t.multipleUseVariable;for(let i=0;i<e;i++)le(t,o)}else oe(t,o);if(o.allowedChoices>=o.currentChoices)break}}if(e.textfieldIsOn&&void 0!==e.idOfTheTextfieldWord&&void 0!==e.wordChangeSelect){const t=Mt.get(e.idOfTheTextfieldWord);void 0!==t&&(t.replaceText=void 0===e.wordChangeDeselect?"":e.wordChangeDeselect)}if(e.isImageUpload&&void 0!==e.defaultImage&&(e.image=e.defaultImage),e.backpackBtnRequirement&&void 0!==app.btnBackpackIsOn&&(app.btnBackpackIsOn-=1),e.showAllAddons&&void 0!==app.showAllAddons&&(app.showAllAddons-=1),e.changeBackground)if(e.changeBgImage){if(void 0!==app.bgImageStack){const t=app.bgImageStack.findIndex(t=>t.id===e.id);-1!==t&&app.bgImageStack.splice(t,1);const o=app.bgImageStack.length;o>0?app.styling.backgroundImage=app.bgImageStack[o-1].data:(app.styling.backgroundImage=app.defaultBgImage??"",delete app.bgImageStack)}}else if(void 0!==e.changedBgColorCode&&void 0!==app.bgColorStack){const t=app.bgColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.bgColorStack.splice(t,1);const o=app.bgColorStack.length;o>0?app.styling.backgroundColor=app.bgColorStack[o-1].data:(app.styling.backgroundColor=app.defaultBgColor??"#FFFFFFFF",delete app.bgColorStack)}if(e.changePointBar){if(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&void 0!==app.barBgColorStack){const t=app.barBgColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barBgColorStack.splice(t,1);const o=app.barBgColorStack.length;o>0?app.styling.barBackgroundColor=app.barBgColorStack[o-1].data:(app.styling.barBackgroundColor=app.defaultBarBgColor??"#FFFFFFFF",delete app.barBgColorStack)}if(e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&void 0!==app.barIconColorStack){const t=app.barIconColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barIconColorStack.splice(t,1);const o=app.barIconColorStack.length;o>0?app.styling.barIconColor=app.barIconColorStack[o-1].data:(app.styling.barIconColor=app.defaultBarIconColor??"#0000008A",delete app.barIconColorStack)}if(e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&void 0!==app.barTextColorStack){const t=app.barTextColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barTextColorStack.splice(t,1);const o=app.barTextColorStack.length;o>0?app.styling.barTextColor=app.barTextColorStack[o-1].data:(app.styling.barTextColor=app.defaultBarIconColor??"#000000",delete app.barTextColorStack)}}if(e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){const t=n.choice;if(fi(t,e.id),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){fi(t.addons[o],e.id)}continue}const l=$t.get(i);if(void 0!==l){fi(l,e.id);continue}const r=Ot.get(i[0]);if(void 0!==r){const t=r.rowElements;for(let i=0;i<t.length;i++){const o=$t.get(t[i]);void 0!==o&&fi(o,e.id)}const o=r.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){fi(t.choice,e.id)}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){wi(n.choice,e.id);continue}const l=$t.get(i);if(void 0!==l){wi(l,e.id);continue}const r=Ot.get(i[0]);if(void 0!==r){const t=r.rowElements;for(let i=0;i<t.length;i++){const o=$t.get(t[i]);void 0!==o&&wi(o,e.id)}const o=r.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){wi(t.choice,e.id)}}continue}}}if(e.setBgmIsOn&&Lt&&e.bgmId&&(Nt.bgmIsPlaying=!1,yo(e,e.bgmId,0)),e.muteBgm&&Lt){const e=A(Lt);app.isMute=!1,e&&"function"==typeof e.unMute&&e.unMute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=$t.get(e.hiddenContentsRow[t]);if(void 0!==o)for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":delete o.objectTitleRemoved;break;case"2":delete o.objectImageRemoved;break;case"3":delete o.objectTextRemoved;break;case"4":delete o.objectScoreRemoved;break;case"5":delete o.objectRequirementRemoved;break;case"6":delete o.addonTitleRemoved;break;case"7":delete o.addonImageRemoved;break;case"8":delete o.addonTextRemoved}}delete e.tempSlots,Z(e,s,0),ee()};-1===s.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,o()},1e3*app.fadeTransitionTime)):o()),0===s.indexOf(e.id)&&s.splice(0)}}function ie(e,o){let i=!0;if(o.allowedChoices>0&&o.currentChoices>=o.allowedChoices){let e=0;for(let t=0;t<o.objects.length;t++){const i=o.objects[t];if(i.isActive){if(!i.forcedActivated){if(i.isSelectableMultiple){let e=i.multipleUseVariable;for(let t=0;t<e;t++)te(i,o)}else te(i,o);break}e++}}e>=o.allowedChoices&&(i=!1)}if(i){for(let t=0;t<e.scores.length;t++){const o=e.scores[t],i=Bt.get(o.id);void 0!==i&&o.isRandom&&!o.setValue&&void 0!==o.maxValue&&void 0!==o.minValue&&(o.value=Math.floor(Math.random()*(o.maxValue-o.minValue+1))+o.minValue,o.value=i.allowFloat?o.value:Math.floor(o.value),o.setValue=!0)}if(ko(e,!0)){const i=()=>{var i,n,l,r,a,s;const d=new y;if(e.isActive=!0,Ct.set(e.id,{multiple:0}),o.currentChoices+=1,e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue)if(e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let o=0;o<e.discountRows.length;o++){const l=$t.get(e.discountRows[o]);if(void 0!==l)for(let o=0;o<l.objects.length;o++){const r=l.objects[o];for(let t=0;t<r.scores.length;t++){const o=r.scores[t];o.isNotDiscountable||0!==(null==(i=e.discountPointTypes)?void 0:i.length)&&-1===(null==(n=e.discountPointTypes)?void 0:n.indexOf(o.id))||Ao(e,o)}t.add(r.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const t=At.get(e.discountChoices[o]);if(void 0!==t){const o=t.choice;for(let t=0;t<o.scores.length;t++){const i=o.scores[t];i.isNotDiscountable||0!==(null==(l=e.discountPointTypes)?void 0:l.length)&&-1===(null==(r=e.discountPointTypes)?void 0:r.indexOf(i.id))||Ao(e,i)}}}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Ot.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=At.get(o.elements[t]);if(void 0!==i)for(let t=0;t<i.choice.scores.length;t++){const o=i.choice.scores[t];o.isNotDiscountable||0!==(null==(a=e.discountPointTypes)?void 0:a.length)&&-1===(null==(s=e.discountPointTypes)?void 0:s.indexOf(o.id))||Ao(e,o)}}}for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(wo(o.requireds)&&!o.isActive){const e=Bt.get(o.id);if(void 0!==e){let t=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value;t=e.allowFloat?t:Math.floor(t),e.startingSum-=t,o.isActive=!0;let i=d.get(o.id);void 0!==i?d.set(o.id,t+i):d.set(o.id,t)}}}if(e.duplicateRow&&void 0!==e.duplicateRowId&&void 0!==e.duplicateRowPlace&&qo(e),e.activateOtherChoice&&void 0!==e.activateThisChoice)if(e.isActivateRandom)X(e);else{const t=e.activateThisChoice.split(",");for(let o=0;o<t.length;o++){const i=t[o].split("/ON#"),n=i.length>1?parseInt(i[1]):0,l=At.get(i[0]);if(void 0!==l){const t=l.row,o=l.choice;G(e,o,t,n)}else{const t=Ot.get(i[0]);if(void 0!==t){const o=t.elements;for(let t=0;t<o.length;t++){const i=At.get(o[t]);if(void 0!==i){const t=i.row,o=i.choice;G(e,o,t,n)}}}}}}if(e.deactivateOtherChoice&&void 0!==e.deactivateThisChoice){const t=e.deactivateThisChoice.split(",");for(let e=0;e<t.length;e++){const o=t[e].split("/ON#"),i=o.length>1?parseInt(o[1]):0,n=At.get(o[0]);if(void 0!==n){const e=n.row,t=n.choice;if(t.isActive)if(t.isSelectableMultiple&&t.isMultipleUseVariable)for(let o=0;o<i;o++)le(t,e);else oe(t,e)}else{const e=Ot.get(o[0]);if(void 0!==e){const t=e.elements;for(let e=0;e<t.length;e++){const o=At.get(t[e]);if(void 0!==o){const e=o.row,t=o.choice;if(t.isActive)if(t.isSelectableMultiple&&t.isMultipleUseVariable)for(let o=0;o<i;o++)le(t,e);else oe(t,e)}}}}}}if(Array.from(Ct.entries()).forEach(([t,o])=>{const i=At.get(t);if(void 0!==i){const t=i.row,n=i.choice;if(n.id!==e.id&&!wo(n.requireds))if(n.forcedActivated&&(delete n.forcedActivated,n.isAllowDeselect||xt.set(n.id,{multiple:o.multiple})),0===o.multiple)n.isActive&&oe(n,t);else if(o.multiple>0)for(let e=0;e<o.multiple;e++)n.isActive&&le(n,t)}}),e.multiplyPointtypeIsOn&&void 0!==e.pointTypeToMultiply&&void 0!==e.multiplyWithThis){let t=0;e.multiplyPointtypeIsOnCheck=!0,"object"!=typeof e.startingSumAtMultiply&&(e.startingSumAtMultiply=[]);for(let o=0;o<e.pointTypeToMultiply.length;o++){let i=Bt.get(e.pointTypeToMultiply[o]);if(void 0!==i)if(e.multiplyPointtypeIsId&&"string"==typeof e.multiplyWithThis){let n=Bt.get(e.multiplyWithThis);void 0!==n?(e.startingSumAtMultiply[o]={value:i.startingSum,calcVal:n.startingSum},i.startingSum*=n.startingSum,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)):t++}else"number"==typeof e.multiplyWithThis&&(e.startingSumAtMultiply[o]={value:i.startingSum,calcVal:e.multiplyWithThis},i.startingSum*=e.multiplyWithThis,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum));else t++}t===e.pointTypeToMultiply.length&&delete e.multiplyPointtypeIsOnCheck,e.multiplyPointtypeIsOnCheck&&Pt.push(e)}if(e.dividePointtypeIsOn&&void 0!==e.pointTypeToDivide&&void 0!==e.divideWithThis){let t=0;e.dividePointtypeIsOnCheck=!0,"object"!=typeof e.startingSumAtDivide&&(e.startingSumAtDivide=[]);for(let o=0;o<e.pointTypeToDivide.length;o++){let i=Bt.get(e.pointTypeToDivide[o]);if(void 0!==i)if(e.dividePointtypeIsId&&"string"==typeof e.divideWithThis){let n=Bt.get(e.divideWithThis);void 0!==n?0===n.startingSum?t++:(e.startingSumAtDivide[o]={value:i.startingSum,calcVal:n.startingSum},i.startingSum/=n.startingSum,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)):t++}else"number"==typeof e.divideWithThis&&(0===e.dividedWithThis?t++:(e.startingSumAtDivide[o]={value:i.startingSum,calcVal:e.divideWithThis},i.startingSum/=e.divideWithThis,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)));else t++}t===e.pointTypeToDivide.length&&delete e.dividePointtypeIsOnCheck,!e.multiplyPointtypeIsOnCheck&&e.dividePointtypeIsOnCheck&&Pt.push(e)}if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Ft.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!0:"2"===e.changeType?o.isTrue=!1:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const o=$t.get(e.idOfAllowChoice[t]);if(void 0!==o&&(o.allowedChoices+=e.numbAddToAllowChoice,o.allowedChoices>0&&o.currentChoices>=o.allowedChoices))for(let e=0;e<o.objects.length;e++){const t=o.objects[e];if(t.isActive&&!t.forcedActivated)if(t.isSelectableMultiple){let e=t.multipleUseVariable;for(let i=0;i<e;i++)le(t,o)}else oe(t,o);if(o.allowedChoices>=o.currentChoices)break}}if(e.textfieldIsOn&&void 0!==e.idOfTheTextfieldWord&&void 0!==e.wordChangeSelect){const t=Mt.get(e.idOfTheTextfieldWord);void 0!==t&&(t.replaceText=e.wordChangeSelect)}if(e.isImageUpload&&(e.defaultImage=e.image,Wt.currentDialog="appImageUpload",Wt.data=e,Wt.imgProp="image"),e.backpackBtnRequirement&&(app.btnBackpackIsOn+=1),e.showAllAddons&&(app.showAllAddons+=1),e.changeBackground&&(e.changeBgImage?void 0!==e.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage??""),app.bgImageStack.push({id:e.id,data:e.bgImage}),app.styling.backgroundImage=e.bgImage):void 0!==e.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor??""),app.bgColorStack.push({id:e.id,data:e.changedBgColorCode}),app.styling.backgroundColor=e.changedBgColorCode)),e.changePointBar&&(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor??"#FFFFFFFF"),app.barBgColorStack.push({id:e.id,data:e.changedBarBgColor}),app.styling.barBackgroundColor=e.changedBarBgColor),e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor??"#0000008A"),app.barIconColorStack.push({id:e.id,data:e.changedBarIconColor}),app.styling.barIconColor=e.changedBarIconColor),e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor??"#000000"),app.barTextColorStack.push({id:e.id,data:e.changedBarTextColor}),app.styling.barTextColor=e.changedBarTextColor)),e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){const t=n.choice;if(vi(t,e.id,e.changeToThisTemplate),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){vi(t.addons[o],e.id,e.changeToThisTemplate)}continue}const l=$t.get(i);if(void 0!==l){vi(l,e.id,e.changeToThisTemplate);continue}const r=Ot.get(i[0]);if(void 0!==r){const t=r.rowElements;for(let i=0;i<t.length;i++){const o=$t.get(t[i]);void 0!==o&&vi(o,e.id,e.changeToThisTemplate)}const o=r.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){vi(t.choice,e.id,e.changeToThisTemplate)}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){bi(n.choice,e.id,e.changeToThisWidth);continue}const l=$t.get(i);if(void 0!==l){bi(l,e.id,e.changeToThisWidth);continue}const r=Ot.get(i[0]);if(void 0!==r){const t=r.rowElements;for(let i=0;i<t.length;i++){const o=$t.get(t[i]);void 0!==o&&bi(o,e.id,e.changeToThisWidth)}const o=r.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){bi(t.choice,e.id,e.changeToThisWidth)}}continue}}}if(e.setBgmIsOn&&e.bgmId&&(Nt.bgmIsPlaying=!0,Nt.isBgmInit?yo(e,e.bgmId,0):(So(e),Nt.isBgmInit=!0)),e.muteBgm&&Lt){const e=A(Lt);app.isMute=!0,e&&"function"==typeof e.mute&&e.mute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=$t.get(e.hiddenContentsRow[t]);if(void 0!==o){o.textIsRemoved||(o.textIsRemoved=!0);for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":o.objectTitleRemoved=!0;break;case"2":o.objectImageRemoved=!0;break;case"3":o.objectTextRemoved=!0;break;case"4":o.objectScoreRemoved=!0;break;case"5":o.objectRequirementRemoved=!0;break;case"6":o.addonTitleRemoved=!0;break;case"7":o.addonImageRemoved=!0;break;case"8":o.addonTextRemoved=!0}}}e.scrollToRow&&_().then(()=>{setTimeout(()=>{var o,i,n,l,r;if(e.scrollToObject){if(e.scrollObjectId){const r=At.get(e.scrollObjectId);if(void 0!==r){const e=r.choice,a=r.row,s=null==(l=null==(n=null==(i=null==(o=t.mainDiv)?void 0:o.children[a.index])?void 0:i.children[0])?void 0:n.children[1])?void 0:l.children;if(void 0!==s)if(t.isBackpack){const t=document.getElementById("backpackDialog");null==t||t.scrollTo({top:s[e.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}else window.scrollTo({top:s[e.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}}}else if(e.scrollRowId){const o=$t.get(e.scrollRowId);if(void 0!==o){const e=null==(r=t.mainDiv)?void 0:r.children;if(void 0!==e)if(t.isBackpack){const t=document.getElementById("backpackDialog");null==t||t.scrollTo({top:e[o.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}else window.scrollTo({top:e[o.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}}},10)}),e.cleanACtivatedOnSelect&&Mo(),Q(e,d,0),ee()};if(e.customTextfieldIsOn&&!O)return h.choice=e,h.row=o,h.context=void 0!==e.wordPromptText?e.wordPromptText:"",h.prevText=e.wordChangeSelect??"",void m($,"dlgCommon");-1===s.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,i()},1e3*app.fadeTransitionTime)):i()),0===s.indexOf(e.id)&&s.splice(0)}}}function ne(e,o){const i=wo(e.requireds)&&!o.isInfoRow&&!e.isNotSelectable;let n=!0,l=o;if(o.isResultRow){const t=At.get(e.id);void 0!==t&&(l=t.row)}if(i&&e.isMultipleUseVariable&&l.allowedChoices>0&&l.currentChoices>=l.allowedChoices){let e=0;for(let t=0;t<l.objects.length;t++){const o=l.objects[t];if(o.isActive){if(!o.forcedActivated){if(o.isSelectableMultiple){let e=o.multipleUseVariable;for(let t=0;t<e;t++)le(o,l)}else te(o,l);break}e++}}e>=l.allowedChoices&&(n=!1)}if(n){for(let t=0;t<e.scores.length;t++){const o=e.scores[t],i=Bt.get(o.id);void 0!==i&&o.isRandom&&!o.setValue&&void 0!==o.maxValue&&void 0!==o.minValue&&(o.value=Math.floor(Math.random()*(o.maxValue-o.minValue+1))+o.minValue,o.value=i.allowFloat?o.value:Math.floor(o.value),o.setValue=!0)}if(ko(e,!0)){const o=()=>{var o,i,n,r,a,s;const d=new y,c=e.isActive,u=e.multipleUseVariable>=0,g=Math.abs(e.multipleUseVariable);if(e.multipleUseVariable+=1,0===e.multipleUseVariable?(Ct.delete(e.id),e.isActive=!1,l.currentChoices-=1):(1===e.multipleUseVariable&&(e.isActive=!0,l.currentChoices+=1),Ct.set(e.id,{multiple:e.multipleUseVariable})),u){if(e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue)if(e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let n=0;n<e.discountRows.length;n++){const l=$t.get(e.discountRows[n]);if(void 0!==l)for(let n=0;n<l.objects.length;n++){const r=l.objects[n];for(let t=0;t<r.scores.length;t++){const n=r.scores[t];n.isNotDiscountable||0!==(null==(o=e.discountPointTypes)?void 0:o.length)&&-1===(null==(i=e.discountPointTypes)?void 0:i.indexOf(n.id))||Ao(e,n)}t.add(r.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const t=At.get(e.discountChoices[o]);if(void 0!==t){const o=t.choice;for(let t=0;t<o.scores.length;t++){const i=o.scores[t];i.isNotDiscountable||0!==(null==(n=e.discountPointTypes)?void 0:n.length)&&-1===(null==(r=e.discountPointTypes)?void 0:r.indexOf(i.id))||Ao(e,i)}}}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Ot.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=At.get(o.elements[t]);if(void 0!==i)for(let t=0;t<i.choice.scores.length;t++){const o=i.choice.scores[t];o.isNotDiscountable||0!==(null==(a=e.discountPointTypes)?void 0:a.length)&&-1===(null==(s=e.discountPointTypes)?void 0:s.indexOf(o.id))||Ao(e,o)}}}for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(void 0===o.isActiveMul&&(o.isActiveMul=[]),wo(o.requireds)&&!o.isActiveMul[g]){const e=Bt.get(o.id);if(void 0!==e){let t=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value;t=e.allowFloat?t:Math.floor(t),o.multiplyByTimes&&(t*=g+1),e.startingSum-=t,o.isActiveMul[g]=!0;let i=d.get(o.id);void 0!==i?d.set(o.id,t+i):d.set(o.id,t)}}}}else for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(void 0===o.isActiveMulMinus&&(o.isActiveMulMinus=[]),wo(o.requireds)&&o.isActiveMulMinus[g]||o.isActiveMulMinus[g]){const e=Bt.get(o.id);if(void 0!==e){let t=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value;t=e.allowFloat?t:Math.floor(t),o.multiplyByTimes&&(t*=Math.abs(g)),e.startingSum-=t;let i=d.get(o.id);void 0!==i?d.set(o.id,t+i):d.set(o.id,t),delete o.isActiveMulMinus[g]}}}if(u&&(e.duplicateRow&&void 0!==e.duplicateRowId&&void 0!==e.duplicateRowPlace&&qo(e),e.activateOtherChoice&&void 0!==e.activateThisChoice))if(e.isActivateRandom)X(e);else{const t=e.activateThisChoice.split(",");for(let o=0;o<t.length;o++){const i=t[o].split("/ON#"),n=i.length>1?parseInt(i[1]):0,l=At.get(i[0]);if(void 0!==l){const t=l.row,o=l.choice;!o.isSelectableMultiple&&c||G(e,o,t,n)}else{const t=Ot.get(i[0]);if(void 0!==t){const o=t.elements;for(let t=0;t<o.length;t++){const i=At.get(o[t]);if(void 0!==i){const t=i.row,o=i.choice;!o.isSelectableMultiple&&c||G(e,o,t,n)}}}}}}if(Array.from(Ct.entries()).forEach(([t,o])=>{const i=At.get(t);if(void 0!==i){const t=i.row,n=i.choice;if(n.id!==e.id&&!wo(n.requireds))if(n.forcedActivated&&(delete n.forcedActivated,n.isAllowDeselect||xt.set(n.id,{multiple:o.multiple})),0===o.multiple)n.isActive&&oe(n,t);else if(o.multiple>0)for(let e=0;e<o.multiple;e++)n.isActive&&le(n,t)}}),e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const o=$t.get(e.idOfAllowChoice[t]);if(void 0!==o&&(o.allowedChoices+=e.numbAddToAllowChoice,o.allowedChoices>0&&o.currentChoices>=o.allowedChoices))for(let e=0;e<o.objects.length;e++){const t=o.objects[e];if(t.isActive&&!t.forcedActivated)if(t.isSelectableMultiple){let e=t.multipleUseVariable;for(let i=0;i<e;i++)le(t,o)}else t.isActive&&oe(t,o);if(o.allowedChoices>=o.currentChoices)break}}if(!c){if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Ft.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!0:"2"===e.changeType?o.isTrue=!1:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.backpackBtnRequirement&&(app.btnBackpackIsOn+=1),e.showAllAddons&&(app.showAllAddons+=1),e.changeBackground&&(e.changeBgImage?void 0!==e.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage??""),app.bgImageStack.push({id:e.id,data:e.bgImage}),app.styling.backgroundImage=e.bgImage):void 0!==e.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor??""),app.bgColorStack.push({id:e.id,data:e.changedBgColorCode}),app.styling.backgroundColor=e.changedBgColorCode)),e.changePointBar&&(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor??"#FFFFFFFF"),app.barBgColorStack.push({id:e.id,data:e.changedBarBgColor}),app.styling.barBackgroundColor=e.changedBarBgColor),e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor??"#0000008A"),app.barIconColorStack.push({id:e.id,data:e.changedBarIconColor}),app.styling.barIconColor=e.changedBarIconColor),e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor??"#000000"),app.barTextColorStack.push({id:e.id,data:e.changedBarTextColor}),app.styling.barTextColor=e.changedBarTextColor)),e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){const t=n.choice;if(vi(t,e.id,e.changeToThisTemplate),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){vi(t.addons[o],e.id,e.changeToThisTemplate)}continue}const l=$t.get(i);if(void 0!==l){vi(l,e.id,e.changeToThisTemplate);continue}const r=Ot.get(i[0]);if(void 0!==r){const t=r.rowElements;for(let i=0;i<t.length;i++){const o=$t.get(t[i]);void 0!==o&&vi(o,e.id,e.changeToThisTemplate)}const o=r.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){vi(t.choice,e.id,e.changeToThisTemplate)}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){bi(n.choice,e.id,e.changeToThisWidth);continue}const l=$t.get(i);if(void 0!==l){bi(l,e.id,e.changeToThisWidth);continue}const r=Ot.get(i[0]);if(void 0!==r){const t=r.rowElements;for(let i=0;i<t.length;i++){const o=$t.get(t[i]);void 0!==o&&bi(o,e.id,e.changeToThisWidth)}const o=r.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){bi(t.choice,e.id,e.changeToThisWidth)}}continue}}}if(e.setBgmIsOn&&e.bgmId&&(Nt.bgmIsPlaying=!0,Nt.isBgmInit?yo(e,e.bgmId,0):(So(e),Nt.isBgmInit=!0)),e.muteBgm&&Lt){const e=A(Lt);app.isMute=!0,e&&"function"==typeof e.mute&&e.mute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=$t.get(e.hiddenContentsRow[t]);if(void 0!==o){o.textIsRemoved||(o.textIsRemoved=!0);for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":o.objectTitleRemoved=!0;break;case"2":o.objectImageRemoved=!0;break;case"3":o.objectTextRemoved=!0;break;case"4":o.objectScoreRemoved=!0;break;case"5":o.objectRequirementRemoved=!0;break;case"6":o.addonTitleRemoved=!0;break;case"7":o.addonImageRemoved=!0;break;case"8":o.addonTextRemoved=!0}}}if(e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){const t=n.choice;t.defaultTemplate&&(t.defaultTemplate=t.template),t.template=e.changeToThisTemplate,e.changeAddonTemplate}else{const t=$t.get(i);if(void 0!==t)t.defaultTemplate=t.template,t.template=e.changeToThisTemplate;else{const t=Ot.get(i[0]);if(void 0!==t){const o=t.rowElements;for(let t=0;t<o.length;t++){const i=$t.get(o[t]);void 0!==i&&(i.defaultTemplate=i.template,i.template=e.changeToThisTemplate)}const i=t.elements;for(let t=0;t<i.length;t++){const o=At.get(i[t]);if(void 0!==o){const t=o.choice;t.defaultTemplate=t.template,t.template=e.changeToThisTemplate}}}}}}}e.scrollToRow&&_().then(()=>{setTimeout(()=>{var o,i,n,l,r;if(e.scrollToObject){if(e.scrollObjectId){const r=At.get(e.scrollObjectId);if(void 0!==r){const e=r.choice,a=r.row,s=null==(l=null==(n=null==(i=null==(o=t.mainDiv)?void 0:o.children[a.index])?void 0:i.children[0])?void 0:n.children[1])?void 0:l.children;if(void 0!==s)if(t.isBackpack){const t=document.getElementById("backpackDialog");null==t||t.scrollTo({top:s[e.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}else window.scrollTo({top:s[e.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}}}else if(e.scrollRowId){const o=$t.get(e.scrollRowId);if(void 0!==o){const e=null==(r=t.mainDiv)?void 0:r.children;if(void 0!==e)if(t.isBackpack){const t=document.getElementById("backpackDialog");null==t||t.scrollTo({top:e[o.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}else window.scrollTo({top:e[o.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}}},10)})}Q(e,d,0),ee()};if(i)if(e.isMultipleUseVariable)void 0===e.multipleUseVariable&&(e.multipleUseVariable=0),void 0===e.numMultipleTimesPluss&&(e.numMultipleTimesPluss=0),e.numMultipleTimesPluss>e.multipleUseVariable&&(-1===s.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,o()},1e3*app.fadeTransitionTime)):o()),0===s.indexOf(e.id)&&s.splice(0));else if(void 0!==e.multipleScoreId){const t=Bt.get(e.multipleScoreId);void 0!==t&&(void 0===e.numMultipleTimesPluss&&(e.numMultipleTimesPluss=0),e.numMultipleTimesPluss>t.startingSum&&(t.startingSum+=1))}}}}function le(e,t){const o=ko(e,!1);let i=t;if(t.isResultRow){const t=At.get(e.id);void 0!==t&&(i=t.row)}if(o){const o=()=>{var t,o,n,l,r,a;const s=new y,d=e.multipleUseVariable>0,c=Math.abs(e.multipleUseVariable-1);if(d){for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(void 0!==o.isActiveMul&&(wo(o.requireds)&&o.isActiveMul[c]||o.isActiveMul[c])){const e=Bt.get(o.id);if(void 0!==e){let t=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value;t=e.allowFloat?t:Math.floor(t),o.multiplyByTimes&&(t*=c+1),e.startingSum+=t;let i=s.get(o.id);void 0!==i?s.set(o.id,-t+i):s.set(o.id,-t),delete o.isActiveMul[c],0===c&&delete o.setValue}}}if(e.activateOtherChoice&&void 0!==e.activateThisChoice)if(e.isActivateRandom&&void 0!==e.activatedRandomMul&&void 0!==e.activatedRandomMul[c]){for(let t=0;t<e.activatedRandomMul[c].length;t++){const o=At.get(e.activatedRandomMul[c][t]);if(void 0!==o){const t=o.row,i=o.choice;H(e,i,t,0)}}e.activatedRandomMul.splice(c,1)}else{const t=e.activateThisChoice.split(",");for(let o=0;o<t.length;o++){const i=t[o].split("/ON#"),n=i.length>1?parseInt(i[1]):0,l=At.get(i[0]);if(void 0!==l){const t=l.row,o=l.choice;H(e,o,t,n)}else{const t=Ot.get(i[0]);if(void 0!==t){const o=t.elements;for(let t=0;t<o.length;t++){const i=At.get(o[t]);if(void 0!==i){const t=i.row,o=i.choice;H(e,o,t,n)}}}}}}if(e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue)if(e.isDisChoices){const i=new Set;if(void 0!==e.discountRows)for(let n=0;n<e.discountRows.length;n++){const l=$t.get(e.discountRows[n]);if(void 0!==l)for(let n=0;n<l.objects.length;n++){const r=l.objects[n];for(let i=0;i<r.scores.length;i++){const n=r.scores[i];n.isNotDiscountable||0!==(null==(t=e.discountPointTypes)?void 0:t.length)&&-1===((null==(o=e.discountPointTypes)?void 0:o.indexOf(n.id))??-1)||$o(e,n)}i.add(r.id)}}if(void 0!==e.discountChoices)for(let t=0;t<e.discountChoices.length;t++)if(!i.has(e.discountChoices[t])){const o=At.get(e.discountChoices[t]);if(void 0!==o){const t=o.choice;for(let r=0;r<t.scores.length;r++){const t=o.choice.scores[r];t.isNotDiscountable||0!==(null==(n=e.discountPointTypes)?void 0:n.length)&&-1===((null==(l=e.discountPointTypes)?void 0:l.indexOf(t.id))??-1)||i.has(t.idx)||$o(e,t)}}}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Ot.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=At.get(o.elements[t]);if(void 0!==i)for(let t=0;t<i.choice.scores.length;t++){const o=i.choice.scores[t];o.isNotDiscountable||0!==(null==(r=e.discountPointTypes)?void 0:r.length)&&-1===((null==(a=e.discountPointTypes)?void 0:a.indexOf(o.id))??-1)||$o(e,o)}}}}else for(let i=0;i<e.scores.length;i++){const t=e.scores[i];if(void 0===t.isActiveMulMinus&&(t.isActiveMulMinus=[]),wo(t.requireds)&&!t.isActiveMulMinus[c]){const e=Bt.get(t.id);if(void 0!==e){let o=t.discountIsOn&&void 0!==t.discountScore?t.discountScore:t.value;o=e.allowFloat?o:Math.floor(o),t.multiplyByTimes&&(o*=c),e.startingSum+=o;let i=s.get(t.id);void 0!==i?s.set(t.id,-o+i):s.set(t.id,-o),t.isActiveMulMinus[c]=!0}}}if(e.multipleUseVariable-=1,0===e.multipleUseVariable?(e.isActive=!1,i.currentChoices-=1,Ct.delete(e.id)):(-1===e.multipleUseVariable&&(e.isActive=!0,i.currentChoices+=1),Ct.set(e.id,{multiple:e.multipleUseVariable})),Array.from(Ct.entries()).forEach(([t,o])=>{const i=At.get(t);if(void 0!==i){const t=i.row,n=i.choice;if(n.id!==e.id&&!wo(n.requireds))if(n.forcedActivated&&(delete n.forcedActivated,n.isAllowDeselect||xt.set(n.id,{multiple:o.multiple})),0===o.multiple)n.forcedActivated&&delete n.forcedActivated,n.isActive&&oe(n,t);else if(o.multiple>0)for(let e=0;e<o.multiple;e++)n.isActive&&le(n,t)}}),e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let i=0;i<e.idOfAllowChoice.length;i++){const t=$t.get(e.idOfAllowChoice[i]);if(void 0!==t&&(t.allowedChoices-=e.numbAddToAllowChoice,t.allowedChoices>0&&t.currentChoices>=t.allowedChoices))for(let e=0;e<t.objects.length;e++){const o=t.objects[e];if(o.isActive&&!o.forcedActivated)if(o.isSelectableMultiple){let e=o.multipleUseVariable;for(let i=0;i<e;i++)le(o,t)}else o.isActive&&oe(o,t);if(t.allowedChoices>=t.currentChoices)break}}if(0===c){if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Ft.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!1:"2"===e.changeType?o.isTrue=!0:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.backpackBtnRequirement&&void 0!==app.btnBackpackIsOn&&(app.btnBackpackIsOn-=1),e.showAllAddons&&void 0!==app.showAllAddons&&(app.showAllAddons-=1),e.changeBackground)if(e.changeBgImage){if(void 0!==app.bgImageStack){const t=app.bgImageStack.findIndex(t=>t.id===e.id);-1!==t&&app.bgImageStack.splice(t,1);const o=app.bgImageStack.length;o>0?app.styling.backgroundImage=app.bgImageStack[o-1].data:(app.styling.backgroundImage=app.defaultBgImage??"",delete app.bgImageStack)}}else if(void 0!==e.changedBgColorCode&&void 0!==app.bgColorStack){const t=app.bgColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.bgColorStack.splice(t,1);const o=app.bgColorStack.length;o>0?app.styling.backgroundColor=app.bgColorStack[o-1].data:(app.styling.backgroundColor=app.defaultBgColor??"#FFFFFFFF",delete app.bgColorStack)}if(e.changePointBar){if(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&void 0!==app.barBgColorStack){const t=app.barBgColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barBgColorStack.splice(t,1);const o=app.barBgColorStack.length;o>0?app.styling.barBackgroundColor=app.barBgColorStack[o-1].data:(app.styling.barBackgroundColor=app.defaultBarBgColor??"#FFFFFFFF",delete app.barBgColorStack)}if(e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&void 0!==app.barIconColorStack){const t=app.barIconColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barIconColorStack.splice(t,1);const o=app.barIconColorStack.length;o>0?app.styling.barIconColor=app.barIconColorStack[o-1].data:(app.styling.barIconColor=app.defaultBarIconColor??"#0000008A",delete app.barIconColorStack)}if(e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&void 0!==app.barTextColorStack){const t=app.barTextColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barTextColorStack.splice(t,1);const o=app.barTextColorStack.length;o>0?app.styling.barTextColor=app.barTextColorStack[o-1].data:(app.styling.barTextColor=app.defaultBarIconColor??"#000000",delete app.barTextColorStack)}}if(e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){const t=n.choice;if(fi(t,e.id),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){fi(t.addons[o],e.id)}continue}const l=$t.get(i);if(void 0!==l){fi(l,e.id);continue}const r=Ot.get(i[0]);if(void 0!==r){const t=r.rowElements;for(let i=0;i<t.length;i++){const o=$t.get(t[i]);void 0!==o&&fi(o,e.id)}const o=r.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){fi(t.choice,e.id)}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){wi(n.choice,e.id);continue}const l=$t.get(i);if(void 0!==l){wi(l,e.id);continue}const r=Ot.get(i[0]);if(void 0!==r){const t=r.rowElements;for(let i=0;i<t.length;i++){const o=$t.get(t[i]);void 0!==o&&wi(o,e.id)}const o=r.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){wi(t.choice,e.id)}}continue}}}if(e.setBgmIsOn&&Lt&&e.bgmId&&(Nt.bgmIsPlaying=!1,yo(e,e.bgmId,0)),e.muteBgm&&Lt){const e=A(Lt);app.isMute=!1,e&&"function"==typeof e.unMute&&e.unMute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=$t.get(e.hiddenContentsRow[t]);if(void 0!==o)for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":o.objectTitleRemoved=!1;break;case"2":o.objectImageRemoved=!1;break;case"3":o.objectTextRemoved=!1;break;case"4":o.objectScoreRemoved=!1;break;case"5":o.objectRequirementRemoved=!1;break;case"6":o.addonTitleRemoved=!1;break;case"7":o.addonImageRemoved=!1;break;case"8":o.addonTextRemoved=!1}}}Z(e,s,0),ee()};if(!t.isInfoRow&&!e.isNotSelectable&&!e.selectOnce)if(e.isMultipleUseVariable)void 0===e.numMultipleTimesMinus&&(e.numMultipleTimesMinus=0),e.multipleUseVariable>e.numMultipleTimesMinus&&(-1===s.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,o()},1e3*app.fadeTransitionTime)):o()),0===s.indexOf(e.id)&&s.splice(0));else if(void 0!==e.multipleScoreId){const t=Bt.get(e.multipleScoreId);void 0!==t&&(void 0===e.numMultipleTimesMinus&&(e.numMultipleTimesMinus=0),t.startingSum>e.numMultipleTimesMinus&&(t.startingSum-=1))}}}var ae=gl(),se=j(ae),de=e=>{var o=ul(),i=p(o);let n;var s=p(i);s.__click=()=>te(t.choice,t.row);var c=p(s),g=e=>{var o=Xn(),i=p(o),n=e=>{var t=Wn(),o=p(t);a(o,()=>we.sanitize(mo(u(D).title),Vt)),T(()=>Te(t,u(U))),d(e,t)};Y(i,e=>{t.row.resultShowRowTitle&&e(n)});var l=J(i,2),s=e=>{var o=R(),i=j(o),n=e=>{ot(e,{get text(){return t.choice.imageSourceTooltip},children:(e,o)=>{var i=En();T(()=>{Ie(i,"src",t.choice.image),Te(i,u(E)),Ie(i,"loading",r()?"eager":"lazy")}),d(e,i)},$$slots:{default:!0}})},l=e=>{var o=Un();T(()=>{Ie(o,"src",t.choice.image),Te(o,u(E)),Ie(o,"loading",r()?"eager":"lazy")}),d(e,o)};Y(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),d(e,o)};Y(l,e=>{(1===t.choice.template||t.windowWidth<=960||t.row.choicesShareTemplate)&&t.choice.image&&!t.row.objectImageRemoved&&e(s)});var c=J(l,2),g=p(c),h=e=>{var o=zn(),i=p(o);a(i,()=>we.sanitize(mo(t.choice.title),Vt)),T(()=>Te(o,u(P))),d(e,o)};Y(g,e=>{""===t.choice.title||t.row.objectTitleRemoved||e(h)});var m=J(g,2),v=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(m,e=>{t.choice.isSelectableMultiple&&u(L)&&0===u(w).multiChoiceCounterPosition&&e(v)});var f=J(m,2),b=e=>{var o=R(),i=j(o);fe(i,17,()=>t.choice.scores,be,(e,o)=>{Nn(e,{get score(){return u(o)},get row(){return t.row},get choice(){return t.choice}})}),d(e,o)};Y(f,e=>{t.row.objectScoreRemoved||e(b)});var y=J(f,2),S=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(y,e=>{t.choice.isSelectableMultiple&&u(L)&&1===u(w).multiChoiceCounterPosition&&e(S)});var C=J(y,2),x=e=>{var o=R(),i=j(o);fe(i,17,()=>t.choice.requireds,be,(e,t)=>{rn(e,{get required(){return u(t)},get scoreText(){return u(U)}})}),d(e,o)};Y(C,e=>{t.row.objectRequirementRemoved||e(x)});var B=J(C,2),$=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(B,e=>{t.choice.isSelectableMultiple&&u(L)&&2===u(w).multiChoiceCounterPosition&&e($)});var A=J(B,2),O=e=>{var o=R(),i=j(o),n=e=>{ot(e,{get text(){return t.choice.imageSourceTooltip},children:(e,o)=>{var i=Gn();T(()=>{Ie(i,"src",t.choice.image),Te(i,u(E)),Ie(i,"loading",r()?"eager":"lazy")}),d(e,i)},$$slots:{default:!0}})},l=e=>{var o=Hn();T(()=>{Ie(o,"src",t.choice.image),Te(o,u(E)),Ie(o,"loading",r()?"eager":"lazy")}),d(e,o)};Y(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),d(e,o)};Y(A,e=>{5===t.choice.template&&t.choice.image&&!t.row.objectImageRemoved&&e(O)});var M=J(A,2),F=e=>{var o=_n(),i=p(o);a(i,()=>we.sanitize(mo(t.choice.text),Vt)),T(()=>Te(o,u(N))),d(e,o)};Y(M,e=>{""===t.choice.text||t.row.objectTextRemoved||e(F)});var W=J(M,2),z=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(W,e=>{t.choice.isSelectableMultiple&&u(L)&&3===u(w).multiChoiceCounterPosition&&e(z)});var G=J(W,2),H=e=>{var o=R(),i=j(o),n=e=>{ot(e,{get text(){return t.choice.imageSourceTooltip},children:(e,o)=>{var i=Yn();T(()=>{Ie(i,"src",t.choice.image),Te(i,u(E)),Ie(i,"loading",r()?"eager":"lazy")}),d(e,i)},$$slots:{default:!0}})},l=e=>{var o=Jn();T(()=>{Ie(o,"src",t.choice.image),Te(o,u(E)),Ie(o,"loading",r()?"eager":"lazy")}),d(e,o)};Y(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),d(e,o)};Y(G,e=>{4===t.choice.template&&t.choice.image&&!t.row.objectImageRemoved&&e(H)});var _=J(c,2);fe(_,21,()=>t.choice.addons,be,(e,o)=>{An(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return u(o)},get isEnabled(){return u(k)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()}})});var X=J(_,2),Z=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(X,e=>{t.choice.isSelectableMultiple&&u(L)&&4===u(w).multiChoiceCounterPosition&&e(Z)}),T(()=>I(_,1,`d-column pa-0 col justify-content-${t.choice.addonJustify??""}`)),d(e,o)},h=e=>{var o=R(),i=j(o),n=e=>{var o=il(),i=j(o),n=p(i),l=e=>{var o=R(),i=j(o),n=e=>{ot(e,{get text(){return t.choice.imageSourceTooltip},children:(e,o)=>{var i=Zn();T(()=>{Ie(i,"src",t.choice.image),Te(i,u(E)),Ie(i,"loading",r()?"eager":"lazy")}),d(e,i)},$$slots:{default:!0}})},l=e=>{var o=Kn();T(()=>{Ie(o,"src",t.choice.image),Te(o,u(E)),Ie(o,"loading",r()?"eager":"lazy")}),d(e,o)};Y(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),d(e,o)};Y(n,e=>{t.choice.image&&!t.row.objectImageRemoved&&e(l)});var s=J(i,2),c=p(s),g=e=>{var o=Qn(),i=p(o);a(i,()=>we.sanitize(mo(t.choice.title),Vt)),T(()=>Te(o,u(P))),d(e,o)};Y(c,e=>{""===t.choice.title||t.row.objectTitleRemoved||e(g)});var h=J(c,2),m=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(h,e=>{t.choice.isSelectableMultiple&&u(L)&&0===u(w).multiChoiceCounterPosition&&e(m)});var v=J(h,2),f=e=>{var o=R(),i=j(o);fe(i,17,()=>t.choice.scores,be,(e,o)=>{Nn(e,{get score(){return u(o)},get row(){return t.row},get choice(){return t.choice}})}),d(e,o)};Y(v,e=>{t.row.objectScoreRemoved||e(f)});var b=J(v,2),y=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(b,e=>{t.choice.isSelectableMultiple&&u(L)&&1===u(w).multiChoiceCounterPosition&&e(y)});var S=J(b,2),C=e=>{var o=R(),i=j(o);fe(i,17,()=>t.choice.requireds,be,(e,t)=>{rn(e,{get required(){return u(t)},get scoreText(){return u(U)}})}),d(e,o)};Y(S,e=>{t.row.objectRequirementRemoved||e(C)});var x=J(S,2),$=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(x,e=>{t.choice.isSelectableMultiple&&u(L)&&2===u(w).multiChoiceCounterPosition&&e($)});var A=J(x,2),O=e=>{var o=el(),i=p(o);a(i,()=>we.sanitize(mo(t.choice.text),Vt)),T(()=>Te(o,u(N))),d(e,o)};Y(A,e=>{""===t.choice.text||t.row.objectTextRemoved||e(O)});var M=J(A,2),F=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(M,e=>{t.choice.isSelectableMultiple&&u(L)&&3===u(w).multiChoiceCounterPosition&&e(F)});var D=J(M,2),W=e=>{var o=tl(),i=j(o);fe(i,21,()=>t.choice.addons,be,(e,o)=>{An(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return u(o)},get isEnabled(){return u(k)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()}})});var n=J(i,2),l=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(n,e=>{t.choice.isSelectableMultiple&&u(L)&&4===u(w).multiChoiceCounterPosition&&e(l)}),T(()=>I(i,1,`d-column pa-0 col justify-content-${t.choice.addonJustify??""}`)),d(e,o)};Y(D,e=>{t.choice.useSeperateAddon||e(W)});var z=J(s,2),G=e=>{var o=ol(),i=p(o);fe(i,21,()=>t.choice.addons,be,(e,o)=>{An(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return u(o)},get isEnabled(){return u(k)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()}})});var n=J(i,2),l=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(n,e=>{t.choice.isSelectableMultiple&&u(L)&&4===u(w).multiChoiceCounterPosition&&e(l)}),T(()=>I(i,1,`d-column pa-0 col justify-content-${t.choice.addonJustify??""}`)),d(e,o)};Y(z,e=>{t.choice.useSeperateAddon&&e(G)}),T(()=>{Te(i,`max-width: ${u(B)??""}%`),Te(s,`max-width: ${100-u(B)}%`)}),d(e,o)},l=(e,o)=>{var i=e=>{var o=cl(),i=j(o),n=p(i),l=e=>{var o=nl(),i=p(o);a(i,()=>we.sanitize(mo(t.choice.title),Vt)),T(()=>Te(o,u(P))),d(e,o)};Y(n,e=>{""===t.choice.title||t.row.objectTitleRemoved||e(l)});var s=J(n,2),c=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(s,e=>{t.choice.isSelectableMultiple&&u(L)&&0===u(w).multiChoiceCounterPosition&&e(c)});var g=J(s,2),h=e=>{var o=R(),i=j(o);fe(i,17,()=>t.choice.scores,be,(e,o)=>{Nn(e,{get score(){return u(o)},get row(){return t.row},get choice(){return t.choice}})}),d(e,o)};Y(g,e=>{t.row.objectScoreRemoved||e(h)});var m=J(g,2),v=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(m,e=>{t.choice.isSelectableMultiple&&u(L)&&1===u(w).multiChoiceCounterPosition&&e(v)});var f=J(m,2),b=e=>{var o=R(),i=j(o);fe(i,17,()=>t.choice.requireds,be,(e,t)=>{rn(e,{get required(){return u(t)},get scoreText(){return u(U)}})}),d(e,o)};Y(f,e=>{t.row.objectRequirementRemoved||e(b)});var y=J(f,2),S=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(y,e=>{t.choice.isSelectableMultiple&&u(L)&&2===u(w).multiChoiceCounterPosition&&e(S)});var C=J(y,2),x=e=>{var o=ll(),i=p(o);a(i,()=>we.sanitize(mo(t.choice.text),Vt)),T(()=>Te(o,u(N))),d(e,o)};Y(C,e=>{""===t.choice.text||t.row.objectTextRemoved||e(x)});var $=J(C,2),A=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y($,e=>{t.choice.isSelectableMultiple&&u(L)&&3===u(w).multiChoiceCounterPosition&&e(A)});var O=J($,2),M=e=>{var o=rl(),i=j(o);fe(i,21,()=>t.choice.addons,be,(e,o)=>{An(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return u(o)},get isEnabled(){return u(k)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()}})});var n=J(i,2),l=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(n,e=>{t.choice.isSelectableMultiple&&u(L)&&4===u(w).multiChoiceCounterPosition&&e(l)}),T(()=>I(i,1,`d-column pa-0 col justify-content-${t.choice.addonJustify??""}`)),d(e,o)};Y(O,e=>{t.choice.useSeperateAddon||e(M)});var F=J(i,2),D=p(F),W=e=>{var o=R(),i=j(o),n=e=>{ot(e,{get text(){return t.choice.imageSourceTooltip},children:(e,o)=>{var i=al();T(()=>{Ie(i,"src",t.choice.image),Te(i,u(E)),Ie(i,"loading",r()?"eager":"lazy")}),d(e,i)},$$slots:{default:!0}})},l=e=>{var o=sl();T(()=>{Ie(o,"src",t.choice.image),Te(o,u(E)),Ie(o,"loading",r()?"eager":"lazy")}),d(e,o)};Y(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),d(e,o)};Y(D,e=>{t.choice.image&&!t.row.objectImageRemoved&&e(W)});var z=J(F,2),G=e=>{var o=dl(),i=p(o);fe(i,21,()=>t.choice.addons,be,(e,o)=>{An(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return u(o)},get isEnabled(){return u(k)},get windowWidth(){return t.windowWidth},get preloadImages(){return r()}})});var n=J(i,2),l=e=>{const o=K(()=>u(k)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Rn(e,{get isEnabled(){return u(o)},get multiChoiceButton(){return u(V)},get multiChoiceText(){return u(q)},get choice(){return t.choice},selectedOneMore:()=>ne(t.choice,t.row),selectedOneLess:()=>le(t.choice,t.row)})};Y(n,e=>{t.choice.isSelectableMultiple&&u(L)&&4===u(w).multiChoiceCounterPosition&&e(l)}),T(()=>I(i,1,`d-column pa-0 col justify-content-${t.choice.addonJustify??""}`)),d(e,o)};Y(z,e=>{t.choice.useSeperateAddon&&e(G)}),T(()=>{Te(i,`max-width: ${100-u(B)}%`),Te(F,`max-width: ${u(B)??""}%`)}),d(e,o)};Y(e,e=>{3===t.choice.template&&e(i)},o)};Y(i,e=>{2===t.choice.template?e(n):e(l,!1)}),d(e,o)};Y(c,e=>{t.choice.template>=4||1===t.choice.template||t.windowWidth<=960||t.row.choicesShareTemplate?e(g):e(h,!1)}),T((e,l)=>{I(o,1,e),n=I(i,1,"",null,n,l),I(s,1,`row row-${t.row.id??""} choice-${t.choice.id??""} ${u(M)?"choice-selected":"choice-unselected"} ${u(k)?"choice-enabled":"choice-disabled"} ${u(M)&&u(b).selOverlayOnImage||!u(k)&&u(b).reqOverlayOnImage?"bg-overlay":""} w-100`),Te(s,u(W))},[()=>re(function(){let e=t.choice.objectWidth||t.row.objectWidth,o=function(e){switch(e){case"col-sm-6":case"col-sm-5":return 2;case"col-md-4":return 3;case"col-md-3":return 4;case"w-20":return 5;case"col-lg-2":return 6;case"w-14":return 7;case"w-12":return 8;case"w-11":return 9;case"w-10":return 10;case"w-9":return 11;case"col-xl-1":return 12;default:return 1}}(e),i="col-6"===app.objectsPerRow?2:"col-4"===app.objectsPerRow?3:4;if(l()>1280)return e;if(!(l()>720))return l()>480?1===o?"col-12":"col-6":"col-12";switch(o){case 1:return"col-12";case 2:return"col-6";case 3:return i>2?"col-4":app.objectsPerRow;case 4:return i>3?"col-3":app.objectsPerRow;default:return app.objectsPerRow}}()),()=>({fullHeight:u(F)})]),d(e,o)};Y(se,e=>{!u(k)&&u(b).reqFilterVisibleIsOn||e(de)});var ce=J(se,2),ue=e=>{const t=K(()=>"dlgCommon"===u($));Pi(e,{get open(){return u(t)},onclose:()=>m($,"none"),title:"",get context(){return h.context},closeHandler:(e,t)=>{"accept"===e.detail.action&&h.choice&&h.row?(O=!0,h.choice.wordChangeSelect=t,ie(h.choice,h.row),O=!1):O=!1},isWord:!0,get prevText(){return h.prevText}})};Y(ce,e=>{"dlgCommon"===u($)&&e(ue)}),d(e,ae);var ge=c({activateObject:te});return n(),ge}Se(["click"]);var ml=r('<img alt=""/>'),pl=r('<img alt=""/>'),vl=r('<h2 class="mb-0"><!></h2>'),fl=r('<img alt=""/>'),bl=r('<img alt=""/>'),wl=r('<p class="mb-0"><!></p>'),Tl=r('<img alt=""/>'),Il=r('<img alt=""/>'),yl=r('<div class="col-12 m-0 p-0"><!> <!> <!> <!> <!></div>'),Sl=r('<h2 class="mb-0"><!></h2>'),Cl=r("<p><!></p>"),xl=r('<img alt=""/>'),Bl=r('<img alt=""/>'),$l=r('<div class="col p-0 text-center"><!> <!></div> <div class="col p-0 text-center"><!></div>',1),Al=r('<img alt=""/>'),Ol=r('<img alt=""/>'),kl=r('<h2 class="mb-0"><!></h2>'),Ml=r("<p><!></p>"),Fl=r('<div class="col p-0 text-center"><!></div> <div class="col p-0 text-center"><!> <!></div>',1),Rl=r("<div><!></div>"),jl=r("<div><!></div>"),Dl=r("<div><!> <!></div>");function Pl(e,t){i(t,!0);const o=v(t,"preloadImages",3,!1),l=v(t,"isBackpack",3,!1);let r=g(void 0),h=K(()=>po("privateBackgroundIsOn",t.row)),f=K(()=>po("privateRowImageIsOn",t.row)),b=K(()=>po("privateRowIsOn",t.row)),w=K(()=>po("privateTextIsOn",t.row)),y=g(0),S=K(()=>u(f).rowImageBoxWidth??50),C=K(()=>wo(t.row.requireds)),x=K(()=>t.row.onlyIfNoChoices&&0!==t.row.currentChoices),B=K(()=>{const e=[];if(void 0!==t.row.resultGroupId&&""!==t.row.resultGroupId&&t.row.resultGroupId)for(const[o]of Ct){const i=At.get(o);if(void 0!==i){const o=i.choice,n=i.row;if(!o.isNotResult)if(t.row.resultGroupId===n.resultGroupId)e.push({choice:o,row:n});else if(void 0!==o.groups)for(let i=0;i<o.groups.length;i++)if(o.groups[i]===t.row.resultGroupId){e.push({choice:o,row:n});break}}}else for(const[t]of Ct){const o=At.get(t);if(void 0!==o){const t=o.choice,i=o.row;t.isNotResult||e.push({choice:t,row:i})}}return e.sort((e,t)=>e.row.index!==t.row.index?e.row.index-t.row.index:e.choice.index-t.choice.index),e}),$=K(()=>{if(void 0!==t.row.styling&&t.row.isPrivateStyling&&t.row.privateBackgroundIsOn&&t.row.styling.backgroundImage)return t.row.styling;if(void 0!==app.rowDesignGroups&&t.row.rowDesignGroups)for(let e=0;e<t.row.rowDesignGroups.length;e++){let o=Rt.get(t.row.rowDesignGroups[e]);if(void 0!==o&&o.privateBackgroundIsOn&&o.styling.backgroundImage){let e=o.activatedId,t=kt.get(e);if(""===e||fo(o.activatedId))return o.styling;if(void 0!==app.globalRequirements&&void 0!==t&&wo(t.requireds))return o.styling}}return!1}),A=K(()=>{if(void 0!==t.row.styling&&t.row.isPrivateStyling&&t.row.privateBackgroundIsOn&&t.row.styling.bgColorIsOn&&t.row.styling.backgroundColor)return t.row.styling;if(void 0!==app.rowDesignGroups&&t.row.rowDesignGroups)for(let e=0;e<t.row.rowDesignGroups.length;e++){let o=Rt.get(t.row.rowDesignGroups[e]);if(void 0!==o&&o.privateBackgroundIsOn&&o.styling.bgColorIsOn&&o.styling.backgroundColor){let e=o.activatedId,t=kt.get(e);if(""===e||fo(o.activatedId))return o.styling;if(void 0!==app.globalRequirements&&void 0!==t&&wo(t.requireds))return o.styling}}return!1}),O=K(()=>{let e=[];return e.push(`margin: ${u(b).rowBodyMarginTop}px ${u(b).rowBodyMarginSides}% ${u(b).rowBodyMarginBottom}px ${u(b).rowBodyMarginSides}%;`),u($)&&e.push(`background-image: url('${u($).backgroundImage}'); ${u($).isBackgroundRepeat?"background-repeat: repeat;":u($).isBackgroundFitIn?"background-size: 100% 100%;":"background-size: cover;"}`),u(A)&&e.push(`background-color: ${u(A).backgroundColor};`),e.join(" ")}),k=K(()=>{let e=u(b).rowBorderRadiusIsPixels?"px":"%",t=[];return u(b).rowBorderImage&&t.push(`border-image: url('${u(b).rowBorderImage}') ${u(b).rowBorderImageSliceTop} ${u(b).rowBorderImageSliceRight} ${u(b).rowBorderImageSliceBottom} ${u(b).rowBorderImageSliceLeft} / ${u(b).rowBorderImageWidth}px ${u(b).rowBorderImageRepeat}; border-style: solid; padding: ${u(b).rowBorderImageWidth}px;`),u(h).rowBackgroundImage&&t.push(`background-image: url('${u(h).rowBackgroundImage}'); ${u(h).isRowBackgroundRepeat?"background-repeat: repeat;":u(h).isRowBackgroundFitIn?"background-size: 100% 100%;":"background-size: cover;"}`),u(h).rowBgColorIsOn&&t.push(`background-color: ${u(h).rowBgColor};`),t.push(`margin-left: ${u(b).rowMargin}%; margin-right: ${u(b).rowMargin}%;`),u(b).rowGradientIsOn&&t.push(`background-image: linear-gradient('${u(b).rowGradient}');`),t.push(`border-radius: ${u(b).rowBorderRadiusTopLeft}${e} ${u(b).rowBorderRadiusTopRight}${e} ${u(b).rowBorderRadiusBottomRight}${e} ${u(b).rowBorderRadiusBottomLeft}${e};`),u(b).rowOverflowIsOn&&t.push("overflow: hidden;"),u(b).rowBorderIsOn&&t.push(`border: ${u(b).rowBorderWidth}px ${u(b).rowBorderStyle} ${u(b).rowBorderColor};`),u(b).rowDropShadowIsOn&&(u(b).rowUseBoxShadowIsOn?t.push(`box-shadow: ${u(b).rowDropShadowH}px ${u(b).rowDropShadowV}px ${u(b).rowDropShadowBlur}px ${u(b).rowDropShadowColor};`):t.push(`filter: drop-shadow(${u(b).rowDropShadowH}px ${u(b).rowDropShadowV}px ${u(b).rowDropShadowBlur}px ${u(b).rowDropShadowColor});`)),t.join(" ")}),M=K(()=>`white-space: pre-wrap;font-family: ${u(w).rowTitle}; font-size: ${u(w).rowTitleTextSize}%; text-align: ${u(w).rowTitleAlign}; color: ${u(w).rowTitleColor}`),F=K(()=>`white-space: pre-wrap; font-family: ${u(w).rowText}; font-size: ${u(w).rowTextTextSize}%; text-align: ${u(w).rowTextAlign}; color: ${u(w).rowTextColor}; padding: ${u(b).rowTextPaddingX}px ${u(b).rowTextPaddingY}% ${u(b).rowTextPaddingX}px ${u(b).rowTextPaddingY}%;`),D=K(()=>{let e=u(f).rowImgBorderRadiusIsPixels?"px":"%",t=[];return t.push(`width: ${u(f).rowImageWidth}%; margin-top: ${u(f).rowImageMarginTop}%; margin-bottoom: ${u(f).rowImageMarginBottom}%;`),t.push(`border-radius: ${u(f).rowImgBorderRadiusTopLeft}${e} ${u(f).rowImgBorderRadiusTopRight}${e} ${u(f).rowImgBorderRadiusBottomRight}${e} ${u(f).rowImgBorderRadiusBottomLeft}${e};`),u(f).rowImgOverflowIsOn&&t.push("overflow: hidden;"),u(f).rowImgBorderIsOn&&t.push(`border: ${u(f).rowImgBorderWidth}px ${u(f).rowImgBorderStyle} ${u(f).rowImgBorderColor};`),t.join(" ")}),P=K(()=>`padding-left: ${u(b).rowButtonYPadding}px; padding-right: ${u(b).rowButtonYPadding}px; padding-top: ${u(b).rowButtonXPadding}px; padding-bottom: ${u(b).rowButtonXPadding}px;`);function q(){if(t.row.btnPointAddon&&"sumaddon"===t.row.buttonTypeRadio&&void 0!==t.row.pointTypeRandom){const e=t.row.randomMax??0,o=t.row.randomMin??0,i=Math.floor(Math.random()*(e-o)+o),n=Bt.get(t.row.pointTypeRandom);return void(void 0!==n&&(n.startingSum+=i))}if(t.row.buttonRandom){const e=[],o=t.row.objects.filter(e=>wo(e.requireds)&&!e.isNotSelectable);if(t.row.isWeightedRandom){let e=0;for(let t=0;t<o.length;t++){e+=o[t].randomWeight||100}if(void 0!==t.row.buttonRandomNumber)for(let i=0;i<t.row.buttonRandomNumber;i++){const i=Math.floor(Math.random()*e);let n=0;for(let e=0;e<o.length;e++){const l=o[e];if(n+=l.randomWeight||100,i<n){u(r).activateObject(l,t.row);break}}}}else if(void 0!==t.row.buttonRandomNumber)for(let i=0;i<t.row.buttonRandomNumber;i++){let i,n,l=0,a=100;do{n=Math.floor(Math.random()*o.length),i=o[n],l++}while(t.row.onlyUnselectedChoices&&(-1!==e.indexOf(n)||Ct.has(i.id))&&l<a);i&&-1===e.indexOf(n)&&(e.push(n),u(r).activateObject(i,t.row))}}else if(void 0!==t.row.buttonId){const e=Ft.get(t.row.buttonId);void 0!==e&&(Ct.has(e.id)?t.row.buttonType&&(e.isTrue=!1,Ct.delete(e.id)):(e.isTrue=!0,Ct.set(e.id,{multiple:0,isVariable:!0})))}}n(()=>{if(t.row.deselectChoices&&!u(C))for(let e=0;e<t.row.objects.length;e++){const o=t.row.objects[e];o.isActive&&u(r).activateObject(o,t.row)}});var V=Dl(),L=p(V),N=e=>{var i=Rl(),n=p(i),l=e=>{var i=yl(),n=p(i),l=e=>{var i=R(),n=j(i),l=e=>{const o=K(()=>!t.row.buttonType&&Ct.has(t.row.buttonId??"")||u(x));ge(e,{onclick:q,get disabled(){return u(o)},get style(){return u(P)},variant:"raised",children:(e,o)=>{he(e,{children:(e,o)=>{var i=R(),n=j(i);a(n,()=>t.row.buttonText??"Click"),d(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})},r=(e,i)=>{var n=e=>{var i=R(),n=j(i),l=e=>{ot(e,{get text(){return t.row.imageSourceTooltip},children:(e,i)=>{var n=ml();T(()=>{Ie(n,"src",t.row.image),Te(n,u(D)),Ie(n,"loading",o()?"eager":"lazy")}),d(e,n)},$$slots:{default:!0}})},r=e=>{var i=pl();T(()=>{Ie(i,"src",t.row.image),Te(i,u(D)),Ie(i,"loading",o()?"eager":"lazy")}),d(e,i)};Y(n,e=>{t.row.imageSourceTooltip?e(l):e(r,!1)}),d(e,i)};Y(e,e=>{t.row.image&&e(n)},i)};Y(n,e=>{t.row.isButtonRow?e(l):e(r,!1)}),d(e,i)};Y(n,e=>{(1===t.row.template||t.windowWidth<=960)&&e(l)});var r=J(n,2),s=e=>{var o=vl(),i=p(o);a(i,()=>we.sanitize(mo(t.row.title),Vt)),T(()=>Te(o,u(M))),d(e,o)};Y(r,e=>{""!==t.row.title&&e(s)});var c=J(r,2),g=e=>{var i=R(),n=j(i),l=e=>{const o=K(()=>!t.row.buttonType&&Ct.has(t.row.buttonId??"")||u(x));ge(e,{onclick:q,get disabled(){return u(o)},get style(){return u(P)},variant:"raised",children:(e,o)=>{he(e,{children:(e,o)=>{var i=R(),n=j(i);a(n,()=>t.row.buttonText??"Click"),d(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})},r=(e,i)=>{var n=e=>{var i=R(),n=j(i),l=e=>{ot(e,{get text(){return t.row.imageSourceTooltip},children:(e,i)=>{var n=fl();T(()=>{Ie(n,"src",t.row.image),Te(n,u(D)),Ie(n,"loading",o()?"eager":"lazy")}),d(e,n)},$$slots:{default:!0}})},r=e=>{var i=bl();T(()=>{Ie(i,"src",t.row.image),Te(i,u(D)),Ie(i,"loading",o()?"eager":"lazy")}),d(e,i)};Y(n,e=>{t.row.imageSourceTooltip?e(l):e(r,!1)}),d(e,i)};Y(e,e=>{t.row.image&&e(n)},i)};Y(n,e=>{t.row.isButtonRow?e(l):e(r,!1)}),d(e,i)};Y(c,e=>{5===t.row.template&&e(g)});var h=J(c,2),m=e=>{var o=wl(),i=p(o);a(i,()=>we.sanitize(mo(t.row.titleText),Vt)),T(()=>Te(o,u(F))),d(e,o)};Y(h,e=>{""!==t.row.titleText&&e(m)});var v=J(h,2),f=e=>{var i=R(),n=j(i),l=e=>{const o=K(()=>!t.row.buttonType&&Ct.has(t.row.buttonId??"")||u(x));ge(e,{onclick:q,get disabled(){return u(o)},get style(){return u(P)},variant:"raised",children:(e,o)=>{he(e,{children:(e,o)=>{var i=R(),n=j(i);a(n,()=>t.row.buttonText??"Click"),d(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})},r=(e,i)=>{var n=e=>{var i=R(),n=j(i),l=e=>{ot(e,{get text(){return t.row.imageSourceTooltip},children:(e,i)=>{var n=Tl();T(()=>{Ie(n,"src",t.row.image),Te(n,u(D)),Ie(n,"loading",o()?"eager":"lazy")}),d(e,n)},$$slots:{default:!0}})},r=e=>{var i=Il();T(()=>{Ie(i,"src",t.row.image),Te(i,u(D)),Ie(i,"loading",o()?"eager":"lazy")}),d(e,i)};Y(n,e=>{t.row.imageSourceTooltip?e(l):e(r,!1)}),d(e,i)};Y(e,e=>{t.row.image&&e(n)},i)};Y(n,e=>{t.row.isButtonRow?e(l):e(r,!1)}),d(e,i)};Y(v,e=>{4===t.row.template&&e(f)}),d(e,i)},r=e=>{var i=R(),n=j(i),l=e=>{var i=$l(),n=j(i),l=p(n),r=e=>{var o=Sl(),i=p(o);a(i,()=>we.sanitize(mo(t.row.title),Vt)),T(()=>Te(o,u(M))),d(e,o)};Y(l,e=>{""!==t.row.title&&e(r)});var s=J(l,2),c=e=>{var o=Cl(),i=p(o);a(i,()=>we.sanitize(mo(t.row.titleText),Vt)),T(()=>Te(o,u(F))),d(e,o)};Y(s,e=>{""!==t.row.titleText&&e(c)});var g=J(n,2),h=p(g),m=e=>{const o=K(()=>!t.row.buttonType&&Ct.has(t.row.buttonId??"")||u(x));ge(e,{onclick:q,get disabled(){return u(o)},get style(){return u(P)},variant:"raised",children:(e,o)=>{he(e,{children:(e,o)=>{var i=R(),n=j(i);a(n,()=>t.row.buttonText??"Click"),d(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})},v=(e,i)=>{var n=e=>{var i=R(),n=j(i),l=e=>{ot(e,{get text(){return t.row.imageSourceTooltip},children:(e,i)=>{var n=xl();T(()=>{Ie(n,"src",t.row.image),Te(n,u(D)),Ie(n,"loading",o()?"eager":"lazy")}),d(e,n)},$$slots:{default:!0}})},r=e=>{var i=Bl();T(()=>{Ie(i,"src",t.row.image),Te(i,u(D)),Ie(i,"loading",o()?"eager":"lazy")}),d(e,i)};Y(n,e=>{t.row.imageSourceTooltip?e(l):e(r,!1)}),d(e,i)};Y(e,e=>{t.row.image&&e(n)},i)};Y(h,e=>{t.row.isButtonRow?e(m):e(v,!1)}),T(()=>{Te(n,`max-width: ${100-u(S)}%`),Te(g,`max-width: ${u(S)??""}%`)}),d(e,i)},r=(e,i)=>{var n=e=>{var i=Fl(),n=j(i),l=p(n),r=e=>{const o=K(()=>!t.row.buttonType&&Ct.has(t.row.buttonId??"")||u(x));ge(e,{onclick:q,get disabled(){return u(o)},get style(){return u(P)},variant:"raised",children:(e,o)=>{he(e,{children:(e,o)=>{var i=R(),n=j(i);a(n,()=>t.row.buttonText??"Click"),d(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})},s=(e,i)=>{var n=e=>{var i=R(),n=j(i),l=e=>{ot(e,{get text(){return t.row.imageSourceTooltip},children:(e,i)=>{var n=Al();T(()=>{Ie(n,"src",t.row.image),Te(n,u(D)),Ie(n,"loading",o()?"eager":"lazy")}),d(e,n)},$$slots:{default:!0}})},r=e=>{var i=Ol();T(()=>{Ie(i,"src",t.row.image),Te(i,u(D)),Ie(i,"loading",o()?"eager":"lazy")}),d(e,i)};Y(n,e=>{t.row.imageSourceTooltip?e(l):e(r,!1)}),d(e,i)};Y(e,e=>{t.row.image&&e(n)},i)};Y(l,e=>{t.row.isButtonRow?e(r):e(s,!1)});var c=J(n,2),g=p(c),h=e=>{var o=kl(),i=p(o);a(i,()=>we.sanitize(mo(t.row.title),Vt)),T(()=>Te(o,u(M))),d(e,o)};Y(g,e=>{""!==t.row.title&&e(h)});var m=J(g,2),v=e=>{var o=Ml(),i=p(o);a(i,()=>we.sanitize(mo(t.row.titleText),Vt)),T(()=>Te(o,u(F))),d(e,o)};Y(m,e=>{""!==t.row.titleText&&e(v)}),T(()=>{Te(n,`max-width: ${u(S)??""}%`),Te(c,`max-width: ${100-u(S)}%`)}),d(e,i)};Y(e,e=>{3===t.row.template&&e(n)},i)};Y(n,e=>{2===t.row.template?e(l):e(r,!1)}),d(e,i)};Y(n,e=>{t.row.template>=4||1===t.row.template||t.windowWidth<=960?e(l):e(r,!1)}),T(()=>{I(i,1,`row gx-0 row-${t.row.id??""}`),Te(i,""!==t.row.title?u(k):"")}),d(e,i)};Y(L,e=>{u(C)&&e(N)});var W=J(L,2),E=e=>{var i=jl(),n=p(i),a=e=>{var i=R(),n=j(i);fe(n,17,()=>u(B),be,(e,i,n)=>{s(hl(e,{get row(){return t.row},get choice(){return u(i).choice},index:n,get windowWidth(){return t.windowWidth},get preloadImages(){return o()}}),e=>m(r,e,!0),()=>u(r))}),d(e,i)},c=e=>{var i=R(),n=j(i);fe(n,17,()=>t.row.objects,be,(e,i,n)=>{s(hl(e,{get row(){return t.row},get choice(){return u(i)},index:n,get windowWidth(){return t.windowWidth},get preloadImages(){return o()},get isBackpack(){return l()},get mainDiv(){return t.mainDiv}}),e=>m(r,e,!0),()=>u(r))}),d(e,i)};Y(n,e=>{t.row.isResultRow?e(a):e(c,!1)}),T(()=>I(i,1,`row gx-0 m-0 p-0 justify-${t.row.rowJustify??""}`)),d(e,i)};Y(W,e=>{u(C)&&e(E)}),T(()=>{I(V,1,`row-${t.row.id??""}-bg text-center ${u(C)?"":"hidden"}`),Te(V,u(O))}),Be(V,"clientWidth",e=>m(y,e)),d(e,V),c()}var ql=r('<div><span><!> <!> <span translate="no"> </span> <!> <!></span></div>');var Vl=r("<!> <!>",1),Ll=r('<div class="p-0 col-12"><!></div>'),Nl=r("<div><!></div>"),Wl=r('<div class="container-fluid p-0"><div class="row gx-0"></div></div>'),El=r("<!> <!> <!>",1);function Ul(e,t){i(t,!0);let o=v(t,"open",7),n=g(0),l=g(void 0),r=K(()=>{let e=[];return e.push("overflow-wrap: break-word;"),e.push("white-space: normal;"),app.styling.useBackpackDesign?(app.styling.backpackBgImage&&e.push(`background-image: url('${app.styling.backpackBgImage}');`),e.push(`background-color: ${app.styling.backpackBgColor};`),app.styling.isBackgroundRepeat?e.push("background-repeat: repeat;"):app.styling.isBackpackBgFitIn?e.push("background-size: 100% 100%;"):e.push("background-size: cover;")):(app.styling.backgroundImage&&e.push(`background-image: url('${app.styling.backgroundImage}');`),e.push(`background-color: ${app.styling.backgroundColor};`),app.styling.isBackgroundRepeat?e.push("background-repeat: repeat;"):app.styling.isBackgroundFitIn?e.push("background-size: 100% 100%;"):e.push("background-size: cover;")),e.join(" ")});const a=K(()=>"dlgBackpack"!==Wt.currentDialog?"close":""),h=K(()=>"dlgBackpack"!==Wt.currentDialog?"close":""),f=K(()=>app.styling.backPackWidth??1200);se(e,{get escapeKeyAction(){return u(a)},get scrimClickAction(){return u(h)},get surface$style(){return`width: ${u(f)??""}px; max-width: calc(100vw - 32px);`},get onSMUIDialogClosed(){return t.onclose},get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=El(),i=j(o);de(i,{class:"p-0 m-0 row",tabindex:0,autofocus:!0,children:(e,t)=>{var o=Ll(),i=p(o);ge(i,{onclick:()=>async function(e){if(e)try{Et.labelText="Downloading image...",Et.isOpen=!0,gi(e),await ui(e);const o=(await dt.maxArea({usePromise:!0})).height,i=e.offsetHeight,n=e.offsetWidth;if(i>o){let l=0,r=1;const a=Math.ceil(i/o);for(;l<i;){const s=Math.min(o,i-l),d=document.createElement("div");Et.labelText=`Splitting large image...(${r} / ${a})`,Et.isOpen=!0,d.style.width=`${n}px`,d.style.height=`${s}px`,d.style.overflow="hidden",d.style.position="absolute",d.style.display="block",d.style.top="0",d.style.left="0",d.style.zIndex="-9999",d.style.pointerEvents="none";const c=e.cloneNode(!0);hi(e,c),gi(c),c.style.transform=`translateY(-${l}px)`,c.style.willChange="transform",c.style.backfaceVisibility="hidden",d.appendChild(c),document.body.appendChild(d),await ui(c),await mi(c),await pi(5);try{const e=await k(d,{filter:e=>{var t,o;return!(null==(t=e.classList)?void 0:t.contains("mdc-top-app-bar"))&&!(null==(o=e.classList)?void 0:o.contains("hidden"))}});if(!e)throw new Error("blob creation failed");const t=URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download=`Build_${io()}_part${r++}.png`,o.click(),URL.revokeObjectURL(t)}catch(t){Et.labelText="Download failed: Restricted content detected.",Et.isOpen=!0,console.error(t)}finally{document.body.removeChild(d)}l+=o}Et.labelText="Image downloads complete.",Et.isOpen=!0}else{const t=await k(e,{filter:e=>{var t,o;return!(null==(t=e.classList)?void 0:t.contains("mdc-top-app-bar"))&&!(null==(o=e.classList)?void 0:o.contains("hidden"))}});if(!t)throw new Error("blob creation failed");const o=URL.createObjectURL(t),i=document.createElement("a");i.href=o,i.download=`Build_${io()}.png`,i.click(),URL.revokeObjectURL(o),Et.labelText="Image download complete.",Et.isOpen=!0}}catch(t){Et.labelText="Download failed: Restricted content detected.",Et.isOpen=!0,console.error(t)}else Et.labelText="Download failed: Restricted content detected.",Et.isOpen=!0}(u(l)),class:"h-100",children:(e,t)=>{var o=Vl(),i=j(o);$e(i,{class:"mdi mdi-file-image"});var n=J(i,2);he(n,{children:(e,t)=>{var o=ie("Download Image");d(e,o)},$$slots:{default:!0}}),d(e,o)},$$slots:{default:!0}}),d(e,o)},$$slots:{default:!0}});var a=J(i,2);ce(a,{id:"backpackDialog",class:"p-0",children:(e,t)=>{var o=Wl(),i=p(o);fe(i,21,()=>app.backpack,be,(e,t)=>{var o=Nl();Pl(p(o),{get row(){return u(t)},get windowWidth(){return u(n)},get preloadImages(){return app.preloadImages},isBackpack:!0}),T(()=>I(o,1,re(u(t).width?"col-6":"col-12"))),d(e,o)}),s(o,e=>m(l,e),()=>u(l)),T(()=>Te(o,u(r))),Be(o,"clientWidth",e=>m(n,e)),d(e,o)},$$slots:{default:!0}});var c=J(a,2);ue(c,{children:(e,t)=>{ge(e,{action:"close",children:(e,t)=>{he(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=ie("Close");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),d(e,o)},$$slots:{default:!0}}),c()}var zl=r("<div><!></div>"),Gl=(e,t)=>{e.preventDefault(),t()},Hl=r('<span class="picture-inner-text svelte-k98dno"><!></span>'),_l=r('<span class="picture-inner-text svelte-k98dno"><!></span>'),Yl=r('<div class="picture-inner svelte-k98dno"><!></div>'),Jl=r('<div class="preview-container svelte-k98dno"><canvas tabindex="0"></canvas> <!></div> <!> <!> <!>',1),Xl=r("<div><!></div> <!> <!>",1),Zl=r("<div><!></div>"),Kl=r('<div id="picture-input" class="picture-input svelte-k98dno"><!> <input type="file" class="svelte-k98dno"/></div>');function Ql(e,r){i(r,!0);let h,b,w=v(r,"width",19,()=>Number.MAX_SAFE_INTEGER),y=v(r,"height",19,()=>Number.MAX_SAFE_INTEGER),S=v(r,"margin",3,0),C=v(r,"accept",3,"image/*, image/avif"),x=v(r,"capture",3,null),B=v(r,"size",19,()=>Number.MAX_SAFE_INTEGER),$=v(r,"name",3,null),A=v(r,"id",3,null),O=v(r,"buttonClass",3,""),k=v(r,"removeButtonClass",3,""),M=v(r,"aspectButtonClass",3,""),F=v(r,"prefill",11,""),R=v(r,"prefillOptions",19,()=>({})),D=v(r,"crop",3,!0),P=v(r,"radius",3,0),q=v(r,"removable",3,!1),V=v(r,"hideChangeButton",3,!1),L=v(r,"autoToggleAspectRatio",3,!1),N=v(r,"toggleAspectRatio",3,!1),W=v(r,"changeOnClick",3,!0),E=v(r,"plain",3,!1),U=v(r,"zIndex",3,1e4),z=v(r,"alertOnError",3,!0),G=v(r,"customStrings",19,()=>({})),H=g(!1),X=g(0),Z=g(0),Q=g(!1),ee=g(0),te=g(0),oe=g(1),le=g(0),re=g(""),ae=g(null),se=g(null),de=g(""),ce=g(0),ue=g(0),me=g(""),pe=g(!1),ve=g(0),fe=g(0),be=g(0),we=g(null),ye=g(o([])),Se={upload:"<p>Your device does not support file uploading.</p>",drag:"Drag an image or <br>click here to select a file",tap:"Tap here to select a photo <br>from your gallery",change:"Change Photo",aspect:"Landscape/Portrait",remove:"Remove Photo",select:"Select a Photo",selected:"<p>Photo successfully selected!</p>",fileSize:"The file size exceeds the limit",fileType:"This file type is not supported."},Ce=g(void 0);const xe=K(()=>{if(navigator.userAgent.match(/(Android (1\.0|1\.1|1\.5|1\.6|2\.0|2\.1))|(Windows Phone (OS 7|8\.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1\.0|2\.0|2\.5|3\.0))/))return!1;const e=document.createElement("input");return e.type="file",!e.disabled}),Be=K(()=>!(!window.FileReader||!window.CanvasRenderingContext2D)),$e=K(()=>{const e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&!("ontouchstart"in window||navigator.maxTouchPoints)}),Oe=K(()=>u(Q)?"dragging-over":""),ke=K(()=>`${Math.min(.04*u(Z),21)}px`);function Me(){u(H)&&!W()||qe(),r.onclick&&r.onclick()}function Fe(){Ne()&&u(ae)&&Pe(u(ae))}function Re(){u($e)&&m(Q,!1)}function je(e,t=!1){var o;const i=e.target,n="drop"===e.type?null==(o=e.dataTransfer)?void 0:o.files:i.files;if(n&&0!==n.length){if(n[0].size<=0||n[0].size>1024*Number(B())*1024)return r.onerror&&r.onerror({type:"fileSize",fileSize:n[0].size,fileType:n[0].type,fileName:n[0].name,message:`${Se.fileSize} (${B()}MB)`}),void(z()&&alert(`${Se.fileSize} (${B()}MB)`));if(n[0].name!==u(de)||n[0].size!==u(ce)||u(ue)!==n[0].lastModified){if(m(se,n[0],!0),m(de,n[0].name,!0),m(ce,n[0].size,!0),m(ue,n[0].lastModified,!0),m(me,n[0].type.split(";")[0],!0),"image/*, image/avif"===C()){if(!u(me).startsWith("image/"))return}else if(-1===u(ye).indexOf(u(me)))return r.onerror&&r.onerror({type:"fileType",fileSize:u(ce),fileType:u(me),fileName:u(de),message:Se.fileType}),void(z()&&alert(Se.fileType));m(H,!0),m(re,""),u(Be)&&u(se)?De(u(se)):t?r.onprefill&&r.onprefill():r.onchange&&r.onchange(u(re))}}}function De(e,t){!function(e,t){const o=new FileReader;o.onload=e=>{const o=new DataView(e.target.result);if(65496!==o.getUint16(0,!1))return t(-2);const i=o.byteLength;let n=2;for(;n<i;){const e=o.getUint16(n,!1);if(n+=2,65505===e){if(1165519206!==o.getUint32(n+=2,!1))return t(-1);const e=18761===o.getUint16(n+=6,!1);n+=o.getUint32(n+4,e);const i=o.getUint16(n,e);n+=2;for(let l=0;l<i;l++)if(274===o.getUint16(n+12*l,e))return t(o.getUint16(n+12*l+8,e))}else{if(65280&~e)break;n+=o.getUint16(n,!1)}}return t(-1)},o.readAsArrayBuffer(e.slice(0,65536))}(e,t=>{!function(e){m(pe,!1),8===e?m(pe,-Math.PI/2):6===e?m(pe,Math.PI/2):3===e&&m(pe,-Math.PI)}(t);const o=new FileReader;o.onload=e=>{m(re,e.target.result,!0),m(ae,new Image,!0),u(ae).onload=()=>{if(L()){We(u(ee),u(te))!==We(u(ae).width,u(ae).height)&&Ee()}Pe(u(ae))},u(ae).src=u(re),r.onchange&&r.onchange(u(re))},o.readAsDataURL(e)})}function Pe(e){m(ve,e.width,!0),m(fe,e.height,!0),m(be,e.width/e.height);let t=0,o=0,i=u(Z),n=u(X);const l=u(Z)/u(X);D()?u(be)>=l?(i=n*u(be),t=(u(Z)-i)/2):(n=i/u(be),o=(u(X)-n)/2):u(be)>=l?(n=i/u(be),o=(u(X)-n)/2):(i=n*u(be),t=(u(Z)-i)/2),u(Ce)&&(u(Ce).style.background="none",u(Ce).width=u(Z)*u(oe),u(Ce).height=u(X)*u(oe),u(we)&&(u(we).setTransform(1,0,0,1,0,0),u(we).clearRect(0,0,u(Ce).width,u(Ce).height),u(pe)&&void 0===e.style.imageOrientation&&(u(we).translate(t*u(oe),o*u(oe)),u(we).translate(i/2*u(oe),n/2*u(oe)),u(we).rotate(u(pe)),t=-i/2,o=-n/2),u(we).drawImage(e,t*u(oe),o*u(oe),i*u(oe),n*u(oe))))}function qe(){b.click()}function Ve(){b.value="",b.type="",b.type="file",m(de,""),m(me,""),m(ce,0),m(ue,0),m(H,!1),m(re,""),m(se,null),m(ae,null),u(Ce)&&(u(Ce).style.backgroundColor="rgba(200,200,200,.25)",u(Ce).width=u(Z)*u(oe)),r.onremove&&r.onremove()}function Le(){Ee(),u(ae)&&Pe(u(ae));const e=We(u(ee),u(te));r.onaspectratiochange&&r.onaspectratiochange(e)}function Ne(){const e=u(ee)/u(te),t=h.clientWidth;return!!t&&(!(!N()&&!L()&&t===u(le))&&(m(le,t,!0),m(Z,Math.min(u(le)-2*Number(S()),u(ee)),!0),m(X,u(Z)/e),!0))}function We(e,t){return e>t?"landscape":e<t?"portrait":"square"}function Ee(){!function(){const e=u(ee);m(ee,u(te),!0),m(te,e,!0)}(),Ne()}function Ue(e,o){let i=window.File;try{new i([],"")}catch(l){i=class extends Blob{constructor(e,o,i={}){super(e,i),t(this,"lastModifiedDate",new Date),t(this,"lastModified",+this.lastModifiedDate),t(this,"name"),this.name=o}}}if(o=Object.assign({},o),"object"==typeof e)return m(H,!0),m(re,""),void(u(Be)?De(e):r.onprefill&&r.onprefill());-1===e.indexOf("data:")&&(e+=-1!==e.indexOf("?")?"&_="+(new Date).getTime():"?_="+(new Date).getTime());const n=new Headers;n.append("Accept","image/*, image/avif"),fetch(e,{method:"GET",mode:"cors",headers:n}).then(e=>e.blob()).then(t=>{const n={target:{files:[]}},l=o.fileName||e.split("/").slice(-1)[0];let r=o.mediaType||t.type||"image/"+(o.fileType||l.split("?")[0].split(".").slice(-1)[0]);r=r.replace("jpg","jpeg").replace("image/svg","image/svg+xml"),"image/svg"===r&&(r="image/svg+xml"),n.target.files[0]=new i([t],l,{type:r}),je(n,!0)}).catch(e=>{r.onerror&&r.onerror({type:"failedPrefill",message:"Failed loading prefill image: "+e}),z()&&alert("Failed loading prefill image: "+e)})}n(()=>{F()&&Ue(F(),R())}),f(async()=>{await _(),function(){if(G())for(const e in G())e in Se&&"string"==typeof G()[e]&&(Se[e]=G()[e])}(),F()&&Ue(F(),R()),window.addEventListener("resize",Fe),Fe(),u(Be)&&u(Ce)&&(m(oe,Math.round(window.devicePixelRatio||1),!0),u(Ce).getContext&&(m(we,u(Ce).getContext("2d"),!0),u(we)&&u(we).scale(u(oe),u(oe)))),"image/*, image/avif"!==C()&&m(ye,C().split(",").map(e=>e.trim()),!0),m(ee,w()!=Number.MAX_SAFE_INTEGER?Number(w()):h.clientWidth,!0),m(te,y()!=Number.MAX_SAFE_INTEGER?Number(y()):u(ee),!0),m(Z,u(ee),!0),m(X,u(te),!0)}),l(()=>{window.removeEventListener("resize",Fe)});var ze=Kl(),Ge=p(ze),He=e=>{var t=zl(),o=p(t);a(o,()=>Se.upload),d(e,t)},_e=(e,t)=>{var o=e=>{var t=Jl(),o=j(t),i=p(o);i.__click=[Gl,Me],s(i,e=>m(Ce,e),()=>u(Ce));var n=J(i,2),l=e=>{var t=Yl(),o=p(t),i=e=>{var t=Hl(),o=p(t);a(o,()=>Se.drag),d(e,t)},n=e=>{var t=_l(),o=p(t);a(o,()=>Se.tap),d(e,t)};Y(o,e=>{u($e)?e(i):e(n,!1)}),T(e=>Te(t,`top: -${u(X)??""}px; margin-bottom: -${u(X)??""}px; font-size: ${u(ke)??""}; border-radius: ${P()??""}%; z-index: ${e??""};`),[()=>parseInt(U()+"")+2]),d(e,t)};Y(n,e=>{u(H)||E()||e(l)});var r=J(o,2),c=e=>{ge(e,{variant:"raised",onclick:qe,get class(){return O()},children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie();T(()=>ne(o,Se.change)),d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};Y(r,e=>{u(H)&&!V()&&e(c)});var g=J(r,2),h=e=>{ge(e,{variant:"raised",onclick:Ve,get class(){return k()},children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie();T(()=>ne(o,Se.remove)),d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};Y(g,e=>{u(H)&&q()&&e(h)});var v=J(g,2),f=e=>{ge(e,{variant:"raised",onclick:Le,get class(){return M()},children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie();T(()=>ne(o,Se.aspect)),d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};Y(v,e=>{u(H)&&N()&&w()!==y()&&e(f)}),T(e=>{Te(o,`max-width: ${u(Z)??""}px; height: ${u(X)??""}px; border-radius: ${P()??""}%;`),I(i,1,`picture-preview ${u(Oe)??""}`,"svelte-k98dno"),Te(i,`height: ${u(X)??""}px; z-index: ${e??""};`)},[()=>parseInt(U()+"")+1]),Ae("drag",i,e=>{e.stopPropagation(),e.preventDefault()}),Ae("dragover",i,e=>{e.stopPropagation(),e.preventDefault()}),Ae("dragstart",i,e=>{e.stopPropagation(),e.preventDefault()}),Ae("dragend",i,e=>{e.stopPropagation(),e.preventDefault()}),Ae("dragenter",i,e=>{e.stopPropagation(),e.preventDefault(),u($e)&&m(Q,!0)}),Ae("dragleave",i,e=>{e.stopPropagation(),e.preventDefault(),Re()}),Ae("drop",i,e=>{e.stopPropagation(),e.preventDefault(),function(e){Re(),je(e)}(e)}),d(e,t)},i=e=>{var t=Zl(),o=p(t),i=e=>{ge(e,{variant:"raised",onclick:qe,get class(){return O()},children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie();T(()=>ne(o,Se.select)),d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},n=e=>{var t=Xl(),o=j(t),i=p(o);a(i,()=>Se.selected);var n=J(o,2),l=e=>{ge(e,{variant:"raised",onclick:qe,get class(){return O()},children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie();T(()=>ne(o,Se.change)),d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};Y(n,e=>{V()||e(l)});var r=J(n,2),s=e=>{ge(e,{variant:"raised",onclick:Ve,get class(){return k()},children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie();T(()=>ne(o,Se.remove)),d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};Y(r,e=>{q()&&e(s)}),d(e,t)};Y(o,e=>{u(H)?e(n,!1):e(i)}),d(e,t)};Y(e,e=>{u(Be)?e(o):e(i,!1)},t)};Y(Ge,e=>{u(xe)?e(_e,!1):e(He)});var Ye=J(Ge,2);Ye.__change=je,s(Ye,e=>b=e,()=>b),s(ze,e=>h=e,()=>h),T(()=>{Ie(Ye,"name",$()),Ie(Ye,"id",A()),Ie(Ye,"accept",C()),Ie(Ye,"capture",x())}),d(e,ze),c()}Se(["click","change"]);var er=r('<div class="mb-4 text-left"><!></div>'),tr=r('<img alt="Converted" loading="lazy" class="svelte-1br61l5"/> <!> <!>',1),or=r('<div class="col col-lg-4"><!> <!></div> <div class="col col-lg-8"><!></div>',1),ir=r('<div><img alt="Cropper" loading="lazy" class="cropper-image svelte-1br61l5"/></div>'),nr=r('<div class="row justify-center"><div class="col"><!></div> <div class="col"><!></div> <div class="col"><!></div></div> <div class="mt-2"><!></div> <!>',1),lr=r('<div class="pt-3 col col-12"><img alt="Compress" loading="lazy" class="svelte-1br61l5"/></div>'),rr=r('<div class="row justify-center"><div class="col"><!></div> <div class="col"><!></div> <div class="col"><!></div> <!></div>'),ar=r('<div class="col col-lg-4"><div><!></div> <div><b>Before:</b> <b>After:</b> </div> <!></div> <div class="col-lg-8"><!> <!> <!></div>',1),sr=r('<div class="container"><!> <div class="row"><!></div></div>'),dr=r("<!> <!> <!>",1);function cr(e,t){i(t,!0);let o,l=v(t,"open",7),r=v(t,"imgObject",7),a=v(t,"canHaveURL",3,!0),h=g("Cropper"),f=g(100),b=g(90),y=!1,S=g(1),C=g(1),x=g(void 0),B=g(void 0),$=g(void 0),A=g(!1),O=0,k=K(()=>{if(u(B)){const e=function(e){const t=e.match(/^data:.+;base64,(.+)$/);return t?t[1]:e}(u(B)).length*(3/4)-2;return Math.round(e/1024)}return 0}),M=K(()=>{if(u($)){const e=u($).split(",")[1].length*(3/4)-2;return Math.round(e/1024)}return 0});function F(){const e=L(r(),t.imgProp);e&&q(e)}function R(){u($)&&V(r(),t.imgProp,u($),!1)}function D(){o&&o.setAspectRatio(u(C)/u(S))}function P(){if(o&&u(x)){const e=o.getCroppedCanvas().toDataURL("image/webp");u(x).src=e,V(r(),t.imgProp,e)}}function q(e){const t=document.createElement("canvas"),o=t.getContext("2d"),i=new Image;i.crossOrigin="anonymous",i.onload=()=>{const e=u(f)/100,n=i.width*e,l=i.height*e;t.setAttribute("width",n.toString()),t.setAttribute("height",l.toString()),null==o||o.drawImage(i,0,0,n,l),m($,t.toDataURL("image/webp",u(b)),!0),O++,y&&O>1&&(y=!1,R(),O=0)},i.src=e}function V(e,t,i,n=!0){e&&(e[t]=i,m(B,i,!0),o&&o.replace(i),n&&q(i))}function L(e,t){return e&&e[t]?e[t]:""}n(()=>(u(x)?o=new Oe(u(x),{viewMode:3,dragMode:"move"}):o&&o.destroy(),()=>{o&&o.destroy()})),se(e,{surface$style:"width: 1200px; max-width: calc(100vw - 32px);",style:"text-align: center",get onSMUIDialogClosed(){return t.onclose},get open(){return l()},set open(e){l(e)},children:(e,o)=>{var i=dr(),n=j(i);de(n,{tabindex:0,autofocus:!0,children:(e,t)=>{var o=ie("Image");d(e,o)},$$slots:{default:!0}});var c=J(n,2);ce(c,{children:(e,o)=>{var i=sr(),n=p(i),c=e=>{var t=er(),o=p(t);me(o,{label:e=>{var t=ie("Uploaded Image or External URL.");d(e,t)},children:(e,t)=>{pe(e,{color:"secondary",class:"switch-scale",get checked(){return u(A)},set checked(e){m(A,e,!0)}})},$$slots:{label:!0,default:!0}});d(e,t)};Y(n,e=>{a()&&e(c)});var g=J(n,2),v=p(g),B=e=>{var o=or(),i=j(o),n=p(i);Mi(n,{get value(){return(null==(e=r())?void 0:e.imageLink)??"";var e},set value(e){var t;t=e,r().imageLink=t},label:"External Image URL",variant:"filled"});var l=J(n,2);ge(l,{onclick:()=>{V(r(),t.imgProp,r().imageLink)},variant:"raised",children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie("Convert URL to Image");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var a=J(i,2),s=p(a),c=e=>{var o=tr(),i=j(o),n=J(i,2);ge(n,{onclick:()=>{V(r(),t.imgProp,""),delete r().imageLink},variant:"raised",class:"my-3",children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie("Remove Photo");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var l=J(n,2);Mi(l,{get value(){return(null==(e=r())?void 0:e.imageSourceTooltip)??"";var e},set value(e){var t;t=e,r().imageSourceTooltip=t},label:"Tooltip That Shows When Hovering over it",variant:"filled"}),T(e=>Ie(i,"src",e),[()=>L(r(),t.imgProp)]),d(e,o)};Y(s,e=>{void 0!==L(r(),t.imgProp)&&""!==L(r(),t.imgProp)&&e(c)}),d(e,o)},$=e=>{var o=ar(),i=j(o),n=p(i),a=p(n),c=e=>{const o=K(()=>Vo(L(r(),t.imgProp))?L(r(),t.imgProp):"");Ql(e,{hideChangeButton:!0,removable:!0,crop:!1,get prefill(){return u(o)},onchange:e=>{V(r(),t.imgProp,e)},onclick:()=>y=app.compressImageAuto,onremove:()=>V(r(),t.imgProp,"")})};Y(a,e=>{l()&&e(c)});var g=J(n,2);let v;var B=J(p(g)),$=J(B,2),A=J(g,2);Mi(A,{get value(){return(null==(e=r())?void 0:e.imageSourceTooltip)??"";var e},set value(e){var t;t=e,r().imageSourceTooltip=t},label:"Tooltip That Shows When Hovering over it",variant:"filled"});var O=J(i,2),q=p(O);{const e=(e,t=w)=>{Re(e,{get tab(){return t()},children:(e,o)=>{he(e,{children:(e,o)=>{var i=ie();T(()=>ne(i,t())),d(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})};ke(q,{tabs:["Cropper","Compress"],get active(){return u(h)},set active(e){m(h,e,!0)},tab:e,$$slots:{tab:!0}})}var N=J(q,2);const W=K(()=>"Cropper"!==u(h)?"display: none;":"");Me(N,{role:"tabpanel",variant:"unelevated",get style(){return u(W)},children:(e,o)=>{Fe(e,{children:(e,o)=>{var i=nr(),n=j(i),l=p(n);Mi(p(l),{label:"Width Aspect",type:"number",variant:"filled",get value(){return u(C)},set value(e){m(C,e,!0)}});var a=J(l,2);Mi(p(a),{label:"Height Aspect",type:"number",variant:"filled",get value(){return u(S)},set value(e){m(S,e,!0)}});var c=J(a,2),g=p(c);ge(g,{onclick:D,variant:"raised",style:"height: 100%;",children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie("Change Aspect");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var h=J(n,2),v=p(h);ge(v,{onclick:P,variant:"raised",children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie("Crop Image");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var f=J(h,2),b=e=>{var o=ir(),i=p(o);s(i,e=>m(x,e),()=>u(x)),T(e=>Ie(i,"src",e),[()=>L(r(),t.imgProp)]),d(e,o)};Y(f,e=>{Vo(L(r(),t.imgProp))&&e(b)}),d(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}});var E=J(N,2);const U=K(()=>"Compress"!==u(h)?"display: none;":"");Me(E,{role:"tabpanel",variant:"unelevated",get style(){return u(U)},children:(e,o)=>{Fe(e,{children:(e,o)=>{var i=rr(),n=p(i);Mi(p(n),{onchange:F,label:"Image Scale",type:"number",variant:"filled",get value(){return u(f)},set value(e){m(f,e,!0)}});var l=J(n,2);Mi(p(l),{onchange:F,label:"Image Quality",type:"number",variant:"filled",get value(){return u(b)},set value(e){m(b,e,!0)}});var a=J(l,2),s=p(a);ge(s,{onclick:R,variant:"raised",style:"height: 100%;",children:(e,t)=>{he(e,{children:(e,t)=>{var o=ie("Compress Image");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var c=J(a,2),g=e=>{var o=lr(),i=p(o);T(e=>Ie(i,"src",e),[()=>L(r(),t.imgProp)]),d(e,o)};Y(c,e=>{Vo(L(r(),t.imgProp))&&e(g)}),d(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}}),T(e=>{v=I(g,1,"pa-4",null,v,e),ne(B,`${u(k)??""} kB|`),ne($,`${u(M)??""} kB`)},[()=>({hidden:!L(r(),t.imgProp)})]),d(e,o)};Y(v,e=>{u(A)?e(B):e($,!1)}),d(e,i)},$$slots:{default:!0}});var g=J(c,2);ue(g,{children:(e,t)=>{ge(e,{action:"close",children:(e,t)=>{he(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=ie("Close");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),d(e,i)},$$slots:{default:!0}}),c()}let ur=0;var gr=r("<div><!></div>");let hr=0;var mr=r("<input/>"),pr=r('<span class="mdc-select__ripple"></span>'),vr=r('<div><!> <div><!> <!> <!> <!> <span><span> </span></span> <span><svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false"><polygon class="mdc-select__dropdown-icon-inactive" stroke="none" fill-rule="evenodd" points="7 10 12 15 17 10"></polygon><polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd" points="7 15 12 10 17 15"></polygon></svg></span> <!></div> <!></div> <!>',1);function fr(e,t){i(t,!0);const[r,a]=Ce(),h=()=>xe(Ke,"$selectedTextStore",r);let I=()=>{};function y(e){return e===I}let S=v(t,"use",19,()=>[]),C=v(t,"class",3,""),x=v(t,"style",3,""),B=v(t,"ripple",3,!0),A=v(t,"disabled",3,!1),O=v(t,"variant",3,"standard"),k=v(t,"noLabel",3,!1),M=v(t,"label",3,void 0),N=v(t,"value",15),W=v(t,"key",3,e=>e),z=v(t,"dirty",15,!1),G=v(t,"invalid",15,I),H=v(t,"updateInvalid",19,()=>y(G())),_=v(t,"required",3,!1),Z=v(t,"inputId",19,()=>"SMUI-select-"+hr++),re=v(t,"hiddenInput",3,!1),se=v(t,"withLeadingIcon",3,I),de=v(t,"anchor$use",19,()=>[]),ce=v(t,"anchor$class",3,""),ue=v(t,"selectedTextContainer$use",19,()=>[]),ge=v(t,"selectedTextContainer$class",3,""),he=v(t,"selectedText$use",19,()=>[]),me=v(t,"selectedText$class",3,""),pe=v(t,"dropdownIcon$use",19,()=>[]),ve=v(t,"dropdownIcon$class",3,""),fe=v(t,"menu$class",3,""),be=v(t,"alwaysFloat",3,!1),we=D(t,["$$slots","$$events","$$legacy","use","class","style","ripple","disabled","variant","noLabel","label","value","key","dirty","invalid","updateInvalid","required","inputId","hiddenInput","withLeadingIcon","anchor$use","anchor$class","selectedTextContainer$use","selectedTextContainer$class","selectedText$use","selectedText$class","dropdownIcon$use","dropdownIcon$class","menu$class","children","leadingIcon","helperText","alwaysFloat"]);const Te=y(G());let Ie;y(G())&&G(!1);let ye,Se=g(void 0),Be=o({}),$e=o({}),Ae=o({}),Oe=g(-1);const ke=K(()=>we.menu$id??Z()+"-menu");let Me,Fe,Re,Ne,We=g(void 0),Ee=E("SMUI:addLayoutListener"),Ue=g(!1),ze=o({}),Ge=g(void 0),He=g(void 0),_e=g(!1),Ye=E("SMUI:select:context"),Je=g(void 0),Xe=g(void 0),Ze=g(void 0);U("SMUI:list:role",""),U("SMUI:list:nav",!1);const Ke=$("");U("SMUI:select:selectedText",Ke);const Qe=$(N());n(()=>{De(Qe,N())}),U("SMUI:select:value",Qe),n(()=>{u(Se)&&u(Se).getValue()!==W()(N())&&u(Se).setValue(W()(N()))});let et=u(Oe);function tt(e){return e in Be?Be[e]:ht().classList.contains(e)}function ot(e){Be[e]||(Be[e]=!0)}function it(e){e in Be&&!Be[e]||(Be[e]=!1)}function nt(e,t){$e[e]!=t&&(""===t||null==t?delete $e[e]:$e[e]=t)}function lt(e){ze[e]||(ze[e]=!0)}function rt(e){e in ze&&!ze[e]||(ze[e]=!1)}function at(e){return e in Ae?Ae[e]??null:ht().getAttribute(e)}function st(e,t){Ae[e]!==t&&(Ae[e]=t)}function dt(e){e in Ae&&null==Ae[e]||(Ae[e]=void 0)}function ct(){return Fe.getOrderedList().map(e=>e.getValue())}function ut(e){var t;null==(t=u(Se))||t.setUseDefaultValidation(e)}function gt(){var e;null==(e=u(Se))||e.layout()}function ht(){return Ie}n(()=>{if(et!==u(Oe))if(et=u(Oe),u(Se))u(Se).setSelectedIndex(u(Oe),!1,!0);else{const e=ct();N()!==e[u(Oe)]&&N(e[u(Oe)])}}),n(()=>{u(Se)&&u(Se).getDisabled()!==A()&&u(Se).setDisabled(A())}),n(()=>{u(Se)&&z()&&u(Se).isValid()!==!G()&&(H()?G(!u(Se).isValid()):u(Se).setValid(!G()))}),n(()=>{u(Se)&&u(Se).getRequired()!==_()&&u(Se).setRequired(_())}),Ee&&(Me=Ee(gt)),U("SMUI:select:leading-icon:mount",e=>{Re=e}),U("SMUI:select:leading-icon:unmount",()=>{Re=void 0}),U("SMUI:list:mount",e=>{Fe=e}),U("SMUI:select:helper-text:id",e=>{m(We,e,!0)}),U("SMUI:select:helper-text:mount",e=>{Ne=e}),U("SMUI:select:helper-text:unmount",()=>{m(We,void 0),Ne=void 0}),f(()=>(m(Se,new Pe({setSelectedText:e=>{De(Ke,e)},isSelectAnchorFocused:()=>document.activeElement===ye,getSelectAnchorAttr:at,setSelectAnchorAttr:st,removeSelectAnchorAttr:dt,addMenuClass:lt,removeMenuClass:rt,openMenu:()=>{m(Ue,!0)},closeMenu:()=>{m(Ue,!1)},getAnchorElement:()=>ye,setMenuAnchorElement:e=>{m(Ge,e,!0)},setMenuAnchorCorner:e=>{m(He,e,!0)},setMenuWrapFocus:e=>{m(_e,e,!0)},getSelectedIndex:()=>u(Oe),setSelectedIndex:e=>{et=e,m(Oe,e,!0),N(ct()[u(Oe)])},focusMenuItemAtIndex:e=>{Fe.focusItemAtIndex(e)},getMenuItemCount:()=>Fe.items.length,getMenuItemValues:()=>ct().map(W()),getMenuItemTextAtIndex:e=>Fe.getPrimaryTextAtIndex(e),isTypeaheadInProgress:()=>Fe.typeaheadInProgress,typeaheadMatchItem:(e,t)=>Fe.typeaheadMatchItem(e,t),addClass:ot,removeClass:it,hasClass:tt,setRippleCenter:e=>u(Xe)&&u(Xe).setRippleCenter(e),activateBottomLine:()=>u(Xe)&&u(Xe).activate(),deactivateBottomLine:()=>u(Xe)&&u(Xe).deactivate(),notifyChange:e=>{var t;z(!0),H()&&G(!(null==(t=u(Se))?void 0:t.isValid())),le(ht(),"SMUISelectChange",{value:N(),index:u(Oe)})},hasOutline:()=>!!u(Ze),notchOutline:e=>u(Ze)&&u(Ze).notch(e),closeOutline:()=>u(Ze)&&u(Ze).closeNotch(),hasLabel:()=>!!u(Je),floatLabel:e=>u(Je)&&u(Je).float(e||be()),getLabelWidth:()=>u(Je)?u(Je).getWidth():0,setLabelRequired:e=>u(Je)&&u(Je).setRequired(e)},{get helperText(){return Ne},get leadingIcon(){return Re}}),!0),m(Oe,ct().indexOf(N()),!0),u(Se).init(),ut(Te),()=>{var e;null==(e=u(Se))||e.destroy()})),l(()=>{Me&&Me()});var mt=vr(),pt=j(mt);P(pt,(e,t,o)=>({class:e,style:t,...o}),[()=>q({[C()]:!0,"mdc-select":!0,"mdc-select--required":_(),"mdc-select--disabled":A(),"mdc-select--filled":"filled"===O(),"mdc-select--outlined":"outlined"===O(),"smui-select--standard":"standard"===O(),"mdc-select--with-leading-icon":y(se())?t.leadingIcon:se(),"mdc-select--no-label":k()||null==M(),"mdc-select--invalid":G(),"mdc-select--activated":u(Ue),"mdc-data-table__pagination-rows-per-page-select":"data-table:pagination"===Ye,...Be}),()=>Object.entries($e).map(([e,t])=>`${e}: ${t};`).concat([x()]).join(" "),()=>X(we,["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])]);var vt=p(pt),ft=e=>{var t=mr();P(t,e=>({type:"hidden",required:_(),disabled:A(),value:N(),...e}),[()=>ee(we,"input$")]),d(e,t)};Y(vt,e=>{re()&&e(ft)});var bt=J(vt,2),wt=e=>{var o;ye.focus(),u(Se)&&u(Se).handleClick(function(e){const t=e.currentTarget.getBoundingClientRect();return(function(e){return"touches"in e}(e)?e.touches[0].clientX:e.clientX)-t.left}(e)),null==(o=t.anchor$onclick)||o.call(t,e)},Tt=e=>{var o;u(Se)&&u(Se).handleKeydown(e),null==(o=t.onkeydown)||o.call(t,e)},It=e=>{var o;u(Se)&&u(Se).handleBlur(),le(ht(),"blur",e),null==(o=t.anchor$onblur)||o.call(t,e)},yt=e=>{var o;u(Se)&&u(Se).handleFocus(),le(ht(),"focus",e),null==(o=t.anchor$onfocus)||o.call(t,e)};P(bt,(e,t)=>({class:e,"aria-required":_()?"true":void 0,"aria-disabled":A()?"true":void 0,"aria-controls":u(ke),"aria-expanded":u(Ue)?"true":"false","aria-describedby":u(We),role:"combobox",tabindex:"0",...Ae,...t,onclick:wt,onkeydown:Tt,onblur:It,onfocus:yt}),[()=>q({[ce()]:!0,"mdc-select__anchor":!0}),()=>ee(we,"anchor$")]);var St=p(bt),Ct=e=>{var t=pr();d(e,t)};Y(St,e=>{"filled"===O()&&e(Ct)});var xt=J(St,2),Bt=e=>{const t=K(()=>Z()+"-smui-label"),o=K(()=>""!==h()||be());var i=K(()=>ee(we,"label$"));s(oe(e,F({get id(){return u(t)},get floatAbove(){return u(o)},get required(){return _()}},()=>u(i),{children:(e,t)=>{var o=R(),i=j(o),n=e=>{},l=(e,t)=>{var o=e=>{var t=ie();T(()=>ne(t,M())),d(e,t)},i=e=>{var t=R(),o=j(t);b(o,M),d(e,t)};Y(e,e=>{"string"==typeof M()?e(o):e(i,!1)},t)};Y(i,e=>{null==M()?e(n):e(l,!1)}),d(e,o)},$$slots:{default:!0}})),e=>m(Je,e,!0),()=>u(Je))};Y(xt,e=>{"outlined"===O()||k()||null==M()||e(Bt)});var $t=J(xt,2),At=e=>{const t=K(()=>k()||null==M());var o=K(()=>ee(we,"outline$"));s(te(e,F({get noLabel(){return u(t)}},()=>u(o),{children:(e,t)=>{var o=R(),i=j(o),n=e=>{const t=K(()=>Z()+"-smui-label"),o=K(()=>""!==h()||be());var i=K(()=>ee(we,"label$"));s(oe(e,F({get id(){return u(t)},get floatAbove(){return u(o)},get required(){return _()}},()=>u(i),{children:(e,t)=>{var o=R(),i=j(o),n=e=>{},l=(e,t)=>{var o=e=>{var t=ie();T(()=>ne(t,M())),d(e,t)},i=e=>{var t=R(),o=j(t);b(o,M),d(e,t)};Y(e,e=>{"string"==typeof M()?e(o):e(i,!1)},t)};Y(i,e=>{null==M()?e(n):e(l,!1)}),d(e,o)},$$slots:{default:!0}})),e=>m(Je,e,!0),()=>u(Je))};Y(i,e=>{k()||null==M()||e(n)}),d(e,o)},$$slots:{default:!0}})),e=>m(Ze,e,!0),()=>u(Ze))};Y($t,e=>{"outlined"===O()&&e(At)});var Ot=J($t,2);b(Ot,()=>t.leadingIcon??w);var kt=J(Ot,2);P(kt,(e,t)=>({class:e,...t}),[()=>q({[ge()]:!0,"mdc-select__selected-text-container":!0}),()=>ee(we,"selectedTextContainer$")]);var Mt=p(kt);P(Mt,(e,t)=>({id:Z()+"-smui-selected-text",class:e,role:"button","aria-haspopup":"listbox","aria-labelledby":Z()+"-smui-label",...t}),[()=>q({[me()]:!0,"mdc-select__selected-text":!0}),()=>ee(we,"selectedText$")]);var Ft=p(Mt);V(Mt,(e,t)=>{var o;return null==(o=L)?void 0:o(e,t)},he),V(kt,(e,t)=>{var o;return null==(o=L)?void 0:o(e,t)},ue);var Rt=J(kt,2);P(Rt,(e,t)=>({class:e,...t}),[()=>q({[ve()]:!0,"mdc-select__dropdown-icon":!0}),()=>ee(we,"dropdownIcon$")]),V(Rt,(e,t)=>{var o;return null==(o=L)?void 0:o(e,t)},pe);var jt=J(Rt,2),Dt=e=>{var t=K(()=>ee(we,"ripple$"));s(ae(e,F(()=>u(t))),e=>m(Xe,e,!0),()=>u(Xe))};Y(jt,e=>{"outlined"!==O()&&B()&&e(Dt)}),s(bt,e=>ye=e,()=>ye),V(bt,(e,t)=>{var o;return null==(o=L)?void 0:o(e,t)},de);var Pt=J(bt,2);const qt=K(()=>q({[fe()]:!0,"mdc-select__menu":!0,...ze}));var Vt=K(()=>ee(we,"menu$"));qe(Pt,F({get class(){return u(qt)},get id(){return u(ke)},fullWidth:!0,anchor:!1,get anchorElement(){return u(Ge)},get anchorCorner(){return u(He)}},()=>u(Vt),{onSMUIMenuSelected:e=>{var o;u(Se)&&u(Se).handleMenuItemAction(e.detail.index),null==(o=t.onSMUIMenuSelected)||o.call(t,e)},onSMUIMenuSurfaceClosing:e=>{var o;u(Se)&&u(Se).handleMenuClosing(),null==(o=t.onSMUIMenuSurfaceClosing)||o.call(t,e)},onSMUIMenuSurfaceClosed:e=>{var o;u(Se)&&u(Se).handleMenuClosed(),null==(o=t.onSMUIMenuSurfaceClosed)||o.call(t,e)},onSMUIMenuSurfaceOpened:e=>{var o;u(Se)&&u(Se).handleMenuOpened(),null==(o=t.onSMUIMenuSurfaceOpened)||o.call(t,e)},get open(){return u(Ue)},set open(e){m(Ue,e,!0)},children:(e,o)=>{var i=K(()=>ee(we,"list$"));Ve(e,F({role:"listbox",get wrapFocus(){return u(_e)}},()=>u(i),{get selectedIndex(){return u(Oe)},set selectedIndex(e){m(Oe,e,!0)},children:(e,o)=>{var i=R(),n=j(i);b(n,()=>t.children??w),d(e,i)},$$slots:{default:!0}}))},$$slots:{default:!0}})),s(pt,e=>Ie=e,()=>Ie),V(pt,(e,t)=>{var o;return null==(o=Q)?void 0:o(e,t)},()=>({ripple:"filled"===O(),unbounded:!1,addClass:ot,removeClass:it,addStyle:nt})),V(pt,(e,t)=>{var o;return null==(o=Le)?void 0:o(e,t)},()=>({addClass:ot,removeClass:it})),V(pt,(e,t)=>{var o;return null==(o=L)?void 0:o(e,t)},S);var Lt=J(pt,2),Nt=e=>{var n=K(()=>ee(we,"helperText$"));!function(e,t){i(t,!0);let n,l=v(t,"use",19,()=>[]),r=v(t,"class",3,""),a=v(t,"id",19,()=>"SMUI-select-helper-text-"+ur++),h=v(t,"persistent",3,!1),I=v(t,"validationMsg",3,!1),y=D(t,["$$slots","$$events","$$legacy","use","class","id","persistent","validationMsg","children"]),S=g(void 0),C=o({}),x=o({}),B=g(void 0);const $=E("SMUI:select:helper-text:id"),A=E("SMUI:select:helper-text:mount"),O=E("SMUI:select:helper-text:unmount");function k(e){return e in C?C[e]:z().classList.contains(e)}function M(e){C[e]||(C[e]=!0)}function F(e){e in C&&!C[e]||(C[e]=!1)}function N(e){return e in x?x[e]??null:z().getAttribute(e)}function W(e,t){x[e]!==t&&(x[e]=t)}function U(e){e in x&&null==x[e]||(x[e]=void 0)}function z(){return n}f(()=>(m(S,new je({addClass:M,removeClass:F,hasClass:k,getAttr:N,setAttr:W,removeAttr:U,setContent:e=>{m(B,e,!0)}}),!0),$&&$(a()),A&&A(u(S)),u(S).init(),()=>{var e;O&&u(S)&&O(u(S)),null==(e=u(S))||e.destroy()}));var G=gr();P(G,e=>({class:e,"aria-hidden":h()?void 0:"true",id:a(),...x,...y}),[()=>q({[r()]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":I(),"mdc-select-helper-text--validation-msg-persistent":h(),...C})]);var H=p(G),_=e=>{var o=R(),i=j(o);b(i,()=>t.children??w),d(e,o)},J=e=>{var t=ie();T(()=>ne(t,u(B))),d(e,t)};Y(H,e=>{null==u(B)?e(_):e(J,!1)}),s(G,e=>n=e,()=>n),V(G,(e,t)=>{var o;return null==(o=L)?void 0:o(e,t)},l),d(e,G),c({getElement:z})}(e,F(()=>u(n),{children:(e,o)=>{var i=R(),n=j(i);b(n,()=>t.helperText??w),d(e,i)},$$slots:{default:!0}}))};Y(Lt,e=>{t.helperText&&e(Nt)}),T(()=>ne(Ft,h())),d(e,mt);var Wt=c({getUseDefaultValidation:function(){if(null==u(Se))throw new Error("Instance is undefined.");return u(Se).getUseDefaultValidation()},setUseDefaultValidation:ut,focus:function(){ye.focus()},layout:gt,getElement:ht});return a(),Wt}function br(e,t){i(t,!0);const[o,n]=Ce();let r=v(t,"use",19,()=>[]);v(t,"class",3,"");let a,g=v(t,"value",3,""),h=D(t,["$$slots","$$events","$$legacy","use","class","value","children"]);const m=E("SMUI:select:selectedText"),p=E("SMUI:select:value");U("SMUI:list:item:role","option");const T=K(()=>null!=g()&&""!==g()&&xe(p,"$selectedValue",o)===g());function I(){u(T)&&a&&De(m,a.getPrimaryText())}f(I),l(I),s(Ne(e,F({get use(){return r()},get"data-value"(){return g()},get value(){return g()},get selected(){return u(T)}},()=>h,{children:(e,o)=>{var i=R(),n=j(i);b(n,()=>t.children??w),d(e,i)},$$slots:{default:!0}})),e=>a=e,()=>a);var y=c({getElement:function(){return a.getElement()}});return n(),y}var wr=r('<div class="col-12 px-3 mt-0"><!></div>'),Tr=r('<div class="container-fluid p-0"><div class="row gy-3"><div class="col-12"><!></div> <div class="col-12"><!></div> <!> <div class="col-12"><!></div> <div class="col-12"><!></div> <div class="col-12"><!></div></div></div>'),Ir=r("<b>Interactive CYOA Creator Plus</b>"),yr=r('<div class="container-fluid p-0"><div class="row gy-3"><div class="col-12 text-right"> <br/></div></div></div>'),Sr=r("<!> <!>",1),Cr=r("<!> <!>",1),xr=r("<!> <!> <!>",1);function Br(e,t){i(t,!0);let o=v(t,"open",7);const n=[{text:"2 Per Row",value:"col-6"},{text:"3 Per Row",value:"col-4"},{text:"4 Per Row",value:"col-3"}];let l=g("General");function r(){Qt&&Qt.abort(),to()}function a(){const e=Ut.allowDeselect;for(let t=0;t<app.backpack.length;t++){const o=app.backpack[t];o.isResultRow&&(o.isInfoRow=!e)}}se(e,{surface$style:"width: 600px; max-width: calc(100vw - 32px);",get onSMUIDialogClosed(){return t.onclose},get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=xr(),i=j(o);de(i,{class:"text-left dialog-title",tabindex:0,autofocus:!0,children:(e,t)=>{var o=ie("Settings");d(e,o)},$$slots:{default:!0}});var s=J(i,2);ce(s,{children:(e,t)=>{var o=Cr(),i=j(o);{const e=(e,t=w)=>{Re(e,{get tab(){return t()},children:(e,o)=>{he(e,{children:(e,o)=>{var i=ie();T(()=>ne(i,t())),d(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})};ke(i,{tabs:["General","About"],get active(){return u(l)},set active(e){m(l,e,!0)},tab:e,$$slots:{tab:!0}})}var s=J(i,2),c=e=>{Me(e,{role:"tabpanel",variant:"unelevated",children:(e,t)=>{Fe(e,{children:(e,t)=>{var o=Tr(),i=p(o),l=p(i);{const e=e=>{var t=ie("Maximum number of choices per row for screens between 720px and 1280px.");d(e,t)};fr(p(l),{label:"Choices Per Row",variant:"standard",alwaysFloat:!0,get value(){return app.objectsPerRow},set value(e){app.objectsPerRow=e},helperText:e,children:(e,t)=>{var o=R(),i=j(o);fe(i,17,()=>n,e=>e.text,(e,t)=>{br(e,{get value(){return u(t).value},children:(e,o)=>{var i=ie();T(()=>ne(i,u(t).text)),d(e,i)},$$slots:{default:!0}})}),d(e,o)},$$slots:{helperText:!0,default:!0}})}var s=J(l,2),c=p(s);me(c,{label:e=>{var t=ie("Enable Auto Save");d(e,t)},children:(e,t)=>{pe(e,{get checked(){return app.buildAutoSaveIsOn??!1},set checked(e){var t;t=e,app.buildAutoSaveIsOn=t},onSMUISwitchChange:()=>{app.buildAutoSaveIsOn&&r()},color:"secondary",class:"switch-scale"})},$$slots:{label:!0,default:!0}});var g=J(s,2),h=e=>{var t=wr(),o=p(t);Mi(o,{get value(){return app.buildAutoSaveInterval??10},set value(e){var t;t=e,app.buildAutoSaveInterval=t},label:"Auto Save Interval",type:"number",suffix:"min",variant:"standard",style:"max-width: 200px",input$class:"text-right",input$min:"1",onchange:()=>{app.buildAutoSaveInterval<1&&(app.buildAutoSaveInterval=1),r()}}),d(e,t)};Y(g,e=>{app.buildAutoSaveIsOn&&e(h)});var m=J(g,2),v=p(m);me(v,{label:e=>{var t=ie("Preload Images in Backpack");d(e,t)},children:(e,t)=>{pe(e,{get checked(){return app.preloadImages??!1},set checked(e){var t;t=e,app.preloadImages=t},color:"secondary",class:"switch-scale"})},$$slots:{label:!0,default:!0}});var f=J(m,2),b=p(f);me(b,{label:e=>{var t=ie("Allow Deselecting Choices in Backpack");d(e,t)},children:(e,t)=>{pe(e,{onSMUISwitchChange:a,color:"secondary",class:"switch-scale",get checked(){return Ut.allowDeselect},set checked(e){Ut.allowDeselect=e}})},$$slots:{label:!0,default:!0}});var w=J(f,2),I=p(w);me(I,{label:e=>{var t=ie("Show Background Music Player");d(e,t)},children:(e,t)=>{pe(e,{get checked(){return app.showMusicPlayer??!1},set checked(e){var t;t=e,app.showMusicPlayer=t},color:"secondary",class:"switch-scale",onchange:()=>{if(app.showMusicPlayer){const e=A(Lt);if(e){let t=0,o=0;0!==Nt.bgmTitleInterval&&(clearInterval(Nt.bgmTitleInterval),Nt.bgmTitleInterval=0),Nt.bgmTitleInterval=window.setInterval(()=>{if(void 0!==e.playerInfo.videoData&&""!==Nt.bgmObjectId){const t=At.get(Nt.bgmObjectId);if(void 0!==t){const o=t.choice;e.playerInfo.videoData.video_id===o.bgmId&&void 0!==e.playerInfo.videoData.title&&""!==e.playerInfo.videoData.title&&(Nt.bgmTitle=e.playerInfo.videoData.title,Nt.curBgmLength=e.getDuration(),clearInterval(Nt.bgmTitleInterval),Nt.bgmTitleInterval=0)}}},1e3),0!==Nt.bgmPlayInterval&&(clearInterval(Nt.bgmPlayInterval),Nt.bgmPlayInterval=0),Nt.bgmPlayInterval=window.setInterval(()=>{if(void 0!==e.playerInfo.videoData&&!Nt.isSeeking&&1===e.getPlayerState()){const i=Math.floor(e.getCurrentTime());i!==Nt.curBgmTime?t!==i?Nt.curBgmTime=i:(o++,o>Nt.curBgmLength&&(o=1),Nt.curBgmTime=o):(t=i,o=i+1,Nt.curBgmTime=o)}},1e3)}}else Nt.bgmIsPlaying&&(0!==Nt.bgmTitleInterval&&(clearInterval(Nt.bgmTitleInterval),Nt.bgmTitleInterval=0),0!==Nt.bgmPlayInterval&&(clearInterval(Nt.bgmPlayInterval),Nt.bgmPlayInterval=0))}})},$$slots:{label:!0,default:!0}});d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},g=(e,t)=>{var o=e=>{Me(e,{role:"tabpanel",variant:"unelevated",children:(e,t)=>{var o=Sr(),i=j(o);We(i,{class:"text-center",children:(e,t)=>{var o=Ir();d(e,o)},$$slots:{default:!0}});var n=J(i,2);Fe(n,{children:(e,t)=>{var o=yr(),i=p(o),n=p(i),l=p(n);T(()=>ne(l,`v${ct}`)),d(e,o)},$$slots:{default:!0}}),d(e,o)},$$slots:{default:!0}})};Y(e,e=>{"About"===u(l)&&e(o)},t)};Y(s,e=>{"General"===u(l)?e(c):e(g,!1)}),d(e,o)},$$slots:{default:!0}});var c=J(s,2);ue(c,{children:(e,t)=>{ge(e,{action:"close",children:(e,t)=>{he(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=ie("Close");d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),d(e,o)},$$slots:{default:!0}}),c()}var $r=r("<!> <!>",1),Ar=r("<!> <!>",1),Or=r("<!> <!> <!>",1),kr=r("<i></i>"),Mr=r('<i class="mdi mdi-stop"></i>'),Fr=r("<i></i>"),Rr=r('<!> <!> <!> <div class="px-1" style="max-width: 104px; width: 100%"><!></div> <div class="ps-1" style="max-width:150px; overflow: hidden;"><span class="scrolling-text"> </span></div> <div class="px-1 col"><!></div> <div class="text-center" style="width: 180px"> </div>',1),jr=r('<i class="mdi mdi-format-list-checks"></i>'),Dr=r('<div class="py-0 justify-center"><!></div>'),Pr=r('<i class="mdi mdi-checkbox-marked-circle-outline"></i>'),qr=r("<!> <!> <!>",1),Vr=r("<div><!></div>"),Lr=r('<div class="ab-0"><div class="fadeOverlay"></div> <!> <!> <div class="s-main"><!> <!> <div class="container-fluid p-0"><div class="row gx-0"></div></div></div></div> <!> <!> <!> <!>',1);function Nr(e,t){i(t,!0);const o=[{action:()=>{!function(){const e=localStorage.getItem("theme");qt.value="dark"===e?"light":"dark";let t=document.head.querySelector("#theme-dark"),o=document.head.querySelector("#theme-light");"dark"===qt.value?(t&&(t.media="screen and (prefers-color-scheme: light)"),o&&(o.media="screen and (prefers-color-scheme: dark)")):(t&&(t.media="screen and (prefers-color-scheme: dark)"),o&&(o.media="screen and (prefers-color-scheme: light)"));localStorage.setItem("theme",qt.value)}()},text:"Toogle Dark/Light Theme",icon:"mdi mdi-theme-light-dark"},{action:()=>{m(f,!u(f))},text:"Top/Bottom Point Bar",icon:"mdi mdi-swap-vertical"},{action:()=>{Mo()},text:"Clean Selected Choices",icon:"mdi mdi-select-off"},{action:()=>{m(b,"appSaveLoad"),m(v,!1)},text:"Save/Load Build",icon:"mdi mdi-content-save"},{action:()=>{m(b,"appGlobalSettings"),m(v,!1)},text:"Settings",icon:"mdi mdi-cog"}];let r,v=g(!1),f=g(!1),b=g("none"),w=K(()=>u(f)?app.showMusicPlayer?"top: 32px;":"top: 0;":"bottom: 0;"),y=K(()=>`opacity: ${app.fadeTransitionIsOn?1:0}; transition: opacity ${app.fadeTransitionTime}s ease-out; background-color: ${app.fadeTransitionColor}; pointer-events: ${app.fadeTransitionIsOn?"auto":"none"}; cursor: ${app.fadeTransitionIsOn?"none":"auto"};`),S=g(0),C=g(void 0),x=K(()=>app.pointTypes.length>0||app.backpack.length>0||app.importedChoicesIsOpen),B=K(()=>`background-color: ${app.styling.barBackgroundColor};margin:${app.styling.barMargin}px;padding:${app.styling.barPadding}px;${u(w)}`),$=K(()=>`color: ${app.styling.barTextColor};margin: ${app.styling.barTextMargin}px;padding: ${app.styling.barTextPadding}px;font-family: "${app.styling.barTextFont}";font-size: ${app.styling.barTextSize}px`),O=K(()=>`color: ${app.styling.barIconColor};`),k=K(()=>{let e=[];return app.styling.backgroundImage&&e.push(`background-image: url('${app.styling.backgroundImage}');`),e.push(`background-color: ${app.styling.backgroundColor};`),app.styling.isBackgroundRepeat?e.push("background-repeat: repeat;"):app.styling.isBackgroundFitIn?e.push("background-size: 100% 100%;"):e.push("background-size: cover;"),u(x)&&e.push("padding-bottom: 56px;"),app.useVW&&e.push("font-size: 0.835vw;"),e.join("")}),M=K(()=>{let e=[];return app.showMusicPlayer&&e.push("padding-top: 32px;"),e.join("")}),F=K(()=>`${V(Nt.curBgmTime)} | ${V(Nt.curBgmLength)}`),D=g(0),P=g(100),q=g(!1);function V(e){const t=Math.floor(e/3600),o=Math.floor(e%3600/60),i=Math.floor(e%60),n=String(o).padStart(2,"0"),l=String(i).padStart(2,"0");return t>0?`${t}:${n}:${l}`:`${n}:${l}`}function L(){if(Lt&&0!==Nt.curBgmLength){const e=A(Lt);if(e)if(Nt.bgmIsPlaying)e.pauseVideo(),Nt.bgmIsPlaying=!1,0!==Nt.bgmPlayInterval&&(clearInterval(Nt.bgmPlayInterval),Nt.bgmPlayInterval=0);else{let t=0,o=0;0!==Nt.bgmPlayInterval&&(clearInterval(Nt.bgmPlayInterval),Nt.bgmPlayInterval=0),e.playVideo(),Nt.bgmIsPlaying=!0,Nt.bgmPlayInterval=window.setInterval(()=>{if(void 0!==e.playerInfo.videoData&&!Nt.isSeeking&&1===e.getPlayerState()){const i=Math.floor(e.getCurrentTime());i!==Nt.curBgmTime?t!==i?Nt.curBgmTime=i:(o++,o>Nt.curBgmLength&&(o=1),Nt.curBgmTime=o):(t=i,o=i+1,Nt.curBgmTime=o)}},1e3)}}}function N(){if(Lt&&Nt.bgmIsPlaying&&0!==Nt.curBgmLength){const e=A(Lt);e&&(e.stopVideo(),Nt.bgmIsPlaying=!1,Nt.curBgmTime=0,0!==Nt.bgmPlayInterval&&(clearInterval(Nt.bgmPlayInterval),Nt.bgmPlayInterval=0))}}function W(){if(app.isMute=!app.isMute,Lt){const e=A(Lt);e&&(app.isMute?e.mute():e.unMute())}}function E(){Lt&&Nt.bgmIsPlaying&&(Nt.isSeeking=!0)}function U(){var e;if(Lt&&Nt.bgmIsPlaying){const e=A(Lt);e&&(e.seekTo(u(D),!0),Nt.curBgmTime=u(D)),Nt.isSeeking=!1}null==(e=document.activeElement)||e.blur()}function z(){m(q,!0)}function G(){var e;if(app.curVolume=u(P),Lt){const e=A(Lt);e&&e.setVolume(u(P))}m(q,!1),null==(e=document.activeElement)||e.blur()}n(()=>{Et.isOpen&&(r.close(),r.open(),Et.isOpen=!1)}),n(()=>{Nt.isSeeking||m(D,Nt.curBgmTime,!0)}),n(()=>{u(q)||m(P,app.curVolume,!0)});var H=Lr(),_=j(H),X=p(_),Z=J(X,2);Ee(Z,{style:"top: 0;",variant:"modal",get open(){return u(v)},set open(e){m(v,e,!0)},children:(e,t)=>{Ge(e,{class:"navigation-drawer",children:(e,t)=>{Ve(e,{children:(e,t)=>{var i=Or(),n=j(i);Ne(n,{onSMUIAction:()=>m(v,!1),class:"my-0",children:(e,t)=>{var o=$r(),i=j(o);He(i,{class:"mdi mdi-chevron-left"});var n=J(i,2);_e(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=ie("Close Menu");d(e,o)},$$slots:{default:!0}}),d(e,o)},$$slots:{default:!0}});var l=J(n,2);Ye(l,{class:"my-3"});var r=J(l,2);fe(r,17,()=>o,be,(e,t)=>{Ne(e,{get onSMUIAction(){return u(t).action},class:"my-0",children:(e,o)=>{var i=Ar(),n=j(i);He(n,{get class(){return u(t).icon}});var l=J(n,2);_e(l,{class:"w-100 list-text text-center",children:(e,o)=>{var i=ie();T(()=>ne(i,u(t).text)),d(e,i)},$$slots:{default:!0}}),d(e,i)},$$slots:{default:!0}})}),d(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}});var Q=J(Z,2);Ue(Q,{});var ee=J(Q,2),te=p(ee),oe=e=>{Je(e,{class:"music-player",variant:"fixed",children:(e,t)=>{Xe(e,{class:"music-player--row",children:(e,t)=>{Ze(e,{class:"px-2 justify-left",children:(e,t)=>{var o=Rr(),i=j(o);ve(i,{class:"music-player--button",onclick:L,size:"button","aria-label":"Play",children:(e,t)=>{var o=kr();T(()=>I(o,1,re(Nt.bgmIsPlaying?"mdi mdi-pause":"mdi mdi-play"))),d(e,o)},$$slots:{default:!0}});var n=J(i,2);ve(n,{class:"music-player--button",onclick:N,size:"button","aria-label":"Stop",children:(e,t)=>{var o=Mr();d(e,o)},$$slots:{default:!0}});var l=J(n,2);ve(l,{class:"music-player--button",onclick:W,size:"button","aria-label":"Mute",children:(e,t)=>{var o=Fr();T(()=>I(o,1,re(app.isMute?"mdi mdi-volume-off":"mdi mdi-volume-high"))),d(e,o)},$$slots:{default:!0}});var r=J(l,2),a=p(r);ye(a,{min:0,max:100,step:1,class:"mx-2",onpointerdown:z,onpointerup:G,get disabled(){return app.isMute},get value(){return u(P)},set value(e){m(P,e,!0)}});var s=J(r,2),c=p(s),g=p(c),h=J(s,2),v=p(h);const f=K(()=>Nt.curBgmLength||1);ye(v,{min:0,get max(){return u(f)},step:1,class:"mx-2",onpointerdown:E,onpointerup:U,get value(){return u(D)},set value(e){m(D,e,!0)}});var b=J(h,2),w=p(b);T(()=>{ne(g,Nt.bgmTitle),ne(w,u(F))}),d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})};Y(te,e=>{app.showMusicPlayer&&e(oe)});var le=J(te,2),ae=e=>{Je(e,{class:"pointBar",get style(){return u(B)},variant:"fixed",color:"secondary",children:(e,t)=>{Xe(e,{class:"justify-space-around",children:(e,t)=>{var o=qr(),n=j(o);Ze(n,{class:"py-0 justify-center",children:(e,t)=>{ve(e,{class:"pointbar-icons",onclick:()=>m(v,!0),"aria-label":"Open Import Window",get style(){return u(O)},children:(e,t)=>{var o=jr();d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var l=J(n,2);Ze(l,{class:"pointbar-center--viewer",children:(e,t)=>{var o=R(),n=j(o);fe(n,17,()=>app.pointTypes,be,(e,t)=>{var o=R(),n=j(o),l=e=>{var o=Dr();!function(e,t){i(t,!0);let o=K(()=>`color: ${app.styling.barTextColor};margin: ${app.styling.barTextMargin}px;padding: ${app.styling.barTextPadding}px;font-family: "${app.styling.barTextFont}";font-size: ${app.styling.barTextSize}px`),n=K(()=>{if(t.point.startingSum>=0){if(void 0!==app.styling.barPointPos)return`color: ${app.styling.barPointPos};`}else if(void 0!==app.styling.barPointNeg)return`color: ${app.styling.barPointNeg};`;return""});function l(e,t){const o=t?e.negativeImage:e.image,i=t?e.negativeIconWidth:e.iconWidth,n=t?e.negativeIconHeight:e.iconHeight;return o?`<img src="${o}" style="width: ${i}px; height:${n}px;" alt="">`:""}var r=ql(),s=p(r),g=p(s),h=e=>{var o=R(),i=j(o),n=e=>{var o=R(),i=j(o),n=e=>{var o=R(),i=j(o);a(i,()=>l(t.point,!0)),d(e,o)};Y(i,e=>{t.point.negativeImageOnSide||t.point.negativeImageSidePlacement||e(n)}),d(e,o)},r=e=>{var o=R(),i=j(o),n=e=>{var o=R(),i=j(o);a(i,()=>l(t.point,!1)),d(e,o)};Y(i,e=>{t.point.imageOnSide||t.point.imageSidePlacement||e(n)}),d(e,o)};Y(i,e=>{t.point.negativeIconIsOn&&t.point.startingSum<0?e(n):e(r,!1)}),d(e,o)};Y(g,e=>{t.point.iconIsOn&&e(h)});var m=J(g),v=J(m),f=e=>{var o=R(),i=j(o),n=e=>{var o=R(),i=j(o),n=e=>{var o=R(),i=j(o);a(i,()=>l(t.point,!0)),d(e,o)};Y(i,e=>{t.point.negativeImageOnSide&&!t.point.negativeImageSidePlacement&&e(n)}),d(e,o)},r=e=>{var o=R(),i=j(o),n=e=>{var o=R(),i=j(o);a(i,()=>l(t.point,!1)),d(e,o)};Y(i,e=>{t.point.imageOnSide&&!t.point.imageSidePlacement&&e(n)}),d(e,o)};Y(i,e=>{t.point.negativeIconIsOn&&t.point.startingSum<0?e(n):e(r,!1)}),d(e,o)};Y(v,e=>{t.point.iconIsOn&&e(f)});var b=J(v,2),w=p(b),I=J(b,2),y=e=>{var o=R(),i=j(o),n=e=>{var o=R(),i=j(o),n=e=>{var o=R(),i=j(o);a(i,()=>l(t.point,!0)),d(e,o)};Y(i,e=>{!t.point.negativeImageOnSide&&t.point.negativeImageSidePlacement&&e(n)}),d(e,o)},r=e=>{var o=R(),i=j(o),n=e=>{var o=R(),i=j(o);a(i,()=>l(t.point,!1)),d(e,o)};Y(i,e=>{!t.point.imageOnSide&&t.point.imageSidePlacement&&e(n)}),d(e,o)};Y(i,e=>{t.point.negativeIconIsOn&&t.point.startingSum<0?e(n):e(r,!1)}),d(e,o)};Y(I,e=>{t.point.iconIsOn&&e(y)});var S=J(I),C=J(S),x=e=>{var o=R(),i=j(o),n=e=>{var o=R(),i=j(o),n=e=>{var o=R(),i=j(o);a(i,()=>l(t.point,!0)),d(e,o)};Y(i,e=>{t.point.negativeImageOnSide&&t.point.negativeImageSidePlacement&&e(n)}),d(e,o)},r=e=>{var o=R(),i=j(o),n=e=>{var o=R(),i=j(o);a(i,()=>l(t.point,!1)),d(e,o)};Y(i,e=>{t.point.imageOnSide&&t.point.imageSidePlacement&&e(n)}),d(e,o)};Y(i,e=>{t.point.negativeIconIsOn&&t.point.startingSum<0?e(n):e(r,!1)}),d(e,o)};Y(C,e=>{t.point.iconIsOn&&e(x)}),T(e=>{Te(r,u(o)),Te(s,t.point.pointPrivateColorIsOn?`color: ${t.point.startingSum>=0?t.point.privateColor:t.point.privateNegativeColor}`:""),ne(m,` ${t.point.beforeText??""} `),Te(b,u(n)),ne(w,e),ne(S,` ${t.point.afterText??""} `)},[()=>t.point.startingSum%1==0?t.point.startingSum:parseFloat(t.point.startingSum.toFixed(t.point.decimalPlaces??2))]),d(e,r),c()}(p(o),{get point(){return u(t)}}),T(()=>Te(o,u($))),d(e,o)};Y(n,e=>{(function(e){if(e.isNotShownPointBar){if(void 0!==e.activatedId&&""!==e.activatedId){let t=kt.get(e.activatedId),o=Ft.get(e.activatedId);return void 0!==t?wo(t.requireds):void 0!==o?o.isTrue:fo(e.activatedId)}return!1}return!0})(u(t))&&e(l)}),d(e,o)}),d(e,o)},$$slots:{default:!0}});var r=J(l,2);Ze(r,{class:"py-0 justify-center",children:(e,t)=>{var o=R(),i=j(o),n=e=>{ve(e,{class:"pointbar-icons",onclick:()=>m(b,"dlgBackpack"),"aria-label":"Open Backpack Window",get style(){return u(O)},children:(e,t)=>{var o=Pr();d(e,o)},$$slots:{default:!0}})};Y(i,e=>{app.backpack.length>0&&(void 0===app.hideBackpackBtn||0===app.hideBackpackBtn||app.hideBackpackBtn>0&&app.hideBackpackBtn===app.btnBackpackIsOn)&&e(n)}),d(e,o)},$$slots:{default:!0}}),d(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};Y(le,e=>{u(x)&&e(ae)});var se=J(le,2),de=p(se);fe(de,21,()=>app.rows,be,(e,t)=>{var o=Vr();Pl(p(o),{get row(){return u(t)},get windowWidth(){return u(S)},get mainDiv(){return u(C)}}),T(()=>I(o,1,re(u(t).width?"col-6":"col-12"))),d(e,o)}),s(de,e=>m(C,e),()=>u(C));var ce=J(_,2),ue=e=>{const t=K(()=>"appSaveLoad"===u(b));on(e,{get open(){return u(t)},onclose:()=>m(b,"none")})},ge=(e,t)=>{var o=e=>{const t=K(()=>"dlgBackpack"===u(b));Ul(e,{get open(){return u(t)},onclose:()=>m(b,"none")})},i=(e,t)=>{var o=e=>{const t=K(()=>"appGlobalSettings"===u(b));Br(e,{get open(){return u(t)},onclose:()=>m(b,"none")})};Y(e,e=>{"appGlobalSettings"===u(b)&&e(o)},t)};Y(e,e=>{"dlgBackpack"===u(b)?e(o):e(i,!1)},t)};Y(ce,e=>{"appSaveLoad"===u(b)?e(ue):e(ge,!1)});var me=J(ce,2),pe=e=>{const t=K(()=>"appImageUpload"===Wt.currentDialog);cr(e,{get open(){return u(t)},onclose:()=>Wt.currentDialog="none",get imgObject(){return Wt.data},get imgProp(){return Wt.imgProp}})},we=(e,t)=>{var o=e=>{const t=K(()=>"dlgCommon"===Wt.currentDialog);Pi(e,{get open(){return u(t)},onclose:()=>Wt.currentDialog="none",get closeHandler(){return Wt.cFunc},get title(){return Wt.title},get context(){return Wt.context},get isWord(){return Wt.isWord}})};Y(e,e=>{"dlgCommon"===Wt.currentDialog&&void 0!==Wt.cFunc&&void 0!==Wt.title&&void 0!==Wt.context&&e(o)},t)};Y(me,e=>{"appImageUpload"===Wt.currentDialog&&void 0!==Wt.data&&void 0!==Wt.imgProp?e(pe):e(we,!1)});var Ie=J(me,2);!function(e,t){i(t,!0);let o=g(void 0),r=null;n(()=>{u(o)&&""!==Qe.text&&(Qe.isVisible&&Qe.anchor?(null==r||r.destroy(),r=h(Qe.anchor,u(o),{placement:"bottom",modifiers:[{name:"offset",options:{offset:[0,6]}},{name:"preventOverflow",options:{boundary:"viewport"}},{name:"flip",options:{fallbackPlacements:["bottom","top"]}}]}),u(o).classList.add("mdc-tooltip--shown")):r&&(r.destroy(),r=null,u(o).classList.remove("mdc-tooltip--shown")))}),l(()=>{null==r||r.destroy()});var v=et(),f=p(v),b=p(f);a(b,()=>Qe.text),s(v,e=>m(o,e),()=>u(o)),d(e,v),c()}(Ie,{});var Se=J(Ie,2);s(ze(Se,{get labelText(){return Et.labelText},get timeoutMs(){return Et.timeoutMs},children:(e,t)=>{he(e,{class:"text-center"})},$$slots:{default:!0}}),e=>r=e,()=>r),T(()=>{Te(_,u(k)),Te(X,u(y)),Te(ee,u(M))}),Be(_,"clientWidth",e=>m(S,e)),d(e,H),c()}var Wr=r('<div id="bgm-player" style="display:none"></div> <!>',1);Ke(function(e,t){let o,n,r;i(t,!0);let a="<div>Loading</div>";async function s(e){const t=Array.from(e);for(let i=0;i<t.length;i++){const e=t[i];try{await new Promise((t,o)=>{const i=new Image;i.onload=t,i.onerror=o,i.src=e})}catch(o){console.error(o)}finally{n&&(n.innerHTML=`<div>Images</div><div>${i} / ${t.length}</div>`)}}}async function u(){if(Yt.value){const t="Your browser does not support the .avif format.\n Avif images may not be displayed.";try{await new Promise((e,t)=>{const o=new Image;o.onload=e,o.onerror=t,o.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="})}catch(e){console.error(e),Et.labelText=t,Et.isOpen=!0}}}f(()=>{window.debugApp=app,function(){if("dark"===localStorage.getItem("theme")){let e=document.head.querySelector("#theme-dark"),t=document.head.querySelector("#theme-light");e&&(e.media="screen and (prefers-color-scheme: light)"),t&&(t.media="screen and (prefers-color-scheme: dark)"),qt.value="dark"}}(),async function(){const e=(await Kt()).transaction("buildStore","readonly").objectStore("buildStore"),t=location.pathname.replace(/\/index\.html$/,"/");await new Promise((o,i)=>{const n=e.openCursor();n.onsuccess=e=>{const i=e.target.result;if(!i)return void o();const n=i.key,l=i.value;if("string"==typeof n&&n.startsWith(t)){const e=n.slice(t.length);if("autoSave"===e)zt.stored=!0,zt.time=l.time,zt.app=l.app;else{const t=e.match(/^slot-(\d+)$/),o=Number(null==t?void 0:t[1]);Gt[o].stored=!0,Gt[o].name=l.name??`Slot ${o+1}`,Gt[o].time=l.time,Gt[o].app=l.app}}i.continue()},n.onerror=i})}(),async function(){o=document.getElementById("lm"),r=document.getElementById("projectSize"),n=document.getElementById("indicator");const e=r?parseInt(r.innerHTML):0,t=n?n.className:"";if(n&&(a=n.innerHTML),o&&(o.style.pointerEvents="none"),"function"==typeof window.fetch)try{const i=await fetch("project.json");if(i&&i.body){const l=i.body.getReader(),d=new TextDecoder;let c=0,g="";for(;;){const{done:o,value:i}=await l.read();if(o)break;c+=i.length,g+=d.decode(i,{stream:!0}),n&&(n.innerHTML="ind2"===t&&e>0?`${a}<div>${(c/e*100).toFixed(1)} %</div>`:"ind3"===t&&e>0?`${a}<div>${(c/1e6).toFixed(1)}/${(e/1e6).toFixed(1)} MB</div>`:`${a}<div>${(c/1e6).toFixed(1)} MB</div>`)}o&&(o.style.height="0");const h=ai(JSON.parse(g)),m=li.safeParse(h);m.success?(ci(m.data),app.preloadExternalImages&&_t.size>0&&await s(_t),setTimeout(()=>{const e=document.createElement("style");document.head.appendChild(e),setTimeout(()=>{o&&(o.style.height="",o.style.opacity="1",o.style.pointerEvents=""),n&&n.remove(),r&&r.remove(),e.sheet&&e.sheet.insertRule("body::before{opacity:0;transition:opacity 2s}",0)},1e3)},1e3),await u()):(Et.labelText="Failed to load data.",Et.isOpen=!0,console.error(m.error))}}catch(i){console.error(i),o&&(o.style.height="0"),ci(JSON.parse(JSON.stringify(app))),app.preloadExternalImages&&_t.size>0&&await s(_t),setTimeout(()=>{const e=document.createElement("style");document.head.appendChild(e),setTimeout(()=>{o&&(o.style.height="",o.style.opacity="1",o.style.pointerEvents=""),n&&n.remove(),r&&r.remove(),e.sheet&&e.sheet.insertRule("body::before{opacity:0;transition:opacity 2s}",0)},1e3)},1e3),await u()}else{const i=new XMLHttpRequest;i.open("GET","project.json",!0),i.onprogress=o=>{n&&(n.innerHTML="ind2"===t&&e>0?`${a}<div>${(o.loaded/e*100).toFixed(1)} %</div>`:"ind3"===t&&e>0?`${a}<div>${(o.loaded/1e6).toFixed(1)}/${(e/1e6).toFixed(1)} MB</div>`:`${a}<div>${(o.loaded/1e6).toFixed(1)} MB</div>`)},i.onload=async()=>{o&&(o.style.height="0"),200===i.status?(ci(JSON.parse(i.responseText)),app.preloadExternalImages&&app.externalImages.size>0&&await s(app.externalImages)):ci(JSON.parse(JSON.stringify(app))),setTimeout(()=>{const e=document.createElement("style");document.head.appendChild(e),setTimeout(()=>{o&&(o.style.height="",o.style.opacity="1",o.style.pointerEvents=""),n&&n.remove(),r&&r.remove(),e.sheet&&e.sheet.insertRule("body::before{opacity:0;transition:opacity 2s}",0)},1e3)},1e3),await u()},i.send()}}();const e=e=>{e.preventDefault(),e.returnValue=""};window.addEventListener("beforeunload",e),l(()=>{Lt.update(e=>(null==e||e.destroy(),null)),window.removeEventListener("beforeunload",e)})});var g=Wr();Nr(J(j(g),2),{}),d(e,g),c()},{target:document.getElementById("app")});
